category: Utilities
commonfields:
  id: MalwareBazaar
  version: -1
configuration:
- defaultvalue: https://mb-api.abuse.ch/api/v1/
  display: Server URL
  name: url
  required: true
  type: 0
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- display: Trust any certificate
  name: insecure
  required: false
  type: 8
- display: API Key
  name: api_key
  required: true
  type: 4
description: Generated description - REPLACE THIS
display: MalwareBazaar
name: MalwareBazaar
script:
  commands:
  - arguments:
    - default: false
      description: SHA256, MD5 or SHA1 hash of the malware sample you want to query
      isArray: false
      name: hash
      required: true
      secret: false
    deprecated: false
    description: Check if a particular malware sample is known to MalwareBazaar
    execution: false
    name: file
    outputs:
    - contextPath: MalwareBazaar.File.query_status
      type: String
    - contextPath: MalwareBazaar.File.data.sha256_hash
      type: String
    - contextPath: MalwareBazaar.File.data.sha3_384_hash
      type: String
    - contextPath: MalwareBazaar.File.data.sha1_hash
      type: String
    - contextPath: MalwareBazaar.File.data.md5_hash
      type: String
    - contextPath: MalwareBazaar.File.data.first_seen
      type: Date
    - contextPath: MalwareBazaar.File.data.last_seen
      type: Date
    - contextPath: MalwareBazaar.File.data.file_name
      type: String
    - contextPath: MalwareBazaar.File.data.file_size
      type: Number
    - contextPath: MalwareBazaar.File.data.file_type_mime
      type: String
    - contextPath: MalwareBazaar.File.data.file_type
      type: String
    - contextPath: MalwareBazaar.File.data.reporter
      type: String
    - contextPath: MalwareBazaar.File.data.origin_country
      type: String
    - contextPath: MalwareBazaar.File.data.anonymous
      type: Number
    - contextPath: MalwareBazaar.File.data.signature
      type: String
    - contextPath: MalwareBazaar.File.data.imphash
      type: String
    - contextPath: MalwareBazaar.File.data.tlsh
      type: String
    - contextPath: MalwareBazaar.File.data.telfhash
      type: Unknown
    - contextPath: MalwareBazaar.File.data.ssdeep
      type: String
    - contextPath: MalwareBazaar.File.data.dhash_icon
      type: Unknown
    - contextPath: MalwareBazaar.File.data.comment
      type: Unknown
    - contextPath: MalwareBazaar.File.data.tags
      type: String
    - contextPath: MalwareBazaar.File.data.code_sign
      type: Unknown
    - contextPath: MalwareBazaar.File.data.delivery_method
      type: Unknown
    - contextPath: MalwareBazaar.File.data.intelligence.clamav
      type: String
    - contextPath: MalwareBazaar.File.data.intelligence.downloads
      type: String
    - contextPath: MalwareBazaar.File.data.intelligence.uploads
      type: String
    - contextPath: MalwareBazaar.File.data.intelligence.mail
      type: Unknown
    - contextPath: MalwareBazaar.File.data.file_information
      type: Unknown
    - contextPath: MalwareBazaar.File.data.yara_rules.rule_name
      type: String
    - contextPath: MalwareBazaar.File.data.yara_rules.author
      type: String
    - contextPath: MalwareBazaar.File.data.yara_rules.description
      type: Unknown
    - contextPath: MalwareBazaar.File.data.yara_rules.reference
      type: Unknown
    - contextPath: MalwareBazaar.File.data.vendor_intel.YOROI_YOMI.detection
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.YOROI_YOMI.score
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Triage.malware_family
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Triage.score
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Triage.link
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Triage.tags
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Triage.signatures.signature
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Triage.signatures.score
      type: Unknown
    - contextPath: MalwareBazaar.File.data.vendor_intel.ReversingLabs.threat_name
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.ReversingLabs.status
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.ReversingLabs.first_seen
      type: Date
    - contextPath: MalwareBazaar.File.data.vendor_intel.ReversingLabs.scanner_count
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.ReversingLabs.scanner_match
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.ReversingLabs.scanner_percent
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Spamhaus_HBL.detection
      type: String
    - contextPath: MalwareBazaar.File.data.vendor_intel.Spamhaus_HBL.link
      type: String
    - contextPath: MalwareBazaar.File.data.comments.id
      type: String
    - contextPath: MalwareBazaar.File.data.comments.date_added
      type: Date
    - contextPath: MalwareBazaar.File.data.comments.twitter_handle
      type: String
    - contextPath: MalwareBazaar.File.data.comments.display_name
      type: String
    - contextPath: MalwareBazaar.File.data.comments.comment
      type: String
  - arguments:
    - default: false
      description: SHA256 hash of the malware sample to download
      isArray: false
      name: sha256_hash
      required: true
      secret: false
    deprecated: false
    description: download (fetch) malware samples from MalwareBazaar. Any malware
      sample downloaded from MalwareBazaar is zipped and password protected using
      the password "infected" (without "").
    execution: false
    name: malwarebazaar-download-sample
  - arguments:
    - default: false
      description: SHA256 hash of the malware sample you want comment
      isArray: false
      name: sha256_hash
      required: true
      secret: false
    - default: false
      description: Comment on the sample
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Comment a malware sample
    execution: false
    name: malwarebazaar-comment-add
    outputs:
    - contextPath: MalwareBazaar.MalwarebazaarCommentAdd.query_status
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Type of sample based on it the API will we queried,issuer_cn
      isArray: false
      name: sample_type
      predefined:
      - tag
      - signatue
      - fie_type
      - clamav
      - imphash
      - yara_rule
      required: true
      secret: false
    - default: false
      isArray: false
      name: sample_value
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: Defualt value is 50 and max number of results is 1000. Be aware,
        when using issuer_cn, all relevant result will display (max 100)
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    execution: false
    name: malwarebazaar-samples-list
    outputs:
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.query_status
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.sha256_hash
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.sha3_384_hash
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.sha1_hash
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.md5_hash
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.first_seen
      type: Date
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.last_seen
      type: Unknown
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.file_name
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.file_size
      type: Number
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.file_type_mime
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.file_type
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.reporter
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.anonymous
      type: Number
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.signature
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.imphash
      type: Unknown
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.tlsh
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.telfhash
      type: Unknown
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.ssdeep
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.dhash_icon
      type: Unknown
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.tags
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.intelligence.clamav
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.intelligence.downloads
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.intelligence.uploads
      type: String
    - contextPath: MalwareBazaar.MalwarebazaarSamplesList.data.intelligence.mail
      type: Unknown
  dockerimage: demisto/python3:3.9.7.24076
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
