MalwareBazaar is a project from abuse.ch with the goal of sharing malware samples with the infosec community, AV vendors and threat intelligence providers.
This integration was integrated and tested with version xx of MalwareBazaar

## Configure MalwareBazaar on Cortex XSOAR

1. Navigate to **Settings** > **Integrations** > **Servers & Services**.
2. Search for MalwareBazaar.
3. Click **Add instance** to create and configure a new integration instance.

    | **Parameter** | **Required** |
    | --- | --- |
    | Server URL | True |
    | API Key | True |
    | Use system proxy settings | False |
    | Trust any certificate (not secure) | False |

4. Click **Test** to validate the URLs, token, and connection.
## Commands
You can execute these commands from the Cortex XSOAR CLI, as part of an automation, or in a playbook.
After you successfully execute a command, a DBot message appears in the War Room with the command details.
### file
***
Check if a particular malware sample is known to MalwareBazaar.


#### Base Command

`file`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| file | list of SHA256, MD5 or SHA1 hash of the malware samples you want to query. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| MalwareBazaar.File.sha256_hash | String | SHA256 hash of the malware sample | 
| MalwareBazaar.File.sha3_384_hash | String | SHA3-384 hash of the malware sample | 
| MalwareBazaar.File.sha1_hash | String | SHA1 hash of the malware sample | 
| MalwareBazaar.File.md5_hash | String | MD5 hash of the malware sample | 
| MalwareBazaar.File.first_seen | Date | TS when the file has been first seen by MalwareBazaar \(UTC\) | 
| MalwareBazaar.File.last_seen | Date | TS when the file has been last seen by MalwareBazaar \(UTC\) | 
| MalwareBazaar.File.file_name | String | Malware sample's file name | 
| MalwareBazaar.File.file_size | Number | File size in bytes | 
| MalwareBazaar.File.file_type_mime | String | MIME file type | 
| MalwareBazaar.File.file_type | String | File type | 
| MalwareBazaar.File.reporter | String | Twitter handle of the report \(or anonymous for anonymous submissions\) | 
| MalwareBazaar.File.origin_country | String | Two letter country code of the country where the sample was uploaded from | 
| MalwareBazaar.File.anonymous | Number | 1 \(true\) or 0 \(false\) | 
| MalwareBazaar.File.signature | String | Malware family \(if available\) | 
| MalwareBazaar.File.imphash | String | imphash \(only available for PE executables\) | 
| MalwareBazaar.File.tlsh | String | Trend Micro Locality Sensitive Hash \(tlsh\) | 
| MalwareBazaar.File.telfhash | Unknown | Trend Micro ELF Hash \(telfhash\) | 
| MalwareBazaar.File.ssdeep | String | ssdeep | 
| MalwareBazaar.File.dhash_icon | Unknown | In case the file is a PE executable: dhash of the samples icon | 
| MalwareBazaar.File.comment | Unknown | comment | 
| MalwareBazaar.File.tags | String | list of tags | 
| MalwareBazaar.File.code_sign.subject_cn | Unknown | Subject Common Name \(CN\) | 
| MalwareBazaar.File.code_sign.issuer_cn | Unknown | Issuer Common Name \(CN\) | 
| MalwareBazaar.File.code_sign.algorithm | Unknown | Algorithm used | 
| MalwareBazaar.File.code_sign.valid_from | Unknown | Datetime valid from | 
| MalwareBazaar.File.code_sign.valid_to | Unknown | Datetime valid to \(expire date\) | 
| MalwareBazaar.File.code_sign.serial_number | Unknown | Serial number | 
| MalwareBazaar.File.code_sign.cscb_listed | Unknown | Code Signing Certificate Blocklist \(CSCB\) status \(True or False\) | 
| MalwareBazaar.File.code_sign.cscb_reason | Unknown | Code Signing Certificate Blocklist \(CSCB\) listing reason | 
| MalwareBazaar.File.delivery_method.email_attachment | Unknown | Distributed via e-mail attachment | 
| MalwareBazaar.File.delivery_method.email_link | Unknown | Distributed via e-mail link | 
| MalwareBazaar.File.delivery_method.web_download | Unknown | Distributed via web download | 
| MalwareBazaar.File.delivery_method.web_drive-by | Unknown | Distributed via drive-by | 
| MalwareBazaar.File.delivery_method.multiple | Unknown | Multiple delivery methods used | 
| MalwareBazaar.File.delivery_method.other | Unknown | Other delivery methods used | 
| MalwareBazaar.File.file_information | Unknown | Contextual information about the file sample | 
| MalwareBazaar.File.yara_rules.rule_name | String | Name of the YARA rule that triggered | 
| MalwareBazaar.File.yara_rules.author | String | Author of the YARA rule | 
| MalwareBazaar.File.yara_rules.description | Unknown | Description of the YARA rule | 
| MalwareBazaar.File.yara_rules.reference | Unknown | Reference of the YARA rule | 
| MalwareBazaar.File.vendor_intel.ANY.RUN | Unknown | Dynamic malware analysis from ANY.RUN | 
| MalwareBazaar.File.vendor_intel.CAPE | Unknown | Dynamic malware analysis from CAPE Sandbox | 
| MalwareBazaar.File.vendor_intel.CERT-PL_MWDB | Unknown | Threat intel from CERT.PL Malware Database | 
| MalwareBazaar.File.vendor_intel.vxCube | Unknown | Dynamic malware analysis from Dr.Web vxCube | 
| MalwareBazaar.File.vendor_intel.DocGuard | Unknown | Office document reputation from DocGuad | 
| MalwareBazaar.File.vendor_intel.FileScan-IO | Unknown | Malware analysis service from FileScan.IO | 
| MalwareBazaar.File.vendor_intel.InQuest Labs | Unknown | File reputation service from InQuest Labs | 
| MalwareBazaar.File.vendor_intel.Intezer | Unknown | Code analysis from Intezer | 
| MalwareBazaar.File.vendor_intel.ReversingLabs | Unknown | File reputation &amp; intelligence from ReversingLabs TitaniumCloud | 
| MalwareBazaar.File.vendor_intel.Spamhaus_HBL | Unknown | File reputation from Spamhaus Hash Blocklist \(HBL\) | 
| MalwareBazaar.File.vendor_intel.Triage | Unknown | Dynamic malware analysis from Hatching Triage | 
| MalwareBazaar.File.vendor_intel.UnpacMe | Unknown | Malware unpacking service from UnpacMe | 
| MalwareBazaar.File.vendor_intel.VMRay | Unknown | Dynamic malware analysis from VMRay | 
| MalwareBazaar.File.vendor_intel.YOROI_YOMI | Unknown | Dynamic malware analysis from YOROI YOMI | 
| MalwareBazaar.File.comments.id | String | Unique id that identifies this comment | 
| MalwareBazaar.File.comments.date_added | Date | Timestamp \(UTC\) when this comment has been made | 
| MalwareBazaar.File.comments.twitter_handle | String | Twitter handle who wrote this comment | 
| MalwareBazaar.File.comments.display_name | String | Twitter display name | 
| MalwareBazaar.File.comments.comment | String | The comment itself | 


#### Command Example
``` ```

#### Human Readable Output



### malwarebazaar-download-sample
***
Download (fetch) malware samples from MalwareBazaar. Any malware sample downloaded from MalwareBazaar is zipped and password protected using the password "infected" (without "").


#### Base Command

`malwarebazaar-download-sample`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| sha256_hash | SHA256 hash of the malware sample to download. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| File.Size | String | The size of the file. | 
| File.SHA1 | String | The SHA1 hash of the file. | 
| File.SHA256 | String | The SHA256 hash of the file. | 
| File.SHA512 | String | The SHA512 hash of the file. | 
| File.Name | String | The name of the file. | 
| File.SSDeep | String | The SSDeep hash of the file. | 
| File.EntryID | String | EntryID of the file | 
| File.Info | String | Information about the file. | 
| File.Type | String | The file type. | 
| File.MD5 | String | The MD5 hash of the file. | 
| File.Extension | String | The extension of the file. | 


#### Command Example
``` ```

#### Human Readable Output



### malwarebazaar-comment-add
***
Comment a malware sample.


#### Base Command

`malwarebazaar-comment-add`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| sha256_hash | SHA256 hash of the malware sample you want comment. | Required | 
| comment | Comment on the sample. | Required | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| MalwareBazaar.MalwarebazaarCommentAdd.query_status | String | success or error value of the request | 


#### Command Example
``` ```

#### Human Readable Output



### malwarebazaar-samples-list
***
Retrieves a list of recent malware samples (max 1'000) associated with a specific sample type.


#### Base Command

`malwarebazaar-samples-list`
#### Input

| **Argument Name** | **Description** | **Required** |
| --- | --- | --- |
| sample_type | Type of sample based on it the API will we queried,issuer_cn. Possible values are: tag, signatue, fie_type, clamav, imphash, yara_rule. | Required | 
| sample_value | Value of the sample selected. | Required | 
| limit | Defualt value is 50 and max number of results is 1000. Be aware, when using issuer_cn, all relevant result will display (max 100). Default is 50. | Optional | 


#### Context Output

| **Path** | **Type** | **Description** |
| --- | --- | --- |
| MalwareBazaar.MalwarebazaarSamplesList.sha256_hash | String | SHA256 hash of the malware sample | 
| MalwareBazaar.MalwarebazaarSamplesList.sha3_384_hash | String | SHA3-384 hash of the malware sample | 
| MalwareBazaar.MalwarebazaarSamplesList.sha1_hash | String | SHA1 hash of the malware sample | 
| MalwareBazaar.MalwarebazaarSamplesList.md5_hash | String | MD5 hash of the malware sample | 
| MalwareBazaar.MalwarebazaarSamplesList.first_seen | Date | TS when the file has been first seen by MalwareBazaar \(UTC\) | 
| MalwareBazaar.MalwarebazaarSamplesList.last_seen | Unknown | TS when the file has been last seen by MalwareBazaar \(UTC\) | 
| MalwareBazaar.MalwarebazaarSamplesList.file_name | String | Malware sample's file name | 
| MalwareBazaar.MalwarebazaarSamplesList.file_size | Number | File size in bytes | 
| MalwareBazaar.MalwarebazaarSamplesList.file_type_mime | String | MIME file type | 
| MalwareBazaar.MalwarebazaarSamplesList.file_type | String | File type | 
| MalwareBazaar.MalwarebazaarSamplesList.reporter | String | Twitter handle of the report \(or anonymous for anonymous submissions\) | 
| MalwareBazaar.MalwarebazaarSamplesList.anonymous | Number | 1 \(true\) or 0 \(false\) | 
| MalwareBazaar.MalwarebazaarSamplesList.signature | String | Malware family \(if available\) | 
| MalwareBazaar.MalwarebazaarSamplesList.imphash | Unknown | imphash \(only available for PE executables\) | 
| MalwareBazaar.MalwarebazaarSamplesList.tlsh | String | Trend Micro Locality Sensitive Hash \(tlsh\) | 
| MalwareBazaar.MalwarebazaarSamplesList.telfhash | Unknown | Trend Micro ELF Hash \(telfhash\) | 
| MalwareBazaar.MalwarebazaarSamplesList.ssdeep | String | ssdeep | 
| MalwareBazaar.MalwarebazaarSamplesList.dhash_icon | Unknown | In case the file is a PE executable: dhash of the samples icon | 
| MalwareBazaar.MalwarebazaarSamplesList.tags | String | list of tags | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.subject_cn | String | Subject Common Name \(CN\) | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.issuer_cn | String | Issuer Common Name \(CN\) | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.algorithm | String | Algorithm used | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.valid_from | String | Datetime valid from | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.valid_to | String | Datetime valid to \(expire date\) | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.serial_number | String | Serial number | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.cscb_listed | String | Code Signing Certificate Blocklist \(CSCB\) status \(True or False\) | 
| MalwareBazaar.MalwarebazaarSamplesList.code_sign.cscb_reason | String | Code Signing Certificate Blocklist \(CSCB\) listing reason | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.clamav | String | List of ClamAV detections \(offical and unofficial rules\) | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.downloads | String | number \(int\) of downloads from MalwareBazaar | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.uploads | String | number \(int\) of uploads to MalwareBazaar | 
| MalwareBazaar.MalwarebazaarSamplesList.intelligence.mail | Unknown | Mail intelligence using spamtrap data | 


#### Command Example
``` ```

#### Human Readable Output


