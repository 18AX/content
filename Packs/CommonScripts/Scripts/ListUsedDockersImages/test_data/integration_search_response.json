{"configurations":[{"brand":"","canGetSamples":false,"category":"Authentication","commitMessage":"","configuration":[{"defaultValue":"","display":"Server IP (e.g. 192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServer","options":null,"required":true,"type":0},{"defaultValue":"389","display":"Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServerPort","options":null,"required":false,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"Base DN (e.g. DC=domain,DC=com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPBaseDN","options":null,"required":true,"type":0},{"defaultValue":"","display":"Default Domain","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPDefaultDomain","options":null,"required":false,"type":0},{"defaultValue":"none","display":"Security Type (none/ssl/tls)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSecurity","options":null,"required":true,"type":0},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSInsecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Auto populate groups","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSFetchGroups","options":null,"required":false,"type":8},{"defaultValue":"","display":"Full path for CA certificate of Active Directory server (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPCaCertFile","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Use this instance for external authentication only","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"By checking this box you are limiting this instance to authenticate external (non-XSOAR) users when they enter to answer a survey sent via a communication task. For more details, see the documentation","name":"LDAPIsExternal","options":null,"required":false,"type":8}],"definitionId":"","description":"Authenticate using Active Directory","display":"Active Directory Authentication","fromServerVersion":"","hidden":false,"icon":"activedirectory.png","id":"activedir-login","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:27.717642+03:00","name":"activedir-login","packID":"","prevName":"activedir-login","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"Server IP (e.g. 192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServer","options":null,"required":true,"type":0},{"defaultValue":"389","display":"Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServerPort","options":null,"required":false,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"Base DN (e.g. DC=domain,DC=com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPBaseDN","options":null,"required":true,"type":0},{"defaultValue":"none","display":"Security Type (none/ssl/tls)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSecurity","options":null,"required":true,"type":0},{"defaultValue":"500","display":"Page Size","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPPageSize","options":null,"required":false,"type":0},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSInsecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Full path for CA certificate of Active Directory server (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPCaCertFile","options":null,"required":false,"type":0}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Active Directory Query v2 integration instead.","display":"Active Directory Query (Deprecated)","fromServerVersion":"","hidden":false,"icon":"activedirectory.png","id":"activedir","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.677787+03:00","name":"activedir","packID":"","prevName":"activedir","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"Server IP address (e.g., 192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"server_ip","options":null,"required":true,"type":0},{"defaultValue":"","display":"Port. If not specified, default the port is 389, or 636 for LDAPS.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"port","options":null,"required":false,"type":0},{"defaultValue":"","display":"Credentials","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"NTLM authentication","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ntlm","options":null,"required":false,"type":8},{"defaultValue":"","display":"Base DN (for example \"dc=company,dc=com\")","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"base_dn","options":null,"required":true,"type":0},{"defaultValue":"500","display":"Page size","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"page_size","options":null,"required":true,"type":0},{"defaultValue":"SSL","display":"Secure Connection","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"secure_connection","options":["None","SSL","TLS"],"required":true,"type":15},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"unsecure","options":null,"required":false,"type":8},{"defaultValue":"User Profile - Active Directory (Incoming)","display":"Incoming Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Used in the IAM commands.","name":"mapper-in","options":null,"required":true,"type":0},{"defaultValue":"User Profile - Active Directory (Outgoing)","display":"Ougoing Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Used in the IAM commands.","name":"mapper-out","options":null,"required":true,"type":0},{"defaultValue":"","display":"Group CN for terminated employees","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"group-cn","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Create if does not exists","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"If true the user will be created when the passed User Profile doesn't exist in AD. Used in IAM commands only.","name":"create-if-not-exists","options":null,"required":false,"type":8}],"definitionId":"","description":"Active Directory Query integration enables you to access and manage Active Directory objects (users, contacts, and computers).","detailedDescription":"Active Directory search uses paging. You set the page size by specifying the 'page size' parameter in the instance settings.\n\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/active-directory-query-v2)","display":"Active Directory Query v2","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Active Directory Query v2","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The username (samAccountName) of the user to modify.","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root (e.g., DC=domain,DC=com)","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Expires the password of an Active Directory user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-expire-password","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username (samAccountName) of the user to modify.","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The initial password to set for the user. The user is requested to change the password after login.","name":"password","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The user's DN.","name":"user-dn","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The display name of the user.","name":"display-name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A short description of the user.","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User email.","name":"email","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The telephone number of the user.","name":"telephone-number","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The job title of the user.","name":"title","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Sets basic or custom attributes of the user object. For example, custom-attributes=\"{\\\"notes\\\":\\\"a note about the contact\\\",\\\"company\\\":\\\"company name\\\"}\"","name":"custom-attributes","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates an Active Directory user. This command requires a secure connection (SSL,TLS).","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-create-user","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Enables you to define search criteria in the Query Active Directory using Active Directory syntax. For example, the following query searches for all user objects, except Andy: \"(\u0026(objectCategory=person)(objectClass=user)(!(cn=andy)))\". NOTE if you have special characters such as \"*\",\"(\",or \"\\\" the character must be preceded by two backslashes \"\\\\\". For example, to use \"*\", type \"\\\\*\". For more information about search filters, see syntax: https://docs.microsoft.com/en-us/windows/win32/adsi/search-filter-syntax","name":"filter","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com). By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false},{"default":false,"deprecated":false,"description":"CSV list of the object attributes to return. For example, \"dn,memberOf\". To return all object attributes, specify 'ALL'.","name":"attributes","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of records to return.","name":"size-limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The maximum time to pull records (in seconds).","name":"time-limit","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"yes","deprecated":false,"description":"Whether to output the search results to the context. Default is yes.","name":"context-output","predefined":["yes","no"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Runs Active Directory queries.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-search","outputs":[{"contentPath":"","contextPath":"ActiveDirectory.Search.dn","description":"The distinguished names that match the query.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Search","description":"The result of the search.","type":"unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username of the user to add to the group. If this argument is not specified, the computer name argument must be specified.","name":"username","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the computer to add to the group. If this argument is not specified, the username argument must be specified.","name":"computer-name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the group for which to add the user.","name":"group-cn","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com. By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Adds an Active Directory user or computer to a group.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-add-to-group","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the user to remove from the group. If this argument is not specified, the computer name argument must be specified.","name":"username","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the computer to remove from the group. If this argument is not specified, the username argument must be specified.","name":"computer-name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the group for which to remove the user.","name":"group-cn","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com). By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Removes an Active Directory user or computer from a group.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-remove-from-group","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username of the account to update (sAMAccountName).","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the attribute to modify. For example, sn, displayName, mail, and so on.","name":"attribute-name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The value of the attribute for which to change.","name":"attribute-value","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com. By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates attributes of an existing Active Directory user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-update-user","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The DN of the user to delete.","name":"user-dn","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Deletes an Active Directory user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-delete-user","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The contact's DN.","name":"contact-dn","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The contact's display name.","name":"display-name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The short description of the contact.","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The email address of the contact.","name":"email","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The contact's telephone number.","name":"telephone-number","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Sets basic or custom attributes of the contact object. For example, custom-attributes=\"{\\\"notes\\\":\\\"some note about the contact\\\",\\\"company\\\":\\\"some company\\\"}.\"","name":"custom-attributes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The job title of the contact.","name":"title","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates an Active Directory contact.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-create-contact","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The contact's DN.","name":"contact-dn","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The attribute name to update.","name":"attribute-name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The attribute value to be updated.","name":"attribute-value","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates attributes of an existing Active Directory contact.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-update-contact","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username of the account to disable (sAMAccountName).","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root (e.g., DC=domain,DC=com). By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Disables an Active Directory user account.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-disable-account","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username of the account to enable (sAMAccountName).","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com). By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Enables a previously disabled Active Directory account.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-enable-account","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username of the account to unlock (sAMAccountName).","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com. By default, the Base DN configured for the instance is used.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Unlocks a previously locked Active Directory user account.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-unlock-account","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username of the account to disable (sAMAccountName).","name":"username","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The password to set for the user.","name":"password","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Root. For example, DC=domain,DC=com. Base DN configured for the instance is used as default.","name":"base-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sets a new password for an Active Directory user. This command requires a secure connection (SSL,TLS).","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-set-new-password","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the computer to modify.","name":"computer-name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Superior DN. For example, OU=computers,DC=domain,DC=com (the specified domain must be the same as the current computer domain).","name":"full-superior-dn","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Modifies the computer organizational unit within a domain.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-modify-computer-ou","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The Distinguished Name of the user in which to return information.","name":"dn","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the user to return information.","name":"name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Adds AD attributes of the resulting objects to the default attributes.","name":"attributes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Queries users by custom field type.","name":"custom-field-type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Queries users by custom field data (relevant only if the `custom-field-type` argument is provided).","name":"custom-field-data","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Queries users by the samAccountName attribute.","name":"username","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Queries users by the samAccountName attribute.","name":"sAMAccountName","required":false,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The maximum number of objects to return. Default is 20.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Queries by the user's email address.","name":"email","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to include verbose translation for UserAccountControl flags. Default is false.","name":"user-account-control-out","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves detailed information about a user account. The user can be specified by name, email address, or as an Active Directory Distinguished Name (DN). If no filter is specified, all users are returned.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-get-user","outputs":[{"contentPath":"","contextPath":"ActiveDirectory.Users.dn","description":"The distinguished name of the user.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Users.displayName","description":"The display name of the user.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Users.name","description":"The common name of the user.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Users.sAMAccountName","description":"The sAMAccountName of the user.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Users.userAccountControl","description":"The account control flag of the user.","type":"number"},{"contentPath":"","contextPath":"ActiveDirectory.Users.mail","description":"The email address of the user.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Users.manager","description":"The manager of the user.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Users.memberOf","description":"Groups for which the user is a member.","type":"string"},{"contentPath":"","contextPath":"Account.DisplayName","description":"The display name of the user.","type":"string"},{"contentPath":"","contextPath":"Account.Groups","description":"Groups for which the user is a member.","type":"string"},{"contentPath":"","contextPath":"Account.Manager","description":"The manager of the user.","type":"string"},{"contentPath":"","contextPath":"Account.ID","description":"The distinguished name of the user.","type":"string"},{"contentPath":"","contextPath":"Account.Username","description":"The samAccountName of the user.","type":"string"},{"contentPath":"","contextPath":"Account.Email","description":"The email address of the user.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The computer's DN.","name":"dn","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the computer for which to return information.","name":"name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Adds AD attributes of the resulting objects to the default attributes.","name":"attributes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Search computers by custom field data (relevant only if the `customFieldType` argument is provided).","name":"custom-field-data","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Search the computer by custom field type.","name":"custom-field-type","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves detailed information about a computer account. The computer can be specified by name, email address, or as an Active Directory Distinguished Name (DN). If no filters are provided, all computers are returned.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-get-computer","outputs":[{"contentPath":"","contextPath":"ActiveDirectory.Computers.dn","description":"The distinguished name of the computer.","type":""},{"contentPath":"","contextPath":"ActiveDirectory.Computers.memberOf","description":"Groups for which the computer is listed.","type":""},{"contentPath":"","contextPath":"ActiveDirectory.Computers.name","description":"The name of the computer.","type":""},{"contentPath":"","contextPath":"Endpoint.ID","description":"The DN of the computer.","type":""},{"contentPath":"","contextPath":"Endpoint.Hostname","description":"The name of the computer.","type":""},{"contentPath":"","contextPath":"Endpoint.Groups","description":"Groups for which the computer is listed as a member.","type":""}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The Distinguished Name of the Group's Active Directory.","name":"group-dn","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"person","deprecated":false,"description":"The type of members to search. Can be: \"Person\", or \"computer\". Default is person.","name":"member-type","predefined":["person","computer","group"],"required":true,"secret":false},{"default":false,"deprecated":false,"description":"CSV list of attributes to include in the results, in addition to the default attributes.","name":"attributes","required":false,"secret":false},{"default":false,"defaultValue":"180","deprecated":false,"description":"Time limit (in seconds) for the search to run.","name":"time_limit","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Disable recursive retrieval of group memberships of a user.","name":"disable-nested-search","predefined":["false","true"],"required":false,"secret":false},{"default":false,"defaultValue":"*","deprecated":false,"description":"Queries results by the samAccountName attribute.","name":"sAMAccountName","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves the list of users or computers that are members of the specified group.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-get-group-members","outputs":[{"contentPath":"","contextPath":"ActiveDirectory.Groups.dn","description":"The DN of the group.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Groups.members.dn","description":"The DN of the group member.","type":"string"},{"contentPath":"","contextPath":"ActiveDirectory.Groups.members.category","description":"The category of the group members.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The Active Directory name of the group.","name":"name","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The type of group. Can be: \"security\", or \"distribution\".","name":"group-type","predefined":["security","distribution"],"required":true,"secret":false},{"default":false,"deprecated":false,"description":"The Full Distinguished Name (DN) of the group. Use double quotes (\"\") rather than single quotes ('') when initializing this command.","name":"dn","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The Full DN Of users or groups that will be members of the newly created group.","isArray":true,"name":"members","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a new security or distribution Active Directory group.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-create-group","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The Active Directory Distinguished Name (DN) of the group.","name":"dn","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Deletes an existing Active Directory security or distribution group.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"ad-delete-group","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator that contains user information, such as name, email address, etc.","name":"user-profile","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"When set to true, after the command execution the status of the user in the 3rd-party integration will be active.","name":"allow-enable","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates an Active Directory user. This command requires a secure connection (SSL,TLS).","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-create-user","outputs":[{"contentPath":"","contextPath":"IAM.UserProfile","description":"The user's profile.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.active","description":"If true the employee's status is active, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Gives the user information if the API was successful, otherwise error information.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.action","description":"The command name.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator that contains user information, such as name, email address, etc.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves a single user resource.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-get-user","outputs":[{"contentPath":"","contextPath":"IAM.UserProfile","description":"The user's profile.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.active","description":"If true the employee's status is active, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Gives the user information if the API was successful, otherwise error information.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.action","description":"The command name.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator that contains user information, such as name, email address, etc.","name":"user-profile","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"When set to true, after the command execution the status of the user in the 3rd-party integration will be active.","name":"allow-enable","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates an existing user with the data in the User Profile indicator that is passed in the user-profile argument.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-update-user","outputs":[{"contentPath":"","contextPath":"IAM.UserProfile","description":"The user's profile","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.active","description":"Gives the active status of user. Can be true of false","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the Integration","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Gives the user information if the API was successful, otherwise error information.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.action","description":"The command name.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator that contains user information, such as name, email address, etc.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Disables a user.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-disable-user","outputs":[{"contentPath":"","contextPath":"IAM.UserProfile","description":"The user's profile","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.active","description":"Gives the active status of user. Can be true of false","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the Integration","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Gives the user information if the API was successful, otherwise error information.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"Unknown"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.action","description":"The command name.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Retrieves a User Profile schema which holds all of the user fields within the application. Used for outgoing-mapping through the Get Schema option.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-mapping-fields","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/ldap:1.0.0.23980","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":true,"isRemoteSyncIn":false,"isRemoteSyncOut":true,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\nfrom typing import List, Dict, Optional\nfrom ldap3 import Server, Connection, NTLM, SUBTREE, ALL_ATTRIBUTES, Tls, Entry, Reader, ObjectDef\nfrom ldap3.extend import microsoft\nimport ssl\nfrom datetime import datetime\nimport traceback\nimport os\nfrom ldap3.utils.log import (set_library_log_detail_level, get_library_log_detail_level,\n                             set_library_log_hide_sensitive_data, EXTENDED)\nfrom ldap3.utils.conv import escape_filter_chars\n\n# global connection\nconn: Optional[Connection] = None\n\n''' GLOBAL VARS '''\n\n# userAccountControl is a bitmask used to store a number of settings.\n# find more at:\n# https://support.microsoft.com/en-gb/help/305144/how-to-use-the-useraccountcontrol-flags-to-manipulate-user-account-pro\nDEFAULT_OUTGOING_MAPPER = \"User Profile - Active Directory (Outgoing)\"\nDEFAULT_INCOMING_MAPPER = \"User Profile - Active Directory (Incoming)\"\n\nCOOMON_ACCOUNT_CONTROL_FLAGS = {\n    512: \"Enabled Account\",\n    514: \"Disabled account\",\n    544: \"Password Not Required\",\n    4096: \"Workstation/server\",\n    66048: \"Enabled, password never expires\",\n    66050: \"Disabled, password never expires\",\n    66080: \"Enables, password never expires, password not required.\",\n    532480: \"Domain controller\"\n}\nNORMAL_ACCOUNT = 512\nDISABLED_ACCOUNT = 514\nINACTIVE_LIST_OPTIONS = [514, 546, 66050, 66082, 262658, 262690, 328226]\nDEFAULT_LIMIT = 20\n\n# common attributes for specific AD objects\nDEFAULT_PERSON_ATTRIBUTES = [\n    'name',\n    'displayName',\n    'memberOf',\n    'mail',\n    'sAMAccountName',\n    'manager',\n    'userAccountControl'\n]\nDEFAULT_COMPUTER_ATTRIBUTES = [\n    'name',\n    'memberOf'\n]\nDEFAULT_GROUP_ATTRIBUTES = [\n    'name',\n    'memberOf'\n]\nFIELDS_THAT_CANT_BE_MODIFIED = [\n    \"dn\", \"cn\", \"ou\"\n]\n\n''' HELPER FUNCTIONS '''\n\n\ndef initialize_server(host, port, secure_connection, unsecure):\n    \"\"\"\n    uses the instance configuration to initialize the LDAP server\n\n    :param host: host or ip\n    :type host: string\n    :param port: port or None\n    :type port: number\n    :param secure_connection: SSL or None\n    :type secure_connection: string\n    :param unsecure: trust any cert\n    :type unsecure: boolean\n    :return: ldap3 Server\n    :rtype: Server\n    \"\"\"\n\n    if secure_connection == \"TLS\":\n        demisto.debug(f\"initializing sever with TLS (unsecure: {unsecure}). port: {port or 'default(636)'}\")\n        tls = Tls(validate=ssl.CERT_NONE)\n        if port:\n            return Server(host, port=port, use_ssl=unsecure, tls=tls)\n        return Server(host, use_ssl=unsecure, tls=tls)\n\n    if secure_connection == \"SSL\":\n        # intialize server with ssl\n        # port is configured by default as 389 or as 636 for LDAPS if not specified in configuration\n        demisto.debug(f\"initializing sever with SSL (unsecure: {unsecure}). port: {port or 'default(636)'}\")\n        if not unsecure:\n            demisto.debug(\"will require server certificate.\")\n            tls = Tls(validate=ssl.CERT_REQUIRED, ca_certs_file=os.environ.get('SSL_CERT_FILE'))\n            if port:\n                return Server(host, port=port, use_ssl=True, tls=tls)\n            return Server(host, use_ssl=True, tls=tls)\n        if port:\n            return Server(host, port=port, use_ssl=True)\n        return Server(host, use_ssl=True)\n    demisto.debug(f\"initializing server without secure connection. port: {port or 'default(389)'}\")\n    if port:\n        return Server(host, port=port)\n    return Server(host)\n\n\ndef account_entry(person_object, custom_attributes):\n    # create an account entry from a person objects\n    account = {\n        'Type': 'AD',\n        'ID': person_object.get('dn'),\n        'Email': person_object.get('mail'),\n        'Username': person_object.get('sAMAccountName'),\n        'DisplayName': person_object.get('displayName'),\n        'Managr': person_object.get('manager'),\n        'Manager': person_object.get('manager'),\n        'Groups': person_object.get('memberOf')\n    }\n\n    lower_cased_person_object_keys = {\n        person_object_key.lower(): person_object_key for person_object_key in person_object.keys()\n    }\n\n    for attr in custom_attributes:\n        try:\n            account[attr] = person_object[attr]\n        except KeyError as e:\n            lower_cased_custom_attr = attr.lower()\n            if lower_cased_custom_attr in lower_cased_person_object_keys:\n                cased_custom_attr = lower_cased_person_object_keys.get(lower_cased_custom_attr, '')\n                account[cased_custom_attr] = person_object[cased_custom_attr]\n            else:\n                demisto.error(f'Failed parsing custom attribute {attr}, error: {e}')\n\n    return account\n\n\ndef endpoint_entry(computer_object, custom_attributes):\n    # create an endpoint entry from a computer object\n    endpoint = {\n        'Type': 'AD',\n        'ID': computer_object.get('dn'),\n        'Hostname': computer_object.get('name'),\n        'Groups': computer_object.get('memberOf')\n    }\n\n    lower_cased_person_object_keys = {\n        person_object_key.lower(): person_object_key for person_object_key in computer_object.keys()\n    }\n\n    for attr in custom_attributes:\n        if attr == '*':\n            continue\n        try:\n            endpoint[attr] = computer_object[attr]\n        except KeyError as e:\n            lower_cased_custom_attr = attr.lower()\n            if lower_cased_custom_attr in lower_cased_person_object_keys:\n                cased_custom_attr = lower_cased_person_object_keys.get(lower_cased_custom_attr, '')\n                endpoint[cased_custom_attr] = computer_object[cased_custom_attr]\n            else:\n                demisto.error(f'Failed parsing custom attribute {attr}, error: {e}')\n\n    return endpoint\n\n\ndef group_entry(group_object, custom_attributes):\n    # create an group entry from a group object\n    group = {\n        'Type': 'AD',\n        'ID': group_object.get('dn'),\n        'Name': group_object.get('name'),\n        'Groups': group_object.get('memberOf'),\n    }\n\n    lower_cased_person_object_keys = {\n        person_object_key.lower(): person_object_key for person_object_key in group_object.keys()\n    }\n\n    for attr in custom_attributes:\n        if attr == '*':\n            continue\n        try:\n            group[attr] = group_object[attr]\n        except KeyError as e:\n            lower_cased_custom_attr = attr.lower()\n            if lower_cased_custom_attr in lower_cased_person_object_keys:\n                cased_custom_attr = lower_cased_person_object_keys.get(lower_cased_custom_attr, '')\n                group[cased_custom_attr] = group_object[cased_custom_attr]\n            else:\n                demisto.error(f'Failed parsing custom attribute {attr}, error: {e}')\n\n    return group\n\n\ndef base_dn_verified(base_dn):\n    # search AD with a simple query to test base DN is configured correctly\n    try:\n        search(\n            \"(objectClass=user)\",\n            base_dn,\n            size_limit=1\n        )\n    except Exception as e:\n        demisto.info(str(e))\n        return False\n    return True\n\n\ndef generate_unique_cn(default_base_dn, cn):\n\n    changing_cn = cn\n    i = 1\n    while check_if_user_exists_by_attribute(default_base_dn, \"cn\", changing_cn):\n        changing_cn = cn + str(i)\n        i += 1\n        if i == 30:\n            raise Exception(\"User CN couldn't be generated\")\n    return changing_cn\n\n\ndef generate_dn_and_remove_from_user_profile(default_base_dn, user):\n    \"\"\"Generates a user dn, in case user dn is included in the user, will return it, otherwise\n    will generate one using the cn and ou values\n    :param default_base_dn: The location in the DIT where the search will start\n    :param user: The user dict including his values\n    :return: The user's dn.\n    \"\"\"\n    user_dn = user.get(\"dn\")\n\n    if user_dn:\n        user.pop(\"dn\")\n        return user_dn\n    user_cn = user.get(\"cn\")\n    if not user_cn:\n        raise Exception(\"User must have cn, please provide a valid value\")\n\n    valid_cn = generate_unique_cn(default_base_dn, user.get(\"cn\"))\n    ou = user.get(\"ou\")\n\n    return 'CN=' + str(valid_cn) + ',' + str(ou)\n\n\ndef check_if_user_exists_by_attribute(default_base_dn, attr, val):\n    \"\"\"Check if user exists base on a specific attribute\n    :param default_base_dn: The location in the DIT where the search will start\n    :param attr: The attribute to search by\n    :param val: The attribute's value\n    :return: True if the user exists, False otherwise.\n    \"\"\"\n    query = f'(\u0026(objectClass=User)(objectCategory=person)({attr}={val}))'\n    entries = search_with_paging(\n        query,\n        default_base_dn,\n        attributes=[attr],\n        size_limit=1,\n        page_size=1\n    )\n    if entries.get('flat'):\n        return True\n    return False\n\n\ndef get_user_activity_by_samaccountname(default_base_dn, samaccountname):\n    \"\"\"Get if user is active or not by samaccountname\n    :param default_base_dn: The location in the DIT where the search will start\n    :param samaccountname: The user's unique samaccountname\n    :return: True if the user active, False otherwise.\n    \"\"\"\n    active = False\n    query = f'(\u0026(objectClass=User)(objectCategory=person)(samaccountname={samaccountname}))'\n    entries = search_with_paging(\n        query,\n        default_base_dn,\n        attributes=[\"userAccountControl\"],\n        size_limit=1,\n        page_size=1\n    )\n\n    if entries.get('flat'):\n        user = entries.get('flat')[0]\n        activity = user.get('userAccountControl')[0]\n        active = activity not in INACTIVE_LIST_OPTIONS\n\n    return active\n\n\ndef get_user_dn_by_email(default_base_dn, email):\n    \"\"\"Get's user dn by it's email, this function assumes that user's unique sameaccountname it the email prefix\n    :param default_base_dn: The location in the DIT where the search will start\n    :param email: The user's email\n    :return: the user's dn\n    \"\"\"\n    dn = ''\n    samaccountname = email.split('@')[0]\n    query = f'(\u0026(objectClass=User)(objectCategory=person)(samaccountname={samaccountname}))'\n    entries = search_with_paging(\n        query,\n        default_base_dn,\n        attributes=[\"samaccountname\"],\n        size_limit=1,\n        page_size=1\n    )\n\n    if entries.get('flat'):\n        user = entries.get('flat')[0]\n        dn = user.get('dn')\n\n    return dn\n\n\ndef modify_user_ou(dn, new_ou):\n    assert conn is not None\n    cn = dn.split(',', 1)[0]\n\n    success = conn.modify_dn(dn, cn, new_superior=new_ou)\n    return success\n\n\ndef get_all_attributes(search_base):\n    obj_inetorgperson = ObjectDef('user', conn)\n    r = Reader(conn, obj_inetorgperson, search_base)\n    r.search()\n    if not r:\n        return []\n    if not r[0]:\n        return []\n    attributes = r[0].allowedAttributes\n    return [attr for attr in attributes]\n\n\n''' COMMANDS '''\n\n''' SEARCH '''\n\n\ndef search(search_filter, search_base, attributes=None, size_limit=0, time_limit=0):\n    \"\"\"\n    find entries in the DIT\n\n    Args:\n        search_base: the location in the DIT where the search will start\n        search_filte: LDAP query string\n        attributes: the attributes to specify for each entry found in the DIT\n\n    \"\"\"\n    assert conn is not None\n    success = conn.search(\n        search_base=search_base,\n        search_filter=search_filter,\n        attributes=attributes,\n        size_limit=size_limit,\n        time_limit=time_limit\n    )\n\n    if not success:\n        raise Exception(\"Search failed\")\n    return conn.entries\n\n\ndef search_with_paging(search_filter, search_base, attributes=None, page_size=100, size_limit=0, time_limit=0):\n    \"\"\"\n    find entries in the DIT\n\n    Args:\n        search_base: the location in the DIT where the search will start\n        search_filter: LDAP query string\n        attributes: the attributes to specify for each entrxy found in the DIT\n\n    \"\"\"\n    assert conn is not None\n    total_entries = 0\n    cookie = None\n    start = datetime.now()\n\n    entries: List[Entry] = []\n    entries_left_to_fetch = size_limit\n    while True:\n        if 0 \u003c entries_left_to_fetch \u003c page_size:\n            page_size = entries_left_to_fetch\n\n        conn.search(\n            search_base,\n            search_filter,\n            search_scope=SUBTREE,\n            attributes=attributes,\n            paged_size=page_size,\n            paged_cookie=cookie\n        )\n\n        entries_left_to_fetch -= len(conn.entries)\n        total_entries += len(conn.entries)\n        cookie = conn.result['controls']['1.2.840.113556.1.4.319']['value']['cookie']\n        time_diff = (start - datetime.now()).seconds\n\n        entries.extend(conn.entries)\n\n        # stop when: 1.reached size limit 2.reached time limit 3. no cookie\n        if (size_limit and size_limit \u003c= total_entries) or (time_limit and time_diff \u003e= time_limit) or (not cookie):\n            break\n\n    # keep the raw entry for raw content (backward compatibility)\n    raw = []\n    # flatten the entries\n    flat = []\n\n    for entry in entries:\n        entry = json.loads(entry.entry_to_json())\n\n        flat_entry = {\n            'dn': entry['dn']\n        }\n\n        for attr in entry.get('attributes', {}):\n            flat_entry[attr] = entry['attributes'][attr]\n\n        raw.append(entry)\n        flat.append(flat_entry)\n\n    return {\n        \"raw\": raw,\n        \"flat\": flat\n    }\n\n\ndef user_dn(sam_account_name, search_base):\n    search_filter = '(\u0026(objectClass=user)(sAMAccountName={}))'.format(sam_account_name)\n    entries = search(\n        search_filter,\n        search_base\n    )\n    if not entries:\n        raise Exception(\"Could not get full DN for user with sAMAccountName '{}'\".format(sam_account_name))\n    entry = json.loads(entries[0].entry_to_json())\n    return entry['dn']\n\n\ndef computer_dn(compuer_name, search_base):\n    search_filter = '(\u0026(objectClass=user)(objectCategory=computer)(name={}))'.format(compuer_name)\n    entries = search(\n        search_filter,\n        search_base\n    )\n    if not entries:\n        raise Exception(\"Could not get full DN for computer with name '{}'\".format(compuer_name))\n    entry = json.loads(entries[0].entry_to_json())\n    return entry['dn']\n\n\ndef group_dn(group_name, search_base):\n    group_name = escape_filter_chars(group_name)\n    search_filter = '(\u0026(objectClass=group)(cn={}))'.format(group_name)\n    entries = search(\n        search_filter,\n        search_base\n    )\n    if not entries:\n        raise Exception(\"Could not get full DN for group with name '{}'\".format(group_name))\n    entry = json.loads(entries[0].entry_to_json())\n    return entry['dn']\n\n\ndef convert_special_chars_to_unicode(search_filter):\n    # We allow users to use special chars without explicitly typing their unicode values\n    chars_to_replace = {\n        '\\\\(': '\\\\28',\n        '\\\\)': '\\\\29',\n        '\\\\*': '\\\\2a',\n        '\\\\/': '\\\\2f',\n        '\\\\\\\\': '\\\\5c'\n    }\n    for i, j in chars_to_replace.items():\n        search_filter = search_filter.replace(i, j)\n\n    return search_filter\n\n\ndef free_search(default_base_dn, page_size):\n\n    args = demisto.args()\n\n    search_filter = args.get('filter')\n    size_limit = int(args.get('size-limit', '0'))\n    time_limit = int(args.get('time-limit', '0'))\n    search_base = args.get('base-dn') or default_base_dn\n    attributes = args.get('attributes')\n    context_output = args.get('context-output')\n\n    search_filter = convert_special_chars_to_unicode(search_filter)\n\n    # if ALL was specified - get all the object's attributes, else expect a string of comma separated values\n    if attributes:\n        attributes = ALL_ATTRIBUTES if attributes == 'ALL' else attributes.split(',')\n\n    entries = search_with_paging(\n        search_filter,\n        search_base,\n        attributes=attributes,\n        size_limit=size_limit,\n        time_limit=time_limit,\n        page_size=page_size\n    )\n\n    ec = {} if context_output == 'no' else {'ActiveDirectory.Search(obj.dn == val.dn)': entries['flat']}\n    demisto_entry = {\n        'ContentsFormat': formats['json'],\n        'Type': entryTypes['note'],\n        'Contents': entries['raw'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown(\"Active Directory Search\", entries['flat']),\n        'EntryContext': ec\n    }\n    demisto.results(demisto_entry)\n\n\ndef search_users(default_base_dn, page_size):\n    # this command is equivalent to script ADGetUser\n    # will preform a custom search to find users by a specific (one) attribute specified by the user\n\n    args = demisto.args()\n\n    attributes: List[str] = []\n    custom_attributes: List[str] = []\n\n    # zero is actually no limitation, default is 20\n    limit = int(args.get('limit', '20'))\n    if limit \u003c= 0:\n        limit = 20\n\n    # default query - list all users\n    query = \"(\u0026(objectClass=User)(objectCategory=person))\"\n\n    # query by user DN\n    if args.get('dn'):\n        dn = escape_filter_chars(args['dn'])\n        query = \"(\u0026(objectClass=User)(objectCategory=person)(distinguishedName={}))\".format(dn)\n\n    # query by name\n    if args.get('name'):\n        name = escape_filter_chars(args['name'])\n        query = \"(\u0026(objectClass=User)(objectCategory=person)(cn={}))\".format(name)\n\n    # query by email\n    if args.get('email'):\n        email = escape_filter_chars(args['email'])\n        query = \"(\u0026(objectClass=User)(objectCategory=person)(mail={}))\".format(email)\n\n    # query by sAMAccountName\n    if args.get('username') or args.get('sAMAccountName'):\n        if args.get('username'):\n            username = escape_filter_chars(args['username'])\n        else:\n            username = escape_filter_chars(args['sAMAccountName'])\n        query = \"(\u0026(objectClass=User)(objectCategory=person)(sAMAccountName={}))\".format(username)\n\n    # query by custom object attribute\n    if args.get('custom-field-type'):\n        if not args.get('custom-field-data'):\n            raise Exception('Please specify \"custom-field-data\" as well when quering by \"custom-field-type\"')\n        field_type = escape_filter_chars(args['custom-field-type'])\n        field_data = escape_filter_chars(args['custom-field-data'])\n        query = \"(\u0026(objectClass=User)(objectCategory=person)({}={}))\".format(\n            field_type, field_data)\n\n    if args.get('attributes'):\n        custom_attributes = args['attributes'].split(\",\")\n\n    attributes = list(set(custom_attributes + DEFAULT_PERSON_ATTRIBUTES))\n\n    entries = search_with_paging(\n        query,\n        default_base_dn,\n        attributes=attributes,\n        size_limit=limit,\n        page_size=page_size\n    )\n\n    accounts = [account_entry(entry, custom_attributes) for entry in entries['flat']]\n\n    if args.get('user-account-control-out', '') == 'true':\n        # display a literal translation of the numeric account control flag\n        for i, user in enumerate(entries['flat']):\n            flag_no = user.get('userAccountControl')[0]\n            entries['flat'][i]['userAccountControl'] = COOMON_ACCOUNT_CONTROL_FLAGS.get(flag_no) or flag_no\n\n    demisto_entry = {\n        'ContentsFormat': formats['json'],\n        'Type': entryTypes['note'],\n        'Contents': entries['raw'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown(\"Active Directory - Get Users\", entries['flat']),\n        'EntryContext': {\n            'ActiveDirectory.Users(obj.dn == val.dn)': entries['flat'],\n            # 'backward compatability' with ADGetUser script\n            'Account(obj.ID == val.ID)': accounts\n        }\n    }\n    demisto.results(demisto_entry)\n\n\ndef get_user_iam(default_base_dn, args, mapper_in, mapper_out):\n    \"\"\"Gets an AD user by User Profile.\n    :param default_base_dn: The location in the DIT where the search will start\n    :param args: Demisto args.\n    :param mapper_in: Mapping AD user to User Profiles\n    :param mapper_out: Mapping User Profiles to AD users.\n    :return: User Profile of the AD user\n    \"\"\"\n    try:\n        user_profile = args.get(\"user-profile\")\n        user_profile_delta = args.get('user-profile-delta')\n        default_attribute = \"samaccountname\"\n\n        iam_user_profile = IAMUserProfile(user_profile=user_profile, user_profile_delta=user_profile_delta)\n\n        # we use the outgoing mapper to get all the AD attributes which will be later passed to search_with_paging()\n        ad_user = iam_user_profile.map_object(mapper_name=mapper_out,\n                                              incident_type=IAMUserProfile.CREATE_INCIDENT_TYPE)\n\n        value = ad_user.get(default_attribute)\n\n        # removing keys with no values\n        user = {k: v for k, v in ad_user.items() if v}\n        attributes = list(user.keys())\n\n        query = f'(\u0026(objectClass=User)(objectCategory=person)({default_attribute}={value}))'\n        entries = search_with_paging(\n            query,\n            default_base_dn,\n            attributes=attributes,\n            size_limit=1,\n            page_size=1\n        )\n\n        if not entries.get('flat'):\n            error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n            iam_user_profile.set_result(action=IAMActions.GET_USER,\n                                        success=False,\n                                        error_code=error_code,\n                                        error_message=error_message)\n        else:\n            user_account_control = get_user_activity_by_samaccountname(default_base_dn, value)\n            ad_user[\"userAccountControl\"] = user_account_control\n            iam_user_profile.update_with_app_data(ad_user, mapper_in)\n            iam_user_profile.set_result(success=True,\n                                        email=ad_user.get('email'),\n                                        username=ad_user.get('name'),\n                                        action=IAMActions.GET_USER,\n                                        details=ad_user,\n                                        active=user_account_control)\n\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, _ = IAMErrors.BAD_REQUEST\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=str(e),\n                                    action=IAMActions.GET_USER\n                                    )\n        return iam_user_profile\n\n\ndef search_computers(default_base_dn, page_size):\n    # this command is equivalent to ADGetComputer script\n\n    args = demisto.args()\n    attributes: List[str] = []\n    custom_attributes: List[str] = []\n\n    # default query - list all users (computer category)\n    query = \"(\u0026(objectClass=user)(objectCategory=computer))\"\n\n    # query by user DN\n    if args.get('dn'):\n        query = \"(\u0026(objectClass=user)(objectCategory=computer)(distinguishedName={}))\".format(args['dn'])\n\n    # query by name\n    if args.get('name'):\n        query = \"(\u0026(objectClass=user)(objectCategory=computer)(name={}))\".format(args['name'])\n\n    # query by custom object attribute\n    if args.get('custom-field-type'):\n        if not args.get('custom-field-data'):\n            raise Exception('Please specify \"custom-field-data\" as well when quering by \"custom-field-type\"')\n        query = \"(\u0026(objectClass=user)(objectCategory=computer)({}={}))\".format(\n            args['custom-field-type'], args['custom-field-data'])\n\n    if args.get('attributes'):\n        custom_attributes = args['attributes'].split(\",\")\n    attributes = list(set(custom_attributes + DEFAULT_COMPUTER_ATTRIBUTES))\n    entries = search_with_paging(\n        query,\n        default_base_dn,\n        attributes=attributes,\n        page_size=page_size\n    )\n\n    endpoints = [endpoint_entry(entry, custom_attributes) for entry in entries['flat']]\n    readable_output = tableToMarkdown(\"Active Directory - Get Computers\", entries['flat'])\n\n    if endpoints:\n        results = CommandResults(\n            readable_output=readable_output,\n            outputs={\n                'ActiveDirectory.Computers(obj.dn == val.dn)': entries['flat'],\n                # 'backward compatability' with ADGetComputer script\n                'Endpoint(obj.ID == val.ID)': endpoints,\n            },\n            raw_response=entries['raw'],\n        )\n    else:\n        results = CommandResults(\n            readable_output=readable_output,\n        )\n\n    return_results(results)\n\n\ndef search_group_members(default_base_dn, page_size):\n    # this command is equivalent to ADGetGroupMembers script\n\n    args = demisto.args()\n    member_type = args.get('member-type')\n    group_dn = args.get('group-dn')\n    nested_search = '' if args.get('disable-nested-search') == 'true' else ':1.2.840.113556.1.4.1941:'\n    time_limit = int(args.get('time_limit', 180))\n    account_name = args.get('sAMAccountName')\n\n    custom_attributes: List[str] = []\n\n    default_attribute_mapping = {\n        'person': DEFAULT_PERSON_ATTRIBUTES,\n        'group': DEFAULT_GROUP_ATTRIBUTES,\n        'computer': DEFAULT_COMPUTER_ATTRIBUTES,\n    }\n    default_attributes = default_attribute_mapping.get(member_type, DEFAULT_COMPUTER_ATTRIBUTES)\n\n    if args.get('attributes'):\n        custom_attributes = args['attributes'].split(\",\")\n\n    attributes = list(set(custom_attributes + default_attributes))\n\n    if member_type == 'group':\n        query = \"(\u0026(objectCategory={})(memberOf{}={})(sAMAccountName={}))\".format(member_type, nested_search, group_dn,\n                                                                                  account_name)\n    else:\n        query = \"(\u0026(objectCategory={})(objectClass=user)(memberOf{}={})(sAMAccountName={}))\"\\\n            .format(member_type, nested_search, group_dn, account_name)\n\n    entries = search_with_paging(\n        query,\n        default_base_dn,\n        attributes=attributes,\n        page_size=page_size,\n        time_limit=time_limit\n    )\n\n    members = [{'dn': entry['dn'], 'category': member_type} for entry in entries['flat']]\n\n    demisto_entry = {\n        'ContentsFormat': formats['json'],\n        'Type': entryTypes['note'],\n        'Contents': entries['raw'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown(\"Active Directory - Get Group Members\", entries['flat']),\n        'EntryContext': {\n            'ActiveDirectory.Groups(obj.dn ==' + group_dn + ')': {\n                'dn': group_dn,\n                'members': members\n            }\n        }\n    }\n\n    if member_type == 'person':\n        demisto_entry['EntryContext']['ActiveDirectory.Users(obj.dn == val.dn)'] = entries['flat']\n        demisto_entry['EntryContext']['Account'] = [account_entry(\n            entry, custom_attributes) for entry in entries['flat']]\n    elif member_type == 'computer':\n        demisto_entry['EntryContext']['ActiveDirectory.Computers(obj.dn == val.dn)'] = entries['flat']\n        demisto_entry['EntryContext']['Endpoint'] = [endpoint_entry(\n            entry, custom_attributes) for entry in entries['flat']]\n    elif member_type == 'group':\n        demisto_entry['EntryContext']['ActiveDirectory.Groups(obj.dn == val.dn)'] = entries['flat']\n        demisto_entry['EntryContext']['Group'] = [group_entry(\n            entry, custom_attributes) for entry in entries['flat']]\n\n    demisto.results(demisto_entry)\n\n\n''' DATABASE OPERATIONS '''\n\n''' CREATE OBJECT'''\n\n\ndef create_user():\n    assert conn is not None\n    args = demisto.args()\n\n    object_classes = [\"top\", \"person\", \"organizationalPerson\", \"user\"]\n    user_dn = args.get('user-dn')\n    username = args.get(\"username\")\n    password = args.get(\"password\")\n    custom_attributes = args.get('custom-attributes')\n    attributes = {\n        \"sAMAccountName\": username\n    }\n\n    # set common user attributes\n    if args.get('display-name'):\n        attributes['displayName'] = args['display-name']\n    if args.get('description'):\n        attributes['description'] = args['description']\n    if args.get('email'):\n        attributes['mail'] = args['email']\n    if args.get('telephone-number'):\n        attributes['telephoneNumber'] = args['telephone-number']\n    if args.get('title'):\n        attributes['title'] = args['title']\n\n    # set user custom attributes\n    if custom_attributes:\n        try:\n            custom_attributes = json.loads(custom_attributes)\n        except Exception as e:\n            demisto.info(str(e))\n            raise Exception(\n                \"Failed to parse custom attributes argument. Please see an example of this argument in the description.\"\n            )\n        for attribute_name, attribute_value in custom_attributes.items():\n            # can run default attribute setting\n            attributes[attribute_name] = attribute_value\n\n    # add user\n    success = conn.add(user_dn, object_classes, attributes)\n    if not success:\n        raise Exception(\"Failed to create user\")\n\n    # set user password\n    success = conn.extend.microsoft.modify_password(user_dn, password)\n    if not success:\n        raise Exception(\"Failed to reset user password\")\n\n    # enable user and expire password\n    modification = {\n        # enable user\n        'userAccountControl': [('MODIFY_REPLACE', NORMAL_ACCOUNT)],\n        # set to 0, to force password change on next login\n        \"pwdLastSet\": [('MODIFY_REPLACE', \"0\")]\n    }\n    modify_object(user_dn, modification)\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Created user with DN: {}\".format(user_dn)\n    }\n    demisto.results(demisto_entry)\n\n\ndef create_user_iam(default_base_dn, args, mapper_out, disabled_users_group_cn):\n    \"\"\"Creates an AD user by User Profile.\n    :param default_base_dn: The location in the DIT where the search will start\n    :param args: Demisto args.\n    :param mapper_out: Mapping User Profiles to AD users.\n    :param disabled_users_group_cn: The disabled group cn, the user will be removed from this group when enabled\n    :return: The user that was created\n    \"\"\"\n    assert conn is not None\n    try:\n\n        user_profile = args.get(\"user-profile\")\n        user_profile_delta = args.get('user-profile-delta')\n        iam_user_profile = IAMUserProfile(user_profile=user_profile, user_profile_delta=user_profile_delta)\n        ad_user = iam_user_profile.map_object(mapper_name=mapper_out, incident_type=IAMUserProfile.CREATE_INCIDENT_TYPE)\n\n        sam_account_name = ad_user.get(\"samaccountname\")\n\n        if not sam_account_name:\n            raise DemistoException(\"User must have a sAMAccountName, please make sure a mapping \"\n                                   \"exists in \\\"\" + mapper_out + \"\\\" outgoing mapper.\")\n        if not ad_user.get('ou'):\n            raise DemistoException(\"User must have an Organizational Unit (OU). Please make sure you've added a \"\n                                   \"transformer script which determines the OU of the user \"\n                                   \"in \\\"\" + mapper_out + \"\\\" outgoing mapper, in the User Profile incident type \"\n                                   \"and schema type, under the \\\"ou\\\" field.\")\n\n        user_exists = check_if_user_exists_by_attribute(default_base_dn, \"samaccountname\", sam_account_name)\n\n        if user_exists:\n            iam_user_profile = update_user_iam(default_base_dn, args, False, mapper_out, disabled_users_group_cn)\n\n        else:\n            user_dn = generate_dn_and_remove_from_user_profile(default_base_dn, ad_user)\n            object_classes = [\"top\", \"person\", \"organizationalPerson\", \"user\"]\n            # ou and cn are updated from the dn, updating them seperatly can cause conflicts\n            ad_user.pop('ou')\n            ad_user.pop('cn')\n            if manager_email := ad_user.get('manageremail'):\n                manager_dn = get_user_dn_by_email(default_base_dn, manager_email)\n                ad_user['manager'] = manager_dn\n            success = conn.add(user_dn, object_classes, ad_user)\n            if success:\n                iam_user_profile.set_result(success=True,\n                                            email=ad_user.get('email'),\n                                            username=ad_user.get('name'),\n                                            details=ad_user,\n                                            action=IAMActions.CREATE_USER,\n                                            active=False)  # the user should be activated with the IAMInitADUser script\n\n            else:\n                error_msg = 'Please validate your instance configuration and make sure all of the ' \\\n                            'required attributes are mapped correctly in \"' + mapper_out + '\" outgoing mapper.'\n                raise DemistoException(error_msg)\n\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, _ = IAMErrors.BAD_REQUEST\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=str(e),\n                                    action=IAMActions.CREATE_USER,\n                                    )\n        return iam_user_profile\n\n\ndef get_iam_user_profile(user_profile, mapper_out):\n    iam_user_profile = IAMUserProfile(user_profile=user_profile)\n    ad_user = iam_user_profile.map_object(mapper_name=mapper_out, incident_type=IAMUserProfile.UPDATE_INCIDENT_TYPE)\n    sam_account_name = ad_user.get(\"samaccountname\")\n\n    old_user_data = user_profile.get_attribute('olduserdata')\n    if old_user_data:\n        iam_old_user_profile = IAMUserProfile(user_profile=old_user_data)\n        ad_old_user = iam_old_user_profile.map_object(mapper_name=mapper_out,\n                                                      incident_type=IAMUserProfile.UPDATE_INCIDENT_TYPE)\n        sam_account_name = ad_old_user.get(\"samaccountname\") or sam_account_name\n\n    return iam_user_profile, ad_user, sam_account_name\n\n\ndef update_user_iam(default_base_dn, args, create_if_not_exists, mapper_out, disabled_users_group_cn):\n    \"\"\"Update an AD user by User Profile.\n    :param default_base_dn: The location in the DIT where the search will start\n    :param args: Demisto args.\n    :param create_if_not_exists: Created the user if it does not exists.\n    :param mapper_out: Mapping User Profiles to AD users.\n    :param disabled_users_group_cn: The disabled group cn, the user will be removed from this group when enabled\n    :return: Updated User\n    \"\"\"\n    assert conn is not None\n    try:\n        user_profile = args.get(\"user-profile\")\n        allow_enable = args.get('allow-enable') == 'true'\n\n        iam_user_profile, ad_user, sam_account_name = get_iam_user_profile(user_profile, mapper_out)\n\n        if not sam_account_name:\n            raise DemistoException(\"User must have a sAMAccountName, please make sure a mapping \"\n                                   \"exists in \\\"\" + mapper_out + \"\\\" outgoing mapper.\")\n        if not ad_user.get('ou'):\n            raise DemistoException(\"User must have an Organizational Unit (OU). Please make sure you've added a \"\n                                   \"transformer script which determines the OU of the user \"\n                                   \"in \\\"\" + mapper_out + \"\\\" outgoing mapper, in the User Profile incident type \"\n                                   \"and schema type, under the \\\"ou\\\" field.\")\n\n        new_ou = ad_user.get(\"ou\")\n        user_exists = check_if_user_exists_by_attribute(default_base_dn, \"samaccountname\", sam_account_name)\n\n        if not user_exists:\n            if create_if_not_exists:\n                iam_user_profile = create_user_iam(default_base_dn, args, mapper_out, disabled_users_group_cn)\n            else:\n                _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                iam_user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                            skip=True,\n                                            skip_reason=error_message)\n        else:\n            dn = user_dn(sam_account_name, default_base_dn)\n\n            if allow_enable:\n                enable_user_iam(default_base_dn, dn, disabled_users_group_cn)\n\n            # fields that can't be modified\n            # notice that we are changing the ou and that effects the dn and cn\n            for field in FIELDS_THAT_CANT_BE_MODIFIED:\n                if ad_user.get(field):\n                    ad_user.pop(field)\n\n            fail_to_modify = []\n            if manager_email := ad_user.get('manageremail'):\n                manager_dn = get_user_dn_by_email(default_base_dn, manager_email)\n                ad_user['manager'] = manager_dn\n                ad_user.pop('manageremail')\n\n            for key in ad_user:\n                modification = {key: [('MODIFY_REPLACE', ad_user.get(key))]}\n                success = conn.modify(dn, modification)\n                if not success:\n                    fail_to_modify.append(key)\n\n            ou_modified_succeed = modify_user_ou(dn, new_ou)\n            if not ou_modified_succeed:\n                fail_to_modify.append(\"ou\")\n\n            if fail_to_modify:\n                error_list = '\\n'.join(fail_to_modify)\n                error_message = f\"Failed to modify the following attributes: {error_list}\"\n                raise DemistoException(error_message)\n\n            else:\n                active = get_user_activity_by_samaccountname(default_base_dn, sam_account_name)\n                iam_user_profile.set_result(success=True,\n                                            email=ad_user.get('email'),\n                                            username=ad_user.get('name'),\n                                            action=IAMActions.UPDATE_USER,\n                                            details=ad_user,\n                                            active=active)\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, _ = IAMErrors.BAD_REQUEST\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=str(e),\n                                    action=IAMActions.UPDATE_USER\n                                    )\n        return iam_user_profile\n\n\ndef create_contact():\n    assert conn is not None\n    args = demisto.args()\n\n    object_classes = [\"top\", \"person\", \"organizationalPerson\", \"contact\"]\n    contact_dn = args.get('contact-dn')\n\n    # set contact attributes\n    attributes: Dict = {}\n    if args.get('custom-attributes'):\n        try:\n            attributes = json.loads(args['custom-attributes'])\n        except Exception as e:\n            demisto.info(str(e))\n            raise Exception(\n                'Failed to parse custom attributes argument. Please see an example of this argument in the argument.'\n            )\n\n    # set common user attributes\n    if args.get('display-name'):\n        attributes['displayName'] = args['display-name']\n    if args.get('description'):\n        attributes['description'] = args['description']\n    if args.get('email'):\n        attributes['mail'] = args['email']\n    if args.get('telephone-number'):\n        attributes['telephoneNumber'] = args['telephone-number']\n    if args.get('title'):\n        attributes['title'] = args['title']\n\n    # add contact\n\n    success = conn.add(contact_dn, object_classes, attributes)\n    if not success:\n        raise Exception(\"Failed to create contact\")\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Created contact with DN: {}\".format(contact_dn)\n    }\n    demisto.results(demisto_entry)\n\n\ndef create_group():\n    assert conn is not None\n    args = demisto.args()\n\n    object_classes = [\"top\", \"group\"]\n    dn = args.get('dn')\n    group_name = args.get('name')\n    group_type_map = {\"security\": \"2147483650\", \"distribution\": \"2\"}\n    group_type = group_type_map[args.get(\"group-type\")]\n    if args.get('members'):\n        members = args.get('members')\n        attributes = {\n            \"samAccountName\": group_name,\n            \"groupType\": group_type,\n            \"member\": members\n        }\n    else:\n        attributes = {\n            \"samAccountName\": group_name,\n            \"groupType\": group_type\n        }\n\n    # create group\n    success = conn.add(dn, object_classes, attributes)\n    if not success:\n        raise Exception(\"Failed to create group\")\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Created group with DN: {}\".format(dn)\n    }\n    demisto.results(demisto_entry)\n\n\n''' UPDATE OBJECT '''\n\n\ndef modify_object(dn, modification):\n    \"\"\"\n    modifies object in the DIT\n    \"\"\"\n    assert conn is not None\n    success = conn.modify(dn, modification)\n    if not success:\n        raise Exception(\"Failed to update object {} with the following modification: {}\".format(\n            dn, json.dumps(modification)))\n\n\ndef update_user(default_base_dn):\n    args = demisto.args()\n\n    # get user DN\n    sam_account_name = args.get('username')\n    attribute_name = args.get('attribute-name')\n    attribute_value = args.get('attribute-value')\n    search_base = args.get('base-dn') or default_base_dn\n    dn = user_dn(sam_account_name, search_base)\n\n    modification = {}\n    modification[attribute_name] = [('MODIFY_REPLACE', attribute_value)]\n\n    # modify user\n    modify_object(dn, modification)\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Updated user's {} to {} \".format(attribute_name, attribute_value)\n    }\n    demisto.results(demisto_entry)\n\n\ndef update_contact():\n    args = demisto.args()\n\n    contact_dn = args.get('contact-dn')\n    modification = {}\n    modification[args.get('attribute-name')] = [('MODIFY_REPLACE', args.get('attribute-value'))]\n\n    # modify\n    modify_object(contact_dn, modification)\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Updated contact's {} to: {} \".format(args.get('attribute-name'), args.get('attribute-value'))\n    }\n    demisto.results(demisto_entry)\n\n\ndef modify_computer_ou(default_base_dn):\n    assert conn is not None\n    args = demisto.args()\n\n    computer_name = args.get('computer-name')\n    dn = computer_dn(computer_name, args.get('base-dn') or default_base_dn)\n\n    success = conn.modify_dn(dn, \"CN={}\".format(computer_name), new_superior=args.get('full-superior-dn'))\n    if not success:\n        raise Exception(\"Failed to modify computer OU\")\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Moved computer {} to {}\".format(computer_name, args.get('full-superior-dn'))\n    }\n    demisto.results(demisto_entry)\n\n\ndef expire_user_password(default_base_dn):\n    args = demisto.args()\n\n    # get user DN\n    sam_account_name = args.get('username')\n    search_base = args.get('base-dn') or default_base_dn\n    dn = user_dn(sam_account_name, search_base)\n\n    modification = {\n        # set to 0, to force password change on next login\n        \"pwdLastSet\": [('MODIFY_REPLACE', \"0\")]\n    }\n\n    # modify user\n    modify_object(dn, modification)\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Expired password successfully\"\n    }\n    demisto.results(demisto_entry)\n\n\ndef set_user_password(default_base_dn, port):\n    assert conn is not None\n    args = demisto.args()\n\n    if port != 636:\n        raise DemistoException('Port 636 is required for this action.')\n\n    # get user DN\n    sam_account_name = args.get('username')\n    password = args.get('password')\n    search_base = args.get('base-dn') or default_base_dn\n    dn = user_dn(sam_account_name, search_base)\n\n    # set user password\n    success = conn.extend.microsoft.modify_password(dn, password)\n    if not success:\n        raise Exception(\"Failed to reset user password\")\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"User password successfully set\"\n    }\n    demisto.results(demisto_entry)\n\n\ndef enable_user(default_base_dn):\n    args = demisto.args()\n\n    # get user DN\n    sam_account_name = args.get('username')\n    search_base = args.get('base-dn') or default_base_dn\n    dn = user_dn(sam_account_name, search_base)\n\n    # modify user\n    modification = {\n        'userAccountControl': [('MODIFY_REPLACE', NORMAL_ACCOUNT)]\n    }\n    modify_object(dn, modification)\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"User {} was enabled\".format(sam_account_name)\n    }\n    demisto.results(demisto_entry)\n\n\ndef disable_user(default_base_dn):\n    args = demisto.args()\n\n    # get user DN\n    sam_account_name = args.get('username')\n    search_base = args.get('base-dn') or default_base_dn\n    dn = user_dn(sam_account_name, search_base)\n\n    # modify user\n    modification = {\n        'userAccountControl': [('MODIFY_REPLACE', DISABLED_ACCOUNT)]\n    }\n    modify_object(dn, modification)\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"User {} was disabled\".format(sam_account_name)\n    }\n    demisto.results(demisto_entry)\n\n\ndef enable_user_iam(default_base_dn, dn, disabled_users_group_cn):\n    \"\"\"Enables an AD user by User Profile.\n    :param default_base_dn: The location in the DIT where the search will start\n    :param dn: The users unique dn\n    :param disabled_users_group_cn: The disabled group cn, the user will be removed from this group when enabled\n    \"\"\"\n    modification = {\n        'userAccountControl': [('MODIFY_REPLACE', NORMAL_ACCOUNT)]\n    }\n    modify_object(dn, modification)\n    if disabled_users_group_cn:\n        grp_dn = group_dn(disabled_users_group_cn, default_base_dn)\n        success = microsoft.removeMembersFromGroups.ad_remove_members_from_groups(conn, [dn], [grp_dn], True)\n        if not success:\n            raise Exception('Failed to remove user from {} group'.format(disabled_users_group_cn))\n\n\ndef disable_user_iam(default_base_dn, disabled_users_group_cn, args, mapper_out):\n    \"\"\"Disables an AD user by User Profile.\n    :param default_base_dn: The location in the DIT where the search will start\n    :param disabled_users_group_cn: The disabled group cn, the user will be added from this group when enabled\n    :param args: Demisto args.\n    :param mapper_out: Mapping User Profiles to AD users.\n    :return: The disabled user\n    \"\"\"\n    try:\n        user_profile = args.get(\"user-profile\")\n        user_profile_delta = args.get('user-profile-delta')\n        iam_user_profile = IAMUserProfile(user_profile=user_profile, user_profile_delta=user_profile_delta)\n        ad_user = iam_user_profile.map_object(mapper_name=mapper_out, incident_type=IAMUserProfile.UPDATE_INCIDENT_TYPE)\n\n        sam_account_name = ad_user.get(\"samaccountname\")\n        if not sam_account_name:\n            raise DemistoException(\"User must have a sAMAccountName, please make sure a mapping \"\n                                   \"exists in \\\"\" + mapper_out + \"\\\" outgoing mapper.\")\n\n        user_exists = check_if_user_exists_by_attribute(default_base_dn, \"samaccountname\", sam_account_name)\n        if not user_exists:\n            iam_user_profile.set_result(success=True, action=IAMActions.DISABLE_USER,\n                                        skip=True, skip_reason=\"User doesn't exist\")\n            return iam_user_profile\n\n        dn = user_dn(sam_account_name, default_base_dn)\n\n        # modify user\n        modification = {\n            'userAccountControl': [('MODIFY_REPLACE', DISABLED_ACCOUNT)]\n        }\n\n        try:\n            modify_object(dn, modification)\n        except Exception as e:\n            error_msg = 'Please validate your instance configuration and make sure all of the ' \\\n                        'required attributes are mapped correctly in \"' + mapper_out + '\" outgoing mapper.\\n' \\\n                        'Error is: ' + str(e)\n            raise DemistoException(error_msg)\n\n        if disabled_users_group_cn:\n\n            grp_dn = group_dn(disabled_users_group_cn, default_base_dn)\n            success = microsoft.addMembersToGroups.ad_add_members_to_groups(conn, [dn], [grp_dn])\n            if not success:\n                raise DemistoException('Failed to remove user from the group \"' + disabled_users_group_cn + '\".')\n\n        iam_user_profile.set_result(success=True,\n                                    email=ad_user.get('email'),\n                                    username=ad_user.get('name'),\n                                    action=IAMActions.DISABLE_USER,\n                                    details=ad_user,\n                                    active=False)\n\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, _ = IAMErrors.BAD_REQUEST\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=str(e),\n                                    action=IAMActions.DISABLE_USER\n                                    )\n        return iam_user_profile\n\n\ndef add_member_to_group(default_base_dn):\n\n    args = demisto.args()\n\n    search_base = args.get('base-dn') or default_base_dn\n\n    # get the  dn of the member - either user or computer\n    args_err = \"Pleade provide either username or computer-name\"\n    member_dn = ''\n\n    if args.get('username') and args.get('computer-name'):\n        # both arguments passed\n        raise Exception(args_err)\n    if args.get('username'):\n        member_dn = user_dn(args['username'], search_base)\n    elif args.get('computer-name'):\n        member_dn = computer_dn(args['computer-name'], search_base)\n    else:\n        # none of the arguments passed\n        raise Exception(args_err)\n\n    grp_dn = group_dn(args.get('group-cn'), search_base)\n\n    success = microsoft.addMembersToGroups.ad_add_members_to_groups(conn, [member_dn], [grp_dn])\n    if not success:\n        raise Exception(\"Failed to add {} to group {}\".format(\n            args.get('username') or args.get('computer-name'),\n            args.get('group_name')\n        ))\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Object with dn {} was added to group {}\".format(member_dn, args.get('group-cn'))\n    }\n    demisto.results(demisto_entry)\n\n\ndef remove_member_from_group(default_base_dn):\n\n    args = demisto.args()\n\n    search_base = args.get('base-dn') or default_base_dn\n\n    # get the dn of the member - either user or computer\n    args_err = \"Pleade provide either username or computer-name\"\n    member_dn = ''\n\n    if args.get('username') and args.get('computer-name'):\n        # both arguments passed\n        raise Exception(args_err)\n    if args.get('username'):\n        member_dn = user_dn(args['username'], search_base)\n    elif args.get('computer-name'):\n        member_dn = computer_dn(args['computer-name'], search_base)\n    else:\n        # none of the arguments passed\n        raise Exception(args_err)\n\n    grp_dn = group_dn(args.get('group-cn'), search_base)\n\n    success = microsoft.removeMembersFromGroups.ad_remove_members_from_groups(conn, [member_dn], [grp_dn], True)\n    if not success:\n        raise Exception(\"Failed to remove {} from group {}\".format(\n            args.get('username') or args.get('computer-name'),\n            args.get('group_name')\n        ))\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Object with dn {} removed from group {}\".format(member_dn, args.get('group-cn'))\n    }\n    demisto.results(demisto_entry)\n\n\ndef unlock_account(default_base_dn):\n    args = demisto.args()\n\n    # get user DN\n    sam_account_name = args.get('username')\n    search_base = args.get('base-dn') or default_base_dn\n    dn = user_dn(sam_account_name, search_base)\n\n    success = microsoft.unlockAccount.ad_unlock_account(conn, dn)\n    if not success:\n        raise Exception(\"Failed to unlock user {}\".format(sam_account_name))\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Unlocked user {}\".format(sam_account_name)\n    }\n    demisto.results(demisto_entry)\n\n\n''' DELETE OBJECT '''\n\n\ndef delete_user():\n    # can actually delete any object...\n    assert conn is not None\n    success = conn.delete(demisto.args().get('user-dn'))\n    if not success:\n        raise Exception('Failed to delete user')\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Deleted object with dn {}\".format(demisto.args().get('user-dn'))\n    }\n    demisto.results(demisto_entry)\n\n\ndef delete_group():\n    assert conn is not None\n    args = demisto.args()\n\n    dn = args.get('dn')\n\n    # delete group\n    success = conn.delete(dn)\n    if not success:\n        raise Exception(\"Failed to delete group\")\n\n    demisto_entry = {\n        'ContentsFormat': formats['text'],\n        'Type': entryTypes['note'],\n        'Contents': \"Deleted group with DN: {}\".format(dn)\n    }\n    demisto.results(demisto_entry)\n\n\ndef get_mapping_fields_command(search_base):\n    ad_attributes = get_all_attributes(search_base)\n    # add keys that are not attributes but can be used in mapping\n    ad_attributes.extend((\"dn\", \"samaccountname\", \"manageremail\"))\n\n    incident_type_scheme = SchemeTypeMapping(type_name=IAMUserProfile.DEFAULT_INCIDENT_TYPE)\n\n    for field in ad_attributes:\n        incident_type_scheme.add_field(field, \"Field\")\n\n    return GetMappingFieldsResponse([incident_type_scheme])\n\n\n'''\n    TEST CONFIGURATION\n    authenticate user credentials while initializing connection with AD server\n    verify base DN is configured correctly\n'''\n\n\ndef main():\n    \"\"\" INSTANCE CONFIGURATION \"\"\"\n    params = demisto.params()\n    command = demisto.command()\n\n    SERVER_IP = params.get('server_ip')\n    USERNAME = params.get('credentials')['identifier']\n    PASSWORD = params.get('credentials')['password']\n    DEFAULT_BASE_DN = params.get('base_dn')\n    SECURE_CONNECTION = params.get('secure_connection')\n    DEFAULT_PAGE_SIZE = int(params.get('page_size'))\n    NTLM_AUTH = params.get('ntlm')\n    UNSECURE = params.get('unsecure', False)\n    PORT = params.get('port')\n\n    disabled_users_group_cn = params.get('group-cn')\n    create_if_not_exists = params.get('create-if-not-exists')\n    mapper_in = params.get('mapper-in', DEFAULT_INCOMING_MAPPER)\n    mapper_out = params.get('mapper-out', DEFAULT_OUTGOING_MAPPER)\n\n    if PORT:\n        # port was configured, cast to int\n        PORT = int(PORT)\n    last_log_detail_level = None\n    try:\n        try:\n            set_library_log_hide_sensitive_data(True)\n            if is_debug_mode():\n                demisto.info('debug-mode: setting library log detail to EXTENDED')\n                last_log_detail_level = get_library_log_detail_level()\n                set_library_log_detail_level(EXTENDED)\n            server = initialize_server(SERVER_IP, PORT, SECURE_CONNECTION, UNSECURE)\n        except Exception as e:\n            return_error(str(e))\n            return\n        global conn\n        if NTLM_AUTH:\n            # intialize connection to LDAP server with NTLM authentication\n            # user example: domain\\user\n            domain_user = SERVER_IP + '\\\\' + USERNAME if '\\\\' not in USERNAME else USERNAME\n            conn = Connection(server, user=domain_user, password=PASSWORD, authentication=NTLM)\n        else:\n            # here username should be the user dn\n            conn = Connection(server, user=USERNAME, password=PASSWORD)\n\n        if SECURE_CONNECTION == 'TLS':\n            conn.open()\n            conn.start_tls()\n\n        # bind operation is the “authenticate” operation.\n        try:\n            # open socket and bind to server\n            if not conn.bind():\n                message = \"Failed to bind to server. Please validate the credentials configured correctly.\\n{}\".format(\n                    json.dumps(conn.result))\n                return_error(message)\n                return\n        except Exception as e:\n            exc_msg = str(e)\n            demisto.info(\"Failed bind to: {}:{}. {}: {}\".format(SERVER_IP, PORT, type(e), exc_msg\n                         + \"\\nTrace:\\n{}\".format(traceback.format_exc())))\n            message = \"Failed to access LDAP server. Please validate the server host and port are configured correctly\"\n            if 'ssl wrapping error' in exc_msg:\n                message = \"Failed to access LDAP server. SSL error.\"\n                if not UNSECURE:\n                    message += ' Try using: \"Trust any certificate\" option.'\n            return_error(message)\n            return\n\n        demisto.info('Established connection with AD LDAP server')\n\n        if not base_dn_verified(DEFAULT_BASE_DN):\n            message = \"Failed to verify the base DN configured for the instance.\\n\" \\\n                \"Last connection result: {}\\n\" \\\n                \"Last error from LDAP server: {}\".format(json.dumps(conn.result), json.dumps(conn.last_error))\n            return_error(message)\n            return\n\n        demisto.info('Verfied base DN \"{}\"'.format(DEFAULT_BASE_DN))\n\n        ''' COMMAND EXECUTION '''\n\n        if command == 'test-module':\n            if conn.user == '':\n                # Empty response means you have no authentication status on the server, so you are an anonymous user.\n                raise Exception(\"Failed to authenticate user\")\n            demisto.results('ok')\n\n        args = demisto.args()\n\n        if command == 'ad-search':\n            free_search(DEFAULT_BASE_DN, DEFAULT_PAGE_SIZE)\n\n        if command == 'ad-expire-password':\n            expire_user_password(DEFAULT_BASE_DN)\n\n        if command == 'ad-set-new-password':\n            set_user_password(DEFAULT_BASE_DN, PORT)\n\n        if command == 'ad-unlock-account':\n            unlock_account(DEFAULT_BASE_DN)\n\n        if command == 'ad-disable-account':\n            disable_user(DEFAULT_BASE_DN)\n\n        if command == 'ad-enable-account':\n            enable_user(DEFAULT_BASE_DN)\n\n        if command == 'ad-remove-from-group':\n            remove_member_from_group(DEFAULT_BASE_DN)\n\n        if command == 'ad-add-to-group':\n            add_member_to_group(DEFAULT_BASE_DN)\n\n        if command == 'ad-create-user':\n            create_user()\n\n        if command == 'ad-delete-user':\n            delete_user()\n\n        if command == 'ad-update-user':\n            update_user(DEFAULT_BASE_DN)\n\n        if command == 'ad-modify-computer-ou':\n            modify_computer_ou(DEFAULT_BASE_DN)\n\n        if command == 'ad-create-contact':\n            create_contact()\n\n        if command == 'ad-update-contact':\n            update_contact()\n\n        if command == 'ad-get-user':\n            search_users(DEFAULT_BASE_DN, DEFAULT_PAGE_SIZE)\n\n        if command == 'ad-get-computer':\n            search_computers(DEFAULT_BASE_DN, DEFAULT_PAGE_SIZE)\n\n        if command == 'ad-get-group-members':\n            search_group_members(DEFAULT_BASE_DN, DEFAULT_PAGE_SIZE)\n\n        if command == 'ad-create-group':\n            create_group()\n\n        if command == 'ad-delete-group':\n            delete_group()\n\n        # IAM commands\n        if command == 'iam-get-user':\n            user_profile = get_user_iam(DEFAULT_BASE_DN, args, mapper_in, mapper_out)\n            return return_results(user_profile)\n\n        if command == 'iam-create-user':\n            user_profile = create_user_iam(DEFAULT_BASE_DN, args, mapper_out, disabled_users_group_cn)\n            return return_results(user_profile)\n\n        if command == 'iam-update-user':\n            user_profile = update_user_iam(DEFAULT_BASE_DN, args, create_if_not_exists, mapper_out,\n                                           disabled_users_group_cn)\n            return return_results(user_profile)\n\n        if command == 'iam-disable-user':\n            user_profile = disable_user_iam(DEFAULT_BASE_DN, disabled_users_group_cn, args, mapper_out)\n            return return_results(user_profile)\n\n        elif command == 'get-mapping-fields':\n            mapping_fields = get_mapping_fields_command(DEFAULT_BASE_DN)\n            return return_results(mapping_fields)\n\n    except Exception as e:\n        message = str(e)\n        if conn:\n            message += \"\\nLast connection result: {}\\nLast error from LDAP server: {}\".format(\n                json.dumps(conn.result), conn.last_error)\n        return_error(message)\n        return\n    finally:\n        # disconnect and close the connection\n        if conn:\n            conn.unbind()\n        if last_log_detail_level:\n            set_library_log_detail_level(last_log_detail_level)\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\n\nclass IAMErrors(object):\n    \"\"\"\n    An enum class to manually handle errors in IAM integrations\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    BAD_REQUEST = 400, 'Bad request - failed to perform operation'\n    USER_DOES_NOT_EXIST = 404, 'User does not exist'\n    USER_ALREADY_EXISTS = 409, 'User already exists'\n\n\nclass IAMActions(object):\n    \"\"\"\n    Enum: contains all the IAM actions (e.g. get, update, create, etc.)\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    GET_USER = 'get'\n    UPDATE_USER = 'update'\n    CREATE_USER = 'create'\n    DISABLE_USER = 'disable'\n    ENABLE_USER = 'enable'\n\n\nclass IAMVendorActionResult:\n    \"\"\" This class is used in IAMUserProfile class to represent actions data.\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    def __init__(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                 error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        self._brand = demisto.callingContext.get('context', {}).get('IntegrationBrand')\n        self._instance_name = demisto.callingContext.get('context', {}).get('IntegrationInstance')\n        self._success = success\n        self._active = active\n        self._iden = iden\n        self._username = username\n        self._email = email\n        self._error_code = error_code\n        self._error_message = error_message\n        self._details = details\n        self._skip = skip\n        self._skip_reason = skip_reason\n        self._action = action\n        self._return_error = return_error\n\n    def should_return_error(self):\n        return self._return_error\n\n    def create_outputs(self):\n        \"\"\" Sets the outputs in `_outputs` attribute.\n        \"\"\"\n        outputs = {\n            'brand': self._brand,\n            'instanceName': self._instance_name,\n            'action': self._action,\n            'success': self._success,\n            'active': self._active,\n            'id': self._iden,\n            'username': self._username,\n            'email': self._email,\n            'errorCode': self._error_code,\n            'errorMessage': self._error_message,\n            'details': self._details,\n            'skipped': self._skip,\n            'reason': self._skip_reason\n        }\n        return outputs\n\n    def create_readable_outputs(self, outputs):\n        \"\"\" Sets the human readable output in `_readable_output` attribute.\n\n        :param outputs: (dict) the command outputs.\n        \"\"\"\n        title = self._action.title() + ' User Results ({})'.format(self._brand)\n\n        if not self._skip:\n            headers = [\"brand\", \"instanceName\", \"success\", \"active\", \"id\", \"username\",\n                       \"email\", \"errorCode\", \"errorMessage\", \"details\"]\n        else:\n            headers = [\"brand\", \"instanceName\", \"skipped\", \"reason\"]\n\n        readable_output = tableToMarkdown(\n            name=title,\n            t=outputs,\n            headers=headers,\n            removeNull=True\n        )\n\n        return readable_output\n\n\nclass IAMUserProfile:\n    \"\"\" A User Profile object class for IAM integrations.\n\n    :type _user_profile: ``str``\n    :param _user_profile: The user profile information.\n\n    :type _user_profile_delta: ``str``\n    :param _user_profile_delta: The user profile delta.\n\n    :type _vendor_action_results: ``list``\n    :param _vendor_action_results: A List of data returned from the vendor.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    DEFAULT_INCIDENT_TYPE = 'User Profile'\n    CREATE_INCIDENT_TYPE = 'User Profile - Create'\n    UPDATE_INCIDENT_TYPE = 'User Profile - Update'\n\n    def __init__(self, user_profile, user_profile_delta=None):\n        self._user_profile = safe_load_json(user_profile)\n        self._user_profile_delta = safe_load_json(user_profile_delta) if user_profile_delta else {}\n        self._vendor_action_results = []\n\n    def get_attribute(self, item, use_old_user_data=False):\n        if use_old_user_data and self._user_profile.get('olduserdata', {}).get(item):\n            return self._user_profile.get('olduserdata', {}).get(item)\n        return self._user_profile.get(item)\n\n    def to_entry(self):\n        \"\"\" Generates a XSOAR IAM entry from the data in _vendor_action_results.\n        Note: Currently we are using only the first element of the list, in the future we will support multiple results.\n\n        :return: A XSOAR entry.\n        :rtype: ``dict``\n        \"\"\"\n\n        outputs = self._vendor_action_results[0].create_outputs()\n        readable_output = self._vendor_action_results[0].create_readable_outputs(outputs)\n\n        entry_context = {\n            'IAM.UserProfile(val.email \u0026\u0026 val.email == obj.email)': self._user_profile,\n            'IAM.Vendor(val.instanceName \u0026\u0026 val.instanceName == obj.instanceName \u0026\u0026 '\n            'val.email \u0026\u0026 val.email == obj.email)': outputs\n        }\n\n        return_entry = {\n            'ContentsFormat': EntryFormat.JSON,\n            'Contents': outputs,\n            'EntryContext': entry_context\n        }\n\n        if self._vendor_action_results[0].should_return_error():\n            return_entry['Type'] = EntryType.ERROR\n        else:\n            return_entry['Type'] = EntryType.NOTE\n            return_entry['HumanReadable'] = readable_output\n\n        return return_entry\n\n    def return_outputs(self):\n        return_results(self.to_entry())\n\n    def set_result(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                   error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        if not email:\n            email = self.get_attribute('email')\n\n        vendor_action_result = IAMVendorActionResult(\n            success=success,\n            active=active,\n            iden=iden,\n            username=username,\n            email=email,\n            error_code=error_code,\n            error_message=error_message if error_message else '',\n            details=details,\n            skip=skip,\n            skip_reason=skip_reason if skip_reason else '',\n            action=action,\n            return_error=return_error\n        )\n\n        self._vendor_action_results.append(vendor_action_result)\n\n    def map_object(self, mapper_name, incident_type):\n        \"\"\" Returns the user data, in an application data format.\n\n        :type mapper_name: ``str``\n        :param mapper_name: The outgoing mapper from XSOAR to the application.\n\n        :type incident_type: ``str``\n        :param incident_type: The incident type used.\n\n        :return: the user data, in the app data format.\n        :rtype: ``dict``\n        \"\"\"\n        if incident_type not in [IAMUserProfile.CREATE_INCIDENT_TYPE, IAMUserProfile.UPDATE_INCIDENT_TYPE]:\n            raise DemistoException('You must provide a valid incident type to the map_object function.')\n        if not self._user_profile:\n            raise DemistoException('You must provide the user profile data.')\n        app_data = demisto.mapObject(self._user_profile, mapper_name, incident_type)\n        return app_data\n\n    def update_with_app_data(self, app_data, mapper_name, incident_type=None):\n        \"\"\" updates the user_profile attribute according to the given app_data\n\n        :type app_data: ``dict``\n        :param app_data: The user data in app\n\n        :type mapper_name: ``str``\n        :param mapper_name: Incoming mapper name\n\n        :type incident_type: ``str``\n        :param incident_type: Optional - incident type\n        \"\"\"\n        if not incident_type:\n            incident_type = IAMUserProfile.DEFAULT_INCIDENT_TYPE\n        if not isinstance(app_data, dict):\n            app_data = safe_load_json(app_data)\n        self._user_profile = demisto.mapObject(app_data, mapper_name, incident_type)\n\n\nclass IAMUserAppData:\n    \"\"\" Holds user attributes retrieved from an application.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, user_id, username, is_active, app_data):\n        self.id = user_id\n        self.username = username\n        self.is_active = is_active\n        self.full_data = app_data\n\n\nclass IAMCommand:\n    \"\"\" A class that implements the IAM CRUD commands - should be used.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, is_create_enabled=True, is_enable_enabled=True, is_disable_enabled=True, is_update_enabled=True,\n                 create_if_not_exists=True, mapper_in=None, mapper_out=None, attr='email'):\n        \"\"\" The IAMCommand c'tor\n\n        :param is_create_enabled: (bool) Whether or not to allow creating users in the application.\n        :param is_enable_enabled: (bool) Whether or not to allow enabling users in the application.\n        :param is_disable_enabled: (bool) Whether or not to allow disabling users in the application.\n        :param is_update_enabled: (bool) Whether or not to allow updating users in the application.\n        :param create_if_not_exists: (bool) Whether or not to create a user if does not exist in the application.\n        :param mapper_in: (str) Incoming mapper from the application to Cortex XSOAR\n        :param mapper_out: (str) Outgoing mapper from the Cortex XSOAR to the application\n        \"\"\"\n        self.is_create_enabled = is_create_enabled\n        self.is_enable_enabled = is_enable_enabled\n        self.is_disable_enabled = is_disable_enabled\n        self.is_update_enabled = is_update_enabled\n        self.create_if_not_exists = create_if_not_exists\n        self.mapper_in = mapper_in\n        self.mapper_out = mapper_out\n        self.attr = attr\n\n    def get_user(self, client, args):\n        \"\"\" Searches a user in the application and updates the user profile object with the data.\n            If not found, the error details will be resulted instead.\n        :param client: (Client) The integration Client object that implements a get_user() method\n        :param args: (dict) The `iam-get-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        try:\n            identifier = user_profile.get_attribute(self.attr)\n            user_app_data = client.get_user(identifier)\n            if not user_app_data:\n                error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                user_profile.set_result(action=IAMActions.GET_USER,\n                                        success=False,\n                                        error_code=error_code,\n                                        error_message=error_message)\n            else:\n                user_profile.update_with_app_data(user_app_data.full_data, self.mapper_in)\n                user_profile.set_result(\n                    action=IAMActions.GET_USER,\n                    active=user_app_data.is_active,\n                    iden=user_app_data.id,\n                    email=user_profile.get_attribute('email'),\n                    username=user_app_data.username,\n                    details=user_app_data.full_data\n                )\n\n        except Exception as e:\n            client.handle_exception(user_profile, e, IAMActions.GET_USER)\n\n        return user_profile\n\n    def disable_user(self, client, args):\n        \"\"\" Disables a user in the application and updates the user profile object with the updated data.\n            If not found, the command will be skipped.\n\n        :param client: (Client) The integration Client object that implements get_user() and disable_user() methods\n        :param args: (dict) The `iam-disable-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        if not self.is_disable_enabled:\n            user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if not user_app_data:\n                    _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                    user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                            skip=True,\n                                            skip_reason=error_message)\n                else:\n                    if user_app_data.is_active:\n                        user_app_data = client.disable_user(user_app_data.id)\n                    user_profile.set_result(\n                        action=IAMActions.DISABLE_USER,\n                        active=False,\n                        iden=user_app_data.id,\n                        email=user_profile.get_attribute('email'),\n                        username=user_app_data.username,\n                        details=user_app_data.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.DISABLE_USER)\n\n        return user_profile\n\n    def create_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If a user in the app already holds the email in the given user profile, updates\n            its data with the given data.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-create-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n\n        if not self.is_create_enabled:\n            user_profile.set_result(action=IAMActions.CREATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    # if user exists, update it\n                    user_profile = self.update_user(client, args)\n\n                else:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.CREATE_INCIDENT_TYPE)\n                    created_user = client.create_user(app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.CREATE_USER,\n                        active=created_user.is_active,\n                        iden=created_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=created_user.username,\n                        details=created_user.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.CREATE_USER)\n\n        return user_profile\n\n    def update_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If the user is disabled and `allow-enable` argument is `true`, also enables the user.\n            If the user does not exist in the app and the `create-if-not-exist` parameter is checked, creates the user.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-update-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        allow_enable = args.get('allow-enable') == 'true'\n        if not self.is_update_enabled:\n            user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr, use_old_user_data=True)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.UPDATE_INCIDENT_TYPE)\n\n                    if allow_enable and self.is_enable_enabled and not user_app_data.is_active:\n                        client.enable_user(user_app_data.id)\n\n                    updated_user = client.update_user(user_app_data.id, app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.UPDATE_USER,\n                        active=updated_user.is_active,\n                        iden=updated_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=updated_user.username,\n                        details=updated_user.full_data\n                    )\n                else:\n                    if self.create_if_not_exists:\n                        user_profile = self.create_user(client, args)\n                    else:\n                        _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                        user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                                skip=True,\n                                                skip_reason=error_message)\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.UPDATE_USER)\n\n        return user_profile\n\n\n\n# python2 uses __builtin__ python3 uses builtins\nif __name__ in ('__builtin__', 'builtins', '__main__'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.3.2","modified":"2021-09-05T10:48:02.786075+03:00","name":"Active Directory Query v2","packID":"Active_Directory_Query","packPropagationLabels":["all"],"prevName":"Active Directory Query v2","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":4},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"true","display":"Fetch indicators","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feed","options":null,"required":false,"type":8},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"TIM customers that upgraded to version 6.2 or above, can have this value pre-configured in their main account so no additional input is needed. To use this feature, upgrade your license so it includes the license key.","name":"api_key","options":null,"required":false,"type":4},{"defaultValue":"Bad","display":"Indicator Reputation","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Indicators from this integration instance will be marked with this reputation","name":"feedReputation","options":["None","Good","Suspicious","Bad"],"required":false,"type":18},{"defaultValue":"A - Completely reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data","name":"feedReliability","options":["A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Traffic Light Protocol Color","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The Traffic Light Protocol (TLP) designation to apply to indicators fetched from the feed","name":"tlp_color","options":["RED","AMBER","GREEN","WHITE"],"required":false,"type":15},{"defaultValue":"indicatorType","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationPolicy","options":["never","interval","indicatorType","suddenDeath"],"required":false,"type":17},{"defaultValue":"20160","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationInterval","options":null,"required":false,"type":1},{"defaultValue":"true","display":"Incremental Feed","displayPassword":"","hidden":true,"hiddenPassword":false,"hiddenUsername":false,"info":"Incremental feeds pull only new or modified indicators that have been sent from the integration. As the determination if the indicator is new or modified happens on the 3rd-party vendor's side, and only indicators that are new or modified are sent to Cortex XSOAR, all indicators coming from these feeds are labeled new or modified.","name":"feedIncremental","options":null,"required":false,"type":8},{"defaultValue":"240","display":"Feed Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedFetchInterval","options":null,"required":false,"type":19},{"defaultValue":"","display":"Bypass exclusion list","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, the exclusion list is ignored for indicators from this feed. This means that if an indicator from this feed is on the exclusion list, the indicator might still be added to the system.","name":"feedBypassExclusionList","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Tags","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Supports CSV values.","name":"feedTags","options":null,"required":false,"type":0}],"definitionId":"","description":"Use the AutoFocus Daily feed to export threat intelligence data produced by AutoFocus and connected services to provide actionable data for the Palo Alto Networks firewall as well as third party TIP and SIEM solutions. AutoFocus feed return a list which includes IP addresses, domains, URLs, and hash indicators which are updated daily.","detailedDescription":"## AutoFocus Feed\nGets Daily Threat Feed from AutoFocus.\n\nFor more information see the [AutoFocus documentation](https://docs.paloaltonetworks.com/autofocus/autofocus-admin/autofocus-feeds.html).\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/auto-focus-daily-feed)","display":"AutoFocus Daily Feed","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"AutoFocus Daily Feed","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"The maximum number of indicators to return. Default is 10.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The index of the first indicator to fetch.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets indicators from AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-daily-get-indicators","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":true,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"from typing import List, Tuple, Optional\n\n# IMPORTS\nimport requests\n\n\n\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n\nclass Client(BaseClient):\n    \"\"\"Client for AutoFocus Feed - gets indicator lists from Daily threat feeds\n\n    Attributes:\n        api_key(str): The API key for AutoFocus.\n        insecure(bool): Use SSH on http request.\n        proxy(str): Use system proxy.\n    \"\"\"\n\n    def __init__(self, api_key, insecure):\n        self.api_key = api_key\n        self.verify = not insecure\n        handle_proxy()\n\n    def daily_http_request(self) -\u003e list:\n        \"\"\"The HTTP request for daily feeds.\n        Returns:\n            list. A list of indicators fetched from the feed.\n        \"\"\"\n        headers = {\n            \"apiKey\": self.api_key,\n            'Content-Type': \"application/json\"\n        }\n\n        res = requests.request(\n            method=\"GET\",\n            url='https://autofocus.paloaltonetworks.com/api/v1.0/output/threatFeedResult',\n            verify=self.verify,\n            headers=headers\n        )\n        res.raise_for_status()\n        indicator_list = res.text.split('\\n')\n        return indicator_list\n\n    def get_ip_type(self, indicator):\n        \"\"\"\n        Indicates the correct IP of the given indicator.\n        Args:\n            indicator: (str) Will be checked according to it the type will be returned.\n        Returns:\n            Indicator Type of the given value.\n        \"\"\"\n        if re.match(ipv4cidrRegex, indicator):\n            return FeedIndicatorType.CIDR\n\n        elif re.match(ipv6cidrRegex, indicator):\n            return FeedIndicatorType.IPv6CIDR\n\n        elif re.match(ipv4Regex, indicator):\n            return FeedIndicatorType.IP\n\n        elif re.match(ipv6Regex, indicator):\n            return FeedIndicatorType.IPv6\n\n        else:\n            return None\n\n    def find_indicator_type(self, indicator):\n        \"\"\"Infer the type of the indicator.\n        Args:\n            indicator(str): The indicator whose type we want to check.\n        Returns:\n            str. The type of the indicator.\n        \"\"\"\n\n        # trying to catch X.X.X.X:portNum\n        if ':' in indicator and '/' not in indicator:\n            sub_indicator = indicator.split(':', 1)[0]\n            ip_type = self.get_ip_type(sub_indicator)\n            if ip_type:\n                return ip_type\n\n        ip_type = self.get_ip_type(indicator)\n        if ip_type:\n            # catch URLs of type X.X.X.X/path/url or X.X.X.X:portNum/path/url\n            if '/' in indicator and (ip_type not in [FeedIndicatorType.IPv6CIDR, FeedIndicatorType.CIDR]):\n                return FeedIndicatorType.URL\n\n            else:\n                return ip_type\n\n        elif re.match(sha256Regex, indicator):\n            return FeedIndicatorType.File\n\n        # in AutoFocus, URLs include a path while domains do not - so '/' is a good sign for us to catch URLs.\n        elif '/' in indicator:\n            return FeedIndicatorType.URL\n\n        else:\n            return FeedIndicatorType.Domain\n\n    def create_indicators_from_response(self, response: list, feed_tags: list, tlp_color: Optional[str]) -\u003e list:\n        \"\"\"\n        Creates a list of indicators from a given response\n        Args:\n            response: List of dict that represent the response from the api\n            feed_tags: The indicator tags\n            tlp_color: Traffic Light Protocol color\n\n        Returns:\n            List of indicators with the correct indicator type.\n        \"\"\"\n        parsed_indicators = []  # type:List\n\n        for indicator in response:\n            if indicator:\n                indicator_type = self.find_indicator_type(indicator)\n\n                # catch ip of the form X.X.X.X:portNum and extract the IP without the port.\n                if indicator_type in [FeedIndicatorType.IP, FeedIndicatorType.CIDR,\n                                      FeedIndicatorType.IPv6CIDR, FeedIndicatorType.IPv6] and \":\" in indicator:\n                    indicator = indicator.split(\":\", 1)[0]\n\n                indicator_obj = {\n                    \"type\": indicator_type,\n                    \"value\": indicator,\n                    \"rawJSON\": {\n                        'value': indicator,\n                        'type': indicator_type,\n                        'service': 'Daily Threat Feed'\n                    },\n                    'fields': {'service': 'Daily Threat Feed', 'tags': feed_tags}\n                }\n                if tlp_color:\n                    indicator_obj['fields']['trafficlightprotocol'] = tlp_color\n\n                parsed_indicators.append(indicator_obj)\n\n        return parsed_indicators\n\n    def build_iterator(self, feed_tags: List, tlp_color: Optional[str], limit=None, offset=None):\n        \"\"\"Builds a list of indicators.\n        Returns:\n            list. A list of JSON objects representing indicators fetched from a feed.\n        \"\"\"\n        response = self.daily_http_request()\n        parsed_indicators = self.create_indicators_from_response(response, feed_tags,\n                                                                 tlp_color)  # list of dict of indicators\n\n        # for get_indicator_command only\n        if limit:\n            parsed_indicators = parsed_indicators[int(offset): int(offset) + int(limit)]\n        return parsed_indicators\n\n\ndef module_test_command(client: Client, args: dict, feed_tags: list, tlp_color: Optional[str]):\n    \"\"\"\n    Returning 'ok' indicates that the integration works like it is supposed to. Connection to the service is successful.\n\n    Args:\n        client(Client): Autofocus Feed client\n        args(Dict): The instance parameters\n        feed_tags: The indicator tags\n        tlp_color: Traffic Light Protocol color\n\n    Returns:\n        'ok' if test passed, anything else will fail the test.\n    \"\"\"\n    try:\n        client.build_iterator(argToList(demisto.params().get('feedTags')), tlp_color, 1, 0)\n    except Exception:\n        raise Exception(\"Could not fetch Daily Threat Feed\\n\"\n                        \"\\nCheck your API key and your connection to AutoFocus.\")\n    return 'ok', {}, {}\n\n\ndef get_indicators_command(client: Client, args: dict, feed_tags: list, tlp_color: Optional[str]) \\\n        -\u003e Tuple[str, dict, list]:\n    \"\"\"Initiate a single fetch-indicators\n\n    Args:\n        client(Client): The AutoFocus Client.\n        args(dict): Command arguments.\n        feed_tags: The indicator tags.\n        tlp_color: Traffic Light Protocol color.\n    Returns:\n        str, dict, list. the markdown table, context JSON and list of indicators\n    \"\"\"\n    offset = int(args.get('offset', 0))\n    limit = int(args.get('limit', 100))\n\n    indicators = fetch_indicators_command(client, feed_tags, tlp_color, limit, offset)\n\n    hr_indicators = []\n    for indicator in indicators:\n        hr_indicators.append({\n            'Value': indicator.get('value'),\n            'Type': indicator.get('type'),\n            'rawJSON': indicator.get('rawJSON'),\n            'fields': indicator.get('fields'),\n        })\n\n    human_readable = tableToMarkdown(\"Indicators from AutoFocus:\", hr_indicators,\n                                     headers=['Value', 'Type', 'rawJSON', 'fields'], removeNull=True)\n\n    if args.get('limit'):\n        human_readable = human_readable + f\"\\nTo bring the next batch of indicators \" \\\n                                          f\"run:\\n!autofocus-daily-get-indicators \" \\\n                                          f\"limit={args.get('limit')} \" \\\n                                          f\"offset={int(str(args.get('limit'))) + int(str(args.get('offset')))}\"\n\n    return human_readable, {}, indicators\n\n\ndef fetch_indicators_command(client: Client, feed_tags: List, tlp_color: Optional[str], limit=None, offset=None) \\\n        -\u003e list:\n    \"\"\"Fetch-indicators command from AutoFocus Feeds\n\n    Args:\n        client(Client): AutoFocus Feed client.\n        feed_tags: The indicator tags.\n        tlp_color: Traffic Light Protocol color.\n        limit: limit the amount of indicators fetched.\n        offset: the index of the first index to fetch.\n\n    Returns:\n        list. List of indicators.\n    \"\"\"\n    indicators = client.build_iterator(feed_tags, tlp_color, limit, offset)\n\n    return indicators\n\n\ndef main():\n    params = demisto.params()\n    feed_tags = argToList(params.get('feedTags'))\n    tlp_color = params.get('tlp_color')\n\n    command = demisto.command()\n    demisto.info(f'Command being called is {command}')\n\n    commands = {\n        'test-module': module_test_command,\n        'autofocus-daily-get-indicators': get_indicators_command\n    }\n    try:\n        auto_focus_key_retriever = AutoFocusKeyRetriever(params.get('api_key'))\n        client = Client(api_key=auto_focus_key_retriever.key,\n                        insecure=params.get('insecure'))\n\n        if demisto.command() == 'fetch-indicators':\n            indicators = fetch_indicators_command(client, feed_tags, tlp_color)\n            # we submit the indicators in batches\n            for b in batch(indicators, batch_size=2000):\n                demisto.createIndicators(b)\n        else:\n            readable_output, outputs, raw_response = commands[command](client, demisto.args(),\n                                                                       feed_tags, tlp_color)  # type: ignore\n            return_outputs(readable_output, outputs, raw_response)\n    except Exception as e:\n        raise Exception(f'Error in AutoFocusFeed Daily Integration [{e}]')\n\n\nif __name__ == '__builtin__' or __name__ == 'builtins':\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.3.9","modified":"2021-09-07T09:21:43.460552+03:00","name":"AutoFocus Daily Feed","packID":"AutoFocus","packPropagationLabels":["all"],"prevName":"AutoFocus Daily Feed","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":5},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"true","display":"Fetch indicators","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feed","options":null,"required":false,"type":8},{"defaultValue":"","display":"Indicator Feed","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"indicator_feeds","options":["Daily Threat Feed","Custom Feed","Samples Feed"],"required":true,"type":16},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"TIM customers that upgraded to version 6.2 or above, can have this value pre-configured in their main account so no additional input is needed. To use this feature, upgrade your license so it includes the license key.","name":"api_key","options":null,"required":false,"type":4},{"defaultValue":"","display":"The URL for the custom feed to fetch","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Only necessary in case a Custom Feed is fetched. Can also support a CSV of Custom feed URLs.","name":"custom_feed_urls","options":null,"required":false,"type":0},{"defaultValue":"","display":"Samples Feed Scope Type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Only necessary in case a Samples Feed is fetched.","name":"scope_type","options":["public","private","global"],"required":false,"type":15},{"defaultValue":"","display":"Samples Feed Query","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"JSON styled AutoFocus query, an example can be found in the description (?) section. Only necessary in case a Samples Feed is fetched.","name":"sample_query","options":null,"required":false,"type":0},{"defaultValue":"Bad","display":"Indicator Reputation","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Indicators from this integration instance will be marked with this reputation","name":"feedReputation","options":["None","Good","Suspicious","Bad"],"required":false,"type":18},{"defaultValue":"A - Completely reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data","name":"feedReliability","options":["A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Traffic Light Protocol Color","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The Traffic Light Protocol (TLP) designation to apply to indicators fetched from the feed","name":"tlp_color","options":["RED","AMBER","GREEN","WHITE"],"required":false,"type":15},{"defaultValue":"suddenDeath","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationPolicy","options":["never","interval","indicatorType","suddenDeath"],"required":false,"type":17},{"defaultValue":"20160","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationInterval","options":null,"required":false,"type":1},{"defaultValue":"15","display":"Feed Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedFetchInterval","options":null,"required":false,"type":19},{"defaultValue":"","display":"Bypass exclusion list","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, the exclusion list is ignored for indicators from this feed. This means that if an indicator from this feed is on the exclusion list, the indicator might still be added to the system.","name":"feedBypassExclusionList","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Tags","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Supports CSV values.","name":"feedTags","options":null,"required":false,"type":0}],"definitionId":"","description":"Use the AutoFocus Feeds integration to fetch indicators from AutoFocus.","detailedDescription":"## AutoFocus Feed\nGets Custom and Sample feeds from AutoFocus.\n\n**Note:** The `Daily Threat Feed` option is deprecated. Use the separate **AutoFocus Daily Feed** instead. \n\nFor more information see the [AutoFocus documentation](https://docs.paloaltonetworks.com/autofocus/autofocus-admin/autofocus-feeds.html).\n\n#### Custom Feed info:\nTo connect a custom AutoFocus feed you need to provide the Custom Feed URL.\n\nThe Custom Feed URL should be in this form:\nhttps://autofocus.paloaltonetworks.com/IOCFeed/{Output_Feed_ID}/{Output_Feed_Name}\n\n#### Samples Feed info:\nTo connect to a sample AutoFocus feed you need to provide the following parameters:\n* Scope Type - Either **public**, **private** or **global**.\n* Query - A JSON styled AutoFocus query. For example: \n```json\n{\n  \"operator\":\"all\",\n  \"children\":[{\n      \"field\":\"sample.create_date\",\n      \"operator\":\"is in the range\",\n      \"value\":[\"2020-03-01T00:00:00\",\"2020-03-02T23:59:59\"]\n    }]\n}\n```\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/auto-focus-feed)","display":"AutoFocus Feed","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"AutoFocus Feed","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"The maximum number of indicators to return.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The index of the first indicator to fetch.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the indicators from AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-get-indicators","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.24019","feed":true,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\n\n# IMPORTS\nimport re\nimport requests\nfrom typing import List, Optional\nfrom datetime import datetime\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n# CONSTANTS\nSOURCE_NAME = \"AutoFocusFeed\"\nDAILY_FEED_BASE_URL = 'https://autofocus.paloaltonetworks.com/api/v1.0/output/threatFeedResult'\nSAMPLE_FEED_BASE_URL = 'https://autofocus.paloaltonetworks.com/api/v1.0/samples/'\nSAMPLE_FEED_REQUEST_BASE_URL = f'{SAMPLE_FEED_BASE_URL}search'\nSAMPLE_FEED_RESPONSE_BASE_URL = f'{SAMPLE_FEED_BASE_URL}results/'\n\nEPOCH_BASE = datetime.utcfromtimestamp(0)\n\naf_indicator_type_to_demisto = {\n    'Domain': FeedIndicatorType.Domain,\n    'Url': FeedIndicatorType.URL,\n    'IPv4': FeedIndicatorType.IP\n}\n\nVERDICTS_TO_DBOTSCORE = {\n    '0': 1,\n    '1': 3,\n    '2': 2,\n    '4': 3,\n}\n\nVERDICTS_TO_TEXT = {\n    '0': 'benign',\n    '1': 'malware',\n    '2': 'grayware',\n    '4': 'phishing',\n}\n\nCONFIDENCE_TO_DBOTSCORE = {\n    'interesting': 2,\n    'suspect': 3,\n    'highly_suspect': 3\n}\n\n\ndef datetime_to_epoch(dt_to_convert):\n    delta_from_epoch_base = dt_to_convert - EPOCH_BASE\n    return int(delta_from_epoch_base.total_seconds() * 1000)\n\n\nclass Client(BaseClient):\n    \"\"\"Client for AutoFocus Feed - gets indicator lists from the Custom and Daily threat feeds\n\n    Attributes:\n        api_key(str): The API key for AutoFocus.\n        insecure(bool): Use SSH on http request.\n        proxy(str): Use system proxy.\n        indicator_feeds(List): A list of indicator feed types to bring from AutoFocus.\n        scope_type(str): The scope type of the AutoFocus samples feed.\n        sample_query(str): The query to use to fetch indicators from AutoFocus samples feed.\n        custom_feed_urls(str): The URLs of the custom feeds to fetch.\n    \"\"\"\n\n    def __init__(self, api_key, insecure, proxy, indicator_feeds, custom_feed_urls=None,\n                 scope_type=None, sample_query=None):\n        self.api_key = api_key\n        self.indicator_feeds = indicator_feeds\n\n        if 'Custom Feed' in indicator_feeds and (custom_feed_urls is None or custom_feed_urls == ''):\n            return_error(f'{SOURCE_NAME} - Output Feed ID and Name are required for Custom Feed')\n\n        elif 'Custom Feed' in indicator_feeds:\n            url_list = []  # type:List\n            for url in custom_feed_urls.split(','):\n                url_list.append(self.url_format(url))\n\n            self.custom_feed_url_list = url_list\n\n        if 'Samples Feed' in indicator_feeds:\n            self.scope_type = scope_type\n\n            if not sample_query:\n                return_error(f'{SOURCE_NAME} - Samples Query can not be empty for Samples Feed')\n            try:\n                self.sample_query = json.loads(sample_query)\n            except Exception:\n                return_error(f'{SOURCE_NAME} - Samples Query is not a well formed JSON object')\n\n        self.verify = not insecure\n        if proxy:\n            handle_proxy()\n\n    def url_format(self, url):\n        \"\"\"Make sure the URL is in the format:\n        https://autofocus.paloaltonetworks.com/api/v1.0/IOCFeed/{ID}/{Name}\n\n        Args:\n            url(str): The URL to format.\n\n        Returns:\n            str. The reformatted URL.\n        \"\"\"\n        if \"https://autofocus.paloaltonetworks.com/IOCFeed/\" in url:\n            url = url.replace(\"https://autofocus.paloaltonetworks.com/IOCFeed/\",\n                              \"https://autofocus.paloaltonetworks.com/api/v1.0/IOCFeed/\")\n\n        elif \"autofocus.paloaltonetworks.com/IOCFeed/\" in url:\n            url = url.replace(\"autofocus.paloaltonetworks.com/IOCFeed/\",\n                              \"https://autofocus.paloaltonetworks.com/api/v1.0/IOCFeed/\")\n\n        return url\n\n    def daily_custom_http_request(self, feed_type) -\u003e list:\n        \"\"\"The HTTP request for daily and custom feeds.\n\n        Args:\n            feed_type(str): The feed type (Daily / Custom feed / Samples feed).\n\n        Returns:\n            list. A list of indicators fetched from the feed.\n        \"\"\"\n        headers = {\n            \"apiKey\": self.api_key,\n            'Content-Type': \"application/json\"\n        }\n\n        if feed_type == \"Daily Threat Feed\":\n            urls = [DAILY_FEED_BASE_URL]\n\n        else:\n            urls = self.custom_feed_url_list\n\n        indicator_list = []  # type:List\n        for url in urls:\n            res = requests.request(\n                method=\"GET\",\n                url=url,\n                verify=self.verify,\n                headers=headers\n            )\n            res.raise_for_status()\n            indicator_list.extend(res.text.split('\\n'))\n\n        return indicator_list\n\n    def sample_http_request(self) -\u003e list:\n        \"\"\"The HTTP request for the samples feed.\n\n        Args:\n\n        Returns:\n            list. A list of indicators fetched from the feed.\n        \"\"\"\n        request_body = {\n            'apiKey': self.api_key,\n            'artifactSource': 'af',\n            'scope': self.scope_type,\n            'query': self.sample_query,\n            'type': 'scan',\n        }\n\n        initiate_sample_res = requests.request(\n            method=\"POST\",\n            headers={'Content-Type': \"application/json\"},\n            url=SAMPLE_FEED_REQUEST_BASE_URL,\n            verify=self.verify,\n            json=request_body\n        )\n        initiate_sample_res.raise_for_status()\n\n        af_cookie = initiate_sample_res.json()['af_cookie']\n        time.sleep(20)  # pylint: disable=sleep-exists\n\n        get_results_res = requests.request(\n            method=\"POST\",\n            url=SAMPLE_FEED_RESPONSE_BASE_URL + af_cookie,\n            verify=self.verify,\n            json={'apiKey': self.api_key}\n        )\n        get_results_res.raise_for_status()\n\n        indicator_list = []  # type:List\n\n        for single_sample in get_results_res.json().get('hits'):\n            indicator_list.extend(self.create_indicators_from_single_sample_response(single_sample))\n\n        return indicator_list\n\n    @staticmethod\n    def get_basic_raw_json(single_sample: dict):\n        single_sample_data = single_sample.get('_source', {})\n        artifacts = single_sample_data.get('artifact', [])\n\n        raw_json_data = {\n            'autofocus_id': single_sample.get('_id'),\n            'autofocus_region': [single_region.upper() for single_region in single_sample_data.get('region', [])],\n            'autofocus_tags': single_sample_data.get('tag', []),\n            'autofocus_tags_groups': single_sample_data.get('tag_groups', []),\n            'autofocus_num_matching_artifacts': len(artifacts),\n            'service': 'AutoFocus Samples Feed'\n        }\n\n        create_date = single_sample_data.get('create_date', None)\n        if create_date is not None:\n            create_date = datetime.strptime(create_date, '%Y-%m-%dT%H:%M:%S')\n            raw_json_data['autofocus_create_date'] = datetime_to_epoch(create_date)\n\n        update_date = single_sample_data.get('update_date', None)\n        if update_date is not None:\n            update_date = datetime.strptime(update_date, '%Y-%m-%dT%H:%M:%S')\n            raw_json_data['autofocus_update_date'] = datetime_to_epoch(update_date)\n\n        return raw_json_data\n\n    @staticmethod\n    def create_indicators_for_file(raw_json_data: dict, full_sample_json: dict):\n        raw_json_data['type'] = FeedIndicatorType.File\n        raw_json_data['md5'] = full_sample_json.get('md5')\n        raw_json_data['size'] = full_sample_json.get('size')\n        raw_json_data['sha1'] = full_sample_json.get('sha1')\n        raw_json_data['value'] = full_sample_json.get('sha256')\n        raw_json_data['sha256'] = full_sample_json.get('sha256')\n        raw_json_data['ssdeep'] = full_sample_json.get('ssdeep')\n        raw_json_data['region'] = [single_region.upper() for single_region in full_sample_json.get('region', [])]\n        raw_json_data['imphash'] = full_sample_json.get('imphash')\n        raw_json_data['autofocus_filetype'] = full_sample_json.get('filetype')\n        raw_json_data['autofocus_malware'] = VERDICTS_TO_TEXT.get(full_sample_json.get('malware'))  # type: ignore\n\n        fields_mapping = {\n            'md5': full_sample_json.get('md5'),\n            'tags': full_sample_json.get('tag'),\n            'size': full_sample_json.get('size'),\n            'sha1': full_sample_json.get('sha1'),\n            'region': raw_json_data.get('region'),\n            'sha256': full_sample_json.get('sha256'),\n            'ssdeep': full_sample_json.get('ssdeep'),\n            'imphash': full_sample_json.get('imphash'),\n            'filetype': full_sample_json.get('filetype'),\n            'threattypes': [{'threatcategory': threat} for threat in full_sample_json.get('tag_groups', [])],\n            'creationdate': raw_json_data.get('autofocus_create_date'),\n        }\n\n        tlp_color = demisto.params().get('tlp_color')\n        if tlp_color:\n            fields_mapping['trafficlightprotocol'] = tlp_color\n\n        return [\n            {\n                'value': raw_json_data['value'],\n                'type': raw_json_data['type'],\n                'rawJSON': raw_json_data,\n                'fields': fields_mapping,\n                'score': VERDICTS_TO_DBOTSCORE.get(full_sample_json.get('malware'), 0)  # type: ignore\n            }\n        ]\n\n    @staticmethod\n    def create_indicator_from_artifact(raw_json_data: dict, artifact: dict):\n        indicator_value = artifact.get('indicator', None)\n        if indicator_value is None:\n            return None\n\n        autofocus_indicator_type = artifact.get('indicator_type', None)\n        indicator_type = af_indicator_type_to_demisto.get(autofocus_indicator_type)\n        if not indicator_type:\n            return None\n\n        raw_json_data.update(\n            {\n                'value': indicator_value,\n                'type': indicator_type,\n                'autofocus_confidence': artifact.get('confidence', ''),\n                'autofocus_malware': artifact.get('m', 0),\n                'autofocus_benign': artifact.get('b', 0),\n                'autofocus_grayware': artifact.get('g', 0)\n            }\n        )\n\n        if indicator_type == FeedIndicatorType.IP and ':' in indicator_value:\n            indicator_value, port = indicator_value.split(':', 1)\n            raw_json_data['autofocus_port'] = port\n\n        fields_mapping = {\n            'firstseenbysource': raw_json_data.get('autofocus_create_date'),\n            'region': raw_json_data.get('autofocus_region'),\n            'tags': raw_json_data.get('autofocus_tags'),\n            'threattypes': [{'threatcategory': threat} for threat in raw_json_data.get('autofocus_tags_groups', [])],\n            'service': 'AutoFocus Samples Feed'\n        }\n\n        tlp_color = demisto.params().get('tlp_color')\n        if tlp_color:\n            fields_mapping['trafficlightprotocol'] = tlp_color\n\n        return {\n            'value': raw_json_data['value'],\n            'type': raw_json_data['type'],\n            'rawJSON': raw_json_data,\n            'fields': fields_mapping,\n            'score': CONFIDENCE_TO_DBOTSCORE.get(artifact.get('confidence'), 0),  # type: ignore\n        }\n\n    @staticmethod\n    def create_indicators_from_single_sample_response(single_sample):\n        single_sample_data = single_sample.get('_source', {})\n        if not single_sample_data:\n            return []\n\n        # When the user do not have access to sample's details a truncated sha256 is used.\n        if '...' in single_sample_data.get('sha256', '...'):\n            return []\n\n        indicators = Client.create_indicators_for_file(Client.get_basic_raw_json(single_sample), single_sample_data)\n\n        artifacts = single_sample_data.get('artifact', [])\n\n        for artifact in artifacts:\n            indicator_from_artifact = Client.create_indicator_from_artifact(Client.get_basic_raw_json(single_sample),\n                                                                            artifact)\n            if indicator_from_artifact:\n                indicators.append(indicator_from_artifact)\n\n        return indicators\n\n    def get_ip_type(self, indicator):\n        if re.match(ipv4cidrRegex, indicator):\n            return FeedIndicatorType.CIDR\n\n        elif re.match(ipv6cidrRegex, indicator):\n            return FeedIndicatorType.IPv6CIDR\n\n        elif re.match(ipv4Regex, indicator):\n            return FeedIndicatorType.IP\n\n        elif re.match(ipv6Regex, indicator):\n            return FeedIndicatorType.IPv6\n\n        else:\n            return None\n\n    def find_indicator_type(self, indicator):\n        \"\"\"Infer the type of the indicator.\n\n        Args:\n            indicator(str): The indicator whose type we want to check.\n\n        Returns:\n            str. The type of the indicator.\n        \"\"\"\n\n        # trying to catch X.X.X.X:portNum\n        if ':' in indicator and '/' not in indicator:\n            sub_indicator = indicator.split(':', 1)[0]\n            ip_type = self.get_ip_type(sub_indicator)\n            if ip_type:\n                return ip_type\n\n        ip_type = self.get_ip_type(indicator)\n        if ip_type:\n            # catch URLs of type X.X.X.X/path/url or X.X.X.X:portNum/path/url\n            if '/' in indicator and (ip_type not in [FeedIndicatorType.IPv6CIDR, FeedIndicatorType.CIDR]):\n                return FeedIndicatorType.URL\n\n            else:\n                return ip_type\n\n        elif re.match(sha256Regex, indicator):\n            return FeedIndicatorType.File\n\n        # in AutoFocus, URLs include a path while domains do not - so '/' is a good sign for us to catch URLs.\n        elif '/' in indicator:\n            return FeedIndicatorType.URL\n\n        else:\n            return FeedIndicatorType.Domain\n\n    def create_indicators_from_response(self, feed_type, response, feed_tags, tlp_color):\n        parsed_indicators = []  # type:List\n\n        for indicator in response:\n            if indicator:\n                indicator_type = self.find_indicator_type(indicator)\n\n                # catch ip of the form X.X.X.X:portNum and extract the IP without the port.\n                if indicator_type in [FeedIndicatorType.IP, FeedIndicatorType.CIDR,\n                                      FeedIndicatorType.IPv6CIDR, FeedIndicatorType.IPv6] and \":\" in indicator:\n                    indicator = indicator.split(\":\", 1)[0]\n\n                indicator_obj = {\n                    \"type\": indicator_type,\n                    \"value\": indicator,\n                    \"rawJSON\": {\n                        'value': indicator,\n                        'type': indicator_type,\n                        'service': feed_type\n                    },\n                    'fields': {'service': feed_type, 'tags': feed_tags}\n                }\n                if tlp_color:\n                    indicator_obj['fields']['trafficlightprotocol'] = tlp_color\n\n                parsed_indicators.append(indicator_obj)\n\n        return parsed_indicators\n\n    def build_iterator(self, feed_tags: List, tlp_color: Optional[str], limit=None, offset=None):\n        \"\"\"Builds a list of indicators.\n\n        Returns:\n            list. A list of JSON objects representing indicators fetched from a feed.\n        \"\"\"\n        parsed_indicators = []  # type:List\n\n        for service in [\"Daily Threat Feed\", \"Custom Feed\"]:\n            if service in self.indicator_feeds:\n                response = self.daily_custom_http_request(feed_type=service)\n                parsed_indicators.extend(self.create_indicators_from_response(service, response, feed_tags, tlp_color))\n\n        # for get_indicator_command only\n        if limit:\n            parsed_indicators = parsed_indicators[int(offset): int(offset) + int(limit)]\n\n        if \"Samples Feed\" in self.indicator_feeds:\n            parsed_indicators.extend(self.sample_http_request())\n\n        # for get_indicator_command only\n        if limit:\n            parsed_indicators = parsed_indicators[int(offset): int(offset) + int(limit)]\n\n        return parsed_indicators\n\n\ndef module_test_command(client: Client, args: dict, feed_tags: list, tlp_color: Optional[str]):\n    \"\"\"\n    Returning 'ok' indicates that the integration works like it is supposed to. Connection to the service is successful.\n\n    Args:\n        client(Client): Autofocus Feed client\n        args(Dict): The instance parameters\n        feed_tags(List): The indicator tags\n        tlp_color(str): Traffic Light Protocol color\n\n    Returns:\n        'ok' if test passed, anything else will fail the test.\n    \"\"\"\n    indicator_feeds = client.indicator_feeds\n    exception_list = []  # type:List\n    if 'Daily Threat Feed' in indicator_feeds:\n        raise Exception(\"Daily Feed is no longer supported by this feed,\"\n                        \" please configure the AutoFocus Daily Feed for this action\")\n    if 'Custom Feed' in indicator_feeds:\n        client.indicator_feeds = ['Custom Feed']\n        url_list = client.custom_feed_url_list\n        for url in url_list:\n            client.custom_feed_url_list = [url]\n            try:\n                client.build_iterator(feed_tags, tlp_color, 1, 0)\n            except Exception:\n                exception_list.append(f\"Could not fetch Custom Feed {url}\\n\"\n                                      f\"\\nCheck your API key the URL for the feed and Check \"\n                                      f\"if they are Enabled in AutoFocus.\")\n\n    if 'Samples Feed' in indicator_feeds:\n        client.indicator_feeds = ['Samples Feed']\n        try:\n            client.build_iterator(feed_tags, tlp_color, 1, 0)\n        except Exception:\n            exception_list.append(\"Could not fetch Samples Feed\\n\"\n                                  \"\\nCheck your instance configuration and your connection to AutoFocus.\")\n\n    if len(exception_list) \u003e 0:\n        raise Exception(\"\\n\".join(exception_list))\n\n    return 'ok', {}, {}\n\n\ndef get_indicators_command(client: Client, args: dict, feed_tags, tlp_color):\n    \"\"\"Initiate a single fetch-indicators\n\n    Args:\n        client(Client): The AutoFocus Client.\n        args(dict): Command arguments.\n        feed_tags: The indicator tags.\n        tlp_color: Traffic Light Protocol color.\n\n    Returns:\n        str, dict, list. the markdown table, context JSON and list of indicators\n    \"\"\"\n    offset = int(args.get('offset', 0))\n    limit = int(args.get('limit', 100))\n    indicators = fetch_indicators_command(client, feed_tags, tlp_color, limit, offset)\n\n    hr_indicators = []\n    for indicator in indicators:\n        hr_indicators.append({\n            'Value': indicator.get('value'),\n            'Type': indicator.get('type'),\n            'rawJSON': indicator.get('rawJSON'),\n            'fields': indicator.get('fields'),\n        })\n\n    human_readable = tableToMarkdown(\"Indicators from AutoFocus:\", hr_indicators,\n                                     headers=['Value', 'Type', 'rawJSON', 'fields'], removeNull=True)\n\n    if args.get('limit'):\n        human_readable = human_readable + f\"\\nTo bring the next batch of indicators run:\\n!autofocus-get-indicators \" \\\n                                          f\"limit={args.get('limit')} \" \\\n                                          f\"offset={int(str(args.get('limit'))) + int(str(args.get('offset')))}\"\n\n    return human_readable, {}, indicators\n\n\ndef fetch_indicators_command(client: Client, feed_tags: List, tlp_color: Optional[str], limit=None, offset=None):\n    \"\"\"Fetch-indicators command from AutoFocus Feeds\n\n    Args:\n        client(Client): AutoFocus Feed client.\n        feed_tags: The indicator tags.\n        tlp_color: Traffic Light Protocol color.\n        limit: limit the amount of incidators fetched.\n        offset: the index of the first index to fetch.\n\n    Returns:\n        list. List of indicators.\n    \"\"\"\n    indicators = client.build_iterator(feed_tags, tlp_color, limit, offset)\n\n    return indicators\n\n\ndef main():\n    params = demisto.params()\n    feed_tags = argToList(params.get('feedTags'))\n    tlp_color = params.get('tlp_color')\n\n    command = demisto.command()\n    demisto.info(f'Command being called is {command}')\n    # Switch case\n    commands = {\n        'test-module': module_test_command,\n        'autofocus-get-indicators': get_indicators_command\n    }\n    try:\n        auto_focus_key_retriever = AutoFocusKeyRetriever(params.get('api_key'))\n        client = Client(api_key=auto_focus_key_retriever.key,\n                        insecure=params.get('insecure'),\n                        proxy=params.get('proxy'),\n                        indicator_feeds=params.get('indicator_feeds'),\n                        custom_feed_urls=params.get('custom_feed_urls'),\n                        scope_type=params.get('scope_type'),\n                        sample_query=params.get('sample_query'))\n\n        if demisto.command() == 'fetch-indicators':\n            indicators = fetch_indicators_command(client, feed_tags, tlp_color)\n            # we submit the indicators in batches\n            for b in batch(indicators, batch_size=2000):\n                demisto.createIndicators(b)\n        else:\n            readable_output, outputs, raw_response = commands[command](client, demisto.args(),\n                                                                       feed_tags, tlp_color)  # type: ignore\n            return_outputs(readable_output, outputs, raw_response)\n    except Exception as e:\n        raise Exception(f'Error in {SOURCE_NAME} Integration [{e}]')\n\n\nif __name__ == '__builtin__' or __name__ == 'builtins':\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.3.9","modified":"2021-09-07T09:21:43.460747+03:00","name":"AutoFocus Feed","packID":"AutoFocus","packPropagationLabels":["all"],"prevName":"AutoFocus Feed","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":5},{"brand":"","canGetSamples":false,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"serverurl","options":null,"required":false,"type":0},{"defaultValue":"","display":"API Token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apitoken","options":null,"required":false,"type":4},{"defaultValue":"true","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the VMware Carbon Black App Control v2 integration instead.","display":"Carbon Black Enterprise Protection (Deprecated)","fromServerVersion":"","hidden":false,"icon":"carbonblack.png","id":"carbonblackprotection","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.955616+03:00","name":"carbonblackprotection","packID":"","prevName":"carbonblackprotection","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"","display":"Server URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"serverurl","options":null,"required":false,"type":0},{"defaultValue":"","display":"API Token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apitoken","options":null,"required":false,"type":4},{"defaultValue":"v1","display":"API Version(Support values: v1, v2, v3)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apiversion","options":null,"required":false,"type":0},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the VMware Carbon Black EDR integration instead.","display":"Carbon Black Enterprise Response (Deprecated)","fromServerVersion":"","hidden":false,"icon":"carbonblack.png","id":"carbonblack","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.916557+03:00","name":"carbonblack","packID":"","prevName":"carbonblack","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"https://firehose.crowdstrike.com","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Address","options":null,"required":true,"type":0},{"defaultValue":"Demisto","display":"App ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"appID","options":null,"required":true,"type":0},{"defaultValue":"","display":"API UUID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ApiUUID","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ApiKey","options":null,"required":true,"type":4},{"defaultValue":"","display":"Filter events string","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"filter","options":null,"required":false,"type":0},{"defaultValue":"","display":"Data Feed URL to use","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"FeedUrl","options":null,"required":false,"type":0},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"","displayPassword":"","hidden":true,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated - We recommend using CrowdStrike Falcon Streaming v2 instead. The Falcon Streaming API (formerly known as the Falcon Firehose API)","detailedDescription":"Use CrowdStrike Streaming API to fetch detections and create incidents from them.\nCrowdStrike uses API keys to provide access to the Falcon Streaming API and to restrict the data returned.\nThese credentials are different than the Query API and Threat Graph API credentials.\nYour API key and UUID are on the API Key page. There is one API key and UUID per customer ID.","display":"CrowdStrike Falcon Streaming (Deprecated)","fromServerVersion":"","hidden":false,"icon":"crowdstrike.png","id":"crowdstrike-streaming-api","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.597897+03:00","name":"crowdstrike-streaming-api","packID":"","prevName":"crowdstrike-streaming-api","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Forensics \u0026 Malware Analysis","commitMessage":"","configuration":[{"defaultValue":"https://api.cylance.com/apiv2/","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Address","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Key","options":null,"required":false,"type":4},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"File threat intelligence","detailedDescription":"Deprecated. This service has been discontinued for external users by Cylance. No available replacement.","display":"CylanceINFINITY (Deprecated)","fromServerVersion":"","hidden":false,"icon":"cylance.png","id":"cylance","image":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAiCAYAAACUcR1DAAADTUlEQVR4Ae3ZA+xcSxTH8fe3nm3bthU826ht27Zt/q3atqPGtW1Pv0kmyWRyseqmtzlJPovZc2dmz2+91ymlxDXMuCIkYCEBCwlYSMBCAhYSsJCAJeAqG95Pw614HEMwHz3xNB5GgjQygAHrAAdjMwbhJyhDWxzEanTDvdLQYAVcAqWNwzdQ2hm0gDJ0l4YGK+BFUNpol4DPQWljQlnwwQcfTEa6ixSzNsT5MoPYePadgXQtTUvREhzqUyLpm1fA86G0UfjWJ+CRIdypP1CIHAf56GjVf4kuSHCZrx76W2P18XwUjX8T2RiK2z3qbsEwFOEpl5pn0NgaexyTkYsc5KIA+cjGRDxqHVPBo28FaBZtwBPwJZR2Hs1x3g7YpyFL8AYewEMO7raOuQ3jkI8bjfFE9MV03G8dMw4fRhhuFhbhSzTDUI/a6hiAX7EC9zvUvINsa6wfmls9eEx7HI8h1ai/D0vxvEvfHsad0Qa8DU9hLRRWowdUGAE/jPwIG98ei/EwkpGPUUh1qB2O9yJcpwF66ctJmIO3XWrbopy+XAbzcbNV8xbGWmMj8VEYe3oGOf61EQZsmIgXsRU9sCvMgB/UwSRH2PxyWIlP8YdzXeQBc8xdWIR7jLGvke9S3wqVjeuNUIwUn4CH44sw9vUUJuE21ERdrQZujV3AQCt8gWNQcQzYbGpvfT3WAXdDfYfxbHzjF7Ae64FRcQz4llgGfB6r8APqQ8XpJdqcoyJ6+dSMxOthzvs0ZiPL4bbXMB2pfgHr8bHooi+/hPFX60v0YijDUJTiBF7GaCjD2BA+ZC32+ZB1l88cNdHfp2YI6nus8aD1MpqE0fjdY85+qGaNdUANh9o0lKIhymC0w1zN/PYX5oesOyIJuABK24T2UNpaPIN9UFrnWH9Ncjj+W1Txe0kzvn7kWHIxCQ8Z9Q9gMBI85nwEg63G/4OvXepvwkgU4BXrtscwyWN/2Q5fk8pfia9Jj2EWFEqRB2V4BWuhMB53xOGHjkh/SDClIcF6BieGMF8KEuKxv7j80KFDTkYzTMBcKMPbyEZZXS+C+nchId6EIVCGF5ER/CZIwObfhnUxF/8gMfgNkICFBCwkYCEBCwlYSMBCApaAhQQsAuMypEm2YIZjn78AAAAASUVORK5CYII=","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.283692+03:00","name":"cylance","packID":"","prevName":"cylance","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"600","display":"Default timeout (seconds) for wait on locks to be released","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"timeout","options":null,"required":true,"type":0},{"defaultValue":"false","display":"Sync integration cache","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Whether to sync the integration cache with the database (Available from Cortex XSOAR 6.2.0).","name":"sync","options":null,"required":false,"type":8}],"definitionId":"","description":"Locking mechanism that prevents concurrent execution of different tasks","detailedDescription":"The Demisto Locking integration allows prevention of concurrent execution of scripts or commands, using a wait-lock-release flow (mutex). \nUse the lock name argument to support multiple locks in different flows.","display":"Demisto Lock","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Demisto Lock","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"Name of lock. When omitted, name is set to Default","name":"name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Additional information to provide for the lock instance","name":"info","required":false,"secret":false},{"default":false,"defaultValue":"600","deprecated":false,"description":"Timeout (seconds) for wait on lock to be freed","name":"timeout","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a lock. If the lock is already in use - will wait until it is released or until timeout is reached","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-lock-get","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Name of lock to release. When omitted, name is set to Default","name":"name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Release a lock","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-lock-release","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Specific lock to show info for. If not specified, shows info for all locks","name":"name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Show information on locks","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-lock-info","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Release all locks","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-lock-release-all","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"function guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\nvar sync = params.sync;\nfunction setLock(guid, info) {\n    if (sync) {\n        var versionedIntegrationContext = getVersionedIntegrationContext(true, true) || {};\n        var integrationContext = versionedIntegrationContext.context;\n        integrationContext[lockName] = {guid: guid, info: info};\n        setVersionedIntegrationContext(integrationContext, true, versionedIntegrationContext.version);\n    } else {\n        var integrationContext = getIntegrationContext() || {};\n        integrationContext[lockName] = {guid: guid, info: info};\n        setIntegrationContext(integrationContext);\n    }\n} function getLock() {\n    if (sync) {\n        var versionedIntegrationContext = getVersionedIntegrationContext(true, true) || {};\n        var integrationContext = versionedIntegrationContext.context;\n        if (!integrationContext[lockName]) {\n            integrationContext[lockName] = {};\n        }\n        return integrationContext[lockName];\n    } else {\n        var integrationContext = getIntegrationContext() || {};\n        if (!integrationContext[lockName]) {\n            integrationContext[lockName] = {};\n        }\n        return integrationContext[lockName];\n    }\n}\nvar lockName = args.name || 'Default';\n\nswitch (command) {\n    case 'test-module':\n        return 'ok';\n\n    case 'demisto-lock-get':\n        var lockTimeout = args.timeout || params.timeout;\n        var lockInfo = 'Locked by incident #' + incidents[0].id + '.';\n        lockInfo += (args.info) ? ' Additional info: ' + args.info :'';\n\n        var guid = guid();\n        var time = 0;\n        var lock = getLock();\n\n        while (lock.guid !== guid \u0026\u0026 time++ \u003c lockTimeout) {\n            wait(1);\n            lock = getLock();\n            if (lock.guid === guid) {\n                continue;\n            }\n            if (!lock.guid) {\n                try {\n                    setLock(guid, lockInfo);\n                } catch(err) {\n                    logDebug(err.message)\n                }\n            }\n        }\n\n        if (lock.guid === guid) {\n            var md = '### Demisto Locking Mechanism\\n';\n            md += 'Lock acquired successfully\\n';\n            md += 'GUID: ' + guid;\n            return { ContentsFormat: formats.markdown, Type: entryTypes.note, Contents: md } ;\n        } else {\n            var md = 'Timeout waiting for lock\\n';\n            md += 'Lock name: ' + lockName + '\\n';\n            md += 'Lock info: ' + lock.info + '\\n';\n            return { ContentsFormat: formats.text, Type: entryTypes.error, Contents: md };\n        }\n        break;\n\n    case 'demisto-lock-release':\n        integrationContext = getVersionedIntegrationContext(sync);\n        integrationContext[lockName] = {};\n        setVersionedIntegrationContext(integrationContext, sync);\n\n        var md = '### Demisto Locking Mechanism\\n';\n        md += 'Lock released successfully';\n        return { ContentsFormat: formats.markdown, Type: entryTypes.note, Contents: md } ;\n\n    case 'demisto-lock-release-all':\n        setVersionedIntegrationContext({}, sync);\n\n        var md = '### Demisto Locking Mechanism\\n';\n        md += 'All locks released successfully';\n        return { ContentsFormat: formats.markdown, Type: entryTypes.note, Contents: md } ;\n\n    case 'demisto-lock-info':\n        integrationContext = getVersionedIntegrationContext(sync);\n        var obj = [];\n\n        var res;\n        var md = '### Demisto Locking Mechanism\\n';\n        var locks = (lockName === 'Default') ? Object.keys(integrationContext) : [lockName];\n\n        locks.forEach(function(lock){\n            md += 'Lock name: ' + lock + ' - ';\n            if (integrationContext[lock] \u0026\u0026 integrationContext[lock].guid) {\n                md += 'Locked.\\n';\n                md += '- GUID: ' + integrationContext[lock].guid + '\\n';\n                md += '- Info: ' + integrationContext[lock].info + '\\n\\n';\n                obj.push({lock: lock, state: integrationContext[lock]});\n            } else {\n                md += 'Not locked\\n\\n';\n            }\n\n        });\n        return { ContentsFormat: formats.json, Type: entryTypes.note, Contents: obj, HumanReadable: md } ;\n\n    default:\n        var md = 'Unknown command ' + command;\n        return { ContentsFormat: formats.text, Type: entryTypes.error, Contents: md };\n}\n","subtype":"","type":"javascript"},"itemVersion":"1.0.1","modified":"2021-08-24T19:09:02.295226+03:00","name":"Demisto Lock","packID":"DemistoLocking","packPropagationLabels":["all"],"prevName":"Demisto Lock","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":2},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"https://127.0.0.1","display":"Demisto Server URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Demisto Server API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apikey","options":null,"required":true,"type":4},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"Use Demisto REST APIs","detailedDescription":"Creating API keys is done in the Demisto interface, under Settings -\u003e Integrations -\u003e API Keys","display":"Demisto REST API","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Demisto REST API","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"Request URI (i.e. /incident)","name":"uri","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Body of HTTP POST","name":"body","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"send HTTP POST request","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-api-post","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Request URI (i.e. /user)","name":"uri","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"send HTTP GET requests","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-api-get","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Request URI (i.e. /user)","name":"uri","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Request body","name":"body","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"send HTTP PUT request","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-api-put","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Request URI (i.e. /user)","name":"uri","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"send HTTP DELETE request","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-api-delete","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Request URI","name":"uri","required":true,"secret":false},{"default":false,"deprecated":false,"description":"File name of download","name":"filename","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Description of file entry","name":"description","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Download files from Demisto server","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-api-download","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Request URI","name":"uri","required":true,"secret":false},{"default":false,"deprecated":false,"description":"File entry ID","name":"entryID","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Request body","name":"body","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Send HTTP Multipart request to upload files to Demisto server","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-api-multipart","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"IDs of the incidents to delete","isArray":true,"name":"ids","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete Demisto incidents","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"demisto-delete-incidents","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"var serverURL = params.url;\nif (serverURL.slice(-1) === '/') {\n    serverURL = serverURL.slice(0,-1);\n}\n\nsendMultipart = function (uri, entryID, body) {\n    var requestUrl = serverURL;\n    if (uri.slice(-1) !== '/') {\n        requestUrl += '/';\n    }\n    requestUrl += uri;\n\n    var res = httpMultipart(\n        requestUrl,\n        entryID,\n        {\n            Headers: {\n                'Authorization': [params.apikey],\n                'Content-Type': ['multipart/form-data'],\n                'Accept': ['application/json']\n            },\n        },\n        body,\n        params.insecure,\n        params.proxy,\n        undefined,\n        'file'\n    );\n    if (res.StatusCode \u003c 200 || res.StatusCode \u003e= 300) {\n        throw 'Demisto REST APIs - Request Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    try {\n        var response = res.Body;\n        try {\n            response = JSON.parse(res.Body);\n        } catch (ex) {\n            // do nothing, already handled prior the try/catch\n        }\n        return {response: response};\n    } catch (ex) {\n        throw 'Demisto REST APIs - Error parsing response - ' + ex + '\\nBody:' + res.Body;\n    }\n\n};\n\nvar sendRequest = function(method, uri, body, raw) {\n    var requestUrl = serverURL;\n    if (uri.slice(0, 1) !== '/') {\n        requestUrl += '/';\n    }\n    requestUrl += uri;\n\n    var res = http(\n        requestUrl,\n        {\n            Method: method,\n            Headers: {\n                'Accept': ['application/json'],\n                'content-type': ['application/json'],\n                'authorization': [params.apikey]\n            },\n            Body: body,\n            SaveToFile: raw\n        },\n        params.insecure,\n        params.proxy\n    );\n\n    if (res.StatusCode \u003c 200 || res.StatusCode \u003e= 300) {\n        throw 'Demisto REST APIs - Request Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    if (raw) {\n        return res;\n    } else {\n        try {\n            var response = res.Body;\n            try {\n                response = JSON.parse(res.Body);\n            } catch (ex) {\n                // do nothing, already handled prior the try/catch\n            }\n            return {response: response};\n        } catch (ex) {\n            throw 'Demisto REST APIs - Error parsing response - ' + ex + '\\nBody:' + res.Body;\n        }\n    }\n};\n\nvar deleteIncidents = function(ids_to_delete) {\n    var body = {\n        ids: ids_to_delete,\n        all: false,\n        filter: {}\n    };\n\n    var res = sendRequest('POST', '/incident/batchDelete', JSON.stringify(body));\n    if (isError(res[0])) {\n        throw res[0].Contents;\n    }\n\n    var response = res['response']\n    var md = tableToMarkdown('Demisto delete incidents', response, ['data', 'total', \"notUpdated\"]);\n\n    return {\n        ContentsFormat: formats.json,\n        Type: entryTypes.note,\n        Contents: res,\n        HumanReadable: md\n    };\n};\n\nswitch (command) {\n    case 'test-module':\n        sendRequest('GET','user');\n        return 'ok';\n    case 'demisto-api-post':\n        var body = JSON.parse(args.body);\n        return sendRequest('POST',args.uri, args.body);\n    case 'demisto-api-get':\n        return sendRequest('GET',args.uri);\n    case 'demisto-api-put':\n        var body = JSON.parse(args.body);\n        return sendRequest('PUT',args.uri, args.body);\n    case 'demisto-api-delete':\n        return sendRequest('DELETE',args.uri);\n    case 'demisto-api-multipart':\n        return sendMultipart(args.uri, args.entryID, args.body);\n    case 'demisto-api-download':\n        var res = sendRequest('GET',args.uri,args.body,true);\n        var filename = res.Path;\n        if (args.filename) {\n            filename = args.filename;\n        } else {\n            var disposition = res.Headers['Content-Disposition'][0].split('=');\n            if (disposition.length === 2) {\n                filename = disposition[1];\n            }\n        }\n        var desc = args.description || '';\n        return ({Type: entryTypes.file, FileID: res.Path, File: filename, Contents: desc});\n    case 'demisto-delete-incidents':\n        var ids = argToList(args.ids);\n        return deleteIncidents(ids);\n    default:\n        throw 'Demisto REST APIs - unknown command';\n}\n","subtype":"","type":"javascript"},"itemVersion":"1.1.5","modified":"2021-08-24T19:09:02.295307+03:00","name":"Demisto REST API","packID":"DemistoRESTAPI","packPropagationLabels":["all"],"prevName":"Demisto REST API","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":2},{"brand":"","canGetSamples":true,"category":"IT Services","commitMessage":"","configuration":[{"defaultValue":"","display":"Server URL (e.g. https://www.example.com:1000)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Docker Client Certificate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"client_certificate","options":null,"required":true,"type":4},{"defaultValue":"","display":"Docker Client Private Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"client_key","options":null,"required":true,"type":4},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"The Engine API is an HTTP API served by Docker Engine. It is the API the Docker client uses to communicate with the Engine, so everything the Docker client can do can be done with the API.","detailedDescription":"### Community Contributed Integration\n #### Integration Author: Ayman Mahmoud\n No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).\n***\n## Docker Engine\nDocker Engine is an open source containerization technology for building and containerizing your applications. Docker Engine acts as a client-server application with:\n\n- A server with a long-running daemon process dockerd.\n- APIs which specify interfaces that programs can use to talk to and instruct the Docker daemon.\n- A command line interface (CLI) client docker.\n\nThe CLI uses Docker APIs to control or interact with the Docker daemon through scripting or direct CLI commands. Many other Docker applications use the underlying API and CLI. The daemon creates and manage Docker objects, such as images, containers, networks, and volumes.\n\n### Configure Docker Engine's API\nBy default, Docker runs through a non-networked UNIX socket. It can also optionally communicate using an HTTP socket.\nIf you need Docker to be reachable through the network in a safe manner, you can enable TLS by specifying the tlsverify flag and pointing Docker’s tlscacert flag to a trusted CA certificate.\nIn the daemon mode, it only allows connections from clients authenticated by a certificate signed by that CA. In the client mode, it only connects to servers with a certificate signed by that CA.\n\nFirst, on the Docker daemon’s host machine, generate CA private and public keys:\n\n    $ openssl genrsa -aes256 -out ca-key.pem 4096\n    Generating RSA private key, 4096 bit long modulus\n    ............................................................................................................................................................................................++\n    ........++\n    e is 65537 (0x10001)\n    Enter pass phrase for ca-key.pem:\n    Verifying - Enter pass phrase for ca-key.pem:\n    \n    $ openssl req -new -x509 -days 365 -key ca-key.pem -sha256 -out ca.pem\n    Enter pass phrase for ca-key.pem:\n    You are about to be asked to enter information that will be incorporated\n    into your certificate request.\n    What you are about to enter is what is called a Distinguished Name or a DN.\n    There are quite a few fields but you can leave some blank\n    For some fields there will be a default value,\n    If you enter '.', the field will be left blank.\n    -----\n    Country Name (2 letter code) [AU]:\n    State or Province Name (full name) [Some-State]:Queensland\n    Locality Name (eg, city) []:Brisbane\n    Organization Name (eg, company) [Internet Widgits Pty Ltd]:Docker Inc\n    Organizational Unit Name (eg, section) []:Sales\n    Common Name (e.g. server FQDN or YOUR name) []:$HOST\n    Email Address []:Sven@home.org.au\n\n    $ openssl genrsa -out server-key.pem 4096 \n    Generating RSA private key, 4096 bit long modulus \n    $ openssl req -subj \"/CN=$HOST\" -sha256 -new -key server-key.pem -out server.csr\n\nNext, we’re going to sign the public key with our CA:\n\nSince TLS connections can be made through IP address as well as DNS name, the IP addresses need to be specified when creating the certificate. For example, to allow connections using 10.10.10.20 and 127.0.0.1:\n\n    $ echo subjectAltName = DNS:$HOST,IP:10.10.10.20,IP:127.0.0.1 \u003e\u003e extfile.cnf\n\nSet the Docker daemon key’s extended usage attributes to be used only for server authentication:\n\n    $ echo extendedKeyUsage = serverAuth \u003e\u003e extfile.cnf\n\nNow, generate the signed certificate:\n\n    $ openssl x509 -req -days 365 -sha256 -in server.csr -CA ca.pem -CAkey ca-key.pem \\\n      -CAcreateserial -out server-cert.pem -extfile extfile.cnf\n    Signature ok\n    subject=/CN=your.host.com\n    Getting CA Private Key\n    Enter pass phrase for ca-key.pem:\n\nYou can then use the client certificate and private key to configure the XSOAR Docker Integration.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/docker-engine-api)","display":"Docker Engine API (Community Contribution)","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"Docker Engine API","image":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAeCAYAAADnydqVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAnmVYSWZNTQAqAAAACAAFARIAAwAAAAEAAQAAARoABQAAAAEAAABKARsABQAAAAEAAABSATEAAgAAACYAAABah2kABAAAAAEAAACAAAAAAAAAAEgAAAABAAAASAAAAAFBZG9iZSBJbGx1c3RyYXRvciBDQyAyMi4xIChNYWNpbnRvc2gpAAACoAIABAAAAAEAAAB4oAMABAAAAAEAAAAeAAAAAJUfK2EAAAAJcEhZcwAACxMAAAsTAQCanBgAAAYoaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA2LjAuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zODwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4xNTA8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGRjOnRpdGxlPgogICAgICAgICAgICA8cmRmOkFsdD4KICAgICAgICAgICAgICAgPHJkZjpsaSB4bWw6bGFuZz0ieC1kZWZhdWx0Ij5ob3Jpem9udGFsPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOkFsdD4KICAgICAgICAgPC9kYzp0aXRsZT4KICAgICAgICAgPHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD51dWlkOjVEMjA4OTI0OTNCRkRCMTE5MTRBODU5MEQzMTUwOEM4PC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnhtcC5kaWQ6RjEwMzk1NjZBNTBEMTFFOTlFMEI5MUI4NEM5Qjk2NEM8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpEZXJpdmVkRnJvbSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgIDxzdFJlZjppbnN0YW5jZUlEPnV1aWQ6ZTg1NDU2OWQtMDVhNC1hMjRjLWEzZTctYzkxYjYxZDBlOGZkPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOmExM2VjNzkxLTAzMzgtNDFjMS1iNmQwLTUyYzg4MmNmOGNiNjwvc3RSZWY6ZG9jdW1lbnRJRD4KICAgICAgICAgPC94bXBNTTpEZXJpdmVkRnJvbT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDpGMTAzOTU2NUE1MEQxMUU5OUUwQjkxQjg0QzlCOTY0QzwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBJbGx1c3RyYXRvciBDQyAyMi4xIChNYWNpbnRvc2gpPC94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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"Amount of disk space in bytes to keep for cache","name":"keep_storage","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Remove all types of build cache","name":"prune_all","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A JSON encoded value of the filters (a `map[string][]string`) to process on the list of build cache objects.  Available filters:  - `until= duration `: duration relative to daemon's time, during which build cache was not used, in Go's duration format (e.g., '24h') - `id= id ` - `parent= id ` - `type= string ` - `description= string ` - `inuse` - `shared` - `private` ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete builder cache","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-build-prune","outputs":[{"contentPath":"","contextPath":"Docker.BuildPruneResponse.SpaceReclaimed","description":"Disk space reclaimed in bytes","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"User-defined name of the config.","name":"configspec_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User-defined key/value metadata.","name":"configspec_labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Base64-url-safe-encoded ([RFC 4648](https://tools.ietf.org/html/rfc4648#section-5)) config data. ","name":"configspec_data","required":false,"secret":false},{"default":false,"deprecated":false,"description":"configspec_templating Name","name":"configspec_templating_Name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"configspec_templating Options","name":"configspec_templating_Options","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a config","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-config-create","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"ID of the config","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Inspect a config","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-config-inspect","outputs":[{"contentPath":"","contextPath":"Docker.Config.ID","description":"Docker Config ID","type":"String"},{"contentPath":"","contextPath":"Docker.Config.CreatedAt","description":"Docker Config CreatedAt","type":"String"},{"contentPath":"","contextPath":"Docker.Config.UpdatedAt","description":"Docker Config UpdatedAt","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A JSON encoded value of the filters ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List configs","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-config-list","outputs":[{"contentPath":"","contextPath":"Docker.Config.ID","description":"Docker Config ID","type":"String"},{"contentPath":"","contextPath":"Docker.Config.CreatedAt","description":"Docker Config CreatedAt","type":"String"},{"contentPath":"","contextPath":"Docker.Config.UpdatedAt","description":"Docker Config UpdatedAt","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"ID or name of the container","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get changes on a container’s filesystem","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-container-changes","outputs":[{"contentPath":"","contextPath":"Docker.ContainerChangeResponseItem.Path","description":"Path to file that has changed","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerChangeResponseItem.Kind","description":"Kind of change","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Assign the specified name to the container. Must match `/?[a-zA-Z0-9][a-zA-Z0-9_.-]+`. ","name":"name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The hostname to use for the container, as a valid RFC 1123 hostname.","name":"containerconfig_hostname","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The domain name to use for the container.","name":"containerconfig_domainname","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The user that commands are run as inside the container.","name":"containerconfig_user","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Whether to attach to `stdin`.","name":"containerconfig_attachstdin","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Whether to attach to `stdout`.","name":"containerconfig_attachstdout","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Whether to attach to `stderr`.","name":"containerconfig_attachstderr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An object mapping ports to an empty object in the form:  `{\" port / tcp|udp|sctp \": {}}` ","name":"containerconfig_exposedports","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Attach standard streams to a TTY, including `stdin` if it is not closed. ","name":"containerconfig_tty","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Open `stdin`","name":"containerconfig_openstdin","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close `stdin` after one attached client disconnects","name":"containerconfig_stdinonce","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of environment variables to set inside the container in the form `[\"VAR=value\", ...]`. A variable without `=` is removed from the environment, rather than to have an empty value. ","isArray":true,"name":"containerconfig_env","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Command to run specified as a string or an array of strings. ","isArray":true,"name":"containerconfig_cmd","required":false,"secret":false},{"default":false,"deprecated":false,"description":"containerconfig_healthcheck Test","name":"containerconfig_healthcheck_Test","required":false,"secret":false},{"default":false,"deprecated":false,"description":"containerconfig_healthcheck Interval","name":"containerconfig_healthcheck_Interval","required":false,"secret":false},{"default":false,"deprecated":false,"description":"containerconfig_healthcheck Timeout","name":"containerconfig_healthcheck_Timeout","required":false,"secret":false},{"default":false,"deprecated":false,"description":"containerconfig_healthcheck Retries","name":"containerconfig_healthcheck_Retries","required":false,"secret":false},{"default":false,"deprecated":false,"description":"containerconfig_healthcheck StartPeriod","name":"containerconfig_healthcheck_StartPeriod","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Command is already escaped (Windows only)","name":"containerconfig_argsescaped","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the image to use when creating the container/ ","name":"containerconfig_image","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An object mapping mount point paths inside the container to empty objects. ","name":"containerconfig_volumes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The working directory for commands to run in.","name":"containerconfig_workingdir","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The entry point for the container as a string or an array of strings.  If the array consists of exactly one empty string (`[\"\"]`) then the entry point is reset to system default (i.e., the entry point used by docker when there is no `ENTRYPOINT` instruction in the `Dockerfile`). ","isArray":true,"name":"containerconfig_entrypoint","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Disable networking for the container.","name":"containerconfig_networkdisabled","required":false,"secret":false},{"default":false,"deprecated":false,"description":"MAC address of the container.","name":"containerconfig_macaddress","required":false,"secret":false},{"default":false,"deprecated":false,"description":"`ONBUILD` metadata that were defined in the image's `Dockerfile`. ","isArray":true,"name":"containerconfig_onbuild","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User-defined key/value metadata.","name":"containerconfig_labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Signal to stop a container as a string or unsigned integer. ","name":"containerconfig_stopsignal","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Timeout to stop a container in seconds.","name":"containerconfig_stoptimeout","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Shell for when `RUN`, `CMD`, and `ENTRYPOINT` uses a shell. ","isArray":true,"name":"containerconfig_shell","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of volume bindings for this container.","isArray":true,"name":"hostconfig_binds","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Path to a file where the container ID is written","name":"hostconfig_containeridfile","required":false,"secret":false},{"default":false,"deprecated":false,"description":"hostconfig_logconfig Type","name":"hostconfig_logconfig_Type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Log Config","name":"hostconfig_logconfig_Config","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Network mode to use for this container.","name":"hostconfig_networkmode","required":false,"secret":false},{"default":false,"deprecated":false,"description":"hostconfig port bindings","name":"hostconfig_portbindings","required":false,"secret":false},{"default":false,"deprecated":false,"description":"hostconfig_restartpolicy Name","name":"hostconfig_restartpolicy_Name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"hostconfig_restartpolicy MaximumRetryCount","name":"hostconfig_restartpolicy_MaximumRetryCount","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Automatically remove the container when the container's process exits. This has no effect if `RestartPolicy` is set. ","name":"hostconfig_autoremove","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Driver that this container uses to mount volumes.","name":"hostconfig_volumedriver","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of volumes to inherit from another container","isArray":true,"name":"hostconfig_volumesfrom","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Specification for mounts to be added to the container. ","isArray":true,"name":"hostconfig_mounts","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of kernel capabilities to add to the container. Conflicts with option 'Capabilities'. ","isArray":true,"name":"hostconfig_capadd","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of kernel capabilities to drop from the container. Conflicts with option 'Capabilities'. ","isArray":true,"name":"hostconfig_capdrop","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"cgroup namespace mode for the container. Possible values are:  - `\"private\"`: the container runs in its own private cgroup namespace - `\"host\"`: use the host system's cgroup namespace  If not specified, the daemon default is used, which can either be `\"private\"` or `\"host\"`, depending on daemon version, kernel support and configuration. ","name":"hostconfig_cgroupnsmode","predefined":["private","host"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of DNS servers for the container to use.","isArray":true,"name":"hostconfig_dns","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of DNS options.","isArray":true,"name":"hostconfig_dnsoptions","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of DNS search domains.","isArray":true,"name":"hostconfig_dnssearch","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of hostnames/IP mappings to add to the container's `/etc/hosts` file. Specified in the form `[\"hostname:IP\"]`. ","isArray":true,"name":"hostconfig_extrahosts","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of additional groups that the container process will run as. ","isArray":true,"name":"hostconfig_groupadd","required":false,"secret":false},{"default":false,"deprecated":false,"description":"IPC sharing mode for the container. Possible values are:  - `\"none\"`: own private IPC namespace, with /dev/shm not mounted - `\"private\"`: own private IPC namespace - `\"shareable\"`: own private IPC namespace, with a possibility to share it with other containers - `\"container: name|id \"`: join another (shareable) container's IPC namespace - `\"host\"`: use the host system's IPC namespace  If not specified, daemon default is used, which can either be `\"private\"` or `\"shareable\"`, depending on daemon version and configuration. ","name":"hostconfig_ipcmode","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Cgroup to use for the container.","name":"hostconfig_cgroup","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of links for the container in the form `container_name:alias`. ","isArray":true,"name":"hostconfig_links","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An integer value containing the score given to the container in order to tune OOM killer preferences. ","name":"hostconfig_oomscoreadj","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set the PID (Process) Namespace mode for the container. It can be either:  - `\"container: name|id \"`: joins another container's PID namespace - `\"host\"`: use the host's PID namespace inside the container ","name":"hostconfig_pidmode","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Gives the container full access to the host.","name":"hostconfig_privileged","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Allocates an ephemeral host port for all of a container's exposed ports.  Ports are de-allocated when the container stops and allocated when the container starts. The allocated port might be changed when restarting the container.  The port is selected from the ephemeral port range that depends on the kernel. For example, on Linux the range is defined by `/proc/sys/net/ipv4/ip_local_port_range`. ","name":"hostconfig_publishallports","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Mount the container's root filesystem as read only.","name":"hostconfig_readonlyrootfs","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of string values to customize labels for MLS systems, such as SELinux.","isArray":true,"name":"hostconfig_securityopt","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Storage driver options for this container, in the form `{\"size\": \"120G\"}`. ","name":"hostconfig_storageopt","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A map of container directories which should be replaced by tmpfs mounts, and their corresponding mount options. For example:  ``` { \"/run\": \"rw,noexec,nosuid,size=65536k\" } ``` ","name":"hostconfig_tmpfs","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UTS namespace to use for the container.","name":"hostconfig_utsmode","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Sets the usernamespace mode for the container when usernamespace remapping option is enabled. ","name":"hostconfig_usernsmode","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Size of `/dev/shm` in bytes. If omitted, the system uses 64MB. ","name":"hostconfig_shmsize","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of kernel  meters (sysctls) to set in the container. For example:  ``` {\"net.ipv4.ip_forward\": \"1\"} ``` ","name":"hostconfig_sysctls","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Runtime to use with this container.","name":"hostconfig_runtime","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Initial console size, as an `[height, width]` array. (Windows only) ","isArray":true,"name":"hostconfig_consolesize","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Isolation technology of the container. (Windows only) ","name":"hostconfig_isolation","predefined":["default","process","hyperv"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The list of paths to be masked inside the container (this overrides the default set of paths). ","isArray":true,"name":"hostconfig_maskedpaths","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The list of paths to be set as read-only inside the container (this overrides the default set of paths). ","isArray":true,"name":"hostconfig_readonlypaths","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A mapping of network name to endpoint configuration for that network. ","name":"networkingconfig_endpointsconfig","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a container","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-container-create","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"ID or name of the container","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Return the size of container as fields `SizeRw` and `SizeRootFs`","name":"size","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Inspect a container","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-container-inspect","outputs":[{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Id","description":"The ID of the container","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Created","description":"The time the container was created","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Path","description":"The path to the command being run","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Image","description":"The container's image ID","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.ResolvConfPath","description":"Docker ContainerInspectResponse ResolvConfPath","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.HostnamePath","description":"Docker ContainerInspectResponse HostnamePath","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.HostsPath","description":"Docker ContainerInspectResponse HostsPath","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.LogPath","description":"Docker ContainerInspectResponse LogPath","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Name","description":"Docker ContainerInspectResponse Name","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.RestartCount","description":"Docker ContainerInspectResponse RestartCount","type":"Number"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Driver","description":"Docker ContainerInspectResponse Driver","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Platform","description":"Docker ContainerInspectResponse Platform","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.MountLabel","description":"Docker ContainerInspectResponse MountLabel","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.ProcessLabel","description":"Docker ContainerInspectResponse ProcessLabel","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.AppArmorProfile","description":"Docker ContainerInspectResponse AppArmorProfile","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.SizeRw","description":"The size of files that have been created or changed by this container. ","type":"Number"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.SizeRootFs","description":"The total size of all the files in this container.","type":"Number"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Type","description":"Docker ContainerInspectResponse Mounts Type","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Name","description":"Docker ContainerInspectResponse Mounts Name","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Source","description":"Docker ContainerInspectResponse Mounts Source","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Destination","description":"Docker ContainerInspectResponse Mounts Destination","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Driver","description":"Docker ContainerInspectResponse Mounts Driver","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Mode","description":"Docker ContainerInspectResponse Mounts Mode","type":"String"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.RW","description":"Docker ContainerInspectResponse Mounts RW","type":"Boolean"},{"contentPath":"","contextPath":"Docker.ContainerInspectResponse.Mounts.Propagation","description":"Docker ContainerInspectResponse Mounts Propagation","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Return all containers. By default, only running containers are shown. ","name":"list_all","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Return this number of most recently created containers, including non-running ones. ","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Return the size of container as fields `SizeRw` and `SizeRootFs`. ","name":"size","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Filters to process on the container list, encoded as JSON (a `map[string][]string`). For example, `{\"status\": [\"paused\"]}` will only return paused containers.  Available filters:  - `ancestor`=(` image-name [: tag ]`, ` image id `, or ` image@digest `) - `before`=(` container id ` or ` container name `) - `expose`=(` port [/ proto ]`|` startport-endport /[ proto ]`) - `exited= int ` containers with exit code of ` int ` - `health`=(`starting`|`healthy`|`unhealthy`|`none`) - `id= ID ` a container's ID - `isolation=`(`default`|`process`|`hyperv`) (Windows daemon only) - `is-task=`(`true`|`false`) - `label=key` or `label=\"key=value\"` of a container label - `name= name ` a container's name - `network`=(` network id ` or ` network name `) - `publish`=(` port [/ proto ]`|` startport-endport /[ proto ]`) - `since`=(` container id ` or ` container name `) - `status=`(`created`|`restarting`|`running`|`removing`|`paused`|`exited`|`dead`) - `volume`=(` volume name ` or ` mount point destination `) ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List containers","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-container-list","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"ID or name of the container","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Stream the output. If false, the stats will be output once and then it will disconnect. ","name":"stream","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Only get a single stat instead of waiting for 2 cycles. Must be used with `stream=false`. ","name":"one_shot","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get container stats based on resource usage","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-container-stats","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"ID or name of the container","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The arguments to pass to `ps`. For example, `aux`","name":"ps_args","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List processes running inside a container","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-container-top","outputs":[{"contentPath":"","contextPath":"Docker.ContainerTopResponse.Processes","description":"Docker ContainerTopResponse Processes","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Image name or ID","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get the history of an image","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-image-history","outputs":[{"contentPath":"","contextPath":"Docker.HistoryResponseItem.Id","description":"Docker HistoryResponseItem Id","type":"String"},{"contentPath":"","contextPath":"Docker.HistoryResponseItem.Created","description":"Docker HistoryResponseItem Created","type":"Number"},{"contentPath":"","contextPath":"Docker.HistoryResponseItem.CreatedBy","description":"Docker HistoryResponseItem CreatedBy","type":"String"},{"contentPath":"","contextPath":"Docker.HistoryResponseItem.Size","description":"Docker HistoryResponseItem Size","type":"Number"},{"contentPath":"","contextPath":"Docker.HistoryResponseItem.Comment","description":"Docker HistoryResponseItem Comment","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Image name or id","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Inspect an image","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-image-inspect","outputs":[{"contentPath":"","contextPath":"Docker.Image.Id","description":"Docker Image ID","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Parent","description":"Docker Image Parent","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Comment","description":"Docker Image Comment","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Created","description":"Docker Image Created","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Container","description":"Docker Image Container","type":"String"},{"contentPath":"","contextPath":"Docker.Image.DockerVersion","description":"Docker Image DockerVersion","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Author","description":"Docker Image Author","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Architecture","description":"Docker Image Architecture","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Os","description":"Docker Image Os","type":"String"},{"contentPath":"","contextPath":"Docker.Image.OsVersion","description":"Docker Image OsVersion","type":"String"},{"contentPath":"","contextPath":"Docker.Image.Size","description":"Docker Image Size","type":"Number"},{"contentPath":"","contextPath":"Docker.Image.VirtualSize","description":"Docker Image VirtualSize","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Show all images. Only images from a final layer (no children) are shown by default.","name":"list_all","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A JSON encoded value of the filters","name":"filters","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Show digest information as a `RepoDigests` field on each image.","name":"digests","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List Images","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-image-list","outputs":[{"contentPath":"","contextPath":"Docker.ImageSummary.Id","description":"Docker Image Summary ID","type":"String"},{"contentPath":"","contextPath":"Docker.ImageSummary.ParentId","description":"Docker Image Summary ParentId","type":"String"},{"contentPath":"","contextPath":"Docker.ImageSummary.Created","description":"Docker Image Summary Created","type":"Number"},{"contentPath":"","contextPath":"Docker.ImageSummary.Size","description":"Docker Image Summary Size","type":"Number"},{"contentPath":"","contextPath":"Docker.ImageSummary.SharedSize","description":"Docker Image Summary SharedSize","type":"Number"},{"contentPath":"","contextPath":"Docker.ImageSummary.VirtualSize","description":"Docker Image Summary VirtualSize","type":"Number"},{"contentPath":"","contextPath":"Docker.ImageSummary.Containers","description":"Docker Image Summary Containers","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Filters to process on the prune list","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete unused images","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-image-prune","outputs":[{"contentPath":"","contextPath":"Docker.ImagePruneResponse.ImagesDeleted.Untagged","description":"The image ID of an image that was untagged","type":"String"},{"contentPath":"","contextPath":"Docker.ImagePruneResponse.ImagesDeleted.Deleted","description":"The image ID of an image that was deleted","type":"String"},{"contentPath":"","contextPath":"Docker.ImagePruneResponse.SpaceReclaimed","description":"Disk space reclaimed in bytes","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Term to search","name":"term","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Maximum number of results to return","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A JSON encoded value of the filters (a `map[string][]string`) to process on the images list. Available filters:  - `is-automated=(true|false)` - `is-official=(true|false)` - `stars= number ` Matches images that has at least 'number' stars. ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search images","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-image-search","outputs":[{"contentPath":"","contextPath":"Docker.ImageSearchResponseItem.description","description":"Docker ImageSearchResponseItem description","type":"String"},{"contentPath":"","contextPath":"Docker.ImageSearchResponseItem.is_official","description":"Docker ImageSearchResponseItem is_official","type":"Boolean"},{"contentPath":"","contextPath":"Docker.ImageSearchResponseItem.is_automated","description":"Docker ImageSearchResponseItem is_automated","type":"Boolean"},{"contentPath":"","contextPath":"Docker.ImageSearchResponseItem.name","description":"Docker ImageSearchResponseItem name","type":"String"},{"contentPath":"","contextPath":"Docker.ImageSearchResponseItem.star_count","description":"Docker ImageSearchResponseItem star_count","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The network's name.","name":"networkconfig_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Check for networks with duplicate names. Since Network is primarily keyed based on a random ID and not on the name, and network name is strictly a user-friendly alias to the network which is uniquely identified using ID, there is no guaranteed way to check for duplicates. CheckDuplicate is there to provide a best effort checking of any networks which has the same name but it is not guaranteed to catch all name collisions. ","name":"networkconfig_checkduplicate","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Name of the network driver plugin to use.","name":"networkconfig_driver","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Restrict external access to the network.","name":"networkconfig_internal","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Globally scoped network is manually attachable by regular containers from workers in swarm mode. ","name":"networkconfig_attachable","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ingress network is the network which provides the routing-mesh in swarm mode. ","name":"networkconfig_ingress","required":false,"secret":false},{"default":false,"deprecated":false,"description":"networkconfig_ipam Driver","name":"networkconfig_ipam_Driver","required":false,"secret":false},{"default":false,"deprecated":false,"description":"networkconfig_ipam Config","name":"networkconfig_ipam_Config","required":false,"secret":false},{"default":false,"deprecated":false,"description":"networkconfig_ipam Options","name":"networkconfig_ipam_Options","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Enable IPv6 on the network.","name":"networkconfig_enableipv6","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Network specific options to be used by the drivers.","name":"networkconfig_options","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User-defined key/value metadata.","name":"networkconfig_labels","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a network","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-network-create","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"JSON encoded value of the filters  ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List networks","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-network-list","outputs":[{"contentPath":"","contextPath":"Docker.Network.Name","description":"Docker Network Name","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Id","description":"Docker Network Id","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Created","description":"Docker Network Created","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Scope","description":"Docker Network Scope","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Driver","description":"Docker Network Driver","type":"String"},{"contentPath":"","contextPath":"Docker.Network.EnableIPv6","description":"Docker Network EnableIPv6","type":"Boolean"},{"contentPath":"","contextPath":"Docker.Network.Internal","description":"Docker Network Internal","type":"Boolean"},{"contentPath":"","contextPath":"Docker.Network.Attachable","description":"Docker Network Attachable","type":"Boolean"},{"contentPath":"","contextPath":"Docker.Network.Ingress","description":"Docker Network Ingress","type":"Boolean"},{"contentPath":"","contextPath":"Docker.Network.Containers.Name","description":"Docker Network Containers Name","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Containers.EndpointID","description":"Docker Network Containers EndpointID","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Containers.MacAddress","description":"Docker Network Containers MacAddress","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Containers.IPv4Address","description":"Docker Network Containers IPv4Address","type":"String"},{"contentPath":"","contextPath":"Docker.Network.Containers.IPv6Address","description":"Docker Network Containers IPv6Address","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Filters to process on the prune list. ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete unused networks","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-network-prune","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or name of the node","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Inspect a node","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-node-inspect","outputs":[{"contentPath":"","contextPath":"Docker.Node.ID","description":"Docker Node ID","type":"String"},{"contentPath":"","contextPath":"Docker.Node.CreatedAt","description":"Date and time at which the node was added to the swarm in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"},{"contentPath":"","contextPath":"Docker.Node.UpdatedAt","description":"Date and time at which the node was last updated in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Filters to process on the nodes list, encoded as JSON (a `map[string][]string`).  Available filters: - `id= node id ` - `label= engine label ` - `membership=`(`accepted`|`pending`)` - `name= node name ` - `node.label= node label ` - `role=`(`manager`|`worker`)` ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List nodes","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-node-list","outputs":[{"contentPath":"","contextPath":"Docker.Node.ID","description":"Docker Node ID","type":"String"},{"contentPath":"","contextPath":"Docker.Node.CreatedAt","description":"Date and time at which the node was added to the swarm in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"},{"contentPath":"","contextPath":"Docker.Node.UpdatedAt","description":"Date and time at which the node was last updated in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"User-defined name of the secret.","name":"secretspec_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User-defined key/value metadata.","name":"secretspec_labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Base64-url-safe-encoded ([RFC 4648](https://tools.ietf.org/html/rfc4648#section-5)) data to store as secret.  This field is only used to _create_ a secret, and is not returned by other endpoints. ","name":"secretspec_data","required":false,"secret":false},{"default":false,"deprecated":false,"description":"secretspec_driver Name","name":"secretspec_driver_Name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"secretspec_driver Options","name":"secretspec_driver_Options","required":false,"secret":false},{"default":false,"deprecated":false,"description":"secretspec_templating Name","name":"secretspec_templating_Name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"secretspec_templating Options","name":"secretspec_templating_Options","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a secret","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-secret-create","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"ID of the secret","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Inspect a secret","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-secret-inspect","outputs":[{"contentPath":"","contextPath":"Docker.Secret.ID","description":"Docker Secret ID","type":"String"},{"contentPath":"","contextPath":"Docker.Secret.CreatedAt","description":"Docker Secret CreatedAt","type":"String"},{"contentPath":"","contextPath":"Docker.Secret.UpdatedAt","description":"Docker Secret UpdatedAt","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A JSON encoded value of the filters (a `map[string][]string`) to process on the secrets list.  Available filters:  - `id= secret id ` - `label= key  or label= key =value` - `name= secret name ` - `names= secret name ` ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List secrets","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-secret-list","outputs":[{"contentPath":"","contextPath":"Docker.Secret.ID","description":"Docker Secret ID","type":"String"},{"contentPath":"","contextPath":"Docker.Secret.CreatedAt","description":"Docker Secret CreatedAt","type":"String"},{"contentPath":"","contextPath":"Docker.Secret.UpdatedAt","description":"Docker Secret UpdatedAt","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Listen address used for inter-manager communication, as well as determining the networking interface used for the VXLAN Tunnel Endpoint (VTEP). This can either be an address/port combination in the form `192.168.1.1:4567`, or an interface followed by a port number, like `eth0:4567`. If the port number is omitted, the default swarm listening port is used. ","name":"listenaddr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Externally reachable address advertised to other nodes. This can either be an address/port combination in the form `192.168.1.1:4567`, or an interface followed by a port number, like `eth0:4567`. If the port number is omitted, the port number from the listen address is used. If `AdvertiseAddr` is not specified, it will be automatically detected when possible. ","name":"advertiseaddr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Address or interface to use for data path traffic (format: ` ip|interface `), for example,  `192.168.1.1`, or an interface, like `eth0`. If `DataPathAddr` is unspecified, the same address as `AdvertiseAddr` is used.  The `DataPathAddr` specifies the address that global scope network drivers will publish towards other  nodes in order to reach the containers running on this node. Using this  meter it is possible to se te the container data traffic from the management traffic of the cluster. ","name":"datapathaddr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"DataPathPort specifies the data path port number for data traffic. Acceptable port range is 1024 to 49151. if no port is set or is set to 0, default port 4789 will be used. ","name":"datapathport","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Default Address Pool specifies default subnet pools for global scope networks. ","isArray":true,"name":"defaultaddrpool","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Force creation of a new swarm.","name":"forcenewcluster","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SubnetSize specifies the subnet size of the networks created from the default subnet pool. ","name":"subnetsize","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec Name","name":"spec_Name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec Labels","name":"spec_Labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec Orchestration","name":"spec_Orchestration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec Raft","name":"spec_Raft","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec Dispatcher","name":"spec_Dispatcher","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec CAConfig","name":"spec_CAConfig","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec EncryptionConfig","name":"spec_EncryptionConfig","required":false,"secret":false},{"default":false,"deprecated":false,"description":"spec TaskDefaults","name":"spec_TaskDefaults","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Initialize a new swarm","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-swarm-init","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Inspect swarm","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-swarm-inspect","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Listen address used for inter-manager communication if the node gets promoted to manager, as well as determining the networking interface used for the VXLAN Tunnel Endpoint (VTEP). ","name":"listenaddr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Externally reachable address advertised to other nodes. This can either be an address/port combination in the form `192.168.1.1:4567`, or an interface followed by a port number, like `eth0:4567`. If the port number is omitted, the port number from the listen address is used. If `AdvertiseAddr` is not specified, it will be automatically detected when possible. ","name":"advertiseaddr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Address or interface to use for data path traffic (format: ` ip|interface `), for example,  `192.168.1.1`, or an interface, like `eth0`. If `DataPathAddr` is unspecified, the same address as `AdvertiseAddr` is used.  The `DataPathAddr` specifies the address that global scope network drivers will publish towards other nodes in order to reach the containers running on this node. Using this  meter it is possible to se te the container data traffic from the management traffic of the cluster. ","name":"datapathaddr","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Addresses of manager nodes already participating in the swarm. ","isArray":true,"name":"remoteaddrs","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Secret token for joining this swarm.","name":"jointoken","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Join an existing swarm","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-swarm-join","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Force leave swarm, even if this is the last manager or that it will  eak the cluster. ","name":"force","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Leave a swarm","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-swarm-leave","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The swarm's unlock key.","name":"unlockkey","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Unlock a locked manager","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-swarm-unlock","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Get the unlock key","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-swarm-unlockkey","outputs":[{"contentPath":"","contextPath":"Docker.UnlockKeyResponse.UnlockKey","description":"The swarm's unlock key.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Get data usage information","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-system-data-usage","outputs":[{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.LayersSize","description":"Docker SystemDataUsageResponse LayersSize","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.Id","description":"Docker SystemDataUsageResponse Images ID","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.ParentId","description":"Docker SystemDataUsageResponse Images ParentId","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.Created","description":"Docker SystemDataUsageResponse Images Created","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.Size","description":"Docker SystemDataUsageResponse Images Size","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.SharedSize","description":"Docker SystemDataUsageResponse Images SharedSize","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.VirtualSize","description":"Docker SystemDataUsageResponse Images VirtualSize","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Images.Containers","description":"Docker SystemDataUsageResponse Images Containers","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Volumes.Name","description":"Name of the volume.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Volumes.Driver","description":"Name of the volume driver used by the volume.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Volumes.Mountpoint","description":"Mount path of the volume on the host.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Volumes.CreatedAt","description":"Date/Time the volume was created.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.Volumes.Scope","description":"The level at which the volume exists. Either `global` for cluster-wide, or `local` for machine level. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.ID","description":"Docker SystemDataUsageResponse BuildCache ID","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.Parent","description":"Docker SystemDataUsageResponse BuildCache Parent","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.Type","description":"Docker SystemDataUsageResponse BuildCache Type","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.Description","description":"Docker SystemDataUsageResponse BuildCache Description","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.InUse","description":"Docker SystemDataUsageResponse BuildCache InUse","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.Shared","description":"Docker SystemDataUsageResponse BuildCache Shared","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.Size","description":"Amount of disk space used by the build cache (in bytes). ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.CreatedAt","description":"Date and time at which the build cache was created in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.LastUsedAt","description":"Date and time at which the build cache was last used in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemDataUsageResponse.BuildCache.UsageCount","description":"Docker SystemDataUsageResponse BuildCache UsageCount.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Get system information","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-system-info","outputs":[{"contentPath":"","contextPath":"Docker.SystemInfo.ID","description":"Unique identifier of the daemon.   p    /  /p       Note  : The format of the ID itself is not part of the API, and   should not be considered stable. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.Containers","description":"Total number of containers on the host.","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.ContainersRunning","description":"Number of containers with status `\"running\"`. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.ContainersPaused","description":"Number of containers with status `\"paused\"`. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.ContainersStopped","description":"Number of containers with status `\"stopped\"`. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.Images","description":"Total number of images on the host.  Both _tagged_ and _untagged_ (dangling) images are counted. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.Driver","description":"Name of the storage driver in use.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.DriverStatus","description":"Status of the storage driver in use.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.DockerRootDir","description":"Root directory of persistent Docker state.  Defaults to `/var/lib/docker` on Linux, and `C:\\ProgramData\\docker` on Windows. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.MemoryLimit","description":"Indicates if the host has memory limit support enabled.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.SwapLimit","description":"Indicates if the host has memory swap limit support enabled.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.KernelMemory","description":"Indicates if the host has kernel memory limit support enabled.   p    /  /p       Deprecated  : This field is deprecated as the kernel 5.4 deprecated   `kmem.limit_in_bytes`. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.CpuCfsPeriod","description":"Indicates if CPU CFS(Completely Fair Scheduler) period is supported by the host. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.CpuCfsQuota","description":"Indicates if CPU CFS(Completely Fair Scheduler) quota is supported by the host. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.CPUShares","description":"Indicates if CPU Shares limiting is supported by the host. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.CPUSet","description":"Indicates if CPUsets (cpuset.cpus, cpuset.mems) are supported by the host.  See [cpuset(7)](https://www.kernel.org/doc/Documentation/cgroup-v1/cpusets.txt) ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.PidsLimit","description":"Indicates if the host kernel has PID limit support enabled.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.OomKillDisable","description":"Indicates if OOM killer disable is supported on the host.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.IPv4Forwarding","description":"Indicates IPv4 forwarding is enabled.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.BridgeNfIptables","description":"Indicates if ` idge-nf-call-iptables` is available on the host.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.BridgeNfIp6tables","description":"Indicates if ` idge-nf-call-ip6tables` is available on the host.","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.Debug","description":"Indicates if the daemon is running in debug-mode / with debug-level logging enabled. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.NFd","description":"The total number of file Descriptors in use by the daemon process.  This information is only returned if debug-mode is enabled. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.NGoroutines","description":"The  number of goroutines that currently exist.  This information is only returned if debug-mode is enabled. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.SystemTime","description":"Current system-time in [RFC 3339](https://www.ietf.org/rfc/rfc3339.txt) format with nano-seconds. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.LoggingDriver","description":"The logging driver to use as a default for new containers. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.CgroupDriver","description":"The driver to use for managing cgroups. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.CgroupVersion","description":"The version of the cgroup. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.NEventsListener","description":"Number of event listeners subscribed.","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.KernelVersion","description":"Kernel version of the host.  On Linux, this information obtained from `uname`. On Windows this information is queried from the  kbd HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\ /kbd  registry value, for example _\"10.0 14393 (14393.1198.amd64fre.rs1_release_sec.170427-1353)\"_. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.OperatingSystem","description":"Name of the host's operating system, for example: \"Ubuntu 16.04.2 LTS\" or \"Windows Server 2016 Datacenter\" ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.OSVersion","description":"Version of the host's operating system   p    /  /p       Note  : The information returned in this field, including its   very existence, and the formatting of values, should not be considered   stable, and may change without notice. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.OSType","description":"Generic type of the operating system of the host, as returned by the Go runtime (`GOOS`).  Currently returned values are \"linux\" and \"windows\". A full list of possible values can be found in the [Go documentation](https://golang.org/doc/install/source#environment). ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.Architecture","description":"Hardware architecture of the host, as returned by the Go runtime (`GOARCH`).  A full list of possible values can be found in the [Go documentation](https://golang.org/doc/install/source#environment). ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.NCPU","description":"The number of logical CPUs usable by the daemon.  The number of available CPUs is checked by querying the operating system when the daemon starts. Changes to operating system CPU allocation after the daemon is started are not reflected. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.MemTotal","description":"Total amount of physical memory available on the host, in bytes. ","type":"Number"},{"contentPath":"","contextPath":"Docker.SystemInfo.IndexServerAddress","description":"Address / URL of the index server that is used for image search, and as a default for user authentication for Docker Hub and Docker Cloud. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.HttpProxy","description":"HTTP-proxy configured for the daemon. This value is obtained from the [`HTTP_PROXY`](https://www.gnu.org/software/wget/manual/html_node/Proxies.html) environment variable. Credentials ([user info component](https://tools.ietf.org/html/rfc3986#section-3.2.1)) in the proxy URL are masked in the API response.  Containers do not automatically inherit this configuration. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.HttpsProxy","description":"HTTPS-proxy configured for the daemon. This value is obtained from the [`HTTPS_PROXY`](https://www.gnu.org/software/wget/manual/html_node/Proxies.html) environment variable. Credentials ([user info component](https://tools.ietf.org/html/rfc3986#section-3.2.1)) in the proxy URL are masked in the API response.  Containers do not automatically inherit this configuration. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.NoProxy","description":"Comma-se ted list of domain extensions for which no proxy should be used. This value is obtained from the [`NO_PROXY`](https://www.gnu.org/software/wget/manual/html_node/Proxies.html) environment variable.  Containers do not automatically inherit this configuration. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.Name","description":"Hostname of the host.","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.ExperimentalBuild","description":"Indicates if experimental features are enabled on the daemon. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.ServerVersion","description":"Version string of the daemon.      Note  : the [standalone Swarm API](https://docs.docker.com/swarm/swarm-api/)   returns the Swarm version instead of the daemon  version, for example   `swarm/1.2.8`. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.ClusterStore","description":"URL of the distributed storage backend.   The storage backend is used for multihost networking (to store network and endpoint information) and by the node discovery mechanism.   p    /  /p       Deprecated  : This field is only propagated when using standalone Swarm   mode, and overlay networking using an external k/v store. Overlay   networks with Swarm mode enabled use the built-in raft store, and   this field will be empty. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.ClusterAdvertise","description":"The network endpoint that the Engine advertises for the purpose of node discovery. ClusterAdvertise is a `host:port` combination on which the daemon is reachable by other hosts.   p    /  /p       Deprecated  : This field is only propagated when using standalone Swarm   mode, and overlay networking using an external k/v store. Overlay   networks with Swarm mode enabled use the built-in raft store, and   this field will be empty. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.Runtimes.path","description":"Name and, optional, path, of the OCI executable binary.  If the path is omitted, the daemon searches the host's `$PATH` for the binary and uses the first result. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.DefaultRuntime","description":"Name of the default OCI runtime that is used when starting containers.  The default can be overridden per-container at create time. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.LiveRestoreEnabled","description":"Indicates if live restore is enabled.  If enabled, containers are kept running when the daemon is shutdown or upon daemon start if running containers are detected. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemInfo.Isolation","description":"Represents the isolation technology to use as a default for containers. The supported values are platform-specific.  If no isolation value is specified on daemon start, on Windows client, the default is `hyperv`, and on Windows server, the default is `process`.  This option is currently not used on other platforms. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.InitBinary","description":"Name and, optional, path of the `docker-init` binary.  If the path is omitted, the daemon searches the host's `$PATH` for the binary and uses the first result. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.ProductLicense","description":"Reports a summary of the product license on the daemon.  If a commercial license has been applied to the daemon, information such as number of nodes, and expiration are included. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.DefaultAddressPools.Base","description":"The network address in CIDR format","type":"String"},{"contentPath":"","contextPath":"Docker.SystemInfo.DefaultAddressPools.Size","description":"The network pool size","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Get version","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-system-version","outputs":[{"contentPath":"","contextPath":"Docker.SystemVersion.Components.Name","description":"Name of the component ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.Components.Version","description":"Version of the component ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.Version","description":"The version of the daemon","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.ApiVersion","description":"The default (and highest) API version that is supported by the daemon ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.MinAPIVersion","description":"The minimum API version that is supported by the daemon ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.GitCommit","description":"The Git commit of the source code that was used to build the daemon ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.GoVersion","description":"The version Go used to compile the daemon, and the version of the Go runtime in use. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.Os","description":"The operating system that the daemon is running on (\"linux\" or \"windows\") ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.Arch","description":"The architecture that the daemon is running on ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.KernelVersion","description":"The kernel version (`uname -r`) that the daemon is running on.  This field is omitted when empty. ","type":"String"},{"contentPath":"","contextPath":"Docker.SystemVersion.Experimental","description":"Indicates if the daemon is started with experimental features enabled.  This field is omitted when empty / false. ","type":"Boolean"},{"contentPath":"","contextPath":"Docker.SystemVersion.BuildTime","description":"The date and time that the daemon was compiled. ","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A JSON encoded value of the filters (a `map[string][]string`) to process on the tasks list.  Available filters:  - `desired-state=(running | shutdown | accepted)` - `id= task id ` - `label=key` or `label=\"key=value\"` - `name= task name ` - `node= node id or name ` - `service= service name ` ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List tasks","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-task-list","outputs":[{"contentPath":"","contextPath":"Docker.Task.ID","description":"The ID of the task.","type":"String"},{"contentPath":"","contextPath":"Docker.Task.CreatedAt","description":"Docker Task CreatedAt.","type":"String"},{"contentPath":"","contextPath":"Docker.Task.UpdatedAt","description":"Docker Task UpdatedAt.","type":"String"},{"contentPath":"","contextPath":"Docker.Task.Name","description":"Name of the task.","type":"String"},{"contentPath":"","contextPath":"Docker.Task.ServiceID","description":"The ID of the service this task is part of.","type":"String"},{"contentPath":"","contextPath":"Docker.Task.Slot","description":"Docker Task Slot","type":"Number"},{"contentPath":"","contextPath":"Docker.Task.NodeID","description":"The ID of the node that this task is on.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The new volume's name. If not specified, Docker generates a name. ","name":"volumeconfig_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Name of the volume driver to use.","name":"volumeconfig_driver","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A mapping of driver options and values. These options are passed directly to the driver and are driver specific. ","name":"volumeconfig_driveropts","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User-defined key/value metadata.","name":"volumeconfig_labels","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a volume","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-volume-create","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Volume name or ID","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Inspect a volume","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-volume-inspect","outputs":[{"contentPath":"","contextPath":"Docker.Volume.Name","description":"Name of the volume.","type":"String"},{"contentPath":"","contextPath":"Docker.Volume.Driver","description":"Name of the volume driver used by the volume.","type":"String"},{"contentPath":"","contextPath":"Docker.Volume.Mountpoint","description":"Mount path of the volume on the host.","type":"String"},{"contentPath":"","contextPath":"Docker.Volume.CreatedAt","description":"Date/Time the volume was created.","type":"String"},{"contentPath":"","contextPath":"Docker.Volume.Scope","description":"The level at which the volume exists. Either `global` for cluster-wide, or `local` for machine level. ","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"JSON encoded value of the filters (a `map[string][]string`) to process on the volumes list. Available filters:  - `dangling= boolean ` When set to `true` (or `1`), returns all    volumes that are not in use by a container. When set to `false`    (or `0`), only volumes that are in use by one or more    containers are returned. - `driver= volume-driver-name ` Matches volumes based on their driver. - `label= key ` or `label= key : value ` Matches volumes based on    the presence of a `label` alone or a `label` and a value. - `name= volume-name ` Matches all or part of a volume name. ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List volumes","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-volume-list","outputs":[{"contentPath":"","contextPath":"Docker.VolumeListResponse.Volumes.Name","description":"Name of the volume.","type":"String"},{"contentPath":"","contextPath":"Docker.VolumeListResponse.Volumes.Driver","description":"Name of the volume driver used by the volume.","type":"String"},{"contentPath":"","contextPath":"Docker.VolumeListResponse.Volumes.Mountpoint","description":"Mount path of the volume on the host.","type":"String"},{"contentPath":"","contextPath":"Docker.VolumeListResponse.Volumes.CreatedAt","description":"Date/Time the volume was created.","type":"String"},{"contentPath":"","contextPath":"Docker.VolumeListResponse.Volumes.Scope","description":"The level at which the volume exists. Either `global` for cluster-wide, or `local` for machine level. ","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Filters to process on the prune list, encoded as JSON (a `map[string][]string`).  Available filters: - `label` (`label= key `, `label= key = value `, `label!= key `, or `label!= key = value `) Prune volumes with (or without, in case `label!=...` is used) the specified labels. ","name":"filters","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete unused volumes","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"docker-volume-prune","outputs":[{"contentPath":"","contextPath":"Docker.VolumePruneResponse.SpaceReclaimed","description":"Disk space reclaimed in bytes","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.5.20070","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"import urllib3\n\n\n\n\nclass Client:\n    def __init__(self, server_url, verify, proxy, headers, client_cert, client_key):\n        self._base_url = server_url\n        self._verify = verify\n        self._proxy = proxy\n        self._headers = headers\n        self._client_cert = client_cert\n        self._client_key = client_key\n\n    def _http_request(self, method, url_suffix='', full_url=None, params=None, headers=None, data=None, json_data=None):\n        address = full_url if full_url else urljoin(self._base_url, url_suffix)\n        headers = headers if headers else self._headers\n        client_cert_path = ''\n        client_key_path = ''\n        if self._client_cert:\n            client_cert_path = 'client.cert'\n            with open(client_cert_path, 'wb') as file:\n                file.write(self._client_cert.encode())\n        if self._client_key:\n            client_key_path = 'client_key.key'\n            with open(client_key_path, 'wb') as file:\n                file.write(self._client_key.encode())\n        response = requests.session().request(\n            method,\n            address,\n            verify=self._verify,\n            params=params,\n            data=data,\n            json=json_data,\n            headers=headers,\n            cert=(client_cert_path, client_key_path),\n            timeout=2,\n\n        )\n        if response.headers.get('Content-Type') == 'application/json':\n            return json.loads(response.content)\n        else:\n            return response.content\n\n    def test_request(self):\n        response = self._http_request('get', 'version')\n\n        return response\n\n    def build_prune_request(self, keep_storage, prune_all, filters):\n        params = assign_params(keep_storage=keep_storage, prune_all=prune_all, filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'build/prune', params=params, headers=headers)\n\n        return response\n\n    def config_create_request(self, configspec_name, configspec_labels,\n                              configspec_data, configspec_templating):\n        data = assign_params(Name=configspec_name, Labels=configspec_labels,\n                             Data=configspec_data, Templating=configspec_templating)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'configs/create', json_data=data, headers=headers)\n\n        return response\n\n    def config_inspect_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'configs/{id_}', headers=headers)\n\n        return response\n\n    def config_list_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'configs', params=params, headers=headers)\n\n        return response\n\n    def container_changes_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'containers/{id_}/changes', headers=headers)\n\n        return response\n\n    def container_create_request(self, name, containerconfig_hostname,\n                                 containerconfig_domainname, containerconfig_user,\n                                 containerconfig_attachstdin, containerconfig_attachstdout,\n                                 containerconfig_attachstderr, containerconfig_exposedports,\n                                 containerconfig_tty, containerconfig_openstdin, containerconfig_stdinonce,\n                                 containerconfig_env, containerconfig_cmd, containerconfig_healthcheck,\n                                 containerconfig_argsescaped, containerconfig_image, containerconfig_volumes,\n                                 containerconfig_workingdir, containerconfig_entrypoint,\n                                 containerconfig_networkdisabled, containerconfig_macaddress,\n                                 containerconfig_onbuild, containerconfig_labels,\n                                 containerconfig_stopsignal, containerconfig_stoptimeout,\n                                 containerconfig_shell, hostconfig_binds, hostconfig_containeridfile,\n                                 hostconfig_logconfig, hostconfig_networkmode, hostconfig_portbindings,\n                                 hostconfig_restartpolicy, hostconfig_autoremove, hostconfig_volumedriver,\n                                 hostconfig_volumesfrom, hostconfig_mounts, hostconfig_capadd,\n                                 hostconfig_capdrop, hostconfig_cgroupnsmode, hostconfig_dns,\n                                 hostconfig_dnsoptions, hostconfig_dnssearch, hostconfig_extrahosts,\n                                 hostconfig_groupadd, hostconfig_ipcmode, hostconfig_cgroup, hostconfig_links,\n                                 hostconfig_oomscoreadj, hostconfig_pidmode, hostconfig_privileged,\n                                 hostconfig_publishallports, hostconfig_readonlyrootfs, hostconfig_securityopt,\n                                 hostconfig_storageopt, hostconfig_tmpfs, hostconfig_utsmode,\n                                 hostconfig_usernsmode, hostconfig_shmsize, hostconfig_sysctls,\n                                 hostconfig_runtime, hostconfig_consolesize, hostconfig_isolation,\n                                 hostconfig_maskedpaths, hostconfig_readonlypaths,\n                                 networkingconfig_endpointsconfig):\n        params = assign_params(name=name)\n        data = assign_params(Hostname=containerconfig_hostname, Domainname=containerconfig_domainname,\n                             User=containerconfig_user, AttachStdin=containerconfig_attachstdin,\n                             AttachStdout=containerconfig_attachstdout, AttachStderr=containerconfig_attachstderr,\n                             ExposedPorts=containerconfig_exposedports, Tty=containerconfig_tty,\n                             OpenStdin=containerconfig_openstdin, StdinOnce=containerconfig_stdinonce,\n                             Env=containerconfig_env, Cmd=containerconfig_cmd,\n                             Healthcheck=containerconfig_healthcheck, ArgsEscaped=containerconfig_argsescaped,\n                             Image=containerconfig_image, Volumes=containerconfig_volumes,\n                             WorkingDir=containerconfig_workingdir, Entrypoint=containerconfig_entrypoint,\n                             NetworkDisabled=containerconfig_networkdisabled,\n                             MacAddress=containerconfig_macaddress, OnBuild=containerconfig_onbuild,\n                             Labels=containerconfig_labels, StopSignal=containerconfig_stopsignal,\n                             StopTimeout=containerconfig_stoptimeout, Shell=containerconfig_shell,\n                             Binds=hostconfig_binds, ContainerIDFile=hostconfig_containeridfile,\n                             LogConfig=hostconfig_logconfig, NetworkMode=hostconfig_networkmode,\n                             PortBindings=hostconfig_portbindings, RestartPolicy=hostconfig_restartpolicy,\n                             AutoRemove=hostconfig_autoremove, VolumeDriver=hostconfig_volumedriver,\n                             VolumesFrom=hostconfig_volumesfrom, Mounts=hostconfig_mounts,\n                             CapAdd=hostconfig_capadd, CapDrop=hostconfig_capdrop,\n                             CgroupnsMode=hostconfig_cgroupnsmode, Dns=hostconfig_dns,\n                             DnsOptions=hostconfig_dnsoptions, DnsSearch=hostconfig_dnssearch,\n                             ExtraHosts=hostconfig_extrahosts, GroupAdd=hostconfig_groupadd,\n                             IpcMode=hostconfig_ipcmode, Cgroup=hostconfig_cgroup,\n                             Links=hostconfig_links, OomScoreAdj=hostconfig_oomscoreadj,\n                             PidMode=hostconfig_pidmode, Privileged=hostconfig_privileged,\n                             PublishAllPorts=hostconfig_publishallports,\n                             ReadonlyRootfs=hostconfig_readonlyrootfs, SecurityOpt=hostconfig_securityopt,\n                             StorageOpt=hostconfig_storageopt, Tmpfs=hostconfig_tmpfs,\n                             UTSMode=hostconfig_utsmode, UsernsMode=hostconfig_usernsmode,\n                             ShmSize=hostconfig_shmsize, Sysctls=hostconfig_sysctls,\n                             Runtime=hostconfig_runtime, ConsoleSize=hostconfig_consolesize,\n                             Isolation=hostconfig_isolation, MaskedPaths=hostconfig_maskedpaths,\n                             ReadonlyPaths=hostconfig_readonlypaths,\n                             EndpointsConfig=networkingconfig_endpointsconfig)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'containers/create', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def container_delete_request(self, id_, v, force, link):\n        params = assign_params(v=v, force=force, link=link)\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'containers/{id_}', params=params, headers=headers)\n\n        return response\n\n    def container_exec_request(self, execconfig_attachstdin, execconfig_attachstdout, execconfig_attachstderr,\n                               execconfig_detachkeys, execconfig_tty, execconfig_env,\n                               execconfig_cmd, execconfig_privileged, execconfig_user,\n                               execconfig_workingdir, id_):\n        data = assign_params(AttachStdin=execconfig_attachstdin, AttachStdout=execconfig_attachstdout,\n                             AttachStderr=execconfig_attachstderr, detach_keys=execconfig_detachkeys,\n                             Tty=execconfig_tty, Env=execconfig_env, Cmd=execconfig_cmd,\n                             Privileged=execconfig_privileged, User=execconfig_user,\n                             WorkingDir=execconfig_workingdir)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/exec', json_data=data, headers=headers)\n\n        return response\n\n    def container_export_request(self, id_):\n\n        headers = self._headers\n        headers['Accept'] = 'application/octet-stream'\n\n        response = self._http_request('get', f'containers/{id_}/export', headers=headers)\n\n        return response\n\n    def container_inspect_request(self, id_, size):\n        params = assign_params(size=size)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'containers/{id_}/json', params=params, headers=headers)\n\n        return response\n\n    def container_kill_request(self, id_, signal):\n        params = assign_params(signal=signal)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/kill', params=params, headers=headers)\n\n        return response\n\n    def container_list_request(self, list_all, limit, size, filters):\n        params = assign_params(list_all=list_all, limit=limit, size=size, filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'containers/json', params=params, headers=headers)\n\n        return response\n\n    def container_logs_request(self, id_, follow, stdout, stderr, since, until, timestamps, tail):\n        params = assign_params(follow=follow, stdout=stdout, stderr=stderr, since=since, until=until,\n                               timestamps=timestamps, tail=tail)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'containers/{id_}/logs', params=params, headers=headers)\n\n        return response\n\n    def container_pause_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/pause', headers=headers)\n\n        return response\n\n    def container_prune_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'containers/prune', params=params, headers=headers)\n\n        return response\n\n    def container_rename_request(self, id_, name):\n        params = assign_params(name=name)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/rename', params=params, headers=headers)\n\n        return response\n\n    def container_resize_request(self, id_, h, w):\n        params = assign_params(h=h, w=w)\n\n        headers = self._headers\n        headers['Content-Type'] = 'application/octet-stream'\n        headers['Accept'] = 'text/plain'\n\n        response = self._http_request('post', f'containers/{id_}/resize', params=params, headers=headers)\n\n        return response\n\n    def container_restart_request(self, id_, t):\n        params = assign_params(t=t)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/restart', params=params, headers=headers)\n\n        return response\n\n    def container_start_request(self, id_, detach_keys):\n        params = assign_params(detach_keys=detach_keys)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/start', params=params, headers=headers)\n\n        return response\n\n    def container_stats_request(self, id_, stream, one_shot):\n        params = assign_params(stream=stream, one_shot=one_shot)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'containers/{id_}/stats', params=params, headers=headers)\n\n        return response\n\n    def container_stop_request(self, id_, t):\n        params = assign_params(t=t)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/stop', params=params, headers=headers)\n\n        return response\n\n    def container_top_request(self, id_, ps_args):\n        params = assign_params(ps_args=ps_args)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'containers/{id_}/top', params=params, headers=headers)\n\n        return response\n\n    def container_unpause_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/unpause', headers=headers)\n\n        return response\n\n    def container_update_request(self, id_, resources_cpushares, resources_memory, resources_cgroupparent,\n                                 resources_blkioweight, resources_blkioweightdevice, resources_blkiodevicereadbps,\n                                 resources_blkiodevicewritebps, resources_blkiodevicereadiops,\n                                 resources_blkiodevicewriteiops, resources_cpuperiod, resources_cpuquota,\n                                 resources_cpurealtimeperiod, resources_cpurealtimeruntime, resources_cpusetcpus,\n                                 resources_cpusetmems, resources_devices, resources_devicecgrouprules,\n                                 resources_devicerequests, resources_kernelmemory, resources_kernelmemorytcp,\n                                 resources_memoryreservation, resources_memoryswap, resources_memoryswappiness,\n                                 resources_nanocpus, resources_oomkilldisable, resources_init, resources_pidslimit,\n                                 resources_ulimits, resources_cpucount, resources_cpupercent, resources_iomaximumiops,\n                                 resources_iomaximumbandwidth, restartpolicy_name, restartpolicy_maximumretrycount):\n        data = assign_params(CpuShares=resources_cpushares, Memory=resources_memory,\n                             CgroupParent=resources_cgroupparent, BlkioWeight=resources_blkioweight,\n                             BlkioWeightDevice=resources_blkioweightdevice,\n                             BlkioDeviceReadBps=resources_blkiodevicereadbps,\n                             BlkioDeviceWriteBps=resources_blkiodevicewritebps,\n                             BlkioDeviceReadIOps=resources_blkiodevicereadiops,\n                             BlkioDeviceWriteIOps=resources_blkiodevicewriteiops,\n                             CpuPeriod=resources_cpuperiod, CpuQuota=resources_cpuquota,\n                             CpuRealtimePeriod=resources_cpurealtimeperiod,\n                             CpuRealtimeRuntime=resources_cpurealtimeruntime,\n                             CpusetCpus=resources_cpusetcpus, CpusetMems=resources_cpusetmems,\n                             Devices=resources_devices,\n                             DeviceCgroupRules=resources_devicecgrouprules,\n                             DeviceRequests=resources_devicerequests,\n                             KernelMemory=resources_kernelmemory,\n                             KernelMemoryTCP=resources_kernelmemorytcp,\n                             MemoryReservation=resources_memoryreservation,\n                             MemorySwap=resources_memoryswap,\n                             MemorySwappiness=resources_memoryswappiness,\n                             NanoCPUs=resources_nanocpus, OomKillDisable=resources_oomkilldisable,\n                             Init=resources_init, PidsLimit=resources_pidslimit,\n                             Ulimits=resources_ulimits, CpuCount=resources_cpucount,\n                             CpuPercent=resources_cpupercent, IOMaximumIOps=resources_iomaximumiops,\n                             IOMaximumBandwidth=resources_iomaximumbandwidth,\n                             Name=restartpolicy_name,\n                             MaximumRetryCount=restartpolicy_maximumretrycount)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/update', json_data=data, headers=headers)\n\n        return response\n\n    def container_wait_request(self, id_, condition):\n        params = assign_params(condition=condition)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'containers/{id_}/wait', params=params, headers=headers)\n\n        return response\n\n    def distribution_inspect_request(self, name):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'distribution/{name}/json', headers=headers)\n\n        return response\n\n    def exec_inspect_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'exec/{id_}/json', headers=headers)\n\n        return response\n\n    def exec_resize_request(self, id_, h, w):\n        params = assign_params(h=h, w=w)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'exec/{id_}/resize', params=params, headers=headers)\n\n        return response\n\n    def exec_start_request(self, execstartconfig_detach, execstartconfig_tty, id_):\n        data = assign_params(Detach=execstartconfig_detach, Tty=execstartconfig_tty)\n\n        headers = self._headers\n        headers['Accept'] = 'application/vnd.docker.raw-stream'\n\n        response = self._http_request('post', f'exec/{id_}/start', json_data=data, headers=headers)\n\n        return response\n\n    def image_build_request(self, input_stream, dockerfile, t, extrahosts, remote, q, nocache, cachefrom, pull, rm,\n                            forcerm, memory, memswap, cpushares, cpusetcpus, cpuperiod, cpuquota, buildargs, shmsize,\n                            squash, labels, networkmode, platform, target, outputs):\n        params = assign_params(dockerfile=dockerfile, t=t, extrahosts=extrahosts, remote=remote, q=q, nocache=nocache,\n                               cachefrom=cachefrom, pull=pull, rm=rm, forcerm=forcerm, memory=memory, memswap=memswap,\n                               cpushares=cpushares, cpusetcpus=cpusetcpus, cpuperiod=cpuperiod, cpuquota=cpuquota,\n                               buildargs=buildargs, shmsize=shmsize, squash=squash, labels=labels,\n                               networkmode=networkmode, platform=platform, target=target, outputs=outputs)\n        data = assign_params(input_stream=input_stream)\n\n        headers = self._headers\n        headers['Content-Type'] = 'application/octet-stream'\n\n        response = self._http_request('post', 'build', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def image_commit_request(self, containerconfig_hostname, containerconfig_domainname, containerconfig_user,\n                             containerconfig_attachstdin, containerconfig_attachstdout, containerconfig_attachstderr,\n                             containerconfig_exposedports, containerconfig_tty, containerconfig_openstdin,\n                             containerconfig_stdinonce, containerconfig_env, containerconfig_cmd,\n                             containerconfig_healthcheck, containerconfig_argsescaped, containerconfig_image,\n                             containerconfig_volumes, containerconfig_workingdir, containerconfig_entrypoint,\n                             containerconfig_networkdisabled, containerconfig_macaddress, containerconfig_onbuild,\n                             containerconfig_labels, containerconfig_stopsignal, containerconfig_stoptimeout,\n                             containerconfig_shell, container, repo, tag, comment, author, pause, changes):\n        params = assign_params(container=container, repo=repo, tag=tag, comment=comment, author=author, pause=pause,\n                               changes=changes)\n        data = assign_params(Hostname=containerconfig_hostname, Domainname=containerconfig_domainname,\n                             User=containerconfig_user, AttachStdin=containerconfig_attachstdin,\n                             AttachStdout=containerconfig_attachstdout, AttachStderr=containerconfig_attachstderr,\n                             ExposedPorts=containerconfig_exposedports, Tty=containerconfig_tty,\n                             OpenStdin=containerconfig_openstdin, StdinOnce=containerconfig_stdinonce,\n                             Env=containerconfig_env, Cmd=containerconfig_cmd,\n                             Healthcheck=containerconfig_healthcheck,\n                             ArgsEscaped=containerconfig_argsescaped,\n                             Image=containerconfig_image, Volumes=containerconfig_volumes,\n                             WorkingDir=containerconfig_workingdir, Entrypoint=containerconfig_entrypoint,\n                             NetworkDisabled=containerconfig_networkdisabled,\n                             MacAddress=containerconfig_macaddress, OnBuild=containerconfig_onbuild,\n                             Labels=containerconfig_labels, StopSignal=containerconfig_stopsignal,\n                             StopTimeout=containerconfig_stoptimeout, Shell=containerconfig_shell)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'commit', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def image_create_request(self, from_image, from_src, repo, tag, message, input_image, platform):\n        params = assign_params(from_image=from_image, from_src=from_src, repo=repo, tag=tag, message=message,\n                               platform=platform)\n        data = assign_params(input_image=input_image)\n\n        headers = self._headers\n        headers['Content-Type'] = 'text/plain'\n\n        response = self._http_request('post', 'images/create', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def image_delete_request(self, name, force, noprune):\n        params = assign_params(force=force, noprune=noprune)\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'images/{name}', params=params, headers=headers)\n\n        return response\n\n    def image_get_request(self, name):\n\n        headers = self._headers\n        headers['Accept'] = 'application/x-tar'\n\n        response = self._http_request('get', f'images/{name}/get', headers=headers)\n\n        return response\n\n    def image_get_all_request(self, names):\n        params = assign_params(names=names)\n\n        headers = self._headers\n        headers['Accept'] = 'application/x-tar'\n\n        response = self._http_request('get', 'images/get', params=params, headers=headers)\n\n        return response\n\n    def image_history_request(self, name):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'images/{name}/history', headers=headers)\n\n        return response\n\n    def image_inspect_request(self, name):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'images/{name}/json', headers=headers)\n\n        return response\n\n    def image_list_request(self, prune_all, filters, digests):\n        params = assign_params(prune_all=prune_all, filters=filters, digests=digests)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'images/json', params=params, headers=headers)\n\n        return response\n\n    def image_load_request(self, images_tarball, quiet):\n        params = assign_params(quiet=quiet)\n        data = assign_params(images_tarball=images_tarball)\n\n        headers = self._headers\n        headers['Content-Type'] = 'application/x-tar'\n\n        response = self._http_request('post', 'images/load', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def image_prune_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'images/prune', params=params, headers=headers)\n\n        return response\n\n    def image_push_request(self, name, tag):\n        params = assign_params(tag=tag)\n\n        headers = self._headers\n        headers['Content-Type'] = 'application/octet-stream'\n\n        response = self._http_request('post', f'images/{name}/push', params=params, headers=headers)\n\n        return response\n\n    def image_search_request(self, term, limit, filters):\n        params = assign_params(term=term, limit=limit, filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'images/search', params=params, headers=headers)\n\n        return response\n\n    def image_tag_request(self, name, repo, tag):\n        params = assign_params(repo=repo, tag=tag)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'images/{name}/tag', params=params, headers=headers)\n\n        return response\n\n    def network_connect_request(self, id_, container_container, container_endpointconfig):\n        data = assign_params(Container=container_container, EndpointConfig=container_endpointconfig)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'networks/{id_}/connect', json_data=data, headers=headers)\n\n        return response\n\n    def network_create_request(self, networkconfig_name, networkconfig_checkduplicate, networkconfig_driver,\n                               networkconfig_internal, networkconfig_attachable, networkconfig_ingress,\n                               networkconfig_ipam, networkconfig_enableipv6, networkconfig_options,\n                               networkconfig_labels):\n        data = assign_params(Name=networkconfig_name, CheckDuplicate=networkconfig_checkduplicate,\n                             Driver=networkconfig_driver, Internal=networkconfig_internal,\n                             Attachable=networkconfig_attachable, Ingress=networkconfig_ingress,\n                             IPAM=networkconfig_ipam, EnableIPv6=networkconfig_enableipv6,\n                             Options=networkconfig_options, Labels=networkconfig_labels)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'networks/create', json_data=data, headers=headers)\n\n        return response\n\n    def network_delete_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'networks/{id_}', headers=headers)\n\n        return response\n\n    def network_disconnect_request(self, id_, container, force):\n        data = assign_params(Container=container, Force=force)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'networks/{id_}/disconnect', json_data=data, headers=headers)\n\n        return response\n\n    def network_inspect_request(self, id_, verbose, scope):\n        params = assign_params(verbose=verbose, scope=scope)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'networks/{id_}', params=params, headers=headers)\n\n        return response\n\n    def network_list_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'networks', params=params, headers=headers)\n\n        return response\n\n    def network_prune_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'networks/prune', params=params, headers=headers)\n\n        return response\n\n    def node_delete_request(self, id_, force):\n        params = assign_params(force=force)\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'nodes/{id_}', params=params, headers=headers)\n\n        return response\n\n    def node_inspect_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'nodes/{id_}', headers=headers)\n\n        return response\n\n    def node_list_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'nodes', params=params, headers=headers)\n\n        return response\n\n    def node_update_request(self, id_, nodespec_name, nodespec_labels, nodespec_role, nodespec_availability, version):\n        params = assign_params(version=version)\n        data = assign_params(Name=nodespec_name, Labels=nodespec_labels, Role=nodespec_role,\n                             Availability=nodespec_availability)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'nodes/{id_}/update', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def secret_create_request(self, secretspec_name, secretspec_labels, secretspec_data, secretspec_driver,\n                              secretspec_templating):\n        data = assign_params(Name=secretspec_name, Labels=secretspec_labels, Data=secretspec_data,\n                             Driver=secretspec_driver, Templating=secretspec_templating)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'secrets/create', json_data=data, headers=headers)\n\n        return response\n\n    def secret_delete_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'secrets/{id_}', headers=headers)\n\n        return response\n\n    def secret_inspect_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'secrets/{id_}', headers=headers)\n\n        return response\n\n    def secret_list_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'secrets', params=params, headers=headers)\n\n        return response\n\n    def secret_update_request(self, id_, secretspec_name, secretspec_labels, secretspec_data, secretspec_driver,\n                              secretspec_templating, version):\n        params = assign_params(version=version)\n        data = assign_params(Name=secretspec_name, Labels=secretspec_labels, Data=secretspec_data,\n                             Driver=secretspec_driver, Templating=secretspec_templating)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'secrets/{id_}/update', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def service_create_request(self, servicespec_name, servicespec_labels, servicespec_tasktemplate, servicespec_mode,\n                               servicespec_updateconfig, servicespec_rollbackconfig, servicespec_networks,\n                               servicespec_endpointspec):\n        data = assign_params(Name=servicespec_name, Labels=servicespec_labels, TaskTemplate=servicespec_tasktemplate,\n                             Mode=servicespec_mode, UpdateConfig=servicespec_updateconfig,\n                             RollbackConfig=servicespec_rollbackconfig, Networks=servicespec_networks,\n                             EndpointSpec=servicespec_endpointspec)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'services/create', json_data=data, headers=headers)\n\n        return response\n\n    def service_delete_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'services/{id_}', headers=headers)\n\n        return response\n\n    def service_inspect_request(self, id_, insert_defaults):\n        params = assign_params(insert_defaults=insert_defaults)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'services/{id_}', params=params, headers=headers)\n\n        return response\n\n    def service_list_request(self, filters, status):\n        params = assign_params(filters=filters, status=status)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'services', params=params, headers=headers)\n\n        return response\n\n    def service_logs_request(self, id_, details, follow, stdout, stderr, since, timestamps, tail):\n        params = assign_params(details=details, follow=follow, stdout=stdout, stderr=stderr, since=since,\n                               timestamps=timestamps, tail=tail)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'services/{id_}/logs', params=params, headers=headers)\n\n        return response\n\n    def service_update_request(self, id_, servicespec_name, servicespec_labels, servicespec_tasktemplate,\n                               servicespec_mode, servicespec_updateconfig, servicespec_rollbackconfig,\n                               servicespec_networks, servicespec_endpointspec, version, registery_auth_from, rollback):\n        params = assign_params(version=version, registery_auth_from=registery_auth_from, rollback=rollback)\n        data = assign_params(Name=servicespec_name, Labels=servicespec_labels, TaskTemplate=servicespec_tasktemplate,\n                             Mode=servicespec_mode, UpdateConfig=servicespec_updateconfig,\n                             RollbackConfig=servicespec_rollbackconfig, Networks=servicespec_networks,\n                             EndpointSpec=servicespec_endpointspec)\n\n        headers = self._headers\n\n        response = self._http_request('post', f'services/{id_}/update', params=params, json_data=data, headers=headers)\n\n        return response\n\n    def session_request(self):\n\n        headers = self._headers\n        headers['Accept'] = 'application/vnd.docker.raw-stream'\n\n        response = self._http_request('post', 'session', headers=headers)\n\n        return response\n\n    def swarm_init_request(self, listenaddr, advertiseaddr, datapathaddr, datapathport,\n                           defaultaddrpool, forcenewcluster, subnetsize, spec):\n        data = assign_params(ListenAddr=listenaddr, AdvertiseAddr=advertiseaddr,\n                             DataPathAddr=datapathaddr, DataPathPort=datapathport,\n                             DefaultAddrPool=defaultaddrpool, ForceNewCluster=forcenewcluster,\n                             SubnetSize=subnetsize, Spec=spec)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'swarm/init', json_data=data, headers=headers)\n\n        return response\n\n    def swarm_inspect_request(self):\n\n        headers = self._headers\n\n        response = self._http_request('get', 'swarm', headers=headers)\n\n        return response\n\n    def swarm_join_request(self, listenaddr, advertiseaddr, datapathaddr, remoteaddrs,\n                           jointoken):\n        data = assign_params(ListenAddr=listenaddr, AdvertiseAddr=advertiseaddr,\n                             DataPathAddr=datapathaddr, RemoteAddrs=remoteaddrs,\n                             JoinToken=jointoken)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'swarm/join', json_data=data, headers=headers)\n\n        return response\n\n    def swarm_leave_request(self, force):\n        params = assign_params(force=force)\n        headers = self._headers\n\n        response = self._http_request('post', 'swarm/leave', params=params, headers=headers)\n\n        return response\n\n    def swarm_unlock_request(self, unlockkey):\n        data = assign_params(UnlockKey=unlockkey)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'swarm/unlock', json_data=data, headers=headers)\n\n        return response\n\n    def swarm_unlockkey_request(self):\n\n        headers = self._headers\n\n        response = self._http_request('get', 'swarm/unlockkey', headers=headers)\n\n        return response\n\n    def system_auth_request(self, authconfig_username, authconfig_password, authconfig_email, authconfig_serveraddress):\n        data = assign_params(username=authconfig_username, password=authconfig_password, email=authconfig_email,\n                             serveraddress=authconfig_serveraddress)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'auth', json_data=data, headers=headers)\n\n        return response\n\n    def system_data_usage_request(self):\n\n        headers = self._headers\n\n        response = self._http_request('get', 'system/df', headers=headers)\n\n        return response\n\n    def system_events_request(self, since, until, filters):\n        params = assign_params(since=since, until=until, filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'events', params=params, headers=headers)\n\n        return response\n\n    def system_info_request(self):\n\n        headers = self._headers\n\n        response = self._http_request('get', 'info', headers=headers)\n\n        return response\n\n    def system_ping_request(self):\n\n        headers = self._headers\n        headers['Accept'] = 'text/plain'\n\n        response = self._http_request('get', '_ping', headers=headers)\n\n        return response\n\n    def system_ping_head_request(self):\n\n        headers = self._headers\n        headers['Accept'] = 'text/plain'\n\n        response = self._http_request('head', '_ping', headers=headers)\n\n        return response\n\n    def system_version_request(self):\n\n        headers = self._headers\n\n        response = self._http_request('get', 'version', headers=headers)\n\n        return response\n\n    def task_inspect_request(self, id_):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'tasks/{id_}', headers=headers)\n\n        return response\n\n    def task_list_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'tasks', params=params, headers=headers)\n\n        return response\n\n    def task_logs_request(self, id_, details, follow, stdout, stderr, since, timestamps, tail):\n        params = assign_params(details=details, follow=follow, stdout=stdout, stderr=stderr, since=since,\n                               timestamps=timestamps, tail=tail)\n\n        headers = self._headers\n\n        response = self._http_request('get', f'tasks/{id_}/logs', params=params, headers=headers)\n\n        return response\n\n    def volume_create_request(self, volumeconfig_name, volumeconfig_driver, volumeconfig_driveropts,\n                              volumeconfig_labels):\n        data = assign_params(Name=volumeconfig_name, Driver=volumeconfig_driver, DriverOpts=volumeconfig_driveropts,\n                             Labels=volumeconfig_labels)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'volumes/create', json_data=data, headers=headers)\n\n        return response\n\n    def volume_delete_request(self, name, force):\n        params = assign_params(force=force)\n\n        headers = self._headers\n\n        response = self._http_request('delete', f'volumes/{name}', params=params, headers=headers)\n\n        return response\n\n    def volume_inspect_request(self, name):\n\n        headers = self._headers\n\n        response = self._http_request('get', f'volumes/{name}', headers=headers)\n\n        return response\n\n    def volume_list_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('get', 'volumes', params=params, headers=headers)\n\n        return response\n\n    def volume_prune_request(self, filters):\n        params = assign_params(filters=filters)\n\n        headers = self._headers\n\n        response = self._http_request('post', 'volumes/prune', params=params, headers=headers)\n\n        return response\n\n\ndef build_prune_command(client, args):\n    keep_storage = args.get('keep_storage', None)\n    prune_all = argToBoolean(args.get('prune_all', False))\n    filters = str(args.get('filters', ''))\n\n    response = client.build_prune_request(keep_storage, prune_all, filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.BuildPruneResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef config_create_command(client, args):\n    configspec_name = str(args.get('configspec_name', ''))\n    configspec_labels = str(args.get('configspec_labels', ''))\n    configspec_data = str(args.get('configspec_data', ''))\n    configspec_templating_name = str(args.get('configspec_templating_name', ''))\n    configspec_templating_options = str(args.get('configspec_templating_options', ''))\n    configspec_templating = assign_params(Name=configspec_templating_name, Options=configspec_templating_options)\n\n    response = client.config_create_request(configspec_name, configspec_labels, configspec_data, configspec_templating)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef config_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.config_inspect_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Config',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef config_list_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.config_list_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Config',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_changes_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.container_changes_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerChangeResponseItem',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_create_command(client, args):\n    name = str(args.get('name', ''))\n    containerconfig_hostname = str(args.get('containerconfig_hostname', ''))\n    containerconfig_domainname = str(args.get('containerconfig_domainname', ''))\n    containerconfig_user = str(args.get('containerconfig_user', ''))\n    containerconfig_attachstdin = argToBoolean(args.get('containerconfig_attachstdin', False))\n    containerconfig_attachstdout = argToBoolean(args.get('containerconfig_attachstdout', False))\n    containerconfig_attachstderr = argToBoolean(args.get('containerconfig_attachstderr', False))\n    containerconfig_exposedports = str(args.get('containerconfig_exposedports', ''))\n    containerconfig_tty = argToBoolean(args.get('containerconfig_tty', False))\n    containerconfig_openstdin = argToBoolean(args.get('containerconfig_openstdin', False))\n    containerconfig_stdinonce = argToBoolean(args.get('containerconfig_stdinonce', False))\n    containerconfig_env = argToList(args.get('containerconfig_env', []))\n    containerconfig_cmd = argToList(args.get('containerconfig_cmd', []))\n    containerconfig_healthcheck_test = str(args.get('containerconfig_healthcheck_test', ''))\n    containerconfig_healthcheck_interval = args.get('containerconfig_healthcheck_interval', None)\n    containerconfig_healthcheck_timeout = args.get('containerconfig_healthcheck_timeout', None)\n    containerconfig_healthcheck_retries = args.get('containerconfig_healthcheck_retries', None)\n    containerconfig_healthcheck_startperiod = args.get('containerconfig_healthcheck_startperiod', None)\n    containerconfig_healthcheck = assign_params(Test=containerconfig_healthcheck_test,\n                                                Interval=containerconfig_healthcheck_interval,\n                                                Timeout=containerconfig_healthcheck_timeout,\n                                                Retries=containerconfig_healthcheck_retries,\n                                                StartPeriod=containerconfig_healthcheck_startperiod)\n    containerconfig_argsescaped = argToBoolean(args.get('containerconfig_argsescaped', False))\n    containerconfig_image = str(args.get('containerconfig_image', ''))\n    containerconfig_volumes = str(args.get('containerconfig_volumes', ''))\n    containerconfig_workingdir = str(args.get('containerconfig_workingdir', ''))\n    containerconfig_entrypoint = argToList(args.get('containerconfig_entrypoint', []))\n    containerconfig_networkdisabled = argToBoolean(args.get('containerconfig_networkdisabled', False))\n    containerconfig_macaddress = str(args.get('containerconfig_macaddress', ''))\n    containerconfig_onbuild = argToList(args.get('containerconfig_onbuild', []))\n    containerconfig_labels = str(args.get('containerconfig_labels', ''))\n    containerconfig_stopsignal = str(args.get('containerconfig_stopsignal', 'SIGTERM'))\n    containerconfig_stoptimeout = args.get('containerconfig_stoptimeout', None)\n    containerconfig_shell = argToList(args.get('containerconfig_shell', []))\n    hostconfig_binds = argToList(args.get('hostconfig_binds', []))\n    hostconfig_containeridfile = str(args.get('hostconfig_containeridfile', ''))\n    hostconfig_logconfig_type = str(args.get('hostconfig_logconfig_type', ''))\n    hostconfig_logconfig_config = str(args.get('hostconfig_logconfig_config', ''))\n    hostconfig_logconfig = assign_params(Type=hostconfig_logconfig_type, Config=hostconfig_logconfig_config)\n    hostconfig_networkmode = str(args.get('hostconfig_networkmode', ''))\n    hostconfig_portbindings = str(args.get('hostconfig_portbindings', ''))\n    hostconfig_restartpolicy_name = str(args.get('hostconfig_restartpolicy_name', ''))\n    hostconfig_restartpolicy_maximumretrycount = args.get('hostconfig_restartpolicy_maximumretrycount', None)\n    hostconfig_restartpolicy = assign_params(Name=hostconfig_restartpolicy_name,\n                                             MaximumRetryCount=hostconfig_restartpolicy_maximumretrycount)\n    hostconfig_autoremove = argToBoolean(args.get('hostconfig_autoremove', False))\n    hostconfig_volumedriver = str(args.get('hostconfig_volumedriver', ''))\n    hostconfig_volumesfrom = argToList(args.get('hostconfig_volumesfrom', []))\n    hostconfig_mounts = argToList(args.get('hostconfig_mounts', []))\n    hostconfig_capadd = argToList(args.get('hostconfig_capadd', []))\n    hostconfig_capdrop = argToList(args.get('hostconfig_capdrop', []))\n    hostconfig_cgroupnsmode = str(args.get('hostconfig_cgroupnsmode', ''))\n    hostconfig_dns = argToList(args.get('hostconfig_dns', []))\n    hostconfig_dnsoptions = argToList(args.get('hostconfig_dnsoptions', []))\n    hostconfig_dnssearch = argToList(args.get('hostconfig_dnssearch', []))\n    hostconfig_extrahosts = argToList(args.get('hostconfig_extrahosts', []))\n    hostconfig_groupadd = argToList(args.get('hostconfig_groupadd', []))\n    hostconfig_ipcmode = str(args.get('hostconfig_ipcmode', ''))\n    hostconfig_cgroup = str(args.get('hostconfig_cgroup', ''))\n    hostconfig_links = argToList(args.get('hostconfig_links', []))\n    hostconfig_oomscoreadj = args.get('hostconfig_oomscoreadj', None)\n    hostconfig_pidmode = str(args.get('hostconfig_pidmode', ''))\n    hostconfig_privileged = argToBoolean(args.get('hostconfig_privileged', False))\n    hostconfig_publishallports = argToBoolean(args.get('hostconfig_publishallports', False))\n    hostconfig_readonlyrootfs = argToBoolean(args.get('hostconfig_readonlyrootfs', False))\n    hostconfig_securityopt = argToList(args.get('hostconfig_securityopt', []))\n    hostconfig_storageopt = str(args.get('hostconfig_storageopt', ''))\n    hostconfig_tmpfs = str(args.get('hostconfig_tmpfs', ''))\n    hostconfig_utsmode = str(args.get('hostconfig_utsmode', ''))\n    hostconfig_usernsmode = str(args.get('hostconfig_usernsmode', ''))\n    hostconfig_shmsize = args.get('hostconfig_shmsize', None)\n    hostconfig_sysctls = str(args.get('hostconfig_sysctls', ''))\n    hostconfig_runtime = str(args.get('hostconfig_runtime', ''))\n    hostconfig_consolesize = argToList(args.get('hostconfig_consolesize', []))\n    hostconfig_isolation = str(args.get('hostconfig_isolation', ''))\n    hostconfig_maskedpaths = argToList(args.get('hostconfig_maskedpaths', []))\n    hostconfig_readonlypaths = argToList(args.get('hostconfig_readonlypaths', []))\n    networkingconfig_endpointsconfig = str(args.get('networkingconfig_endpointsconfig', ''))\n\n    response = client.container_create_request(name, containerconfig_hostname, containerconfig_domainname,\n                                               containerconfig_user,\n                                               containerconfig_attachstdin,\n                                               containerconfig_attachstdout,\n                                               containerconfig_attachstderr,\n                                               containerconfig_exposedports,\n                                               containerconfig_tty,\n                                               containerconfig_openstdin,\n                                               containerconfig_stdinonce,\n                                               containerconfig_env,\n                                               containerconfig_cmd,\n                                               containerconfig_healthcheck,\n                                               containerconfig_argsescaped,\n                                               containerconfig_image,\n                                               containerconfig_volumes,\n                                               containerconfig_workingdir,\n                                               containerconfig_entrypoint,\n                                               containerconfig_networkdisabled,\n                                               containerconfig_macaddress,\n                                               containerconfig_onbuild,\n                                               containerconfig_labels,\n                                               containerconfig_stopsignal,\n                                               containerconfig_stoptimeout,\n                                               containerconfig_shell,\n                                               hostconfig_binds,\n                                               hostconfig_containeridfile,\n                                               hostconfig_logconfig,\n                                               hostconfig_networkmode,\n                                               hostconfig_portbindings,\n                                               hostconfig_restartpolicy,\n                                               hostconfig_autoremove,\n                                               hostconfig_volumedriver,\n                                               hostconfig_volumesfrom,\n                                               hostconfig_mounts,\n                                               hostconfig_capadd,\n                                               hostconfig_capdrop,\n                                               hostconfig_cgroupnsmode,\n                                               hostconfig_dns,\n                                               hostconfig_dnsoptions,\n                                               hostconfig_dnssearch,\n                                               hostconfig_extrahosts,\n                                               hostconfig_groupadd,\n                                               hostconfig_ipcmode,\n                                               hostconfig_cgroup,\n                                               hostconfig_links,\n                                               hostconfig_oomscoreadj,\n                                               hostconfig_pidmode,\n                                               hostconfig_privileged,\n                                               hostconfig_publishallports,\n                                               hostconfig_readonlyrootfs,\n                                               hostconfig_securityopt,\n                                               hostconfig_storageopt,\n                                               hostconfig_tmpfs,\n                                               hostconfig_utsmode,\n                                               hostconfig_usernsmode,\n                                               hostconfig_shmsize,\n                                               hostconfig_sysctls,\n                                               hostconfig_runtime,\n                                               hostconfig_consolesize,\n                                               hostconfig_isolation,\n                                               hostconfig_maskedpaths,\n                                               hostconfig_readonlypaths,\n                                               networkingconfig_endpointsconfig)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_delete_command(client, args):\n    id_ = str(args.get('id', ''))\n    v = argToBoolean(args.get('v', False))\n    force = argToBoolean(args.get('force', False))\n    link = argToBoolean(args.get('link', False))\n\n    response = client.container_delete_request(id_, v, force, link)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_exec_command(client, args):\n    execconfig_attachstdin = argToBoolean(args.get('execconfig_attachstdin', False))\n    execconfig_attachstdout = argToBoolean(args.get('execconfig_attachstdout', False))\n    execconfig_attachstderr = argToBoolean(args.get('execconfig_attachstderr', False))\n    execconfig_detachkeys = str(args.get('execconfig_detachkeys', ''))\n    execconfig_tty = argToBoolean(args.get('execconfig_tty', False))\n    execconfig_env = argToList(args.get('execconfig_env', []))\n    execconfig_cmd = argToList(args.get('execconfig_cmd', []))\n    execconfig_privileged = argToBoolean(args.get('execconfig_privileged', False))\n    execconfig_user = str(args.get('execconfig_user', ''))\n    execconfig_workingdir = str(args.get('execconfig_workingdir', ''))\n    id_ = str(args.get('id', ''))\n\n    response = client.container_exec_request(execconfig_attachstdin, execconfig_attachstdout, execconfig_attachstderr,\n                                             execconfig_detachkeys, execconfig_tty,\n                                             execconfig_env, execconfig_cmd,\n                                             execconfig_privileged, execconfig_user,\n                                             execconfig_workingdir, id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_export_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.container_export_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n    size = argToBoolean(args.get('size', False))\n\n    response = client.container_inspect_request(id_, size)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerInspectResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_kill_command(client, args):\n    id_ = str(args.get('id', ''))\n    signal = str(args.get('signal', 'SIGKILL'))\n\n    response = client.container_kill_request(id_, signal)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_list_command(client, args):\n    list_all = argToBoolean(args.get('list_all', False))\n    limit = args.get('limit', None)\n    size = argToBoolean(args.get('size', False))\n    filters = str(args.get('filters', ''))\n\n    response = client.container_list_request(list_all, limit, size, filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerSummary',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_logs_command(client, args):\n    id_ = str(args.get('id', ''))\n    follow = argToBoolean(args.get('follow', False))\n    stdout = argToBoolean(args.get('stdout', False))\n    stderr = argToBoolean(args.get('stderr', False))\n    since = int(args.get('since', 0))\n    until = int(args.get('until', 0))\n    timestamps = argToBoolean(args.get('timestamps', False))\n    tail = str(args.get('tail', 'all'))\n\n    response = client.container_logs_request(id_, follow, stdout, stderr, since, until, timestamps, tail)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_pause_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.container_pause_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_prune_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.container_prune_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerPruneResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_rename_command(client, args):\n    id_ = str(args.get('id', ''))\n    name = str(args.get('name', ''))\n\n    response = client.container_rename_request(id_, name)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_resize_command(client, args):\n    id_ = str(args.get('id', ''))\n    h = args.get('h', None)\n    w = args.get('w', None)\n\n    response = client.container_resize_request(id_, h, w)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_restart_command(client, args):\n    id_ = str(args.get('id', ''))\n    t = args.get('t', None)\n\n    response = client.container_restart_request(id_, t)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_start_command(client, args):\n    id_ = str(args.get('id', ''))\n    detach_keys = str(args.get('detach_keys', ''))\n\n    response = client.container_start_request(id_, detach_keys)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_stats_command(client, args):\n    id_ = str(args.get('id', ''))\n    stream = argToBoolean(args.get('stream', False))\n    one_shot = argToBoolean(args.get('one_shot', False))\n\n    response = client.container_stats_request(id_, stream, one_shot)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_stop_command(client, args):\n    id_ = str(args.get('id', ''))\n    t = args.get('t', None)\n\n    response = client.container_stop_request(id_, t)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_top_command(client, args):\n    id_ = str(args.get('id', ''))\n    ps_args = str(args.get('ps_args', '-ef'))\n\n    response = client.container_top_request(id_, ps_args)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerTopResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_unpause_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.container_unpause_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_update_command(client, args):\n    id_ = str(args.get('id', ''))\n    resources_cpushares = args.get('resources_cpushares', None)\n    resources_memory = int(args.get('resources_memory', 0))\n    resources_cgroupparent = str(args.get('resources_cgroupparent', ''))\n    resources_blkioweight = args.get('resources_blkioweight', None)\n    resources_blkioweightdevice = argToList(args.get('resources_blkioweightdevice', []))\n    resources_blkiodevicereadbps = argToList(args.get('resources_blkiodevicereadbps', []))\n    resources_blkiodevicewritebps = argToList(args.get('resources_blkiodevicewritebps', []))\n    resources_blkiodevicereadiops = argToList(args.get('resources_blkiodevicereadiops', []))\n    resources_blkiodevicewriteiops = argToList(args.get('resources_blkiodevicewriteiops', []))\n    resources_cpuperiod = args.get('resources_cpuperiod', None)\n    resources_cpuquota = args.get('resources_cpuquota', None)\n    resources_cpurealtimeperiod = args.get('resources_cpurealtimeperiod', None)\n    resources_cpurealtimeruntime = args.get('resources_cpurealtimeruntime', None)\n    resources_cpusetcpus = str(args.get('resources_cpusetcpus', ''))\n    resources_cpusetmems = str(args.get('resources_cpusetmems', ''))\n    resources_devices = argToList(args.get('resources_devices', []))\n    resources_devicecgrouprules = argToList(args.get('resources_devicecgrouprules', []))\n    resources_devicerequests = argToList(args.get('resources_devicerequests', []))\n    resources_kernelmemory = args.get('resources_kernelmemory', None)\n    resources_kernelmemorytcp = args.get('resources_kernelmemorytcp', None)\n    resources_memoryreservation = args.get('resources_memoryreservation', None)\n    resources_memoryswap = args.get('resources_memoryswap', None)\n    resources_memoryswappiness = args.get('resources_memoryswappiness', None)\n    resources_nanocpus = args.get('resources_nanocpus', None)\n    resources_oomkilldisable = argToBoolean(args.get('resources_oomkilldisable', False))\n    resources_init = argToBoolean(args.get('resources_init', False))\n    resources_pidslimit = args.get('resources_pidslimit', None)\n    resources_ulimits = argToList(args.get('resources_ulimits', []))\n    resources_cpucount = args.get('resources_cpucount', None)\n    resources_cpupercent = args.get('resources_cpupercent', None)\n    resources_iomaximumiops = args.get('resources_iomaximumiops', None)\n    resources_iomaximumbandwidth = args.get('resources_iomaximumbandwidth', None)\n    restartpolicy_name = str(args.get('restartpolicy_name', ''))\n    restartpolicy_maximumretrycount = args.get('restartpolicy_maximumretrycount', None)\n\n    response = client.container_update_request(id_, resources_cpushares, resources_memory, resources_cgroupparent,\n                                               resources_blkioweight,\n                                               resources_blkioweightdevice,\n                                               resources_blkiodevicereadbps,\n                                               resources_blkiodevicewritebps,\n                                               resources_blkiodevicereadiops,\n                                               resources_blkiodevicewriteiops,\n                                               resources_cpuperiod,\n                                               resources_cpuquota,\n                                               resources_cpurealtimeperiod,\n                                               resources_cpurealtimeruntime,\n                                               resources_cpusetcpus,\n                                               resources_cpusetmems,\n                                               resources_devices,\n                                               resources_devicecgrouprules,\n                                               resources_devicerequests,\n                                               resources_kernelmemory,\n                                               resources_kernelmemorytcp,\n                                               resources_memoryreservation,\n                                               resources_memoryswap,\n                                               resources_memoryswappiness,\n                                               resources_nanocpus,\n                                               resources_oomkilldisable,\n                                               resources_init, resources_pidslimit,\n                                               resources_ulimits, resources_cpucount,\n                                               resources_cpupercent,\n                                               resources_iomaximumiops,\n                                               resources_iomaximumbandwidth,\n                                               restartpolicy_name,\n                                               restartpolicy_maximumretrycount)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerUpdateResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef container_wait_command(client, args):\n    id_ = str(args.get('id', ''))\n    condition = str(args.get('condition', 'not-running'))\n\n    response = client.container_wait_request(id_, condition)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ContainerWaitResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef distribution_inspect_command(client, args):\n    name = str(args.get('name', ''))\n\n    response = client.distribution_inspect_request(name)\n    command_results = CommandResults(\n        outputs_prefix='Docker.DistributionInspectResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef exec_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.exec_inspect_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ExecInspectResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef exec_resize_command(client, args):\n    id_ = str(args.get('id', ''))\n    h = args.get('h', None)\n    w = args.get('w', None)\n\n    response = client.exec_resize_request(id_, h, w)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef exec_start_command(client, args):\n    execstartconfig_detach = argToBoolean(args.get('execstartconfig_detach', False))\n    execstartconfig_tty = argToBoolean(args.get('execstartconfig_tty', False))\n    id_ = str(args.get('id', ''))\n\n    response = client.exec_start_request(execstartconfig_detach, execstartconfig_tty, id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_plugin_privileges_command(client, args):\n    remote = str(args.get('remote', ''))\n\n    response = client.get_plugin_privileges_request(remote)\n    command_results = CommandResults(\n        outputs_prefix='Docker.PluginPrivilegeItem',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_build_command(client, args):\n    input_stream = str(args.get('input_stream', ''))\n    dockerfile = str(args.get('dockerfile', 'Dockerfile'))\n    t = str(args.get('t', ''))\n    extrahosts = str(args.get('extrahosts', ''))\n    remote = str(args.get('remote', ''))\n    q = argToBoolean(args.get('q', False))\n    nocache = argToBoolean(args.get('nocache', False))\n    cachefrom = str(args.get('cachefrom', ''))\n    pull = str(args.get('pull', ''))\n    rm = argToBoolean(args.get('rm', False))\n    forcerm = argToBoolean(args.get('forcerm', False))\n    memory = args.get('memory', None)\n    memswap = args.get('memswap', None)\n    cpushares = args.get('cpushares', None)\n    cpusetcpus = str(args.get('cpusetcpus', ''))\n    cpuperiod = args.get('cpuperiod', None)\n    cpuquota = args.get('cpuquota', None)\n    buildargs = str(args.get('buildargs', ''))\n    shmsize = args.get('shmsize', None)\n    squash = argToBoolean(args.get('squash', False))\n    labels = str(args.get('labels', ''))\n    networkmode = str(args.get('networkmode', ''))\n    platform = str(args.get('platform', ''))\n    target = str(args.get('target', ''))\n    outputs = str(args.get('outputs', ''))\n\n    response = client.image_build_request(input_stream, dockerfile, t, extrahosts, remote, q, nocache, cachefrom, pull,\n                                          rm, forcerm, memory, memswap, cpushares,\n                                          cpusetcpus, cpuperiod, cpuquota, buildargs,\n                                          shmsize, squash, labels, networkmode,\n                                          platform, target, outputs)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_commit_command(client, args):\n    containerconfig_hostname = str(args.get('containerconfig_hostname', ''))\n    containerconfig_domainname = str(args.get('containerconfig_domainname', ''))\n    containerconfig_user = str(args.get('containerconfig_user', ''))\n    containerconfig_attachstdin = argToBoolean(args.get('containerconfig_attachstdin', False))\n    containerconfig_attachstdout = argToBoolean(args.get('containerconfig_attachstdout', False))\n    containerconfig_attachstderr = argToBoolean(args.get('containerconfig_attachstderr', False))\n    containerconfig_exposedports = str(args.get('containerconfig_exposedports', ''))\n    containerconfig_tty = argToBoolean(args.get('containerconfig_tty', False))\n    containerconfig_openstdin = argToBoolean(args.get('containerconfig_openstdin', False))\n    containerconfig_stdinonce = argToBoolean(args.get('containerconfig_stdinonce', False))\n    containerconfig_env = argToList(args.get('containerconfig_env', []))\n    containerconfig_cmd = argToList(args.get('containerconfig_cmd', []))\n    containerconfig_healthcheck_test = str(args.get('containerconfig_healthcheck_test', ''))\n    containerconfig_healthcheck_interval = args.get('containerconfig_healthcheck_interval', None)\n    containerconfig_healthcheck_timeout = args.get('containerconfig_healthcheck_timeout', None)\n    containerconfig_healthcheck_retries = args.get('containerconfig_healthcheck_retries', None)\n    containerconfig_healthcheck_startperiod = args.get('containerconfig_healthcheck_startperiod', None)\n    containerconfig_healthcheck = assign_params(Test=containerconfig_healthcheck_test,\n                                                Interval=containerconfig_healthcheck_interval,\n                                                Timeout=containerconfig_healthcheck_timeout,\n                                                Retries=containerconfig_healthcheck_retries,\n                                                StartPeriod=containerconfig_healthcheck_startperiod)\n    containerconfig_argsescaped = argToBoolean(args.get('containerconfig_argsescaped', False))\n    containerconfig_image = str(args.get('containerconfig_image', ''))\n    containerconfig_volumes = str(args.get('containerconfig_volumes', ''))\n    containerconfig_workingdir = str(args.get('containerconfig_workingdir', ''))\n    containerconfig_entrypoint = argToList(args.get('containerconfig_entrypoint', []))\n    containerconfig_networkdisabled = argToBoolean(args.get('containerconfig_networkdisabled', False))\n    containerconfig_macaddress = str(args.get('containerconfig_macaddress', ''))\n    containerconfig_onbuild = argToList(args.get('containerconfig_onbuild', []))\n    containerconfig_labels = str(args.get('containerconfig_labels', ''))\n    containerconfig_stopsignal = str(args.get('containerconfig_stopsignal', 'SIGTERM'))\n    containerconfig_stoptimeout = args.get('containerconfig_stoptimeout', None)\n    containerconfig_shell = argToList(args.get('containerconfig_shell', []))\n    container = str(args.get('container', ''))\n    repo = str(args.get('repo', ''))\n    tag = str(args.get('tag', ''))\n    comment = str(args.get('comment', ''))\n    author = str(args.get('author', ''))\n    pause = argToBoolean(args.get('pause', False))\n    changes = str(args.get('changes', ''))\n\n    response = client.image_commit_request(containerconfig_hostname, containerconfig_domainname, containerconfig_user,\n                                           containerconfig_attachstdin,\n                                           containerconfig_attachstdout,\n                                           containerconfig_attachstderr,\n                                           containerconfig_exposedports,\n                                           containerconfig_tty,\n                                           containerconfig_openstdin,\n                                           containerconfig_stdinonce,\n                                           containerconfig_env,\n                                           containerconfig_cmd,\n                                           containerconfig_healthcheck,\n                                           containerconfig_argsescaped,\n                                           containerconfig_image,\n                                           containerconfig_volumes,\n                                           containerconfig_workingdir,\n                                           containerconfig_entrypoint,\n                                           containerconfig_networkdisabled,\n                                           containerconfig_macaddress,\n                                           containerconfig_onbuild,\n                                           containerconfig_labels,\n                                           containerconfig_stopsignal,\n                                           containerconfig_stoptimeout,\n                                           containerconfig_shell, container,\n                                           repo, tag, comment, author, pause, changes)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_create_command(client, args):\n    from_image = str(args.get('from_image', ''))\n    from_src = str(args.get('from_src', ''))\n    repo = str(args.get('repo', ''))\n    tag = str(args.get('tag', ''))\n    message = str(args.get('message', ''))\n    input_image = str(args.get('input_image', ''))\n    platform = str(args.get('platform', ''))\n\n    response = client.image_create_request(from_image, from_src, repo, tag, message, input_image, platform)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_delete_command(client, args):\n    name = str(args.get('name', ''))\n    force = argToBoolean(args.get('force', False))\n    noprune = argToBoolean(args.get('noprune', False))\n\n    response = client.image_delete_request(name, force, noprune)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ImageDeleteResponseItem',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_get_command(client, args):\n    name = str(args.get('name', ''))\n\n    response = client.image_get_request(name)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_get_all_command(client, args):\n    names = argToList(args.get('names', []))\n\n    response = client.image_get_all_request(names)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_history_command(client, args):\n    name = str(args.get('name', ''))\n\n    response = client.image_history_request(name)\n    command_results = CommandResults(\n        outputs_prefix='Docker.HistoryResponseItem',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_inspect_command(client, args):\n    name = str(args.get('name', ''))\n\n    response = client.image_inspect_request(name)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Image',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_list_command(client, args):\n    list_all = argToBoolean(args.get('list_all', False))\n    filters = str(args.get('filters', ''))\n    digests = argToBoolean(args.get('digests', False))\n\n    response = client.image_list_request(list_all, filters, digests)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ImageSummary',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_load_command(client, args):\n    images_tarball = str(args.get('images_tarball', ''))\n    quiet = argToBoolean(args.get('quiet', False))\n\n    response = client.image_load_request(images_tarball, quiet)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_prune_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.image_prune_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ImagePruneResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_push_command(client, args):\n    name = str(args.get('name', ''))\n    tag = str(args.get('tag', ''))\n\n    response = client.image_push_request(name, tag)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_search_command(client, args):\n    term = str(args.get('term', ''))\n    limit = args.get('limit', None)\n    filters = str(args.get('filters', ''))\n\n    response = client.image_search_request(term, limit, filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ImageSearchResponseItem',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef image_tag_command(client, args):\n    name = str(args.get('name', ''))\n    repo = str(args.get('repo', ''))\n    tag = str(args.get('tag', ''))\n\n    response = client.image_tag_request(name, repo, tag)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_connect_command(client, args):\n    id_ = str(args.get('id', ''))\n    container_container = str(args.get('container_container', ''))\n    container_endpointconfig_ipamconfig = str(args.get('container_endpointconfig_ipamconfig', ''))\n    container_endpointconfig_links = str(args.get('container_endpointconfig_links', ''))\n    container_endpointconfig_aliases = str(args.get('container_endpointconfig_aliases', ''))\n    container_endpointconfig_networkid = str(args.get('container_endpointconfig_networkid', ''))\n    container_endpointconfig_endpointid = str(args.get('container_endpointconfig_endpointid', ''))\n    container_endpointconfig_gateway = str(args.get('container_endpointconfig_gateway', ''))\n    container_endpointconfig_ipaddress = str(args.get('container_endpointconfig_ipaddress', ''))\n    container_endpointconfig_ipprefixlen = args.get('container_endpointconfig_ipprefixlen', None)\n    container_endpointconfig_ipv6gateway = str(args.get('container_endpointconfig_ipv6gateway', ''))\n    container_endpointconfig_globalipv6address = str(args.get('container_endpointconfig_globalipv6address', ''))\n    container_endpointconfig_globalipv6prefixlen = args.get('container_endpointconfig_globalipv6prefixlen', None)\n    container_endpointconfig_macaddress = str(args.get('container_endpointconfig_macaddress', ''))\n    container_endpointconfig_driveropts = str(args.get('container_endpointconfig_driveropts', ''))\n    container_endpointconfig = assign_params(IPAMConfig=container_endpointconfig_ipamconfig,\n                                             Links=container_endpointconfig_links,\n                                             Aliases=container_endpointconfig_aliases,\n                                             NetworkID=container_endpointconfig_networkid,\n                                             EndpointID=container_endpointconfig_endpointid,\n                                             Gateway=container_endpointconfig_gateway,\n                                             IPAddress=container_endpointconfig_ipaddress,\n                                             IPPrefixLen=container_endpointconfig_ipprefixlen,\n                                             IPv6Gateway=container_endpointconfig_ipv6gateway,\n                                             GlobalIPv6Address=container_endpointconfig_globalipv6address,\n                                             GlobalIPv6PrefixLen=container_endpointconfig_globalipv6prefixlen,\n                                             MacAddress=container_endpointconfig_macaddress,\n                                             DriverOpts=container_endpointconfig_driveropts)\n\n    response = client.network_connect_request(id_, container_container, container_endpointconfig)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_create_command(client, args):\n    networkconfig_name = str(args.get('networkconfig_name', ''))\n    networkconfig_checkduplicate = argToBoolean(args.get('networkconfig_checkduplicate', False))\n    networkconfig_driver = str(args.get('networkconfig_driver', 'bridge'))\n    networkconfig_internal = argToBoolean(args.get('networkconfig_internal', False))\n    networkconfig_attachable = argToBoolean(args.get('networkconfig_attachable', False))\n    networkconfig_ingress = argToBoolean(args.get('networkconfig_ingress', False))\n    networkconfig_ipam_driver = str(args.get('networkconfig_ipam_driver', ''))\n    networkconfig_ipam_config = str(args.get('networkconfig_ipam_config', ''))\n    networkconfig_ipam_options = str(args.get('networkconfig_ipam_options', ''))\n    networkconfig_ipam = assign_params(Driver=networkconfig_ipam_driver, Config=networkconfig_ipam_config,\n                                       Options=networkconfig_ipam_options)\n    networkconfig_enableipv6 = argToBoolean(args.get('networkconfig_enableipv6', False))\n    networkconfig_options = str(args.get('networkconfig_options', ''))\n    networkconfig_labels = str(args.get('networkconfig_labels', ''))\n\n    response = client.network_create_request(networkconfig_name, networkconfig_checkduplicate, networkconfig_driver,\n                                             networkconfig_internal, networkconfig_attachable, networkconfig_ingress,\n                                             networkconfig_ipam, networkconfig_enableipv6, networkconfig_options,\n                                             networkconfig_labels)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_delete_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.network_delete_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_disconnect_command(client, args):\n    id_ = str(args.get('id', ''))\n    container = str(args.get('container', ''))\n    force = argToBoolean(args.get('force', False))\n\n    response = client.network_disconnect_request(id_, container, force)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n    verbose = argToBoolean(args.get('verbose', False))\n    scope = str(args.get('scope', ''))\n\n    response = client.network_inspect_request(id_, verbose, scope)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Network',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_list_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.network_list_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Network',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef network_prune_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.network_prune_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.NetworkPruneResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef node_delete_command(client, args):\n    id_ = str(args.get('id', ''))\n    force = argToBoolean(args.get('force', False))\n\n    response = client.node_delete_request(id_, force)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef node_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.node_inspect_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Node',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef node_list_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.node_list_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Node',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef node_update_command(client, args):\n    id_ = str(args.get('id', ''))\n    nodespec_name = str(args.get('nodespec_name', ''))\n    nodespec_labels = str(args.get('nodespec_labels', ''))\n    nodespec_role = str(args.get('nodespec_role', ''))\n    nodespec_availability = str(args.get('nodespec_availability', ''))\n    version = args.get('version', None)\n\n    response = client.node_update_request(id_, nodespec_name, nodespec_labels, nodespec_role, nodespec_availability,\n                                          version)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef secret_create_command(client, args):\n    secretspec_name = str(args.get('secretspec_name', ''))\n    secretspec_labels = str(args.get('secretspec_labels', ''))\n    secretspec_data = str(args.get('secretspec_data', ''))\n    secretspec_driver_name = str(args.get('secretspec_driver_name', ''))\n    secretspec_driver_options = str(args.get('secretspec_driver_options', ''))\n    secretspec_driver = assign_params(Name=secretspec_driver_name, Options=secretspec_driver_options)\n    secretspec_templating_name = str(args.get('secretspec_templating_name', ''))\n    secretspec_templating_options = str(args.get('secretspec_templating_options', ''))\n    secretspec_templating = assign_params(Name=secretspec_templating_name, Options=secretspec_templating_options)\n\n    response = client.secret_create_request(secretspec_name, secretspec_labels, secretspec_data, secretspec_driver,\n                                            secretspec_templating)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef secret_delete_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.secret_delete_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef secret_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.secret_inspect_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Secret',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef secret_list_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.secret_list_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Secret',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef secret_update_command(client, args):\n    id_ = str(args.get('id', ''))\n    secretspec_name = str(args.get('secretspec_name', ''))\n    secretspec_labels = str(args.get('secretspec_labels', ''))\n    secretspec_data = str(args.get('secretspec_data', ''))\n    secretspec_driver_name = str(args.get('secretspec_driver_name', ''))\n    secretspec_driver_options = str(args.get('secretspec_driver_options', ''))\n    secretspec_driver = assign_params(Name=secretspec_driver_name, Options=secretspec_driver_options)\n    secretspec_templating_name = str(args.get('secretspec_templating_name', ''))\n    secretspec_templating_options = str(args.get('secretspec_templating_options', ''))\n    secretspec_templating = assign_params(Name=secretspec_templating_name, Options=secretspec_templating_options)\n    version = args.get('version', None)\n\n    response = client.secret_update_request(id_, secretspec_name, secretspec_labels, secretspec_data, secretspec_driver,\n                                            secretspec_templating, version)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef service_create_command(client, args):\n    servicespec_name = str(args.get('servicespec_name', ''))\n    servicespec_labels = str(args.get('servicespec_labels', ''))\n    servicespec_tasktemplate_pluginspec = str(args.get('servicespec_tasktemplate_pluginspec', ''))\n    servicespec_tasktemplate_containerspec = str(args.get('servicespec_tasktemplate_containerspec', ''))\n    servicespec_tasktemplate_networkattachmentspec = str(args.get('servicespec_tasktemplate_networkattachmentspec', ''))\n    servicespec_tasktemplate_resources = str(args.get('servicespec_tasktemplate_resources', ''))\n    servicespec_tasktemplate_restartpolicy = str(args.get('servicespec_tasktemplate_restartpolicy', ''))\n    servicespec_tasktemplate_placement = str(args.get('servicespec_tasktemplate_placement', ''))\n    servicespec_tasktemplate_forceupdate = args.get('servicespec_tasktemplate_forceupdate', None)\n    servicespec_tasktemplate_runtime = str(args.get('servicespec_tasktemplate_runtime', ''))\n    servicespec_tasktemplate_networks = str(args.get('servicespec_tasktemplate_networks', ''))\n    servicespec_tasktemplate_logdriver = str(args.get('servicespec_tasktemplate_logdriver', ''))\n    servicespec_tasktemplate = assign_params(PluginSpec=servicespec_tasktemplate_pluginspec,\n                                             ContainerSpec=servicespec_tasktemplate_containerspec,\n                                             NetworkAttachmentSpec=servicespec_tasktemplate_networkattachmentspec,\n                                             Resources=servicespec_tasktemplate_resources,\n                                             RestartPolicy=servicespec_tasktemplate_restartpolicy,\n                                             Placement=servicespec_tasktemplate_placement,\n                                             ForceUpdate=servicespec_tasktemplate_forceupdate,\n                                             Runtime=servicespec_tasktemplate_runtime,\n                                             Networks=servicespec_tasktemplate_networks,\n                                             LogDriver=servicespec_tasktemplate_logdriver)\n    servicespec_mode_replicated = str(args.get('servicespec_mode_replicated', ''))\n    servicespec_mode_global = str(args.get('servicespec_mode_global', ''))\n    servicespec_mode_replicatedjob = str(args.get('servicespec_mode_replicatedjob', ''))\n    servicespec_mode_globaljob = str(args.get('servicespec_mode_globaljob', ''))\n    servicespec_mode = assign_params(Replicated=servicespec_mode_replicated, Global=servicespec_mode_global,\n                                     ReplicatedJob=servicespec_mode_replicatedjob,\n                                     GlobalJob=servicespec_mode_globaljob)\n    servicespec_updateconfig_parallelism = args.get('servicespec_updateconfig_parallelism', None)\n    servicespec_updateconfig_delay = args.get('servicespec_updateconfig_delay', None)\n    servicespec_updateconfig_failureaction = str(args.get('servicespec_updateconfig_failureaction', ''))\n    servicespec_updateconfig_monitor = args.get('servicespec_updateconfig_monitor', None)\n    servicespec_updateconfig_maxfailureratio = str(args.get('servicespec_updateconfig_maxfailureratio', ''))\n    servicespec_updateconfig_order = str(args.get('servicespec_updateconfig_order', ''))\n    servicespec_updateconfig = assign_params(Parallelism=servicespec_updateconfig_parallelism,\n                                             Delay=servicespec_updateconfig_delay,\n                                             FailureAction=servicespec_updateconfig_failureaction,\n                                             Monitor=servicespec_updateconfig_monitor,\n                                             MaxFailureRatio=servicespec_updateconfig_maxfailureratio,\n                                             Order=servicespec_updateconfig_order)\n    servicespec_rollbackconfig_parallelism = args.get('servicespec_rollbackconfig_parallelism', None)\n    servicespec_rollbackconfig_delay = args.get('servicespec_rollbackconfig_delay', None)\n    servicespec_rollbackconfig_failureaction = str(args.get('servicespec_rollbackconfig_failureaction', ''))\n    servicespec_rollbackconfig_monitor = args.get('servicespec_rollbackconfig_monitor', None)\n    servicespec_rollbackconfig_maxfailureratio = str(args.get('servicespec_rollbackconfig_maxfailureratio', ''))\n    servicespec_rollbackconfig_order = str(args.get('servicespec_rollbackconfig_order', ''))\n    servicespec_rollbackconfig = assign_params(Parallelism=servicespec_rollbackconfig_parallelism,\n                                               Delay=servicespec_rollbackconfig_delay,\n                                               FailureAction=servicespec_rollbackconfig_failureaction,\n                                               Monitor=servicespec_rollbackconfig_monitor,\n                                               MaxFailureRatio=servicespec_rollbackconfig_maxfailureratio,\n                                               Order=servicespec_rollbackconfig_order)\n    servicespec_networks = argToList(args.get('servicespec_networks', []))\n    servicespec_endpointspec_mode = str(args.get('servicespec_endpointspec_mode', ''))\n    servicespec_endpointspec_ports = str(args.get('servicespec_endpointspec_ports', ''))\n    servicespec_endpointspec = assign_params(Mode=servicespec_endpointspec_mode, Ports=servicespec_endpointspec_ports)\n\n    response = client.service_create_request(servicespec_name, servicespec_labels, servicespec_tasktemplate,\n                                             servicespec_mode, servicespec_updateconfig,\n                                             servicespec_rollbackconfig, servicespec_networks,\n                                             servicespec_endpointspec)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef service_delete_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.service_delete_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef service_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n    insert_defaults = argToBoolean(args.get('insert_defaults', False))\n\n    response = client.service_inspect_request(id_, insert_defaults)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Service',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef service_list_command(client, args):\n    filters = str(args.get('filters', ''))\n    status = argToBoolean(args.get('status', False))\n\n    response = client.service_list_request(filters, status)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Service',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef service_logs_command(client, args):\n    id_ = str(args.get('id', ''))\n    details = argToBoolean(args.get('details', False))\n    follow = argToBoolean(args.get('follow', False))\n    stdout = argToBoolean(args.get('stdout', False))\n    stderr = argToBoolean(args.get('stderr', False))\n    since = int(args.get('since', 0))\n    timestamps = argToBoolean(args.get('timestamps', False))\n    tail = str(args.get('tail', 'all'))\n\n    response = client.service_logs_request(id_, details, follow, stdout, stderr, since, timestamps, tail)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef service_update_command(client, args):\n    id_ = str(args.get('id', ''))\n    servicespec_name = str(args.get('servicespec_name', ''))\n    servicespec_labels = str(args.get('servicespec_labels', ''))\n    servicespec_tasktemplate_pluginspec = str(args.get('servicespec_tasktemplate_pluginspec', ''))\n    servicespec_tasktemplate_containerspec = str(args.get('servicespec_tasktemplate_containerspec', ''))\n    servicespec_tasktemplate_networkattachmentspec = str(args.get('servicespec_tasktemplate_networkattachmentspec', ''))\n    servicespec_tasktemplate_resources = str(args.get('servicespec_tasktemplate_resources', ''))\n    servicespec_tasktemplate_restartpolicy = str(args.get('servicespec_tasktemplate_restartpolicy', ''))\n    servicespec_tasktemplate_placement = str(args.get('servicespec_tasktemplate_placement', ''))\n    servicespec_tasktemplate_forceupdate = args.get('servicespec_tasktemplate_forceupdate', None)\n    servicespec_tasktemplate_runtime = str(args.get('servicespec_tasktemplate_runtime', ''))\n    servicespec_tasktemplate_networks = str(args.get('servicespec_tasktemplate_networks', ''))\n    servicespec_tasktemplate_logdriver = str(args.get('servicespec_tasktemplate_logdriver', ''))\n    servicespec_tasktemplate = assign_params(PluginSpec=servicespec_tasktemplate_pluginspec,\n                                             ContainerSpec=servicespec_tasktemplate_containerspec,\n                                             NetworkAttachmentSpec=servicespec_tasktemplate_networkattachmentspec,\n                                             Resources=servicespec_tasktemplate_resources,\n                                             RestartPolicy=servicespec_tasktemplate_restartpolicy,\n                                             Placement=servicespec_tasktemplate_placement,\n                                             ForceUpdate=servicespec_tasktemplate_forceupdate,\n                                             Runtime=servicespec_tasktemplate_runtime,\n                                             Networks=servicespec_tasktemplate_networks,\n                                             LogDriver=servicespec_tasktemplate_logdriver)\n    servicespec_mode_replicated = str(args.get('servicespec_mode_replicated', ''))\n    servicespec_mode_global = str(args.get('servicespec_mode_global', ''))\n    servicespec_mode_replicatedjob = str(args.get('servicespec_mode_replicatedjob', ''))\n    servicespec_mode_globaljob = str(args.get('servicespec_mode_globaljob', ''))\n    servicespec_mode = assign_params(Replicated=servicespec_mode_replicated, Global=servicespec_mode_global,\n                                     ReplicatedJob=servicespec_mode_replicatedjob,\n                                     GlobalJob=servicespec_mode_globaljob)\n    servicespec_updateconfig_parallelism = args.get('servicespec_updateconfig_parallelism', None)\n    servicespec_updateconfig_delay = args.get('servicespec_updateconfig_delay', None)\n    servicespec_updateconfig_failureaction = str(args.get('servicespec_updateconfig_failureaction', ''))\n    servicespec_updateconfig_monitor = args.get('servicespec_updateconfig_monitor', None)\n    servicespec_updateconfig_maxfailureratio = str(args.get('servicespec_updateconfig_maxfailureratio', ''))\n    servicespec_updateconfig_order = str(args.get('servicespec_updateconfig_order', ''))\n    servicespec_updateconfig = assign_params(Parallelism=servicespec_updateconfig_parallelism,\n                                             Delay=servicespec_updateconfig_delay,\n                                             FailureAction=servicespec_updateconfig_failureaction,\n                                             Monitor=servicespec_updateconfig_monitor,\n                                             MaxFailureRatio=servicespec_updateconfig_maxfailureratio,\n                                             Order=servicespec_updateconfig_order)\n    servicespec_rollbackconfig_parallelism = args.get('servicespec_rollbackconfig_parallelism', None)\n    servicespec_rollbackconfig_delay = args.get('servicespec_rollbackconfig_delay', None)\n    servicespec_rollbackconfig_failureaction = str(args.get('servicespec_rollbackconfig_failureaction', ''))\n    servicespec_rollbackconfig_monitor = args.get('servicespec_rollbackconfig_monitor', None)\n    servicespec_rollbackconfig_maxfailureratio = str(args.get('servicespec_rollbackconfig_maxfailureratio', ''))\n    servicespec_rollbackconfig_order = str(args.get('servicespec_rollbackconfig_order', ''))\n    servicespec_rollbackconfig = assign_params(Parallelism=servicespec_rollbackconfig_parallelism,\n                                               Delay=servicespec_rollbackconfig_delay,\n                                               FailureAction=servicespec_rollbackconfig_failureaction,\n                                               Monitor=servicespec_rollbackconfig_monitor,\n                                               MaxFailureRatio=servicespec_rollbackconfig_maxfailureratio,\n                                               Order=servicespec_rollbackconfig_order)\n    servicespec_networks = argToList(args.get('servicespec_networks', []))\n    servicespec_endpointspec_mode = str(args.get('servicespec_endpointspec_mode', ''))\n    servicespec_endpointspec_ports = str(args.get('servicespec_endpointspec_ports', ''))\n    servicespec_endpointspec = assign_params(Mode=servicespec_endpointspec_mode, Ports=servicespec_endpointspec_ports)\n    version = args.get('version', None)\n    registery_auth_from = str(args.get('registery_auth_from', 'spec'))\n    rollback = str(args.get('rollback', ''))\n\n    response = client.service_update_request(id_, servicespec_name, servicespec_labels, servicespec_tasktemplate,\n                                             servicespec_mode,\n                                             servicespec_updateconfig,\n                                             servicespec_rollbackconfig,\n                                             servicespec_networks,\n                                             servicespec_endpointspec,\n                                             version, registery_auth_from, rollback)\n    command_results = CommandResults(\n        outputs_prefix='Docker.ServiceUpdateResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef session_command(client, args):\n\n    response = client.session_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef swarm_init_command(client, args):\n    listenaddr = str(args.get('listenaddr', ''))\n    advertiseaddr = str(args.get('advertiseaddr', ''))\n    datapathaddr = str(args.get('datapathaddr', ''))\n    datapathport = args.get('datapathport', None)\n    defaultaddrpool = argToList(args.get('defaultaddrpool', []))\n    forcenewcluster = argToBoolean(args.get('forcenewcluster', False))\n    subnetsize = args.get('subnetsize', None)\n    spec_name = str(args.get('spec_name', ''))\n    spec_labels = str(args.get('spec_labels', ''))\n    spec_orchestration = str(args.get('spec_orchestration', ''))\n    spec_raft = str(args.get('spec_raft', ''))\n    spec_dispatcher = str(args.get('spec_dispatcher', ''))\n    spec_caconfig = str(args.get('spec_caconfig', ''))\n    spec_encryptionconfig = str(args.get('spec_encryptionconfig', ''))\n    spec_taskdefaults = str(args.get('spec_taskdefaults', ''))\n    spec = assign_params(Name=spec_name, Labels=spec_labels,\n                         Orchestration=spec_orchestration,\n                         Raft=spec_raft,\n                         Dispatcher=spec_dispatcher,\n                         CAConfig=spec_caconfig,\n                         EncryptionConfig=spec_encryptionconfig,\n                         TaskDefaults=spec_taskdefaults)\n\n    response = client.swarm_init_request(listenaddr, advertiseaddr, datapathaddr,\n                                         datapathport, defaultaddrpool, forcenewcluster,\n                                         subnetsize, spec)\n    if type(response) == str:\n        response = {\n            \"Node ID\": response\n        }\n        command_results = CommandResults(\n            outputs_prefix='Docker.Swarm.Token',\n            outputs_key_field='',\n            outputs=response,\n            raw_response=response\n        )\n    else:\n        command_results = CommandResults(\n            outputs_prefix='Docker.Swarm.Token',\n            outputs_key_field='',\n            outputs=response,\n            raw_response=response\n        )\n    return command_results\n\n\ndef swarm_inspect_command(client, args):\n\n    response = client.swarm_inspect_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker.Swarm',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef swarm_join_command(client, args):\n    listenaddr = str(args.get('listenaddr', ''))\n    advertiseaddr = str(args.get('advertiseaddr', ''))\n    datapathaddr = str(args.get('datapathaddr', ''))\n    remoteaddrs = argToList(args.get('remoteaddrs', []))\n    jointoken = str(args.get('jointoken', ''))\n\n    response = client.swarm_join_request(listenaddr, advertiseaddr, datapathaddr,\n                                         remoteaddrs, jointoken)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef swarm_leave_command(client, args):\n    force = argToBoolean(args.get('force', False))\n\n    response = client.swarm_leave_request(force)\n\n    if type(response) == dict:\n        command_results = CommandResults(\n            outputs_prefix='Docker',\n            outputs_key_field='',\n            outputs=response,\n            raw_response=response\n        )\n    else:\n        response = {\n            \"message\": \"Swarm node left.\"\n        }\n        command_results = CommandResults(\n            outputs_prefix='Docker',\n            outputs_key_field='',\n            outputs=response,\n            raw_response=response\n        )\n\n    return command_results\n\n\ndef swarm_unlock_command(client, args):\n    unlockkey = str(args.get('unlockkey', ''))\n\n    response = client.swarm_unlock_request(unlockkey)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef swarm_unlockkey_command(client, args):\n\n    response = client.swarm_unlockkey_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker.UnlockKeyResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_auth_command(client, args):\n    authconfig_username = str(args.get('authconfig_username', ''))\n    authconfig_password = str(args.get('authconfig_password', ''))\n    authconfig_email = str(args.get('authconfig_email', ''))\n    authconfig_serveraddress = str(args.get('authconfig_serveraddress', ''))\n\n    response = client.system_auth_request(authconfig_username, authconfig_password, authconfig_email,\n                                          authconfig_serveraddress)\n    command_results = CommandResults(\n        outputs_prefix='Docker.SystemAuthResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_data_usage_command(client, args):\n\n    response = client.system_data_usage_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker.SystemDataUsageResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_events_command(client, args):\n    since = str(args.get('since', ''))\n    until = str(args.get('until', ''))\n    filters = str(args.get('filters', ''))\n\n    response = client.system_events_request(since, until, filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.SystemEventsResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_info_command(client, args):\n\n    response = client.system_info_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker.SystemInfo',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_ping_command(client, args):\n\n    response = client.system_ping_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_ping_head_command(client, args):\n\n    response = client.system_ping_head_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef system_version_command(client, args):\n\n    response = client.system_version_request()\n    command_results = CommandResults(\n        outputs_prefix='Docker.SystemVersion',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef task_inspect_command(client, args):\n    id_ = str(args.get('id', ''))\n\n    response = client.task_inspect_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Task',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef task_list_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.task_list_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Task',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef task_logs_command(client, args):\n    id_ = str(args.get('id', ''))\n    details = argToBoolean(args.get('details', False))\n    follow = argToBoolean(args.get('follow', False))\n    stdout = argToBoolean(args.get('stdout', False))\n    stderr = argToBoolean(args.get('stderr', False))\n    since = int(args.get('since', 0))\n    timestamps = argToBoolean(args.get('timestamps', False))\n    tail = str(args.get('tail', 'all'))\n\n    response = client.task_logs_request(id_, details, follow, stdout, stderr, since, timestamps, tail)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef volume_create_command(client, args):\n    volumeconfig_name = str(args.get('volumeconfig_name', ''))\n    volumeconfig_driver = str(args.get('volumeconfig_driver', 'local'))\n    volumeconfig_driveropts = str(args.get('volumeconfig_driveropts', ''))\n    volumeconfig_labels = str(args.get('volumeconfig_labels', ''))\n\n    response = client.volume_create_request(volumeconfig_name, volumeconfig_driver, volumeconfig_driveropts,\n                                            volumeconfig_labels)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef volume_delete_command(client, args):\n    name = str(args.get('name', ''))\n    force = argToBoolean(args.get('force', False))\n\n    response = client.volume_delete_request(name, force)\n    command_results = CommandResults(\n        outputs_prefix='Docker',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef volume_inspect_command(client, args):\n    name = str(args.get('name', ''))\n\n    response = client.volume_inspect_request(name)\n    command_results = CommandResults(\n        outputs_prefix='Docker.Volume',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef volume_list_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.volume_list_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.VolumeListResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef volume_prune_command(client, args):\n    filters = str(args.get('filters', ''))\n\n    response = client.volume_prune_request(filters)\n    command_results = CommandResults(\n        outputs_prefix='Docker.VolumePruneResponse',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef test_module(client):\n    # Test functions here\n    response = client.test_request()\n    if response.get('Platform'):\n        demisto.results('ok')\n    else:\n        demisto.results(response)\n\n\ndef main():\n\n    params = demisto.params()\n    args = demisto.args()\n    url = params.get('url')\n    client_cert = params.get('client_certificate')\n    client_key = params.get('client_key')\n    verify_certificate = not params.get('insecure', False)\n    proxy = params.get('proxy', False)\n\n    command = demisto.command()\n    LOG(f'Command being called is {command}')\n\n    try:\n        urllib3.disable_warnings()\n        client = Client(urljoin(url, \"/v1.41\"), verify_certificate, proxy, headers=None,\n                        client_cert=client_cert, client_key=client_key)\n        commands = {\n            'docker-build-prune': build_prune_command,\n            'docker-config-create': config_create_command,\n            'docker-config-inspect': config_inspect_command,\n            'docker-config-list': config_list_command,\n            'docker-container-changes': container_changes_command,\n            'docker-container-create': container_create_command,\n            'docker-container-delete': container_delete_command,\n            'docker-container-exec': container_exec_command,\n            'docker-container-export': container_export_command,\n            'docker-container-inspect': container_inspect_command,\n            'docker-container-kill': container_kill_command,\n            'docker-container-list': container_list_command,\n            'docker-container-logs': container_logs_command,\n            'docker-container-pause': container_pause_command,\n            'docker-container-prune': container_prune_command,\n            'docker-container-rename': container_rename_command,\n            'docker-container-resize': container_resize_command,\n            'docker-container-restart': container_restart_command,\n            'docker-container-start': container_start_command,\n            'docker-container-stats': container_stats_command,\n            'docker-container-stop': container_stop_command,\n            'docker-container-top': container_top_command,\n            'docker-container-unpause': container_unpause_command,\n            'docker-container-update': container_update_command,\n            'docker-container-wait': container_wait_command,\n            'docker-distribution-inspect': distribution_inspect_command,\n            'docker-exec-inspect': exec_inspect_command,\n            'docker-exec-resize': exec_resize_command,\n            'docker-exec-start': exec_start_command,\n            'docker-image-build': image_build_command,\n            'docker-image-commit': image_commit_command,\n            'docker-image-create': image_create_command,\n            'docker-image-delete': image_delete_command,\n            'docker-image-get': image_get_command,\n            'docker-image-get-all': image_get_all_command,\n            'docker-image-history': image_history_command,\n            'docker-image-inspect': image_inspect_command,\n            'docker-image-list': image_list_command,\n            'docker-image-load': image_load_command,\n            'docker-image-prune': image_prune_command,\n            'docker-image-push': image_push_command,\n            'docker-image-search': image_search_command,\n            'docker-image-tag': image_tag_command,\n            'docker-network-connect': network_connect_command,\n            'docker-network-create': network_create_command,\n            'docker-network-delete': network_delete_command,\n            'docker-network-disconnect': network_disconnect_command,\n            'docker-network-inspect': network_inspect_command,\n            'docker-network-list': network_list_command,\n            'docker-network-prune': network_prune_command,\n            'docker-node-delete': node_delete_command,\n            'docker-node-inspect': node_inspect_command,\n            'docker-node-list': node_list_command,\n            'docker-node-update': node_update_command,\n            'docker-secret-create': secret_create_command,\n            'docker-secret-delete': secret_delete_command,\n            'docker-secret-inspect': secret_inspect_command,\n            'docker-secret-list': secret_list_command,\n            'docker-secret-update': secret_update_command,\n            'docker-service-create': service_create_command,\n            'docker-service-delete': service_delete_command,\n            'docker-service-inspect': service_inspect_command,\n            'docker-service-list': service_list_command,\n            'docker-service-logs': service_logs_command,\n            'docker-service-update': service_update_command,\n            'docker-session': session_command,\n            'docker-swarm-init': swarm_init_command,\n            'docker-swarm-inspect': swarm_inspect_command,\n            'docker-swarm-join': swarm_join_command,\n            'docker-swarm-leave': swarm_leave_command,\n            'docker-swarm-unlock': swarm_unlock_command,\n            'docker-swarm-unlockkey': swarm_unlockkey_command,\n            'docker-system-auth': system_auth_command,\n            'docker-system-data-usage': system_data_usage_command,\n            'docker-system-events': system_events_command,\n            'docker-system-info': system_info_command,\n            'docker-system-ping': system_ping_command,\n            'docker-system-ping-head': system_ping_head_command,\n            'docker-system-version': system_version_command,\n            'docker-task-inspect': task_inspect_command,\n            'docker-task-list': task_list_command,\n            'docker-task-logs': task_logs_command,\n            'docker-volume-create': volume_create_command,\n            'docker-volume-delete': volume_delete_command,\n            'docker-volume-inspect': volume_inspect_command,\n            'docker-volume-list': volume_list_command,\n            'docker-volume-prune': volume_prune_command,\n        }\n\n        if command == 'test-module':\n            test_module(client)\n        else:\n            return_results(commands[command](client, args))\n\n    except Exception as e:\n        return_error(str(e))\n\n\nif __name__ in ['__main__', 'builtin', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.2","modified":"2021-09-05T10:49:33.527216+03:00","name":"Docker Engine API","packID":"DevSecOps","packPropagationLabels":["all"],"prevName":"Docker Engine API","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":false,"category":"Authentication","commitMessage":"","configuration":[{"defaultValue":"","display":"API hostname, in format: api-26290611.duosecurity.com","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"host","options":null,"required":true,"type":0},{"defaultValue":"","display":"Integration key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"integrationKey","options":null,"required":true,"type":0},{"defaultValue":"","display":"Secret key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"secretKey","options":null,"required":true,"type":4},{"defaultValue":"","display":"User agent","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"userAgent","options":null,"required":false,"type":0},{"defaultValue":"","display":"API Timeout, such as \"300ms\", \"1.5h\" or \"2h45m\"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"timeout","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use Duo 2FA to login to Demisto","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"allow-login","options":null,"required":false,"type":8},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8}],"definitionId":"","description":"DUO authentication service","detailedDescription":"The DUO integration allows you to trigger DUO actios using their API calls/auth\nPlease note that DUO Push times out after 60 seconds, and phone calls will time out after approximately one minute.\nAllow \"Use Duo 2FA to login to Demisto\" to sync users based on their username with Duo, which allows for 2 factor authentication in demisto.\nWhen a phone is set for a user with same username in Duo, after initial login, user will be required to select a 2 factor authentication using push (if app is installed), phone, or sms.\nIf no user with the same username found in Duo, or no connection to server, user will be allowed to sign in with the initial login only.","display":"DUO","fromServerVersion":"","hidden":false,"icon":"duo.png","id":"duo","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.679958+03:00","name":"duo","packID":"","prevName":"duo","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Analytics \u0026 SIEM","commitMessage":"","configuration":[{"defaultValue":"","display":"Server URL (e.g. http://192.168.0.1:9200)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Address","options":null,"required":true,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":false,"type":9},{"defaultValue":"2.*","display":"Elastic version 2.* or 5.*","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"version","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Trust server certificate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Import data as incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"Index/indexes to fetch incidents from (comma separated)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetchIndex","options":null,"required":false,"type":0},{"defaultValue":"","display":"Query to fetch incidents by (Lucene style)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetchQuery","options":null,"required":false,"type":0},{"defaultValue":"","display":"Index time field, used to sort and limit data","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetchTimeField","options":null,"required":false,"type":0},{"defaultValue":"","display":"Time format as kept in ElasticSearch, leave empty to use default","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetchTimeFormat","options":null,"required":false,"type":0},{"defaultValue":"","display":"Use DQ syntax to map elastic JSON struct to incident fields, use :: as mapping seperator","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentMapping","options":null,"required":false,"type":0}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Elasticsearch v2 integration instead.","detailedDescription":"Time format is goland style format. For more details, look at: [https://golang.org/pkg/time](https://golang.org/pkg/time)\n\t\t\t","display":"Elasticsearch (Deprecated)","fromServerVersion":"","hidden":false,"icon":"elasticseearch.png","id":"elasticsearch","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.400681+03:00","name":"elasticsearch","packID":"","prevName":"elasticsearch","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"Indicator Query","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"indicators_query","options":null,"required":false,"type":0},{"defaultValue":"text","display":"Outbound Format","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"format","options":["text","json","json-seq","csv","XSOAR json","XSOAR json-seq","XSOAR csv","McAfee Web Gateway","Symantec ProxySG","PAN-OS URL"],"required":false,"type":15},{"defaultValue":"Don't Collapse","display":"Should Collapse IPs","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Only applies to IPs in text or csv formats.","name":"collapse_ips","options":["Don't Collapse","To CIDRs","To Ranges"],"required":false,"type":15},{"defaultValue":"","display":"Show CSV Formats as Text","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"If selected, csv and XSOAR-csv formats will create a textual web page instead of downloading a CSV file.","name":"csv_text","options":null,"required":false,"type":8},{"defaultValue":"10000","display":"List Size","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"list_size","options":null,"required":true,"type":0},{"defaultValue":"","display":"Update On-Demand Only","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"on_demand","options":null,"required":false,"type":8},{"defaultValue":"5 minutes","display":"Refresh Rate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"How often to refresh the exported indicators (e.g., 5 minutes, 12 hours, 7 days, 3 months, 1 year). For performance reasons, we do not recommend setting this value to less than 1 minute.","name":"cache_refresh_rate","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Long Running Instance","displayPassword":"","hidden":true,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"longRunning","options":null,"required":false,"type":8},{"defaultValue":"","display":"Listen Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Requires a unique port for each long-running integration instance. Do not use the same port for multiple instances.","name":"longRunningPort","options":null,"required":true,"type":0},{"defaultValue":"","display":"Certificate (Required for HTTPS)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"certificate","options":null,"required":false,"type":12},{"defaultValue":"","display":"Append String To EDL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"String to add to end of published EDL, if type is Text. Supports Newline characters (\\n).","name":"append_string","options":null,"required":false,"type":12},{"defaultValue":"","display":"Prepend String To EDL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"String to add to beginning of published EDL, if type is Text. Supports Newline characters (\\n).","name":"prepend_string","options":null,"required":false,"type":12},{"defaultValue":"","display":"Private Key (Required for HTTPS)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"key","options":null,"required":false,"type":14},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Enable basic authentication for accessing the EDL. If empty, no authentication is enforced.","name":"credentials","options":null,"required":false,"type":9},{"defaultValue":"string","display":"Mcafee Gateway Indicator List Type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"For use with McAfee Web Gateway format to indicate the list type.","name":"mwg_type","options":["string","applcontrol","dimension","category","ip","mediatype","number","regex"],"required":false,"type":15},{"defaultValue":"","display":"PAN-OS URL Format Port Strip","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"For use with PAN-OS URL format - if selected will strip the port from URLs. If not selected - URLs with ports will be ignored.","name":"strip_port","options":null,"required":false,"type":8},{"defaultValue":"","display":"PAN-OS URL Format Drop Invalid Entries","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"For use with PAN-OS URL format - if selected, any URL entry that is not compliant with PAN-OS EDL URL format is dropped instead of being rewritten.","name":"drop_invalids","options":null,"required":false,"type":8},{"defaultValue":"bc_category","display":"Symantec ProxySG Default Category","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"For use with Symantec ProxySG format - set the default category for the output.","name":"category_default","options":null,"required":false,"type":0},{"defaultValue":"","display":"Symantec ProxySG Listed Categories","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"For use with Symantec ProxySG format - set the categories that should be listed in the output. If not set, will list all existing categories.","name":"category_attribute","options":null,"required":false,"type":0},{"defaultValue":"","display":"NGINX Global Directives","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"NGINX global directives to be passed on the command line using the -g option. Each directive should end with `;`. For example: `worker_processes 4; timer_resolution 100ms;`. Advanced configuration to be used only if instructed by XSOAR Support.","name":"nginx_global_directives","options":null,"required":false,"type":0},{"defaultValue":"","display":"NGINX Server Conf","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"NGINX server configuration. To be used instead of the default NGINX_SERVER_CONF used in the integration code. Advanced configuration to be used only if instructed by XSOAR Support.","name":"nginx_server_conf","options":null,"required":false,"type":12},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13}],"definitionId":"","description":"Use the Export Indicators Service integration to provide an endpoint with a list of indicators as a service for the system indicators.","detailedDescription":"## How to Access the Export Indicators Service\nThere are two ways that you can access the Export Indicators Service.\nUse these to make sure your indicators are exported properly.\n\nIn case of several Export Indicators Service integration instances - make sure to use **different listening ports** to separate the outbound feeds.\n\n### Access the Export Indicators Service by URL and Port (HTTP)\nIn a web browser, go to **http://*cortex-xsoar-server-address*:*listen_port***.\n\n**Note**: For security purposes, Cortex XSOAR recommends that you use HTTPS when accessing the indicator service through the URL and port. To do so, you must provide a certificate and private key, in the respective fields. In addition, make sure to provide credentials that must be used to connect to the integration instance.\n\n### Access the Export Indicators Service by Instance Name (HTTPS)\n\n**Note**: By default, the route will be open without security hardening and might expose you to network risks. Cortex XSOAR recommends that you use the service with a username and password. Click **Switch to username and password** and provide the credentials that must be used to access the service.\n\nTo access the Export Indicators service by instance name, make sure ***Instance execute external*** is enabled. \n\n1. In Cortex XSOAR, go to **Settings \u003e About \u003e Troubleshooting**.\n2. In the **Server Configuration** section, verify that the `instance.execute.external.\u003cinstance_name\u003e` key is set to `true`. If this key does not exist, click **+ Add Server Configuration** and add the `instance.execute.external.\u003cinstance_name\u003e` and set the value to `true`. See [this documentation](https://xsoar.pan.dev/docs/reference/articles/long-running-invoke) for further information.\n3. In a web browser, go to `https://\u003ccortex-xsoar_address\u003e/instance/execute/\u003cinstance_name\u003e/`.\n\n### Modify Request Parameters Through the URL\nUse the following arguments in the URL to change the request:\n\n1. **n** - The maximum number of entries in the output. If no value is provided, will use the value specified in the *List Size* parameter configured in the instance configuration.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?n=50\n2. **s** - The starting entry index from which to export the indicators.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?s=10\u0026n=50\n3. **v** - The output format. Supports `text`, `csv`, `json`, `json-seq`,`xsoar-json`, `xsoar-seq`, `xsoar-csv`, `mwg`, `panosurl` and `proxysg` (alias: `bluecoat`).\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=json\n4. **q** - The query used to retrieve indicators from the system.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?q=\"type:ip and sourceBrand:my_source\"\n5. **t** - Only with `mwg` format. The type indicated on the top of the exported list. Supports: string, applcontrol, dimension, category, ip, mediatype, number and regex.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=mwg\u0026t=ip\n6. **sp** - Only with `panosurl` format. If set will strip ports off URLs, otherwise will ignore URLs with ports.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=panosurl\u0026sp \n7. **di** - Only with `panosurl` format. If set will ignore URLs which are not compliant with PAN-OS URL format instead of being re-written.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=panosurl\u0026di\n8. **cd** - Only with `proxysg` format. The default category for the exported indicators.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=proxysg\u0026cd=default_category\n9. **ca** - Only with `proxysg` format. The categories which will be exported. Indicators not in these categories will be classified as the default category.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=proxysg\u0026ca=category1,category2\n10. **tr** - Whether to collapse IPs. \n    * 0 - Do not collapse. \n    * 1 - Collapse to ranges.\n    * 2 - Collapse to CIDRs.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?q=\"type:ip and sourceBrand:my_source\"\u0026tr=1\n11. **tx** - Whether to output `csv` or `xsoar-csv` formats as textual web pages.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=xsoar-csv\u0026tx\n12. **sf** - The field by which to sort the indicators by. Only applicable with the `sort_order` argument.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=xsoar-csv\u0026sf=last_seen\u0026so=asc\n13. **so** - The direction by which to order the indicators. The options are `asc` or `desc`. Only applicable with the `sort_field` argument.\n * Example: https://{cortex-xsoar_instance}/instance/execute/{ExportIndicators_instance_name}?v=xsoar-csv\u0026sf=last_seen\u0026so=desc\n\n### When running in On-Demand mode\nPlease make sure to to run !eis-update for the first time to initialize the export process.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/export-indicators)","display":"Export Indicators Service","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"ExportIndicators","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The query used to retrieve indicators from the system. Leave empty to use the query from the integration parameters. ","name":"query","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"text","deprecated":false,"description":"The output format. Can be \"text\", \"json\", \"json-seq\", \"csv\", \"XOSAR json\", \"XSOAR json-seq\", \"XSOAR csv\", \"PAN-OS URL\", \"McAfee Web Gateway\" and \"Symantec ProxySG\".","name":"format","predefined":["text","json","json-seq","csv","XSOAR json","XSOAR json-seq","XSOAR csv","McAfee Web Gateway","Symantec ProxySG","PAN-OS URL"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The maximum number of entries in the output. If no value is provided, will use the value specified in the \"List Size\" parameter configured in the instance configuration.","name":"list_size","required":false,"secret":false},{"default":false,"defaultValue":"false","deprecated":false,"description":"Whether to print the indicators. If set to \"true\" will print the indicators that were saved to the Export Indicators Service. The default value is \"false\".","name":"print_indicators","predefined":["false","true"],"required":true,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The starting entry index from which to export the indicators.","name":"offset","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"string","deprecated":false,"description":"For use with McAfee Web Gateway format to indicate the list type.","name":"mwg_type","predefined":["string","applcontrol","dimension","category","ip","mediatype","number","regex"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"For use with PAN-OS URL format - if True, will strip the port from URLs. If False, - URLs with ports will be ignored.","name":"strip_port","predefined":["True","False"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"For use with PAN-OS URL format - if True, any URL entry that is not compliant with PAN-OS EDL URL format is dropped instead of being rewritten.","name":"drop_invalids","predefined":["False","True"],"required":false,"secret":false},{"default":false,"defaultValue":"bc_category","deprecated":false,"description":"For use with Symantec ProxySG format - set the default category for the output.","name":"category_default","required":false,"secret":false},{"default":false,"deprecated":false,"description":"For use with Symantec ProxySG format - set the categories that should be listed in the output. If not set, will list all existing categories.","name":"category_attribute","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"Don't Collapse","deprecated":false,"description":"Whether to collapse IPs to ranges or CIDRs.","name":"collapse_ips","predefined":["Don't Collapse","To CIDRs","To Ranges"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"If True, will output csv and XSOAR-csv formats as textual web pages.","name":"csv_text","predefined":["False","True"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The field by which to sort the indicators by.","name":"sort_field","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The direction by which to order the indicators. The options are `asc` or `desc`.","name":"sort_order","predefined":["asc","desc"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates values stored in the Export Indicators Service (only avaialable On-Demand).","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"eis-update","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/flask-nginx:1.0.0.23674","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":true,"longRunningPortMapping":true,"resetContext":false,"runOnce":false,"script":"\n\n\n\n\nimport re\nfrom base64 import b64decode\nfrom flask import Flask, Response, request\nfrom netaddr import IPAddress, IPSet\nfrom typing import Callable, Any, cast, Dict, Tuple\nfrom math import ceil\nimport dateparser\n\n''' GLOBAL VARIABLES '''\nINTEGRATION_NAME: str = 'Export Indicators Service'\nPAGE_SIZE: int = 200\nAPP: Flask = Flask('demisto-export_iocs')\nCTX_VALUES_KEY: str = 'dmst_export_iocs_values'\nCTX_MIMETYPE_KEY: str = 'dmst_export_iocs_mimetype'\n\nFORMAT_CSV: str = 'csv'\nFORMAT_TEXT: str = 'text'\nFORMAT_JSON_SEQ: str = 'json-seq'\nFORMAT_JSON: str = 'json'\nFORMAT_ARG_MWG = 'mwg'\nFORMAT_ARG_PANOSURL = 'panosurl'\nFORMAT_ARG_BLUECOAT = 'bluecoat'\nFORMAT_ARG_PROXYSG = 'proxysg'\nFORMAT_MWG: str = 'McAfee Web Gateway'\nFORMAT_PROXYSG: str = \"Symantec ProxySG\"\nFORMAT_PANOSURL: str = \"PAN-OS URL\"\nFORMAT_XSOAR_JSON: str = 'XSOAR json'\nFORMAT_ARG_XSOAR_JSON: str = 'xsoar-json'\nFORMAT_XSOAR_JSON_SEQ: str = 'XSOAR json-seq'\nFORAMT_ARG_XSOAR_JSON_SEQ: str = 'xsoar-seq'\nFORMAT_XSOAR_CSV: str = 'XSOAR csv'\nFORMAT_ARG_XSOAR_CSV: str = 'xsoar-csv'\n\nMWG_TYPE_OPTIONS = [\"string\", \"applcontrol\", \"dimension\", \"category\", \"ip\", \"mediatype\", \"number\", \"regex\"]\n\nCTX_FORMAT_ERR_MSG: str = 'Please provide a valid format from: text, json, json-seq, csv, mgw, panosurl and proxysg'\nCTX_LIMIT_ERR_MSG: str = 'Please provide a valid integer for List Size'\nCTX_OFFSET_ERR_MSG: str = 'Please provide a valid integer for Starting Index'\nCTX_MWG_TYPE_ERR_MSG: str = 'The McAFee Web Gateway type can only be one of the following: string,' \\\n                            ' applcontrol, dimension, category, ip, mediatype, number, regex'\nCTX_COLLAPSE_ERR_MSG: str = 'The Collapse parameter can only get the following: 0 - Dont Collapse, ' \\\n                            '1 - Collapse to Ranges, 2 - Collapse to CIDRS'\nCTX_MISSING_REFRESH_ERR_MSG: str = 'Refresh Rate must be \"number date_range_unit\", examples: (2 hours, 4 minutes, ' \\\n                                   '6 months, 1 day, etc.)'\nCTX_NO_URLS_IN_PROXYSG_FORMAT = 'ProxySG format only outputs URLs - no URLs found in the current query'\n\nMIMETYPE_JSON_SEQ: str = 'application/json-seq'\nMIMETYPE_JSON: str = 'application/json'\nMIMETYPE_CSV: str = 'text/csv'\nMIMETYPE_TEXT: str = 'text/plain'\n\nDONT_COLLAPSE = \"Don't Collapse\"\nCOLLAPSE_TO_CIDR = \"To CIDRs\"\nCOLLAPSE_TO_RANGES = \"To Ranges\"\n\nSORT_ASCENDING = 'asc'\nSORT_DESCENDING = 'desc'\n\n_PROTOCOL_REMOVAL = re.compile(r'^(?:[a-z]+:)*//')\n_PORT_REMOVAL = re.compile(r'^([a-z0-9\\-\\.]+)(?:\\:[0-9]+)*')\n_INVALID_TOKEN_REMOVAL = re.compile(r'(?:[^\\./+=\\?\u0026]+\\*[^\\./+=\\?\u0026]*)|(?:[^\\./+=\\?\u0026]*\\*[^\\./+=\\?\u0026]+)')\n_BROAD_PATTERN = re.compile(r'^(?:\\*\\.)+[a-zA-Z]+(?::[0-9]+)?$')\n\n\n'''Request Arguments Class'''\n\n\nclass RequestArguments:\n    def __init__(self, query: str, out_format: str = FORMAT_TEXT, limit: int = 10000, offset: int = 0,\n                 mwg_type: str = 'string', strip_port: bool = False, drop_invalids: bool = False,\n                 category_default: str = 'bc_category', category_attribute: str = '',\n                 collapse_ips: str = DONT_COLLAPSE, csv_text: bool = False, sort_field: str = '',\n                 sort_order: str = ''):\n\n        self.query = query\n        self.out_format = out_format\n        self.limit = limit\n        self.offset = offset\n        self.mwg_type = mwg_type\n        self.strip_port = strip_port\n        self.drop_invalids = drop_invalids\n        self.category_default = category_default\n        self.category_attribute = []  # type:List\n        self.collapse_ips = collapse_ips\n        self.csv_text = csv_text\n        self.sort_field = sort_field\n        self.sort_order = sort_order\n\n        if category_attribute is not None:\n            category_attribute_list = category_attribute.split(',')\n\n            if len(category_attribute_list) != 1 or '' not in category_attribute_list:\n                self.category_attribute = category_attribute_list\n\n    def is_request_change(self, last_update_data: Dict):\n        if self.limit != last_update_data.get('last_limit'):\n            return True\n\n        elif self.offset != last_update_data.get('last_offset'):\n            return True\n\n        elif self.out_format != last_update_data.get('last_format'):\n            return True\n\n        elif self.mwg_type != last_update_data.get('mwg_type'):\n            return True\n\n        elif self.drop_invalids != last_update_data.get('drop_invalids'):\n            return True\n\n        elif self.strip_port != last_update_data.get('strip_port'):\n            return True\n\n        elif self.category_default != last_update_data.get('category_default'):\n            return True\n\n        elif self.category_attribute != last_update_data.get('category_attribute'):\n            return True\n\n        elif self.collapse_ips != last_update_data.get('collapse_ips'):\n            return True\n\n        elif self.csv_text != last_update_data.get('csv_text'):\n            return True\n\n        elif self.sort_field != last_update_data.get('sort_field'):\n            return True\n\n        elif self.sort_order != last_update_data.get('sort_order'):\n            return True\n\n        return False\n\n\n''' HELPER FUNCTIONS '''\n\n\ndef list_to_str(inp_list: list, delimiter: str = ',', map_func: Callable = str) -\u003e str:\n    \"\"\"\n    Transforms a list to an str, with a custom delimiter between each list item\n    \"\"\"\n    str_res = \"\"\n    if inp_list:\n        if isinstance(inp_list, list):\n            str_res = delimiter.join(map(map_func, inp_list))\n        else:\n            raise AttributeError('Invalid inp_list provided to list_to_str')\n    return str_res\n\n\ndef sort_iocs(request_args: RequestArguments, iocs: list) -\u003e list:\n    \"\"\"\n    Sorts the IoCs according to the sort field and order.\n    Returns: Sorted List of IoCs, if sorting arguments are defined.\n    \"\"\"\n    try:\n        if request_args.sort_field:\n            if request_args.sort_order == SORT_ASCENDING:\n                return sorted(iocs, key=lambda ioc: ioc[request_args.sort_field], reverse=False)\n            elif request_args.sort_order == SORT_DESCENDING:\n                return sorted(iocs, key=lambda ioc: ioc[request_args.sort_field], reverse=True)\n    except KeyError:\n        demisto.debug('ExportIndicators - Could not sort IoCs, please verify that you entered the correct field name.\\n'\n                      f'Field used: {request_args.sort_field}')\n    except Exception as e:\n        demisto.debug(f'ExportIndicators - Could not sort IoCs due to an unknown error.\\n{e}')\n\n    return iocs\n\n\ndef refresh_outbound_context(request_args: RequestArguments, on_demand: bool = False) -\u003e str:\n    \"\"\"\n    Refresh the values and format using an indicator_query to call demisto.searchIndicators\n    Update integration cache only in case of running on demand\n    Returns: List(IoCs in output format)\n    \"\"\"\n    now = datetime.now()\n    # poll indicators into list from demisto\n    iocs = []\n    out_dict: dict = {}\n    limit = request_args.offset + request_args.limit\n    indicator_searcher = IndicatorsSearcher(\n        query=request_args.query,\n        size=PAGE_SIZE\n    )\n    while True:\n        indicator_searcher.limit = limit + 100  # fetch more indicators to reduce chances of search after truncation\n        new_iocs = find_indicators_with_limit(indicator_searcher)[request_args.offset:limit]\n        if not new_iocs:\n            break\n        iocs += new_iocs\n        iocs = sort_iocs(request_args, iocs)\n        # reformat the output\n        out_dict, actual_indicator_amount = create_values_for_returned_dict(iocs, request_args)\n        if request_args.out_format in [FORMAT_CSV, FORMAT_XSOAR_CSV]:\n            actual_indicator_amount = actual_indicator_amount - 1\n        if actual_indicator_amount \u003e= len(iocs) or (indicator_searcher.total and indicator_searcher.total \u003c= limit):\n            # continue searching iocs if 1) iocs was truncated or 2) got all available iocs\n            break\n        # advance search window with gap size\n        limit += (limit - actual_indicator_amount)\n\n    if request_args.out_format == FORMAT_JSON:\n        out_dict[CTX_MIMETYPE_KEY] = MIMETYPE_JSON\n\n    elif request_args.out_format in [FORMAT_CSV, FORMAT_XSOAR_CSV]:\n        if request_args.csv_text:\n            out_dict[CTX_MIMETYPE_KEY] = MIMETYPE_TEXT\n\n        else:\n            out_dict[CTX_MIMETYPE_KEY] = MIMETYPE_CSV\n\n    elif request_args.out_format in [FORMAT_JSON_SEQ, FORMAT_XSOAR_JSON_SEQ]:\n        out_dict[CTX_MIMETYPE_KEY] = MIMETYPE_JSON_SEQ\n\n    else:\n        out_dict[CTX_MIMETYPE_KEY] = MIMETYPE_TEXT\n\n    if on_demand:\n        set_integration_context({\n            \"last_output\": out_dict,\n            'last_run': date_to_timestamp(now),\n            'last_limit': request_args.limit,\n            'last_offset': request_args.offset,\n            'last_format': request_args.out_format,\n            'last_query': request_args.query,\n            'current_iocs': iocs,\n            'mwg_type': request_args.mwg_type,\n            'drop_invalids': request_args.drop_invalids,\n            'strip_port': request_args.strip_port,\n            'category_default': request_args.category_default,\n            'category_attribute': request_args.category_attribute,\n            'collapse_ips': request_args.collapse_ips,\n            'csv_text': request_args.csv_text,\n            'sort_field': request_args.sort_field,\n            'sort_order': request_args.sort_order,\n        })\n    return out_dict[CTX_VALUES_KEY] if CTX_VALUES_KEY in out_dict else []\n\n\ndef find_indicators_with_limit(indicator_searcher: IndicatorsSearcher) -\u003e list:\n    \"\"\"\n    Finds indicators using demisto.searchIndicators\n    \"\"\"\n    iocs: List[dict] = []\n    for ioc_res in indicator_searcher:\n        fetched_iocs = ioc_res.get('iocs') or []\n        iocs.extend(fetched_iocs)\n    return iocs\n\n\ndef ip_groups_to_cidrs(ip_range_groups: list):\n    \"\"\"Collapse ip groups list to CIDRs\n\n    Args:\n        ip_range_groups (list): a list of lists containing connected IPs\n\n    Returns:\n        list. a list of CIDRs.\n    \"\"\"\n    ip_ranges = []  # type:List\n    for cidr in ip_range_groups:\n        # handle single ips\n        if len(cidr) == 1:\n            # CIDR with a single IP appears with \"/32\" suffix so handle them differently\n            ip_ranges.append(str(cidr[0]))\n            continue\n\n        ip_ranges.append(str(cidr))\n\n    return ip_ranges\n\n\ndef ip_groups_to_ranges(ip_range_groups: list):\n    \"\"\"Collapse ip groups list to ranges.\n\n    Args:\n        ip_range_groups (list): a list of lists containing connected IPs\n\n    Returns:\n        list. a list of Ranges.\n    \"\"\"\n    ip_ranges = []  # type:List\n    for group in ip_range_groups:\n        # handle single ips\n        if len(group) == 1:\n            ip_ranges.append(str(group[0]))\n            continue\n\n        ip_ranges.append(str(group))\n\n    return ip_ranges\n\n\ndef ips_to_ranges(ips: list, collapse_ips: str):\n    \"\"\"Collapse IPs to Ranges or CIDRs.\n\n    Args:\n        ips (list): a list of IP strings.\n        collapse_ips (str): Whether to collapse to Ranges or CIDRs.\n\n    Returns:\n        list. a list to Ranges or CIDRs.\n    \"\"\"\n\n    if collapse_ips == COLLAPSE_TO_RANGES:\n        ips_range_groups = IPSet(ips).iter_ipranges()\n        return ip_groups_to_ranges(ips_range_groups)\n\n    else:\n        cidrs = IPSet(ips).iter_cidrs()\n        return ip_groups_to_cidrs(cidrs)\n\n\ndef panos_url_formatting(iocs: list, drop_invalids: bool, strip_port: bool):\n    formatted_indicators = []  # type:List\n    for indicator_data in iocs:\n        # only format URLs and Domains\n        indicator = indicator_data.get('value')\n        if not indicator:\n            continue\n        if indicator_data.get('indicator_type') in ['URL', 'Domain', 'DomainGlob']:\n            indicator = indicator.lower()\n\n            # remove initial protocol - http/https/ftp/ftps etc\n            indicator = _PROTOCOL_REMOVAL.sub('', indicator)\n\n            indicator_with_port = indicator\n            # remove port from indicator - from demisto.com:369/rest/of/path -\u003e demisto.com/rest/of/path\n            indicator = _PORT_REMOVAL.sub(r'\\g\u003c1\u003e', indicator)\n            # check if removing the port changed something about the indicator\n            if indicator != indicator_with_port and not strip_port:\n                # if port was in the indicator and strip_port param not set - ignore the indicator\n                continue\n\n            with_invalid_tokens_indicator = indicator\n            # remove invalid tokens from indicator\n            indicator = _INVALID_TOKEN_REMOVAL.sub('*', indicator)\n\n            # check if the indicator held invalid tokens\n            if with_invalid_tokens_indicator != indicator:\n                # invalid tokens in indicator- if drop_invalids is set - ignore the indicator\n                if drop_invalids:\n                    continue\n\n                # check if after removing the tokens the indicator is too broad if so - ignore\n                # example of too broad terms: \"*.paloalto\", \"*.*.paloalto\", \"*.paloalto:60\"\n                hostname = indicator\n                if '/' in hostname:\n                    hostname, _ = hostname.split('/', 1)\n\n                if _BROAD_PATTERN.match(hostname) is not None:\n                    continue\n\n            # for PAN-OS \"*.domain.com\" does not match \"domain.com\" - we should provide both\n            if indicator.startswith('*.'):\n                formatted_indicators.append(indicator[2:])\n\n        formatted_indicators.append(indicator)\n    return {CTX_VALUES_KEY: list_to_str(formatted_indicators, '\\n')}, len(formatted_indicators)\n\n\ndef create_json_out_format(iocs: list):\n    formatted_indicators = []  # type:List\n    for indicator_data in iocs:\n        if indicator_data.get(\"value\"):\n            json_format_indicator = json_format_single_indicator(indicator_data)\n            formatted_indicators.append(json_format_indicator)\n\n    return {CTX_VALUES_KEY: json.dumps(formatted_indicators)}\n\n\ndef json_format_single_indicator(indicator: dict):\n    json_format_indicator = {\n        \"indicator\": indicator.get(\"value\")\n    }\n    indicator.pop(\"value\", None)\n\n    json_format_indicator[\"value\"] = indicator\n    return json_format_indicator\n\n\ndef add_indicator_to_category(indicator, category, category_dict):\n    if category in category_dict.keys():\n        category_dict[category].append(indicator)\n\n    else:\n        category_dict[category] = [indicator]\n\n    return category_dict\n\n\ndef create_proxysg_out_format(iocs: list, category_attribute: list, category_default: str = 'bc_category'):\n    formatted_indicators = ''\n    category_dict = {}  # type:Dict\n    num_of_returned_indicators = 0\n\n    for indicator in iocs:\n        if indicator.get('indicator_type') in ['URL', 'Domain', 'DomainGlob'] and indicator.get('value'):\n            stripped_indicator = _PROTOCOL_REMOVAL.sub('', indicator.get('value'))\n            indicator_proxysg_category = indicator.get('proxysgcategory')\n            # if a ProxySG Category is set and it is in the category_attribute list or that the attribute list is empty\n            # than list add the indicator to it's category list\n            if indicator_proxysg_category is not None and \\\n                    (indicator_proxysg_category in category_attribute or len(category_attribute) == 0):\n                category_dict = add_indicator_to_category(stripped_indicator, indicator_proxysg_category,\n                                                          category_dict)\n\n            else:\n                # if ProxySG Category is not set or does not exist in the category_attribute list\n                category_dict = add_indicator_to_category(stripped_indicator, category_default, category_dict)\n\n    for category, indicator_list in category_dict.items():\n        sub_output_string = f\"define category {category}\\n\"\n        sub_output_string += list_to_str(indicator_list, '\\n')\n        sub_output_string += \"\\nend\\n\"\n        formatted_indicators += sub_output_string\n        num_of_returned_indicators = num_of_returned_indicators + len(indicator_list)\n\n    if len(formatted_indicators) == 0:\n        raise Exception(CTX_NO_URLS_IN_PROXYSG_FORMAT)\n\n    return {CTX_VALUES_KEY: formatted_indicators}, num_of_returned_indicators\n\n\ndef create_mwg_out_format(iocs: list, mwg_type: str) -\u003e dict:\n    formatted_indicators = []  # type:List\n    for indicator in iocs:\n        if not indicator.get('value'):\n            continue\n        value = \"\\\"\" + indicator.get('value') + \"\\\"\"\n        sources = indicator.get('sourceBrands')\n        if sources:\n            sources_string = \"\\\"\" + ','.join(sources) + \"\\\"\"\n\n        else:\n            sources_string = \"\\\"from CORTEX XSOAR\\\"\"\n\n        formatted_indicators.append(value + \" \" + sources_string)\n\n    string_formatted_indicators = list_to_str(formatted_indicators, '\\n')\n\n    if isinstance(mwg_type, list):\n        mwg_type = mwg_type[0]\n\n    string_formatted_indicators = \"type=\" + mwg_type + \"\\n\" + string_formatted_indicators\n\n    return {CTX_VALUES_KEY: string_formatted_indicators}\n\n\ndef create_values_for_returned_dict(iocs: list, request_args: RequestArguments) -\u003e Tuple[dict, int]:\n    \"\"\"\n    Create a dictionary for output values using the selected format (json, json-seq, text, csv, McAfee Web Gateway,\n    Symantec ProxySG, panosurl)\n    \"\"\"\n    if request_args.out_format == FORMAT_PANOSURL:\n        return panos_url_formatting(iocs, request_args.drop_invalids, request_args.strip_port)\n\n    if request_args.out_format == FORMAT_PROXYSG:\n        return create_proxysg_out_format(iocs, request_args.category_attribute, request_args.category_default)\n\n    if request_args.out_format == FORMAT_MWG:\n        return create_mwg_out_format(iocs, request_args.mwg_type), len(iocs)\n\n    if request_args.out_format == FORMAT_JSON:\n        return create_json_out_format(iocs), len(iocs)\n\n    if request_args.out_format == FORMAT_XSOAR_JSON:\n        iocs_list = [ioc for ioc in iocs]\n        return {CTX_VALUES_KEY: json.dumps(iocs_list)}, len(iocs)\n\n    else:\n        ipv4_formatted_indicators = []\n        ipv6_formatted_indicators = []\n        formatted_indicators = []\n        if request_args.out_format == FORMAT_XSOAR_CSV and len(iocs) \u003e 0:  # add csv keys as first item\n            headers = list(iocs[0].keys())\n            formatted_indicators.append(list_to_str(headers))\n\n        elif request_args.out_format == FORMAT_CSV and len(iocs) \u003e 0:\n            formatted_indicators.append('indicator')\n\n        for ioc in iocs:\n            value = ioc.get('value')\n            type = ioc.get('indicator_type')\n            if value:\n                if request_args.out_format in [FORMAT_TEXT, FORMAT_CSV]:\n                    if type == 'IP' and request_args.collapse_ips != DONT_COLLAPSE:\n                        ipv4_formatted_indicators.append(IPAddress(value))\n\n                    elif type == 'IPv6' and request_args.collapse_ips != DONT_COLLAPSE:\n                        ipv6_formatted_indicators.append(IPAddress(value))\n\n                    else:\n                        formatted_indicators.append(value)\n\n                elif request_args.out_format == FORMAT_XSOAR_JSON_SEQ:\n                    formatted_indicators.append(json.dumps(ioc))\n\n                elif request_args.out_format == FORMAT_JSON_SEQ:\n                    json_format_indicator = json_format_single_indicator(ioc)\n                    formatted_indicators.append(json.dumps(json_format_indicator))\n\n                elif request_args.out_format == FORMAT_XSOAR_CSV:\n                    # wrap csv values with \" to escape them\n                    values = list(ioc.values())\n                    formatted_indicators.append(list_to_str(values, map_func=lambda val: f'\"{val}\"'))\n\n        if len(ipv4_formatted_indicators) \u003e 0:\n            ipv4_formatted_indicators = ips_to_ranges(ipv4_formatted_indicators, request_args.collapse_ips)\n            formatted_indicators.extend(ipv4_formatted_indicators)\n\n        if len(ipv6_formatted_indicators) \u003e 0:\n            ipv6_formatted_indicators = ips_to_ranges(ipv6_formatted_indicators, request_args.collapse_ips)\n            formatted_indicators.extend(ipv6_formatted_indicators)\n\n    return {CTX_VALUES_KEY: list_to_str(formatted_indicators, '\\n')}, len(formatted_indicators)\n\n\ndef get_outbound_mimetype() -\u003e str:\n    \"\"\"Returns the mimetype of the export_iocs\"\"\"\n    ctx = get_integration_context().get('last_output', {})\n    return ctx.get(CTX_MIMETYPE_KEY, 'text/plain')\n\n\ndef get_outbound_ioc_values(on_demand, request_args: RequestArguments,\n                            last_update_data=None, cache_refresh_rate=None) -\u003e str:\n    \"\"\"\n    Get the ioc list to return in the list\n    \"\"\"\n    if last_update_data is None:\n        last_update_data = {}\n\n    last_update = last_update_data.get('last_run')\n    last_query = last_update_data.get('last_query')\n    current_iocs = last_update_data.get('current_iocs')\n\n    # on_demand ignores cache\n    if on_demand:\n        if request_args.is_request_change(last_update_data):\n            values_str = get_ioc_values_str_from_context(request_args=request_args, iocs=current_iocs)\n\n        else:\n            values_str = get_ioc_values_str_from_context(request_args=request_args)\n\n    else:\n        if last_update:\n            # takes the cache_refresh_rate amount of time back since run time.\n            cache_time, _ = parse_date_range(cache_refresh_rate, to_timestamp=True)\n            if last_update \u003c= cache_time or request_args.is_request_change(last_update_data) or \\\n                    request_args.query != last_query:\n                values_str = refresh_outbound_context(request_args=request_args)\n            else:\n                values_str = get_ioc_values_str_from_context(request_args=request_args)\n        else:\n            values_str = refresh_outbound_context(request_args)\n\n    return values_str\n\n\ndef get_ioc_values_str_from_context(request_args: RequestArguments, iocs=None) -\u003e str:\n    \"\"\"\n    Extracts output values from cache\n    \"\"\"\n    if iocs:\n        if request_args.offset \u003e len(iocs):\n            return ''\n\n        iocs = iocs[request_args.offset: request_args.limit + request_args.offset]\n        returned_dict, _ = create_values_for_returned_dict(iocs, request_args=request_args)\n        current_cache = get_integration_context()\n        current_cache['last_output'] = returned_dict\n        set_integration_context(current_cache)\n\n    else:\n        returned_dict = get_integration_context().get('last_output', {})\n\n    return returned_dict.get(CTX_VALUES_KEY, '')\n\n\ndef try_parse_integer(int_to_parse: Any, err_msg: str) -\u003e int:\n    \"\"\"\n    Tries to parse an integer, and if fails will throw DemistoException with given err_msg\n    \"\"\"\n    try:\n        res = int(int_to_parse)\n    except (TypeError, ValueError):\n        raise DemistoException(err_msg)\n    return res\n\n\ndef validate_basic_authentication(headers: dict, username: str, password: str) -\u003e bool:\n    \"\"\"\n    Checks whether the authentication is valid.\n    :param headers: The headers of the http request\n    :param username: The integration's username\n    :param password: The integration's password\n    :return: Boolean which indicates whether the authentication is valid or not\n    \"\"\"\n    credentials: str = headers.get('Authorization', '')\n    if not credentials or 'Basic ' not in credentials:\n        return False\n    encoded_credentials: str = credentials.split('Basic ')[1]\n    credentials: str = b64decode(encoded_credentials).decode('utf-8')\n    if ':' not in credentials:\n        return False\n    credentials_list = credentials.split(':')\n    if len(credentials_list) != 2:\n        return False\n    user, pwd = credentials_list\n    return user == username and pwd == password\n\n\n''' ROUTE FUNCTIONS '''\n\n\ndef get_request_args(params):\n    limit = try_parse_integer(request.args.get('n', params.get('list_size', 10000)), CTX_LIMIT_ERR_MSG)\n    offset = try_parse_integer(request.args.get('s', 0), CTX_OFFSET_ERR_MSG)\n    out_format = request.args.get('v', params.get('format', 'text'))\n    query = request.args.get('q', params.get('indicators_query'))\n    mwg_type = request.args.get('t', params.get('mwg_type', \"string\"))\n    strip_port = request.args.get('sp', params.get('strip_port', False))\n    drop_invalids = request.args.get('di', params.get('drop_invalids', False))\n    category_default = request.args.get('cd', params.get('category_default', 'bc_category'))\n    category_attribute = request.args.get('ca', params.get('category_attribute', ''))\n    collapse_ips = request.args.get('tr', params.get('collapse_ips', DONT_COLLAPSE))\n    csv_text = request.args.get('tx', params.get('csv_text', False))\n    sort_field = request.args.get('sf', params.get('sort_field'))\n    sort_order = request.args.get('so', params.get('sort_order'))\n\n    # handle flags\n    if strip_port is not None and strip_port == '':\n        strip_port = True\n\n    if drop_invalids is not None and drop_invalids == '':\n        drop_invalids = True\n\n    if csv_text is not None and csv_text == '':\n        csv_text = True\n\n    if collapse_ips is not None and collapse_ips not in [DONT_COLLAPSE, COLLAPSE_TO_CIDR, COLLAPSE_TO_RANGES]:\n        collapse_ips = try_parse_integer(collapse_ips, CTX_COLLAPSE_ERR_MSG)\n        if collapse_ips == 0:\n            collapse_ips = DONT_COLLAPSE\n\n        elif collapse_ips == 1:\n            collapse_ips = COLLAPSE_TO_RANGES\n\n        elif collapse_ips == 2:\n            collapse_ips = COLLAPSE_TO_CIDR\n\n    # prevent given empty params\n    if len(query) == 0:\n        query = params.get('indicators_query')\n\n    if len(out_format) == 0:\n        out_format = params.get('format', 'text')\n\n    if out_format not in [FORMAT_PROXYSG, FORMAT_PANOSURL, FORMAT_TEXT, FORMAT_JSON, FORMAT_CSV,\n                          FORMAT_JSON_SEQ, FORMAT_MWG, FORMAT_ARG_BLUECOAT, FORMAT_ARG_MWG, FORMAT_ARG_PANOSURL,\n                          FORMAT_ARG_PROXYSG, FORMAT_ARG_PANOSURL, FORMAT_XSOAR_JSON, FORMAT_ARG_XSOAR_JSON,\n                          FORMAT_XSOAR_JSON_SEQ, FORAMT_ARG_XSOAR_JSON_SEQ, FORMAT_XSOAR_CSV, FORMAT_ARG_XSOAR_CSV]:\n        raise DemistoException(CTX_FORMAT_ERR_MSG)\n\n    elif out_format in [FORMAT_ARG_PROXYSG, FORMAT_ARG_BLUECOAT]:\n        out_format = FORMAT_PROXYSG\n\n    elif out_format == FORMAT_ARG_MWG:\n        out_format = FORMAT_MWG\n\n    elif out_format == FORMAT_ARG_PANOSURL:\n        out_format = FORMAT_PANOSURL\n\n    elif out_format == FORMAT_ARG_XSOAR_JSON:\n        out_format = FORMAT_XSOAR_JSON\n\n    elif out_format == FORAMT_ARG_XSOAR_JSON_SEQ:\n        out_format = FORMAT_XSOAR_JSON_SEQ\n\n    elif out_format == FORMAT_ARG_XSOAR_CSV:\n        out_format = FORMAT_XSOAR_CSV\n\n    if out_format == FORMAT_MWG:\n        if mwg_type not in MWG_TYPE_OPTIONS:\n            raise DemistoException(CTX_MWG_TYPE_ERR_MSG)\n\n    return RequestArguments(query, out_format, limit, offset, mwg_type, strip_port, drop_invalids, category_default,\n                            category_attribute, collapse_ips, csv_text, sort_field, sort_order)\n\n\n@APP.route('/', methods=['GET'])\ndef route_list_values() -\u003e Response:\n    \"\"\"\n    Main handler for values saved in the integration context\n    \"\"\"\n    try:\n        params = demisto.params()\n\n        credentials = params.get('credentials') if params.get('credentials') else {}\n        username: str = credentials.get('identifier', '')\n        password: str = credentials.get('password', '')\n        if username and password:\n            headers: dict = cast(Dict[Any, Any], request.headers)\n            if not validate_basic_authentication(headers, username, password):\n                err_msg: str = 'Basic authentication failed. Make sure you are using the right credentials.'\n                demisto.debug(err_msg)\n                return Response(err_msg, status=401, mimetype='text/plain', headers=[\n                    ('WWW-Authenticate', 'Basic realm=\"Login Required\"'),\n                ])\n\n        request_args = get_request_args(params)\n        created = datetime.now(timezone.utc)\n        cache_refresh_rate = params.get('cache_refresh_rate')\n\n        values = get_outbound_ioc_values(\n            on_demand=params.get('on_demand'),\n            last_update_data=get_integration_context(),\n            cache_refresh_rate=cache_refresh_rate,\n            request_args=request_args\n        )\n        query_time = (datetime.now(timezone.utc) - created).total_seconds()\n\n        if not get_integration_context() and params.get('on_demand'):\n            values = 'You are running in On-Demand mode - please run !eis-update command to initialize the ' \\\n                     'export process'\n\n        elif not values:\n            values = \"No Results Found For the Query\"\n\n        # if the case there are strings to add to the EDL, add them if the output type is text\n        if request_args.out_format == FORMAT_TEXT:\n            append_str = params.get(\"append_string\")\n            prepend_str = params.get(\"prepend_string\")\n            if append_str:\n                append_str = append_str.replace(\"\\\\n\", \"\\n\")\n                values = f\"{values}{append_str}\"\n            if prepend_str:\n                prepend_str = prepend_str.replace(\"\\\\n\", \"\\n\")\n                values = f\"{prepend_str}\\n{values}\"\n\n        mimetype = get_outbound_mimetype()\n\n        list_size = 0\n        if values.strip():\n            list_size = values.count('\\n') + 1  # add 1 as last line doesn't have a \\n\n        max_age = ceil((datetime.now() - dateparser.parse(cache_refresh_rate)).total_seconds())  # type: ignore[operator]\n        demisto.debug(f'Returning exported indicators list of size: [{list_size}], created: [{created}], '\n                      f'query time seconds: [{query_time}], max age: [{max_age}]')\n        resp = Response(values, status=200, mimetype=mimetype, headers=[\n            ('X-ExportIndicators-Created', created.isoformat()),\n            ('X-ExportIndicators-Query-Time-Secs', \"{:.3f}\".format(query_time)),\n            ('X-ExportIndicators-Size', str(list_size))\n        ])\n        resp.cache_control.max_age = max_age\n        resp.cache_control[\n            'stale-if-error'] = '600'  # number of seconds we are willing to serve stale content when there is an error\n        return resp\n\n    except Exception:\n        return Response(traceback.format_exc(), status=400, mimetype='text/plain')\n\n\n''' COMMAND FUNCTIONS '''\n\n\ndef test_module(args, params):\n    \"\"\"\n    Validates:\n        1. Valid port.\n        2. Valid cache_refresh_rate\n    \"\"\"\n    get_params_port(params)\n    on_demand = params.get('on_demand', None)\n    if not on_demand:\n        try_parse_integer(params.get('list_size'), CTX_LIMIT_ERR_MSG)  # validate export_iocs Size was set\n        query = params.get('indicators_query')  # validate indicators_query isn't empty\n        if not query:\n            raise ValueError('\"Indicator Query\" is required. Provide a valid query.')\n        cache_refresh_rate = params.get('cache_refresh_rate', '')\n        if not cache_refresh_rate:\n            raise ValueError(CTX_MISSING_REFRESH_ERR_MSG)\n        # validate cache_refresh_rate value\n        range_split = cache_refresh_rate.split(' ')\n        if len(range_split) != 2:\n            raise ValueError(CTX_MISSING_REFRESH_ERR_MSG)\n        try_parse_integer(range_split[0], 'Invalid time value for the Refresh Rate. Must be a valid integer.')\n        if not range_split[1] in ['minute', 'minutes', 'hour', 'hours', 'day', 'days', 'month', 'months', 'year',\n                                  'years']:\n            raise ValueError(\n                'Invalid time unit for the Refresh Rate. Must be minutes, hours, days, months, or years.')\n        parse_date_range(cache_refresh_rate, to_timestamp=True)\n    run_long_running(params, is_test=True)\n    return 'ok'\n\n\ndef update_outbound_command(args, params):\n    \"\"\"\n    Updates the export_iocs values and format on demand\n    \"\"\"\n    on_demand = params.get('on_demand')\n    if not on_demand:\n        raise DemistoException(\n            '\"Update exported IOCs On Demand\" is off. If you want to update manually please toggle it on.')\n    limit = try_parse_integer(args.get('list_size', params.get('list_size')), CTX_LIMIT_ERR_MSG)\n    print_indicators = args.get('print_indicators')\n\n    query = args.get('query')\n    # in case no query is entered take the query in the integration params\n    if not query:\n        query = params.get('indicators_query')\n\n    out_format = args.get('format')\n    offset = try_parse_integer(args.get('offset', 0), CTX_OFFSET_ERR_MSG)\n    mwg_type = args.get('mwg_type')\n    strip_port = args.get('strip_port') == 'True'\n    drop_invalids = args.get('drop_invalids') == 'True'\n    category_attribute = args.get('category_attribute')\n    category_default = args.get('category_default')\n    collapse_ips = args.get('collapse_ips')\n    csv_text = args.get('csv_text') == 'True'\n    sort_field = args.get('sort_field')\n    sort_order = args.get('sort_order')\n\n    request_args = RequestArguments(query, out_format, limit, offset, mwg_type, strip_port, drop_invalids,\n                                    category_default, category_attribute, collapse_ips, csv_text, sort_field, sort_order)\n\n    indicators = refresh_outbound_context(request_args, on_demand=on_demand)\n    if indicators:\n        hr = tableToMarkdown('List was updated successfully with the following values', indicators,\n                             ['Indicators']) if print_indicators == 'true' else 'List was updated successfully'\n\n    else:\n        hr = \"No Results Found For the Query\"\n\n    return CommandResults(readable_output=hr, raw_response=indicators)\n\n\ndef main():\n    \"\"\"\n    Main\n    \"\"\"\n    params = demisto.params()\n\n    credentials = params.get('credentials') if params.get('credentials') else {}\n    username: str = credentials.get('identifier', '')\n    password: str = credentials.get('password', '')\n    if (username and not password) or (password and not username):\n        err_msg: str = 'If using credentials, both username and password should be provided.'\n        demisto.debug(err_msg)\n        raise DemistoException(err_msg)\n\n    command = demisto.command()\n    demisto.debug('Command being called is {}'.format(command))\n    commands = {\n        'test-module': test_module,\n        'eis-update': update_outbound_command\n    }\n\n    try:\n        if command == 'long-running-execution':\n            run_long_running(params)\n        elif command in commands:\n            return_results(commands[command](demisto.args(), params))\n        else:\n            raise NotImplementedError(f'Command \"{command}\" is not implemented.')\n    except Exception as e:\n        demisto.error(traceback.format_exc())\n        err_msg = f'Error in {INTEGRATION_NAME} Integration [{e}]'\n        return_error(err_msg)\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\n\nfrom multiprocessing import Process\nfrom gevent.pywsgi import WSGIServer\nimport subprocess\nimport gevent\nfrom signal import SIGUSR1\nimport requests\nfrom flask.logging import default_handler\nfrom typing import Any, Dict\nimport os\nimport traceback\nfrom string import Template\n\n\nclass Handler:\n    @staticmethod\n    def write(msg: str):\n        demisto.info(msg)\n\n\nclass ErrorHandler:\n    @staticmethod\n    def write(msg: str):\n        demisto.error(f'wsgi error: {msg}')\n\n\nDEMISTO_LOGGER: Handler = Handler()\nERROR_LOGGER: ErrorHandler = ErrorHandler()\n\n\n# nginx server params\nNGINX_SERVER_ACCESS_LOG = '/var/log/nginx/access.log'\nNGINX_SERVER_ERROR_LOG = '/var/log/nginx/error.log'\nNGINX_SERVER_CONF_FILE = '/etc/nginx/conf.d/default.conf'\nNGINX_SSL_KEY_FILE = '/etc/nginx/ssl/ssl.key'\nNGINX_SSL_CRT_FILE = '/etc/nginx/ssl/ssl.crt'\nNGINX_SSL_CERTS = f'''\n    ssl_certificate {NGINX_SSL_CRT_FILE};\n    ssl_certificate_key {NGINX_SSL_KEY_FILE};\n'''\nNGINX_SERVER_CONF = '''\nserver {\n\n    listen $port default_server $ssl;\n\n    $sslcerts\n\n    proxy_cache_key $scheme$proxy_host$request_uri$extra_cache_key;\n\n    # Static test file\n    location = /nginx-test {\n        alias /var/lib/nginx/html/index.html;\n        default_type text/html;\n    }\n\n    # Proxy everything to python\n    location / {\n        proxy_pass http://localhost:$serverport/;\n        add_header X-Proxy-Cache $upstream_cache_status;\n        # allow bypassing the cache with an arg of nocache=1 ie http://server:7000/?nocache=1\n        proxy_cache_bypass $arg_nocache;\n    }\n}\n\n'''\n\n\ndef create_nginx_server_conf(file_path: str, port: int, params: Dict):\n    \"\"\"Create nginx conf file\n\n    Args:\n        file_path (str): path of server conf file\n        port (int): listening port. server port to proxy to will be port+1\n        params (Dict): additional nginx params\n\n    Raises:\n        DemistoException: raised if there is a detected config error\n    \"\"\"\n    params = demisto.params() if not params else params\n    template_str = params.get('nginx_server_conf') or NGINX_SERVER_CONF\n    certificate: str = params.get('certificate', '')\n    private_key: str = params.get('key', '')\n    ssl = ''\n    sslcerts = ''\n    serverport = port + 1\n    extra_cache_key = ''\n    if (certificate and not private_key) or (private_key and not certificate):\n        raise DemistoException('If using HTTPS connection, both certificate and private key should be provided.')\n    if certificate and private_key:\n        demisto.debug('Using HTTPS for nginx conf')\n        with open(NGINX_SSL_CRT_FILE, 'wt') as f:\n            f.write(certificate)\n        with open(NGINX_SSL_KEY_FILE, 'wt') as f:\n            f.write(private_key)\n        ssl = 'ssl'  # to be included in the listen directive\n        sslcerts = NGINX_SSL_CERTS\n    credentials = params.get('credentials') or {}\n    if credentials.get('identifier'):\n        extra_cache_key = \"$http_authorization\"\n    server_conf = Template(template_str).safe_substitute(port=port, serverport=serverport, ssl=ssl,\n                                                         sslcerts=sslcerts, extra_cache_key=extra_cache_key)\n    with open(file_path, mode='wt+') as f:\n        f.write(server_conf)\n\n\ndef start_nginx_server(port: int, params: Dict = {}) -\u003e subprocess.Popen:\n    params = demisto.params() if not params else params\n    create_nginx_server_conf(NGINX_SERVER_CONF_FILE, port, params)\n    nginx_global_directives = 'daemon off;'\n    global_directives_conf = params.get('nginx_global_directives')\n    if global_directives_conf:\n        nginx_global_directives = f'{nginx_global_directives} {global_directives_conf}'\n    directive_args = ['-g', nginx_global_directives]\n    # we first do a test that all config is good and log it\n    try:\n        nginx_test_command = ['nginx', '-T']\n        nginx_test_command.extend(directive_args)\n        test_output = subprocess.check_output(nginx_test_command, stderr=subprocess.STDOUT, text=True)\n        demisto.info(f'ngnix test passed. command: [{nginx_test_command}]')\n        demisto.debug(f'nginx test ouput:\\n{test_output}')\n    except subprocess.CalledProcessError as err:\n        raise ValueError(f\"Failed testing nginx conf. Return code: {err.returncode}. Output: {err.output}\")\n    nginx_command = ['nginx']\n    nginx_command.extend(directive_args)\n    res = subprocess.Popen(nginx_command, text=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)\n    demisto.info(f'done starting nginx with pid: {res.pid}')\n    return res\n\n\ndef nginx_log_process(nginx_process: subprocess.Popen):\n    try:\n        old_access = NGINX_SERVER_ACCESS_LOG + '.old'\n        old_error = NGINX_SERVER_ERROR_LOG + '.old'\n        log_access = False\n        log_error = False\n        # first check if one of the logs are missing. This may happen on rare ocations that we renamed and deleted the file\n        # before nginx completed the role over of the logs\n        missing_log = False\n        if not os.path.isfile(NGINX_SERVER_ACCESS_LOG):\n            missing_log = True\n            demisto.info(f'Missing access log: {NGINX_SERVER_ACCESS_LOG}. Will send roll signal to nginx.')\n        if not os.path.isfile(NGINX_SERVER_ERROR_LOG):\n            missing_log = True\n            demisto.info(f'Missing error log: {NGINX_SERVER_ERROR_LOG}. Will send roll signal to nginx.')\n        if missing_log:\n            nginx_process.send_signal(int(SIGUSR1))\n            demisto.info(f'Done sending roll signal to nginx (pid: {nginx_process.pid}) after detecting missing log file.'\n                         ' Will skip this iteration.')\n            return\n        if os.path.getsize(NGINX_SERVER_ACCESS_LOG):\n            log_access = True\n            os.rename(NGINX_SERVER_ACCESS_LOG, old_access)\n        if os.path.getsize(NGINX_SERVER_ERROR_LOG):\n            log_error = True\n            os.rename(NGINX_SERVER_ERROR_LOG, old_error)\n        if log_access or log_error:\n            # nginx rolls the logs when getting sigusr1\n            nginx_process.send_signal(int(SIGUSR1))\n            gevent.sleep(0.5)  # sleep 0.5 to let nginx complete the roll\n        if log_access:\n            with open(old_access, 'rt') as f:\n                start = 1\n                for lines in batch(f.readlines(), 100):\n                    end = start + len(lines)\n                    demisto.info(f'nginx access log ({start}-{end-1}): ' + ''.join(lines))\n                    start = end\n            os.unlink(old_access)\n        if log_error:\n            with open(old_error, 'rt') as f:\n                start = 1\n                for lines in batch(f.readlines(), 100):\n                    end = start + len(lines)\n                    demisto.error(f'nginx error log ({start}-{end-1}): ' + ''.join(lines))\n                    start = end\n            os.unlink(old_error)\n    except Exception as e:\n        demisto.error(f'Failed nginx log processing: {e}. Exception: {traceback.format_exc()}')\n\n\ndef nginx_log_monitor_loop(nginx_process: subprocess.Popen):\n    \"\"\"An endless loop to monitor nginx logs. Meant to be spawned as a greenlet.\n    Will run every minute and if needed will dump the nginx logs and roll them if needed.\n\n    Args:\n        nginx_process (subprocess.Popen): the nginx process. Will send signal for log rolling.\n    \"\"\"\n    while True:\n        gevent.sleep(60)\n        nginx_log_process(nginx_process)\n\n\ndef test_nginx_server(port: int, params: Dict):\n    nginx_process = start_nginx_server(port, params)\n    # let nginx startup\n    time.sleep(0.5)\n    try:\n        protocol = 'https' if params.get('key') else 'http'\n        res = requests.get(f'{protocol}://localhost:{port}/nginx-test',\n                           verify=False, proxies={\"http\": \"\", \"https\": \"\"})  # nosec guardrails-disable-line\n        res.raise_for_status()\n        welcome = 'Welcome to nginx'\n        if welcome not in res.text:\n            raise ValueError(f'Unexpected response from nginx-text (does not contain \"{welcome}\"): {res.text}')\n    finally:\n        try:\n            nginx_process.terminate()\n            nginx_process.wait(1.0)\n        except Exception as ex:\n            demisto.error(f'failed stoping test nginx process: {ex}')\n\n\ndef try_parse_integer(int_to_parse: Any, err_msg: str) -\u003e int:\n    \"\"\"\n    Tries to parse an integer, and if fails will throw DemistoException with given err_msg\n    \"\"\"\n    try:\n        res = int(int_to_parse)\n    except (TypeError, ValueError):\n        raise DemistoException(err_msg)\n    return res\n\n\ndef get_params_port(params: Dict = None) -\u003e int:\n    \"\"\"\n    Gets port from the integration parameters\n    \"\"\"\n    params = demisto.params() if not params else params\n    port_mapping: str = params.get('longRunningPort', '')\n    err_msg: str\n    port: int\n    if port_mapping:\n        err_msg = f'Listen Port must be an integer. {port_mapping} is not valid.'\n        if ':' in port_mapping:\n            port = try_parse_integer(port_mapping.split(':')[1], err_msg)\n        else:\n            port = try_parse_integer(port_mapping, err_msg)\n    else:\n        raise ValueError('Please provide a Listen Port.')\n    return port\n\n\ndef run_long_running(params: Dict = None, is_test: bool = False):\n    \"\"\"\n    Start the long running server\n    :param params: Demisto params\n    :param is_test: Indicates whether it's test-module run or regular run\n    :return: None\n    \"\"\"\n    params = demisto.params() if not params else params\n    nginx_process = None\n    nginx_log_monitor = None\n\n    try:\n\n        nginx_port = get_params_port()\n        server_port = nginx_port + 1\n        # set our own log handlers\n        APP.logger.removeHandler(default_handler)  # type: ignore[name-defined] # pylint: disable=E0602\n        integration_logger = IntegrationLogger()\n        integration_logger.buffering = False\n        log_handler = DemistoHandler(integration_logger)\n        log_handler.setFormatter(\n            logging.Formatter(\"flask log: [%(asctime)s] %(levelname)s in %(module)s: %(message)s\")\n        )\n        APP.logger.addHandler(log_handler)  # type: ignore[name-defined] # pylint: disable=E0602\n        demisto.debug('done setting demisto handler for logging')\n        server = WSGIServer(('0.0.0.0', server_port),\n                            APP, log=DEMISTO_LOGGER,  # type: ignore[name-defined] # pylint: disable=E0602\n                            error_log=ERROR_LOGGER)\n        if is_test:\n            test_nginx_server(nginx_port, params)\n            server_process = Process(target=server.serve_forever)\n            server_process.start()\n            time.sleep(5)\n            try:\n                server_process.terminate()\n                server_process.join(1.0)\n            except Exception as ex:\n                demisto.error(f'failed stoping test wsgi server process: {ex}')\n\n        else:\n            nginx_process = start_nginx_server(nginx_port, params)\n            nginx_log_monitor = gevent.spawn(nginx_log_monitor_loop, nginx_process)\n            demisto.updateModuleHealth('')\n            server.serve_forever()\n    except Exception as e:\n        error_message = str(e)\n        demisto.error(f'An error occurred: {error_message}. Exception: {traceback.format_exc()}')\n        demisto.updateModuleHealth(f'An error occurred: {error_message}')\n        raise ValueError(error_message)\n\n    finally:\n        if nginx_process:\n            try:\n                nginx_process.terminate()\n            except Exception as ex:\n                demisto.error(f'Failed stopping nginx process when exiting: {ex}')\n        if nginx_log_monitor:\n            try:\n                nginx_log_monitor.kill(timeout=1.0)\n            except Exception as ex:\n                demisto.error(f'Failed stopping nginx_log_monitor when exiting: {ex}')\n\n\n\n\nif __name__ in ['__main__', '__builtin__', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.11","modified":"2021-08-24T19:09:02.295393+03:00","name":"ExportIndicators","packID":"ExportIndicators","packPropagationLabels":["all"],"prevName":"ExportIndicators","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":2},{"brand":"","canGetSamples":false,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8}],"definitionId":"","description":"Send push notifications to mobile app","display":"FCM Push Notifications","fromServerVersion":"","hidden":false,"icon":"fcm.png","id":"fcm","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:28.802774+03:00","name":"fcm","packID":"","prevName":"fcm","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"Issue","display":"Select an Issue or Pull requests to Fetch","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_object","options":["Issue","Pull_requests"],"required":false,"type":15},{"defaultValue":"https://api.github.com","display":"Server URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":false,"type":0},{"defaultValue":"","display":"API Token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"token","options":null,"required":false,"type":4},{"defaultValue":"","display":"Credentials","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Username of the repository owner, for example: github.com/repos/{_owner_}/{repo}/issues","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"user","options":null,"required":false,"type":0},{"defaultValue":"","display":"The name of the requested repository","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"repository","options":null,"required":false,"type":0},{"defaultValue":"3","display":"First fetch interval (in days)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_time","options":null,"required":false,"type":0},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"GitHub app integration ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"integration_id","options":null,"required":false,"type":0},{"defaultValue":"","display":"GitHub app installation ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"installation_id","options":null,"required":false,"type":0},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19}],"definitionId":"","description":"Integration to GitHub API","detailedDescription":"\n To access the requested repository, you need to provide \n the username, repository name, and API key as parameters for the\n integration.\n \n To generate your personal access token, visit:\n https://github.com/settings/tokens\n \n The integration supports the following workflows:\n - Create an issue\n - Update an issue\n - Close an issue\n - List all issues\n - Search for specific issues\n - Get the download count for each release in a repository\n \n \n \n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/git-hub)","display":"GitHub","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"GitHub","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The title of the issue.","name":"title","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The contents of the issue.","name":"body","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Labels to associate with this issue.","isArray":true,"name":"labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Logins for Users to assign to this issue.","isArray":true,"name":"assignees","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates an issue in GitHub.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-create-issue","outputs":[{"contentPath":"","contextPath":"GitHub.Issue.ID","description":"The ID of the created issue.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Issue.Repository","description":"The repository of the created issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Title","description":"The title of the created issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Body","description":"The body of the created issue.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Issue.State","description":"The state of the created issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Labels","description":"Labels applied to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Assignees","description":"Users assigned to this issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Created_at","description":"Date when the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Updated_at","description":"Date when the issue was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_at","description":"Date when the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_by","description":"User who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Organization","description":"The repository organization.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the issue to close.","name":"ID","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Closes an existing issue.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-close-issue","outputs":[{"contentPath":"","contextPath":"GitHub.Issue.ID","description":"The ID of the closed issue.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Issue.Repository","description":"The repository of the closed issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Title","description":"The title of the closed issue","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Body","description":"The body of the closed issue.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Issue.State","description":"The state of the closed issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Labels","description":"Labels applied to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Assignees","description":"Users assigned to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Created_at","description":"Date when the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Updated_at","description":"Date when the issue was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_at","description":"Date when the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_by","description":"User who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Organization","description":"The repository organization.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the issue to update.","name":"ID","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The title of the issue.","name":"title","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The contents of the issue.","name":"body","required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the issue. Either open or closed.","name":"state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Labels to apply to this issue. Pass one or more Labels to replace the set of Labels on this Issue. Send an empty array ([]) to clear all Labels from the Issue. ","isArray":true,"name":"labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Logins for Users to assign to this issue. Pass one or more user logins to replace the set of assignees on this Issue. Send an empty array ([]) to clear all assignees from the Issue.","isArray":true,"name":"assignees","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates the parameters of a specified issue.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-update-issue","outputs":[{"contentPath":"","contextPath":"GitHub.Issue.ID","description":"The ID of the updated issue.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Issue.Repository","description":"The repository of the updated issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Title","description":"The title of the updated issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Body","description":"The body of the updated issue.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Issue.State","description":"The state of the updated issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Labels","description":"Labels applied to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Assignees","description":"Users assigned to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Created_at","description":"Date when the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Updated_at","description":"Date when the issue was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_at","description":"Date when the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_by","description":"User who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Organization","description":"The repository organization.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":false,"defaultValue":"open","deprecated":false,"description":"The state of the issues to return. Can be 'open', 'closed' or 'all'. Default is 'open'","name":"state","predefined":["open","closed","all"],"required":true,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The number of issues to return. Default is 50. Maximum is 100.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Lists all issues that the user has access to view.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-all-issues","outputs":[{"contentPath":"","contextPath":"GitHub.Issue.ID","description":"The ID of the issue.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Issue.Repository","description":"The repository of the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Title","description":"The title of the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Body","description":"The body of the issue.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Issue.State","description":"The state of the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Labels","description":"Labels applied to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Assignees","description":"Users assigned to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Created_at","description":"Date when the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Updated_at","description":"Date when the issue was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_at","description":"Date when the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_by","description":"User who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Organization","description":"The repository organization.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The query line for the search. For more information see the GitHub documentation at https://docs.github.com/en/github/searching-for-information-on-github/searching-code","name":"query","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The page number.","name":"page_number","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The size of the requested page. Maximum is 100.","name":"page_size","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The number of results to return. Default is 50.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Searches for code in repositories that match a given query.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-search-code","outputs":[{"contentPath":"","contextPath":"GitHub.CodeSearchResults.name","description":"The file name where the code found.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.path","description":"The full file path where the code found.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.html_url","description":"The url to the file.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.full_name","description":"The repository name.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.html_url","description":"The url to the repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.description","description":"Repository description.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.private","description":"True if repository is private. and false if public.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.id","description":"The ID of the repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.releases_url","description":"The url to the releases of the repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.branches_url","description":"The url to the branches of the repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.CodeSearchResults.repository.commits_url","description":"The url to the commits of the repository.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The query line for the search. For more information see the GitHub documentation at https://help.github.com/en/articles/searching-issues-and-pull-requests.","name":"query","required":true,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The number of issues to return. Default is 50. Maximum is 100.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Searches for and returns issues that match a given query.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-search-issues","outputs":[{"contentPath":"","contextPath":"GitHub.Issue.ID","description":"The ID of the issue.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Issue.Repository","description":"The repository of the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Title","description":"The title of the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Body","description":"The body of the issue.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Issue.State","description":"The state of the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Labels","description":"Labels applied to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Assignees","description":"Users assigned to the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Created_at","description":"Date when the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Updated_at","description":"Date when the issue was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_at","description":"Date when the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Issue.Closed_by","description":"User who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitHub.Issue.Organization","description":"The repository organization.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Returns the total number of downloads for all releases for the specified repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-download-count","outputs":[{"contentPath":"","contextPath":"GitHub.Release.ID","description":"ID of the release.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Release.Download_count","description":"Download count for the release.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Release.Name","description":"Name of the release.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.Body","description":"Body of the release.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.Created_at","description":"Date when the release was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Release.Published_at","description":"Date when the release was published.","type":"Date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"defaultValue":"3 days","deprecated":false,"description":"Time of inactivity after which a PR is considered stale","name":"stale_time","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The label used to identify PRs of interest","name":"label","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get inactive pull requests","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-stale-prs","outputs":[{"contentPath":"","contextPath":"GitHub.PR.URL","description":"The html URL of the PR","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The GitHub pull request number","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer","description":"A list of the PR's requested reviewers","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the branch to retrieve","name":"branch_name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a branch","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-branch","outputs":[{"contentPath":"","contextPath":"GitHub.Branch.Name","description":"The name of the branch","type":"String"},{"contentPath":"","contextPath":"GitHub.Branch.CommitSHA","description":"The SHA of the commit the branch references","type":"String"},{"contentPath":"","contextPath":"GitHub.Branch.CommitNodeID","description":"The Node ID of the commit the branch references","type":"String"},{"contentPath":"","contextPath":"GitHub.Branch.CommitAuthorID","description":"The GitHub ID number of the author of the commit the branch references","type":"Number"},{"contentPath":"","contextPath":"GitHub.Branch.CommitAuthorLogin","description":"The GitHub login of the author of the commit the branch references","type":"String"},{"contentPath":"","contextPath":"GitHub.Branch.CommitParentSHA","description":"The SHAs of parent commits","type":"String"},{"contentPath":"","contextPath":"GitHub.Branch.Protected","description":"Whether the branch is a protected one or not","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name for the new branch","name":"branch_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The SHA hash of the commit to reference. Try executing the 'GitHub-get-branch' command to find a commit SHA hash to reference.","name":"commit_sha","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a new branch","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-create-branch","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID number by which the team is identified. Try executing the 'GitHub-list-teams' command to find team IDs to reference.","name":"team_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The login of the user whose membership you wish to check","name":"user_name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve a user's membership status with a team","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-team-membership","outputs":[{"contentPath":"","contextPath":"GitHub.Team.Member.Role","description":"The user's role on a team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Member.State","description":"The user's state for a team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.ID","description":"The ID number of the team","type":"Number"},{"contentPath":"","contextPath":"GitHub.Team.Member.Login","description":"The login of the team member","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the Pull Request for which you wish to request review","name":"pull_number","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A CSV list of GitHub users to request review from for a Pull Request","isArray":true,"name":"reviewers","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Request reviews from GitHub users for a given Pull Request","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-request-review","outputs":[{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The number of the Pull Request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Login","description":"The login of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.ID","description":"The ID of the user requested for review","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.NodeID","description":"The node ID of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Type","description":"The type of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.SiteAdmin","description":"Whether the user requested for review is a site admin or not","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the issue to comment on","name":"issue_number","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The contents of the comment","name":"body","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a comment for a given issue","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-create-comment","outputs":[{"contentPath":"","contextPath":"GitHub.Comment.IssueNumber","description":"The number of the issue to which the comment belongs","type":"Number"},{"contentPath":"","contextPath":"GitHub.Comment.ID","description":"The ID of the comment","type":"Number"},{"contentPath":"","contextPath":"GitHub.Comment.NodeID","description":"The node ID of the comment","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.Body","description":"The body content of the comment","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.Login","description":"The login of the user who commented","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.ID","description":"The ID of the user who commented","type":"Number"},{"contentPath":"","contextPath":"GitHub.Comment.User.NodeID","description":"The node ID of the user who commented","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.Type","description":"The type of the user who commented","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.SiteAdmin","description":"Whether the user who commented is a site admin or not","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the issue to list comments for","name":"issue_number","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"List comments on an issue","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-issue-comments","outputs":[{"contentPath":"","contextPath":"GitHub.Comment.IssueNumber","description":"The number of the issue to which the comment belongs","type":"Number"},{"contentPath":"","contextPath":"GitHub.Comment.ID","description":"The ID of the comment","type":"Number"},{"contentPath":"","contextPath":"GitHub.Comment.NodeID","description":"The node ID of the comment","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.Body","description":"The body content of the comment","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.Login","description":"The login of the user who commented","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.ID","description":"The ID of the user who commented","type":"Number"},{"contentPath":"","contextPath":"GitHub.Comment.User.NodeID","description":"The node ID of the user who commented","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.Type","description":"The type of the user who commented","type":"String"},{"contentPath":"","contextPath":"GitHub.Comment.User.SiteAdmin","description":"Whether the user who commented is a site admin or not","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the pull request.","name":"pull_number","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The repository of the pull request.","name":"repository","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Lists the pull request files.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-pr-files","outputs":[{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The number of the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.File.SHA","description":"The SHA hash of the last commit involving the file.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.File.Name","description":"The name of the file.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.File.Status","description":"The status of the file.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.File.Additions","description":"The number of additions to the file.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.File.Deletions","description":"The number of deletions in the file.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.File.Changes","description":"The number of changes made in the file.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the pull request","name":"pull_number","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"List reviews on a pull request","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-pr-reviews","outputs":[{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The number of the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Review.ID","description":"The ID of the review","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Review.NodeID","description":"The node ID of the review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.Body","description":"The content of the review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.CommitID","description":"The ID of the commit for which the review is applicable","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.State","description":"The state of the review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.User.Login","description":"The reviewer's user login","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.User.ID","description":"The reviewer's user ID","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Review.User.NodeID","description":"The reviewer's user node ID","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.User.Type","description":"The reviewer user type","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Review.User.SiteAdmin","description":"Whether the reviewer is a site admin or not","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The SHA hash of the commit. Try executing the 'GitHub-get-branch' command to find a commit SHA hash to reference.","name":"commit_sha","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a commit","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-commit","outputs":[{"contentPath":"","contextPath":"GitHub.Commit.SHA","description":"The SHA hash of the commit","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Author.Date","description":"The commit author date","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Author.Name","description":"The name of the author","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Author.Email","description":"The email of the author","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Committer.Date","description":"The date the commiter committed","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Committer.Name","description":"The name of the committer","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Committer.Email","description":"The email of the committer","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Message","description":"The message associated with the commit","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Parent","description":"List of parent SHA hashes","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Commit.TreeSHA","description":"The SHA hash of the commit's tree","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Verification.Verified","description":"Whether the commit was verified or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.Commit.Verification.Reason","description":"The reason why the commit was or was not verified","type":"String"},{"contentPath":"","contextPath":"GitHub.Commit.Verification.Signature","description":"The commit verification signature","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.Commit.Verification.Payload","description":"The commit verification payload","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the issue to add labels to","name":"issue_number","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A CSV list of labels to add to an issue","isArray":true,"name":"labels","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Add labels to an issue","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-add-label","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The number of the pull request to retrieve","name":"pull_number","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The repository of the pull request.","name":"repository","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a pull request","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-pull-request","outputs":[{"contentPath":"","contextPath":"GitHub.PR.ID","description":"The ID number of the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.NodeID","description":"The node ID of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The issue number of the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.State","description":"The state of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Locked","description":"Whether the pull request is locked or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Title","description":"The title of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Login","description":"The login of the user who opened the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.ID","description":"The ID of the user who opened the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.User.NodeID","description":"The node ID of the user who opened the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Type","description":"The type of the user who opened the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.SiteAdmin","description":"Whether the user who opened the pull request is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Body","description":"The body content of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.ID","description":"The ID of the label","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Label.NodeID","description":"The node ID of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Name","description":"The name of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Description","description":"The description of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Color","description":"The hex color value of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Default","description":"Whether the label is a default or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ID","description":"The ID of the milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.NodeID","description":"The node ID of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Number","description":"The number of the milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.State","description":"The state of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Title","description":"The title of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Description","description":"The description of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Login","description":"The login of the milestone creator","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.ID","description":"The ID the milestone creator","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.NodeID","description":"The node ID of the milestone creator","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Type","description":"The type of the milestone creator","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.SiteAdmin","description":"Whether the milestone creator is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.OpenIssues","description":"The number of open issues with this milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedIssues","description":"The number of closed issues with this milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.CreatedAt","description":"The date the milestone was created","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.UpdatedAt","description":"The date the milestone was updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedAt","description":"The date the milestone was closed","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.DueOn","description":"The due date for the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ActiveLockReason","description":"The reason the pull request is locked","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.CreatedAt","description":"The date the pull request was created","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.UpdatedAt","description":"The date the pull request was updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ClosedAt","description":"The date the pull request was closed","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedAt","description":"The date the pull request was merged","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergeCommitSHA","description":"The SHA hash of the pull request's merge commit","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Login","description":"The login of the user assigned to the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.ID","description":"The ID of the user assigned to the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.NodeID","description":"The node ID of the user assigned to the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Type","description":"The type of the user assigned to the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.SiteAdmin","description":"Whether the user assigned to the pull request is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Login","description":"The login of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.ID","description":"The ID of the user requested for review","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.NodeID","description":"The node ID of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Type","description":"The type of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.SiteAdmin","description":"Whether the user requested for review is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.ID","description":"The ID of the team requested for review","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.NodeID","description":"The node ID of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Name","description":"The name of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Slug","description":"The slug of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Description","description":"The description of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Privacy","description":"The privacy setting of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Permission","description":"The permissions of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Parent","description":"The parent of the team requested for review","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Label","description":"The label of the branch that HEAD points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Ref","description":"The reference of the branch that HEAD points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.SHA","description":"The SHA hash of the commit that HEAD points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Login","description":"The login of the committer of the HEAD commit of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.ID","description":"The ID of the committer of the HEAD commit of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.NodeID","description":"The node ID of the committer of the HEAD commit of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Type","description":"The type of the committer of the HEAD commit of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.SiteAdmin","description":"Whether the committer of the HEAD commit of the checked out branch is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ID","description":"The ID of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.NodeID","description":"The node ID of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Name","description":"The name of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.FullName","description":"The full name of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Login","description":"The user login of the owner of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.ID","description":"The user ID of the owner of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Type","description":"The user type of the owner of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository of the checked out branch is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Private","description":"Whether the repository of the checked out branch is private or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Description","description":"The description of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Fork","description":"Whether the repository of the checked out branch is a fork or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Language","description":"The language of the repository of the checked out branch","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ForksCount","description":"The number of forks of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.StargazersCount","description":"The number of stars of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.WatchersCount","description":"The number of entities watching the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Size","description":"The size of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.DefaultBranch","description":"The default branch of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.OpenIssuesCount","description":"The open issues of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Topics","description":"Topics listed for the repository of the checked out branch","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasIssues","description":"Whether the repository of the checked out branch has issues or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasProjects","description":"Whether the repository of the checked out branch has projects or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasWiki","description":"Whether the repository of the checked out branch has a wiki or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasPages","description":"Whether the repository of the checked out branch has pages or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasDownloads","description":"Whether the repository of the checked out branch has downloads or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Archived","description":"Whether the repository of the checked out branch has been arvhived or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Disabled","description":"Whether the repository of the checked out branch has been disabled or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.PushedAt","description":"The date of the latest push to the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.CreatedAt","description":"The date of creation of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.UpdatedAt","description":"The date the repository of the checked out branch was last updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowRebaseMerge","description":"Whether the repository of the checked out branch permits rebase-style merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowSquashMerge","description":"Whether the repository of the checked out branch permits squash merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowMergeCommit","description":"Whether the repository of the checked out branch permits merge commits or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.SubscribersCount","description":"The number of entities subscribing to the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Label","description":"The label of the base branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Ref","description":"The reference of the base branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.SHA","description":"The SHA hash of the base branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Login","description":"The login of the committer of the commit that the base branch points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.ID","description":"The ID of the committer of the commit that the base branch points to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.NodeID","description":"The node ID of the committer of the commit that the base branch points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Type","description":"The user type of the committer of the commit that the base branch points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.SiteAdmin","description":"Whether the committer of the commit that the base branch points to is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ID","description":"The ID of the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.NodeID","description":"The node ID of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Name","description":"The name of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.FullName","description":"The full name of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Login","description":"The user login of the owner of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.ID","description":"The user ID of the owner of the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Type","description":"The user type of the owner of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository that the base branch belongs to is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Private","description":"Whether the repository that the base branch belongs to is private or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Description","description":"The description of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Fork","description":"Whether the repository that the base branch belongs to is a fork or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Language","description":"The language of the repository that the base branch belongs to","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ForksCount","description":"The number of times that the repository that the base branch belongs to has been forked","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.StargazersCount","description":"The number of times that the repository that the base branch belongs to has been starred","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.WatchersCount","description":"The number of entities watching the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Size","description":"The size of the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.DefaultBranch","description":"The default branch of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.OpenIssuesCount","description":"The number of open issues in the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Topics","description":"Topics listed for the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasIssues","description":"Whether the repository that the base branch belongs to has issues or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasProjects","description":"Whether the repository that the base branch belongs to has projects or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasWiki","description":"Whether the repository that the base branch belongs to has a wiki or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasPages","description":"Whether the repository that the base branch belongs to has pages or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasDownloads","description":"Whether the repository that the base branch belongs to has downloads or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Archived","description":"Whether the repository that the base branch belongs to is archived or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Disabled","description":"Whether the repository that the base branch belongs to is disabled or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.PushedAt","description":"The date that the repository that the base branch belongs to was last pushed to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.CreatedAt","description":"The date of creation of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.UpdatedAt","description":"The date that the repository that the base branch belongs to was last updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowRebaseMerge","description":"Whether the repository that the base branch belongs to allows rebase-style merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowSquashMerge","description":"Whether the repository that the base branch belongs to allows squash merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowMergeCommit","description":"Whether the repository that the base branch belongs to allows merge commits or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.SubscribersCount","description":"The number of entities that subscribe to the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.AuthorAssociation","description":"The pull request author association","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Draft","description":"Whether the pull request is a draft or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Merged","description":"Whether the pull request is merged or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Mergeable","description":"Whether the pull request is mergeable or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Rebaseable","description":"Whether the pull request is rebaseable or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.MergeableState","description":"The mergeable state of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Login","description":"The login of the user who merged the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.ID","description":"The ID of the user who merged the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.NodeID","description":"The node ID of the user who merged the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Type","description":"The type of the user who merged the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.SiteAdmin","description":"Whether the user who merged the pull request is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Comments","description":"The number of comments on the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComments","description":"The number of review comments on the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MaintainerCanModify","description":"Whether the maintainer can modify the pull request or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Commits","description":"The number of commits in the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Additions","description":"The number of additions in the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Deletions","description":"The number of deletions in the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ChangedFiles","description":"The number of changed files in the pull request","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the organization","name":"organization","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"List the teams for an organization. Note that this API call is only available to authenticated members of the organization.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-teams","outputs":[{"contentPath":"","contextPath":"GitHub.Team.ID","description":"The ID of the team","type":"Number"},{"contentPath":"","contextPath":"GitHub.Team.NodeID","description":"The node ID of the team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Name","description":"The name of the team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Slug","description":"The slug of the team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Description","description":"The description of the team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Privacy","description":"The privacy setting of the team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Permission","description":"The permissions of the team","type":"String"},{"contentPath":"","contextPath":"GitHub.Team.Parent","description":"The parent of the team","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the branch to delete","name":"branch_name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete a branch","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-delete-branch","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The issue number of the pull request.","name":"pull_number","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Lists all the review comments for a pull request.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-pr-review-comments","outputs":[{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The issue number of the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.ID","description":"The ID number of the pull request review comment.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.NodeID","description":"The Node ID of the pull request review comment.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.PullRequestReviewID","description":"The ID of the pull request review.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.DiffHunk","description":"The diff hunk for which the review comment applies.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.Path","description":"The file path of the proposed file changes for which the review comment applies.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.Position","description":"The position of the change for which the review comment applies.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.OriginalPosition","description":"The original position of the change for which the review comment applies.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.CommitID","description":"The commit ID of the proposed change.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.OriginalCommitID","description":"The commit ID of the commit before the proposed change.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.InReplyToID","description":"The reply ID of the comment for which the review comment applies.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.User.Login","description":"The login of the user who created the review comment.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.User.ID","description":"The ID of the user who created the review comment.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.User.NodeID","description":"The Node ID of the user who created the review comment.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.User.Type","description":"The type of the user who created the review comment.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.User.SiteAdmin","description":"Whether the user who created the review comment is a site administrator. or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.Body","description":"The body content of the review comment.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.CreatedAt","description":"The time the review comment was created.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.UpdatedAt","description":"The time the review comment was updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComment.AuthorAssociation","description":"The association of the user who created the review comment.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The new title of the pull request.","name":"title","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The new body content of the pull request.","name":"body","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The new state of the pull request. Can be \"open\", or \"closed\".","name":"state","predefined":["open","closed"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the branch that you want your changes pulled, which must be an existing branch in the current repository. You cannot update the base branch in a pull request to point to another repository.","name":"base","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Indicates whether maintainers can modify the pull request.","name":"maintainer_can_modify","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The issue number of the pull request for which to modify.","name":"pull_number","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates a pull request in a repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-update-pull-request","outputs":[{"contentPath":"","contextPath":"GitHub.PR.ID","description":"The ID number of the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.NodeID","description":"The Node ID of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The issue number of the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.State","description":"The state of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Locked","description":"Whether the pull request is locked.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Title","description":"The title of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Login","description":"The login of the user who opened the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.ID","description":"The ID of the user who opened the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.User.NodeID","description":"The Node ID of the user who opened the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Type","description":"The type of the user who opened the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.SiteAdmin","description":"Whether the user who opened the pull request is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Body","description":"The body content of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.ID","description":"The ID of the label.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Label.NodeID","description":"The Node ID of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Name","description":"The name of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Description","description":"The description of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Color","description":"The hex color value of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Default","description":"Whether the label is a default.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ID","description":"The ID of the milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.NodeID","description":"The Node ID of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Number","description":"The number of the milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.State","description":"The state of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Title","description":"The title of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Description","description":"The description of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Login","description":"The login of the milestone creator.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.ID","description":"The ID the milestone creator.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.NodeID","description":"The Node ID of the milestone creator.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Type","description":"The type of the milestone creator.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.SiteAdmin","description":"Whether the milestone creator is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.OpenIssues","description":"The number of open issues with this milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedIssues","description":"The number of closed issues with this milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.CreatedAt","description":"The date the milestone was created.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.UpdatedAt","description":"The date the milestone was updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedAt","description":"The date the milestone was closed.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.DueOn","description":"The due date for the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ActiveLockReason","description":"The reason the pull request is locked.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.CreatedAt","description":"The date the pull request was created.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.UpdatedAt","description":"The date the pull request was updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ClosedAt","description":"The date the pull request was closed.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedAt","description":"The date the pull request was merged.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergeCommitSHA","description":"The SHA hash of the pull request's merge commit.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Login","description":"The login of the user assigned to the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.ID","description":"The ID of the user assigned to the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.NodeID","description":"The Node ID of the user assigned to the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Type","description":"The type of the user assigned to the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.SiteAdmin","description":"Whether the user assigned to the pull request is a site administrator. not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Login","description":"The login of the user requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.ID","description":"The ID of the user requested for review.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.NodeID","description":"The Node ID of the user requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Type","description":"The type of the user requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.SiteAdmin","description":"Whether the user requested for review is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.ID","description":"The ID of the team requested for review.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.NodeID","description":"The Node ID of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Name","description":"The name of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Slug","description":"The slug of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Description","description":"The description of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Privacy","description":"The privacy setting of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Permission","description":"The permissions of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Parent","description":"The parent of the team requested for review.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Label","description":"The label of the branch for which the HEAD points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Ref","description":"The reference of the branch for which the HEAD points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.SHA","description":"The SHA hash of the commit for which the HEAD points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Login","description":"The committer login of the HEAD commit of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.ID","description":"The committer ID of the HEAD commit of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.NodeID","description":"The Node committer ID of the HEAD commit of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Type","description":"The committer type of the HEAD commit of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.SiteAdmin","description":"Whether the committer of the HEAD commit of the checked out branch is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ID","description":"The ID of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.NodeID","description":"The Node ID of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Name","description":"The name of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.FullName","description":"The full name of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Login","description":"The user login of the owner of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.ID","description":"The user ID of the owner of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository of the checked. out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Type","description":"The user type of the owner of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository of the checked out branch is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Private","description":"Whether the repository of the checked out branch is private.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Description","description":"The description of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Fork","description":"Whether the repository of the checked out branch is a fork.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Language","description":"The language of the repository of the checked out branch.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ForksCount","description":"The number of forks of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.StargazersCount","description":"The number of stars of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.WatchersCount","description":"The number of entities watching the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Size","description":"The size of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.DefaultBranch","description":"The default branch of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.OpenIssuesCount","description":"The open issues of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Topics","description":"Topics listed for the repository of the checked out branch.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasIssues","description":"Whether the repository of the checked out branch has issues.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasProjects","description":"Whether the repository of the checked out branch has projects.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasWiki","description":"Whether the repository of the checked out branch has a wiki.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasPages","description":"Whether the repository of the checked out branch has pages.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasDownloads","description":"Whether the repository of the checked out branch has downloads.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Archived","description":"Whether the repository of the checked out branch has been archived.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Disabled","description":"Whether the repository of the checked out branch has been disabled.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.PushedAt","description":"The date of the latest push to the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.CreatedAt","description":"The date of creation of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.UpdatedAt","description":"The date the repository of the checked out branch was last updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowRebaseMerge","description":"Whether the repository of the checked out branch permits rebase-style merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowSquashMerge","description":"Whether the repository of the checked out branch permits squash merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowMergeCommit","description":"Whether the repository of the checked out branch permits merge commits.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.SubscribersCount","description":"The number of entities subscribing to the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Label","description":"The label of the base branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Ref","description":"The reference of the base branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.SHA","description":"The SHA hash of the base branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Login","description":"The committer login of the commit for which the base branch points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.ID","description":"The ID of the committer of the commit for which the base branch points.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.NodeID","description":"The committer Node ID of the commit for which the base branch points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Type","description":"The user committer type of the commit for which the base branch points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.SiteAdmin","description":"Whether the committer of the commit for which the base branch points is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ID","description":"The ID of the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.NodeID","description":"The Node ID of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Name","description":"The name of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.FullName","description":"The full name of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Login","description":"The user login of the owner of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.ID","description":"The user ID of the owner of the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Type","description":"The user type of the owner of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository for which the base branch belongs to is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Private","description":"Whether the repository for which the base branch belongs is private.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Description","description":"The description of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Fork","description":"Whether the repository for which the base branch belongs to is a fork.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Language","description":"The language of the repository for which the base branch belongs.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ForksCount","description":"The number of times that the repository for which the base branch belongs has been forked.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.StargazersCount","description":"The number of times that the repository for which the base branch belongs has been starred.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.WatchersCount","description":"The number of entities watching the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Size","description":"The size of the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.DefaultBranch","description":"The default branch of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.OpenIssuesCount","description":"The number of open issues in the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Topics","description":"Topics listed for the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasIssues","description":"Whether the repository for which the base branch belongs has issues.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasProjects","description":"Whether the repository for which the base branch belongs has projects.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasWiki","description":"Whether the repository for which the base branch belongs has a wiki.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasPages","description":"Whether the repository for which the base branch belongs to has pages.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasDownloads","description":"Whether the repository for which the base branch belongs has downloads.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Archived","description":"Whether the repository for which the base branch belongs is archived.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Disabled","description":"Whether the repository for which the base branch belongs is disabled.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.PushedAt","description":"The date that the repository for which the base branch belongs to was last pushed.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.CreatedAt","description":"The date of creation of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.UpdatedAt","description":"The date that the repository for which the base branch belongs was last updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowRebaseMerge","description":"Whether the repository for which the base branch belongs allows rebase-style merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowSquashMerge","description":"Whether the repository for which the base branch belongs allows squash merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowMergeCommit","description":"Whether the repository for which the base branch belongs allows merge commits.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.SubscribersCount","description":"The number of entities for which subscribe to the repository that the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.AuthorAssociation","description":"The pull request author association.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Draft","description":"Whether the pull request is a draft.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Merged","description":"Whether the pull request is merged.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Mergeable","description":"Whether the pull request is mergeable.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Rebaseable","description":"Whether the pull request is rebaseable.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.MergeableState","description":"The mergeable state of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Login","description":"The login of the user who merged the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.ID","description":"The ID of the user who merged the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.NodeID","description":"The Node ID of the user who merged the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Type","description":"The type of the user who merged the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.SiteAdmin","description":"Whether the user who merged the pull request is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Comments","description":"The number of comments on the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComments","description":"The number of review comments on the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MaintainerCanModify","description":"Whether the maintainer can modify the pull request.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Commits","description":"The number of commits in the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Additions","description":"The number of additions in the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Deletions","description":"The number of deletions in the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ChangedFiles","description":"The number of changed files in the pull request.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The issue number of the pull request to check.","name":"pull_number","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns a merged pull request. If the pull request has been merged, the API returns 'Status: 204 No Content'. If the pull request has not been merged the API returns 'Status: 404 Not Found'","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-is-pr-merged","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The title of the pull request.","name":"title","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the branch where the changes are made.","name":"head","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the branch you want the changes pulled into, which must be an existing branch on the current repository.","name":"base","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The contents of the pull request.","name":"body","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Indicates whether maintainers can modify the pull request.","name":"maintainer_can_modify","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Indicates whether the pull request is a draft. For more information, see https://help.github.com/en/articles/about-pull-requests#draft-pull-requests.","name":"draft","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a new pull request.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-create-pull-request","outputs":[{"contentPath":"","contextPath":"GitHub.PR.ID","description":"The ID number of the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.NodeID","description":"The Node ID of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The issue number of the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.State","description":"The state of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Locked","description":"Whether the pull request is locked.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Title","description":"The title of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Login","description":"The login of the user who opened the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.ID","description":"The ID of the user who opened the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.User.NodeID","description":"The Node ID of the user who opened the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Type","description":"The user type who opened the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.SiteAdmin","description":"Whether the user who opened the pull request is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Body","description":"The body content of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.ID","description":"The ID of the label.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Label.NodeID","description":"The Node ID of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Name","description":"The name of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Description","description":"The description of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Color","description":"The hex color value of the label.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Default","description":"Whether the label is a default.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ID","description":"The ID of the milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.NodeID","description":"The Node ID of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Number","description":"The number of the milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.State","description":"The state of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Title","description":"The title of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Description","description":"The description of the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Login","description":"The login of the milestone creator.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.ID","description":"The ID the milestone creator.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.NodeID","description":"The Node ID of the milestone creator.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Type","description":"The type of the milestone creator.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.SiteAdmin","description":"Whether the milestone creator is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.OpenIssues","description":"The number of open issues with this milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedIssues","description":"The number of closed issues with this milestone.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.CreatedAt","description":"The date the milestone was created.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.UpdatedAt","description":"The date the milestone was updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedAt","description":"The date the milestone was closed.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.DueOn","description":"The due date for the milestone.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ActiveLockReason","description":"The reason the pull request is locked.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.CreatedAt","description":"The date the pull request was created.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.UpdatedAt","description":"The date the pull request was updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ClosedAt","description":"The date the pull request was closed.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedAt","description":"The date the pull request was merged.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergeCommitSHA","description":"The SHA hash of the pull request's merge commit.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Login","description":"The login of the user assigned to the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.ID","description":"The ID of the user assigned to the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.NodeID","description":"The Node ID of the user assigned to the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Type","description":"The type of the user assigned to the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.SiteAdmin","description":"Whether the user assigned to the pull request is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Login","description":"The login of the user requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.ID","description":"The ID of the user requested for review.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.NodeID","description":"The Node ID of the user requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Type","description":"The type of the user requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.SiteAdmin","description":"Whether the user requested for review is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.ID","description":"The ID of the team requested for review.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.NodeID","description":"The Node ID of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Name","description":"The name of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Slug","description":"The slug of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Description","description":"The description of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Privacy","description":"The privacy setting of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Permission","description":"The permissions of the team requested for review.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Parent","description":"The parent of the team requested for review.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Label","description":"The label of the branch for which the HEAD points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Ref","description":"The reference of the branch for which the HEAD points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.SHA","description":"The SHA hash of the commit for which the HEAD points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Login","description":"The committer login of the HEAD commit of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.ID","description":"The committer ID of the HEAD commit of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.NodeID","description":"The Node ID of the committer of the HEAD commit of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Type","description":"The committer type of the HEAD commit of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.SiteAdmin","description":"Whether the committer of the HEAD commit of the checked out branch is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ID","description":"The ID of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.NodeID","description":"The Node ID of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Name","description":"The name of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.FullName","description":"The full name of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Login","description":"The user login of the owner of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.ID","description":"The user ID of the owner of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.NodeID","description":"The user Node ID of the owner of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Type","description":"The user type of the owner of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository of the checked out branch is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Private","description":"Whether the repository of the checked out branch is private.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Description","description":"The description of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Fork","description":"Whether the repository of the checked out branch is a fork.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Language","description":"The language of the repository of the checked out branch.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ForksCount","description":"The number of forks of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.StargazersCount","description":"The number of stars of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.WatchersCount","description":"The number of entities watching the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Size","description":"The size of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.DefaultBranch","description":"The default branch of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.OpenIssuesCount","description":"The open issues of the repository of the checked out branch.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Topics","description":"Topics listed for the repository of the checked out branch.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasIssues","description":"Whether the repository of the checked out branch has issues.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasProjects","description":"Whether the repository of the checked out branch has projects.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasWiki","description":"Whether the repository of the checked out branch has a wiki.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasPages","description":"Whether the repository of the checked out branch has pages.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasDownloads","description":"Whether the repository of the checked out branch has downloads.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Archived","description":"Whether the repository of the checked out branch has been archived.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Disabled","description":"Whether the repository of the checked out branch has been disabled.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.PushedAt","description":"The date of the latest push to the repository of the checked out.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.CreatedAt","description":"The date of creation of the repository of the checked out branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.UpdatedAt","description":"The date the repository of the checked out branch was last updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowRebaseMerge","description":"Whether the repository of the checked out branch permits rebase-style merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowSquashMerge","description":"Whether the repository of the checked out branch permits squash merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowMergeCommit","description":"Whether the repository of the checked out branch permits merge commits.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.SubscribersCount","description":"The number of entities subscribing to the repository of the checked out.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Label","description":"The label of the base branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Ref","description":"The reference of the base branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.SHA","description":"The SHA hash of the base branch.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Login","description":"The committer login of the commit for which the base branch points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.ID","description":"The ID of the committer of the commit for which the base branch points. to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.NodeID","description":"The committer Node ID of the commit for which the base branch points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Type","description":"The user type of the committer for which the commit base branch points.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.SiteAdmin","description":"Whether the committer of the commit for which the base branch points to is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ID","description":"The ID of the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.NodeID","description":"The Node ID of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Name","description":"The name of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.FullName","description":"The full name of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Login","description":"The user login of the owner of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.ID","description":"The user ID of the owner of the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Type","description":"The user type of the owner of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository that the base branch belongs to is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Private","description":"Whether the repository for which the base branch belongs to is private.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Description","description":"The description of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Fork","description":"Whether the repository that the base branch belongs to is a fork.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Language","description":"The language of the repository for which the base branch belongs.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ForksCount","description":"The number of times that the repository for which the base branch belongs has been forked.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.StargazersCount","description":"The number of times that the repository that the base branch belongs to has been starred.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.WatchersCount","description":"The number of entities watching the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Size","description":"The size of the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.DefaultBranch","description":"The default branch of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.OpenIssuesCount","description":"The number of open issues in the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Topics","description":"Topics listed for the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasIssues","description":"Whether the repository for which the base branch belongs to has issues.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasProjects","description":"Whether the repository for which the base branch belongs to has projects.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasWiki","description":"Whether the repository for which the base branch belongs to has a wiki.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasPages","description":"Whether the repository for which the base branch belongs to has pages.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasDownloads","description":"Whether the repository for which the base branch belongs to has downloads.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Archived","description":"Whether the repository for which the base branch belongs to is archived.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Disabled","description":"Whether the repository for which the base branch belongs to is disabled.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.PushedAt","description":"The date that the repository for which the base branch belongs was last pushed.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.CreatedAt","description":"The date of creation of the repository for which the base branch belongs.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.UpdatedAt","description":"The date that the repository for which the base branch belongs was last updated.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowRebaseMerge","description":"Whether the repository for which the base branch belongs allows rebase-style merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowSquashMerge","description":"Whether the repository for which the base branch belongs allows squash merges.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowMergeCommit","description":"Whether the repository for which the base branch belongs allows merge commits.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.SubscribersCount","description":"The number of entities that subscribe to the repository for which the base branch belongs.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.AuthorAssociation","description":"The pull request author association.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Draft","description":"Whether the pull request is a draft.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Merged","description":"Whether the pull request is merged.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Mergeable","description":"Whether the pull request is mergeable.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Rebaseable","description":"Whether the pull request is rebaseable.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.MergeableState","description":"The mergeable state of the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Login","description":"The login of the user who merged the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.ID","description":"The ID of the user who merged the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.NodeID","description":"The Node ID of the user who merged the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Type","description":"The user type who merged the pull request.","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.SiteAdmin","description":"Whether the user who merged the pull request is a site administrator.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Comments","description":"The number of comments on the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComments","description":"The number of review comments on the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MaintainerCanModify","description":"Whether the maintainer can modify the pull request.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Commits","description":"The number of commits in the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Additions","description":"The number of additions in the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Deletions","description":"The number of deletions in the pull request.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ChangedFiles","description":"The number of changed files in the pull request.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The repository owner.","name":"owner","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the usage details of GitHub action workflows of private repositories, by repository owner.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"Github-get-github-actions-usage","outputs":[{"contentPath":"","contextPath":"GitHub.ActionsUsage.RepositoryName","description":"The name of the private repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.ActionsUsage.WorkflowID","description":"The workflow ID of the GitHub action.","type":"Number"},{"contentPath":"","contextPath":"GitHub.ActionsUsage.WorkflowName","description":"The display name of the GitHub action workflow.","type":"String"},{"contentPath":"","contextPath":"GitHub.ActionsUsage.WorkflowUsage","description":"GitHub action worflow usage on different OS.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Organization or Owner","name":"owner","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Git Repository Name","name":"repository","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Check Run ID","name":"run_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Head Commit ID","name":"commit_id","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a check run details","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"Github-get-check-run","outputs":[{"contentPath":"","contextPath":"GitHub.CheckRuns.CheckRunConclusion","description":"Check Run Conculsion","type":"String"},{"contentPath":"","contextPath":"GitHub.CheckRuns.CheckRunAppName","description":"Check Run App Name","type":"String"},{"contentPath":"","contextPath":"GitHub.CheckRuns.CheckExternalID","description":"Check Run External ID","type":"String"},{"contentPath":"","contextPath":"GitHub.CheckRuns.CheckRunName","description":"Check Run Name","type":"String"},{"contentPath":"","contextPath":"GitHub.CheckRuns.CheckRunStatus","description":"Check Run Status","type":"String"},{"contentPath":"","contextPath":"GitHub.CheckRuns.CheckRunID","description":"Check Run ID","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The path of the file.","name":"file_path","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The branch name from which to get the file.","name":"branch_name","required":false,"secret":false},{"default":false,"defaultValue":"raw","deprecated":false,"description":"The media type in which the file contents will be fetched. Possible values are: \"raw\" and \"html\". Default value is \"raw\".","name":"media_type","predefined":["raw","html"],"required":false,"secret":false},{"default":false,"defaultValue":"false","deprecated":false,"description":"Whether to create a file entry in the War Room with the file contents. Possible values are: \"true\" and \"false\". Default value is \"false\".","name":"create_file_from_content","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the repository.","name":"repository","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the content of a file from GitHub.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-file-content","outputs":[{"contentPath":"","contextPath":"GitHub.FileContent.Path","description":"The path of the file.","type":"String"},{"contentPath":"","contextPath":"GitHub.FileContent.Content","description":"The content of the file.","type":"Number"},{"contentPath":"","contextPath":"GitHub.FileContent.MediaType","description":"The media type in which the file was fetched.","type":"String"},{"contentPath":"","contextPath":"GitHub.FileContent.Branch","description":"The branch from which the file was fetched.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The path in the branch to get the files from.","name":"path","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the repository.","name":"repository","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The branch name from which to get the files.","name":"branch","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get list of files from the given path in the repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"Github-list-files","outputs":[{"contentPath":"","contextPath":"GitHub.File.Name","description":"The name of the file.","type":"String"},{"contentPath":"","contextPath":"GitHub.File.Type","description":"Whether the item is file or directory.","type":"String"},{"contentPath":"","contextPath":"GitHub.File.Size","description":"The size of the file in bytes.","type":"Number"},{"contentPath":"","contextPath":"GitHub.File.Path","description":"The file path inside the repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.File.DownloadUrl","description":"Link to download the file content.","type":"String"},{"contentPath":"","contextPath":"GitHub.File.SHA","description":"The SHA of the file.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the organization.","name":"organization","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Team name.","name":"team_slug","required":true,"secret":false},{"default":false,"defaultValue":"30","deprecated":false,"description":"Miximum number of users to return.","name":"maximum_users","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List team members","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-team-members","outputs":[{"contentPath":"","contextPath":"GitHub.TeamMember.ID","description":"The ID of the team member.","type":"Number"},{"contentPath":"","contextPath":"GitHub.TeamMember.Login","description":"The login name of the team member.","type":"String"},{"contentPath":"","contextPath":"GitHub.TeamMember.Team","description":"The user's team.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Commit message.","name":"commit_message","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Path to the file in the Github repo (including file name and file ending).","name":"path_to_file","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Entry ID for the file to commit. Either \"entry_id\" or \"file_text\" must be provided.","name":"entry_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Plain text for the file to commit. Either \"entry_id\" or \"file_text\" must be provided.","name":"file_text","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The branch name.","name":"branch_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The blob SHA of the file being replaced. Use the Github-list-files command to get the SHA value of the file.  Required if you are updating a file.","name":"file_sha","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Commits a given file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"Github-commit-file","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the release.","name":"name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the release tag.","name":"tag_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Text describing the contents of the tag.","name":"body","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"True","deprecated":false,"description":"Whether to create a draft (unpublished) release.","name":"draft","predefined":["True","False"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a release.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-create-release","outputs":[{"contentPath":"","contextPath":"GitHub.Release.draft","description":"Whether the release is a draft.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.Release.html_url","description":"The release URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.id","description":"The ID of the release.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Release.url","description":"Github API URL link to the release.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The branch name from which to retrieve pull requests.","name":"branch_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The repository for the pull request. Defaults to the repository parameter if not provided.","name":"repository","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get pull requests corresponding to the given branch name.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-branch-pull-requests","outputs":[{"contentPath":"","contextPath":"GitHub.PR.ID","description":"The ID number of the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.NodeID","description":"The node ID of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Number","description":"The issue number of the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.State","description":"The state of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Locked","description":"Whether the pull request is locked or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.User.Login","description":"The login of the user who opened the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.ID","description":"The ID of the user who opened the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.User.NodeID","description":"The node ID of the user who opened the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.Type","description":"The type of the user who opened the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.User.SiteAdmin","description":"Whether the user who opened the pull request is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Body","description":"The body content of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.ID","description":"The ID of the label","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Label.NodeID","description":"The node ID of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Name","description":"The name of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Description","description":"The description of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Color","description":"The hex color value of the label","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Label.Default","description":"Whether the label is a default or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ID","description":"The ID of the milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.NodeID","description":"The node ID of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Number","description":"The number of the milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.State","description":"The state of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Title","description":"The title of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Description","description":"The description of the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Login","description":"The login of the milestone creator","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.ID","description":"The ID the milestone creator","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.NodeID","description":"The node ID of the milestone creator","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.Type","description":"The type of the milestone creator","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.Creator.SiteAdmin","description":"Whether the milestone creator is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.OpenIssues","description":"The number of open issues with this milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedIssues","description":"The number of closed issues with this milestone","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.CreatedAt","description":"The date the milestone was created","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.UpdatedAt","description":"The date the milestone was updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.ClosedAt","description":"The date the milestone was closed","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Milestone.DueOn","description":"The due date for the milestone","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ActiveLockReason","description":"The reason the pull request is locked","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.CreatedAt","description":"The date the pull request was created","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.UpdatedAt","description":"The date the pull request was updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.ClosedAt","description":"The date the pull request was closed","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedAt","description":"The date the pull request was merged","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergeCommitSHA","description":"The SHA hash of the pull request's merge commit","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Login","description":"The login of the user assigned to the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.ID","description":"The ID of the user assigned to the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.NodeID","description":"The node ID of the user assigned to the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.Type","description":"The type of the user assigned to the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Assignee.SiteAdmin","description":"Whether the user assigned to the pull request is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Login","description":"The login of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.ID","description":"The ID of the user requested for review","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.NodeID","description":"The node ID of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.Type","description":"The type of the user requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedReviewer.SiteAdmin","description":"Whether the user requested for review is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.ID","description":"The ID of the team requested for review","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.NodeID","description":"The node ID of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Name","description":"The name of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Slug","description":"The slug of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Description","description":"The description of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Privacy","description":"The privacy setting of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Permission","description":"The permissions of the team requested for review","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.RequestedTeam.Parent","description":"The parent of the team requested for review","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Label","description":"The label of the branch that HEAD points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Ref","description":"The reference of the branch that HEAD points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.SHA","description":"The SHA hash of the commit that HEAD points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Login","description":"The login of the committer of the HEAD commit of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.ID","description":"The ID of the committer of the HEAD commit of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.NodeID","description":"The node ID of the committer of the HEAD commit of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.Type","description":"The type of the committer of the HEAD commit of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.User.SiteAdmin","description":"Whether the committer of the HEAD commit of the checked out branch is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ID","description":"The ID of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.NodeID","description":"The node ID of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Name","description":"The name of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.FullName","description":"The full name of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Login","description":"The user login of the owner of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.ID","description":"The user ID of the owner of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.Type","description":"The user type of the owner of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository of the checked out branch is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Private","description":"Whether the repository of the checked out branch is private or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Description","description":"The description of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Fork","description":"Whether the repository of the checked out branch is a fork or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Language","description":"The language of the repository of the checked out branch","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.ForksCount","description":"The number of forks of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.StargazersCount","description":"The number of stars of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.WatchersCount","description":"The number of entities watching the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Size","description":"The size of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.DefaultBranch","description":"The default branch of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.OpenIssuesCount","description":"The open issues of the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Topics","description":"Topics listed for the repository of the checked out branch","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasIssues","description":"Whether the repository of the checked out branch has issues or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasProjects","description":"Whether the repository of the checked out branch has projects or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasWiki","description":"Whether the repository of the checked out branch has a wiki or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasPages","description":"Whether the repository of the checked out branch has pages or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.HasDownloads","description":"Whether the repository of the checked out branch has downloads or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Archived","description":"Whether the repository of the checked out branch has been arvhived or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.Disabled","description":"Whether the repository of the checked out branch has been disabled or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.PushedAt","description":"The date of the latest push to the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.CreatedAt","description":"The date of creation of the repository of the checked out branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.UpdatedAt","description":"The date the repository of the checked out branch was last updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowRebaseMerge","description":"Whether the repository of the checked out branch permits rebase-style merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowSquashMerge","description":"Whether the repository of the checked out branch permits squash merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.AllowMergeCommit","description":"Whether the repository of the checked out branch permits merge commits or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Head.Repo.SubscribersCount","description":"The number of entities subscribing to the repository of the checked out branch","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Label","description":"The label of the base branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Ref","description":"The reference of the base branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.SHA","description":"The SHA hash of the base branch","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Login","description":"The login of the committer of the commit that the base branch points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.ID","description":"The ID of the committer of the commit that the base branch points to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.NodeID","description":"The node ID of the committer of the commit that the base branch points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.Type","description":"The user type of the committer of the commit that the base branch points to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.User.SiteAdmin","description":"Whether the committer of the commit that the base branch points to is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ID","description":"The ID of the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.NodeID","description":"The node ID of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Name","description":"The name of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.FullName","description":"The full name of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Login","description":"The user login of the owner of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.ID","description":"The user ID of the owner of the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.NodeID","description":"The user node ID of the owner of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.Type","description":"The user type of the owner of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Owner.SiteAdmin","description":"Whether the owner of the repository that the base branch belongs to is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Private","description":"Whether the repository that the base branch belongs to is private or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Description","description":"The description of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Fork","description":"Whether the repository that the base branch belongs to is a fork or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Language","description":"The language of the repository that the base branch belongs to","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.ForksCount","description":"The number of times that the repository that the base branch belongs to has been forked","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.StargazersCount","description":"The number of times that the repository that the base branch belongs to has been starred","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.WatchersCount","description":"The number of entities watching the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Size","description":"The size of the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.DefaultBranch","description":"The default branch of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.OpenIssuesCount","description":"The number of open issues in the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Topics","description":"Topics listed for the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasIssues","description":"Whether the repository that the base branch belongs to has issues or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasProjects","description":"Whether the repository that the base branch belongs to has projects or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasWiki","description":"Whether the repository that the base branch belongs to has a wiki or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasPages","description":"Whether the repository that the base branch belongs to has pages or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.HasDownloads","description":"Whether the repository that the base branch belongs to has downloads or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Archived","description":"Whether the repository that the base branch belongs to is archived or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.Disabled","description":"Whether the repository that the base branch belongs to is disabled or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.PushedAt","description":"The date that the repository that the base branch belongs to was last pushed to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.CreatedAt","description":"The date of creation of the repository that the base branch belongs to","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.UpdatedAt","description":"The date that the repository that the base branch belongs to was last updated","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowRebaseMerge","description":"Whether the repository that the base branch belongs to allows rebase-style merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowSquashMerge","description":"Whether the repository that the base branch belongs to allows squash merges or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.AllowMergeCommit","description":"Whether the repository that the base branch belongs to allows merge commits or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Base.Repo.SubscribersCount","description":"The number of entities that subscribe to the repository that the base branch belongs to","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.AuthorAssociation","description":"The pull request author association","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.Draft","description":"Whether the pull request is a draft or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Merged","description":"Whether the pull request is merged or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Mergeable","description":"Whether the pull request is mergeable or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Rebaseable","description":"Whether the pull request is rebaseable or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.MergeableState","description":"The mergeable state of the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Login","description":"The login of the user who merged the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.ID","description":"The ID of the user who merged the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.NodeID","description":"The node ID of the user who merged the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.Type","description":"The type of the user who merged the pull request","type":"String"},{"contentPath":"","contextPath":"GitHub.PR.MergedBy.SiteAdmin","description":"Whether the user who merged the pull request is a site admin or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Comments","description":"The number of comments on the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ReviewComments","description":"The number of review comments on the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.MaintainerCanModify","description":"Whether the maintainer can modify the pull request or not","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.PR.Commits","description":"The number of commits in the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Additions","description":"The number of additions in the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.Deletions","description":"The number of deletions in the pull request","type":"Number"},{"contentPath":"","contextPath":"GitHub.PR.ChangedFiles","description":"The number of changed files in the pull request","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The issue number for which to retrieve events.","name":"issue_number","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns events corresponding to the given issue.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"Github-list-issue-events","outputs":[{"contentPath":"","contextPath":"GitHub.IssueEvent.id","description":"Event ID.","type":"Number"},{"contentPath":"","contextPath":"GitHub.IssueEvent.node_id","description":"Event node ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.url","description":"Event URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.login","description":"Event actor login username.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.id","description":"Event actor ID.","type":"Number"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.node_id","description":"Event actor node ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.avatar_url","description":"Event actor avatar URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.gravatar_id","description":"Event actor gravatar ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.url","description":"Event actor URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.html_url","description":"Event actor HTML URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.followers_url","description":"Event actor followers URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.following_url","description":"Event actor following URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.gists_url","description":"Event actor gists URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.starred_url","description":"Event actor starred URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.subscriptions_url","description":"Event actor subscriptions URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.organizations_url","description":"Event actor organizations URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.repos_url","description":"Event actor repos URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.events_url","description":"Event actor events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.received_events_url","description":"Event actor received events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.type","description":"Event actor type.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.actor.site_admin","description":"Indicates whether the event actor is site admin.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.IssueEvent.event","description":"Issue event type, e.g labeled, closed.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.commit_id","description":"Event commit ID.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.IssueEvent.commit_url","description":"Event commit URL.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.IssueEvent.created_at","description":"Event created time.","type":"Date"},{"contentPath":"","contextPath":"GitHub.IssueEvent.label.name","description":"Event label name.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.label.color","description":"Event label color","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.performed_via_github_app","description":"Indicates whether event was performed via GitHub application.","type":"Unknown"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.login","description":"Assignee login username.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.id","description":"Assignee ID.","type":"Number"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.node_id","description":"Assignee node ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.avatar_url","description":"Assignee avatar URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.gravatar_id","description":"Assignee gravatar ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.url","description":"Assignee URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.html_url","description":"Assignee HTML URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.followers_url","description":"Assignee followers URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.following_url","description":"Assignee following URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.gists_url","description":"Assignee gists URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.starred_url","description":"Assignee starred URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.subscriptions_url","description":"Assignee subscriptions URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.organizations_url","description":"Assignee organizations URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.repos_url","description":"Assignee repos URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.events_url","description":"Assignee events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.received_events_url","description":"Assignee received events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.type","description":"Assignee type.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assignee.site_admin","description":"Indicates whether the assignee is site admin.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.login","description":"Assigner login username.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.id","description":"Assigner ID.","type":"Number"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.node_id","description":"Assigner node ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.avatar_url","description":"Assigner avatar URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.gravatar_id","description":"Assigner gravatar ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.url","description":"Assigner URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.html_url","description":"Assigner HTML URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.followers_url","description":"Assigner followers URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.following_url","description":"Assigner following URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.gists_url","description":"Assigner gists URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.starred_url","description":"Assigner starred URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.subscriptions_url","description":"Assigner subscriptions URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.organizations_url","description":"Assigner organizations URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.repos_url","description":"Assigner repos URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.events_url","description":"Assigner events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.received_events_url","description":"Assigner received events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.type","description":"Assigner type.","type":"String"},{"contentPath":"","contextPath":"GitHub.IssueEvent.assigner.site_admin","description":"Indicates whether the assignee is site admin.","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Only list projects with the following numbers","isArray":true,"name":"project_filter","required":false,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The number of projects to return. Default is 20. Maximum is 100.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Lists all issues that the user has access to view.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-list-all-projects","outputs":[{"contentPath":"","contextPath":"GitHub.Project.Name","description":"The name of the project board.","type":"String"},{"contentPath":"","contextPath":"GitHub.Project.ID","description":"The ID of the project board.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Project.Number","description":"Project board number.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Project.Columns.Name","description":"Column Name.","type":"String"},{"contentPath":"","contextPath":"GitHub.Project.Columns.ColumnID","description":"The ID of the column.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Project.Columns.Cards.CardID","description":"The ID of the card.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Project.Columns.Cards.ContentNumber","description":"The content number of this card, usually this is the issue number.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Project.Issues","description":"List of all issue numbers that are in this project board.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Column unique id ","name":"column_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Issue unique ID","name":"issue_unique_id","required":true,"secret":false},{"default":false,"defaultValue":"Issue","deprecated":false,"description":"Content type of the project card","name":"content_type","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Add an Issue as a card in column of a spesific project  ","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-add-issue-to-project-board","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Relative path to retrieve its data.","name":"relative_path","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The branch name from which to get the file data. Default is master.","name":"branch_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization containing the file.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The repository of the file.","name":"repository","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the data of the a given path.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-get-path-data","outputs":[{"contentPath":"","contextPath":"GitHub.PathData.name","description":"Path name.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.path","description":"Relative path for the given repository.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.sha","description":"Path SHA.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.size","description":"Path size in bytes. Will be 0 if path to a dir was given.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PathData.url","description":"Path URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.html_url","description":"Path HTML URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.git_url","description":"Path Git URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.download_url","description":"Path download URL. If a directory path was given will be empty.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.type","description":"Path data, e.g file, dir.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.content","description":"Content of the path if a file path was given.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.encoding","description":"Encoding method if path to a file was given.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.name","description":"If dir was given in file_path, name of the dir entry.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.path","description":"If dir was given in file_path, path of the dir entry.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.sha","description":"If dir was given in file_path, SHA of the dir entry.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.size","description":"If dir was given in file_path, size of the dir entry. Will be 0 if entry is also a dir.","type":"Number"},{"contentPath":"","contextPath":"GitHub.PathData.entries.url","description":"If dir was given in file_path, URL of the dir entry.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.html_url","description":"If dir was given in file_path, HTML URL of the dir entry.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.git_url","description":"If dir was given in file_path, Git URL of the dir entry.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.download_url","description":"If dir was given in file_path, download URL of the dir entry. Will be empty if entry is also a dir.","type":"String"},{"contentPath":"","contextPath":"GitHub.PathData.entries.type","description":"If dir was given in file_path, type of the dir entry.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Page number to retrieve releases from. If limit argument is not given, defaults to 1.","name":"page","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Size of the page. If limit argument is not given, defaults to 50.","name":"page_size","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Maximum number of releases data to retrieve. Will get results of the first pages. Cannot be given with page_size or page arguments.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the organization containing the repository. Defaults to organization instance parameter if not given.","name":"organization","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The repository containing the releases. Defaults to repository instance parameter if not given.","name":"repository","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets releases data from a given repository and organization.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"GitHub-releases-list","outputs":[{"contentPath":"","contextPath":"GitHub.Release.url","description":"Release URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.assets_url","description":"Release assets URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.upload_url","description":"Upload URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.html_url","description":"HTML URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.id","description":"Release ID.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Release.author.login","description":"The release author login username.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.id","description":"The release author user ID.","type":"Number"},{"contentPath":"","contextPath":"GitHub.Release.author.node_id","description":"The release author node ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.avatar_url","description":"The release author avatar URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.gravatar_id","description":"The release author gravatar ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.url","description":"The release author URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.html_url","description":"The release author HTML URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.followers_url","description":"The release author followers URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.following_url","description":"The release author following URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.gists_url","description":"The release author gists URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.starred_url","description":"The release author starred URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.subscriptions_url","description":"The release author subscriptions URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.organizations_url","description":"The release author organizations URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.repos_url","description":"The release author repos URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.events_url","description":"The release author events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.received_events_url","description":"The release author received events URL.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.type","description":"The release author type. (E.g, \"User\").","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.author.site_admin","description":"Whether the release author is site admin.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.Release.node_id","description":"Release Node ID.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.tag_name","description":"Release tag name.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.target_commitish","description":"Release target commit.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.name","description":"Release name.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.draft","description":"Whether release is draft.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.Release.prerelease","description":"Whether release is pre release.","type":"Boolean"},{"contentPath":"","contextPath":"GitHub.Release.created_at","description":"Date when release was created.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Release.published_at","description":"Date when release was published.","type":"Date"},{"contentPath":"","contextPath":"GitHub.Release.tarball_url","description":"Release tar URL download.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.zipball_url","description":"Release zip URL download.","type":"String"},{"contentPath":"","contextPath":"GitHub.Release.body","description":"Release body.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/pyjwt3:1.0.0.23674","feed":false,"isFetch":true,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\n''' IMPORTS '''\nimport copy\nimport json\nfrom datetime import datetime\nfrom typing import Any, Union\nimport codecs\nimport requests\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n''' GLOBALS/PARAMS '''\nBASE_URL: str\nUSER: str\nTOKEN: str\nPRIVATE_KEY: str\nINTEGRATION_ID: str\nINSTALLATION_ID: str\nREPOSITORY: str\nUSE_SSL: bool\nFETCH_TIME: str\nMAX_FETCH_PAGE_RESULTS: int\nUSER_SUFFIX: str\nISSUE_SUFFIX: str\nPROJECT_SUFFIX: str\nRELEASE_SUFFIX: str\nPULLS_SUFFIX: str\nFILE_SUFFIX: str\nHEADERS: dict\n\nRELEASE_HEADERS = ['ID', 'Name', 'Download_count', 'Body', 'Created_at', 'Published_at']\nISSUE_HEADERS = ['ID', 'Repository', 'Organization', 'Title', 'State', 'Body', 'Created_at', 'Updated_at', 'Closed_at',\n                 'Closed_by', 'Assignees', 'Labels']\nPROJECT_HEADERS = ['Name', 'ID', 'Number', 'Columns']\nFILE_HEADERS = ['Name', 'Path', 'Type', 'Size', 'SHA', 'DownloadUrl']\n\n# Headers to be sent in requests\nMEDIA_TYPE_INTEGRATION_PREVIEW = \"application/vnd.github.machine-man-preview+json\"\nPROJECTS_PREVIEW = 'application/vnd.github.inertia-preview+json'\n\nDEFAULT_PAGE_SIZE = 50\nDEFAULT_PAGE_NUMBER = 1\n''' HELPER FUNCTIONS '''\n\n\ndef create_jwt(private_key: str, integration_id: str):\n    \"\"\"\n    Create a JWT token used for getting access token. It's needed for github bots.\n    POSTs https://api.github.com/app/installations/\u003cinstallation_id\u003e/access_tokens\n    :param private_key: str: github's private key\n    :param integration_id: str: ID of the github integration (bot)\n    \"\"\"\n    import jwt\n\n    now = int(time.time())\n    expiration = 60\n    payload = {\"iat\": now, \"exp\": now + expiration, \"iss\": integration_id}\n    jwt_token = jwt.encode(payload, private_key, algorithm='RS256')\n    return jwt_token\n\n\ndef get_installation_access_token(installation_id: str, jwt_token: str):\n    \"\"\"\n    Get an access token for the given installation id.\n    POSTs https://api.github.com/app/installations/\u003cinstallation_id\u003e/access_tokens\n    :param installation_id: str: the id of the installation (where the bot was installed)\n    :param jwt_token: str token needed in the request for retrieving the access token\n    \"\"\"\n    response = requests.post(\n        \"{}/app/installations/{}/access_tokens\".format(\n            BASE_URL, installation_id\n        ),\n        headers={\n            \"Authorization\": \"Bearer {}\".format(jwt_token),\n            \"Accept\": MEDIA_TYPE_INTEGRATION_PREVIEW,\n        },\n    )\n    if response.status_code == 201:\n        return response.json()['token']\n    elif response.status_code == 403:\n        return_error('403 Forbidden - The credentials are incorrect')\n    elif response.status_code == 404:\n        return_error('404 Not found - Installation wasn\\'t found')\n    else:\n        return_error(f'Encountered an error: {response.text}')\n\n\ndef safe_get(obj_to_fetch_from: dict, what_to_fetch: str, default_val: Union[dict, list, str]) -\u003e Any:\n    \"\"\"Guarantees the default value in place of a Nonetype object when the value for a given key is explicitly None\n\n    Args:\n        obj_to_fetch_from (dict): The dictionary to fetch from\n        what_to_fetch (str): The key for the desired value\n        default_val: The default value to set instead of None\n\n    Returns:\n        The fetched value unless it is None in which case the default is returned instead\n    \"\"\"\n    val = obj_to_fetch_from.get(what_to_fetch, default_val)\n    if val is None:\n        val = default_val\n    return val\n\n\ndef http_request(method, url_suffix, params=None, data=None, headers=None, is_raw_response=False):\n    res = requests.request(\n        method,\n        BASE_URL + url_suffix,\n        verify=USE_SSL,\n        params=params,\n        data=json.dumps(data),\n        headers=headers or HEADERS\n    )\n    if res.status_code \u003e= 400:\n        try:\n            json_res = res.json()\n            # add message from GitHub if available\n            err_msg = json_res.get('message', '')\n            if err_msg and 'documentation_url' in json_res:\n                err_msg += f' see: {json_res[\"documentation_url\"]}'\n            if json_res.get('errors') is None:\n                err_msg = f'Error in API call to the GitHub Integration [{res.status_code}] {res.reason}. {err_msg}'\n            else:\n                error_code = json_res.get('errors')[0].get('code')\n                if error_code == 'missing_field':\n                    err_msg = f'Error: the field: \"{json_res.get(\"errors\")[0].get(\"field\")}\" requires a value. ' \\\n                              f'{err_msg}'\n                elif error_code == 'invalid':\n                    field = json_res.get('errors')[0].get('field')\n                    if field == 'q':\n                        err_msg = f'Error: invalid query - {json_res.get(\"errors\")[0].get(\"message\")}. {err_msg}'\n                    else:\n                        err_msg = f'Error: the field: \"{field}\" has an invalid value. {err_msg}'\n\n                elif error_code == 'missing':\n                    err_msg = f\"Error: {json_res.get('errors')[0].get('resource')} does not exist. {err_msg}\"\n\n                elif error_code == 'already_exists':\n                    err_msg = f\"Error: the field {json_res.get('errors')[0].get('field')} must be unique. {err_msg}\"\n\n                else:\n                    err_msg = f'Error in API call to the GitHub Integration [{res.status_code}] - {res.reason}. ' \\\n                              f'{err_msg}'\n            raise DemistoException(err_msg)\n\n        except ValueError:\n            raise DemistoException(f'Error in API call to GitHub Integration [{res.status_code}] - {res.reason}')\n\n    try:\n        if res.status_code == 204:\n            return res\n        elif is_raw_response:\n            return res.content.decode('utf-8')\n        else:\n            return res.json()\n\n    except Exception as excep:\n        return_error('Error in HTTP request - {}'.format(str(excep)))\n\n\ndef data_formatting(title, body, labels, assignees, state):\n    \"\"\"This method creates a dictionary to be used as \"data\" field in an http request.\"\"\"\n    data = {}\n    if title is not None:\n        data['title'] = title\n\n    if body is not None:\n        data['body'] = body\n\n    if state is not None:\n        data['state'] = state\n\n    if labels is not None:\n        data['labels'] = labels.split(',')\n\n    if assignees is not None:\n        data['assignees'] = assignees.split(',')\n\n    return data\n\n\ndef context_create_issue(response, issue):\n    \"\"\" Create GitHub.Issue EntryContext and results to be printed in Demisto.\n\n    Args:\n        response (dict): The raw HTTP response to be inserted to the 'Contents' field.\n        issue (dict or list): A dictionary or a list of dictionaries formatted for Demisto results.\n    \"\"\"\n    ec = {\n        'GitHub.Issue(val.Repository == obj.Repository \u0026\u0026 val.ID == obj.ID)': issue\n    }\n    return_outputs(tableToMarkdown(\"Issues:\", issue, headers=ISSUE_HEADERS, removeNull=True), ec, response)\n\n\ndef list_create(issue, list_name, element_name):\n    \"\"\" Creates a list if parameters exist in issue.\n\n    Args:\n        issue(dict): an issue from GitHub.\n        list_name (str): the name of the list in the issue.\n        element_name (str): the field name of the element in the list.\n\n    Returns:\n        The created list or None if it does not exist.\n    \"\"\"\n    if issue.get(list_name) is not None:\n        return [element.get(element_name) for element in issue.get(list_name)]\n\n    else:\n        None\n\n\ndef issue_format(issue):\n    \"\"\" Create a dictionary with selected fields representing an issue in Demisto.\n\n    Args:\n        issue (dict): An HTTP response representing an issue, formatted as a dictionary\n\n    Returns:\n        (dict). representing an issue in Demisto.\n    \"\"\"\n    closed_by = None\n    if issue.get('closed_by') is not None and issue.get('state') == 'closed':\n        closed_by = issue.get('closed_by').get('login')\n\n    org = ''\n    repository_url = issue.get('repository_url').split('/')\n    repo = repository_url[-1]\n    if len(repository_url) \u003e 1:\n        org = repository_url[-2]\n\n    form = {\n        'ID': issue.get('number'),\n        'Repository': repo,\n        'Organization': org,\n        'Title': issue.get('title'),\n        'Body': issue.get('body'),\n        'State': issue.get('state'),\n        'Labels': list_create(issue, 'labels', 'name'),\n        'Assignees': list_create(issue, 'assignees', 'login'),\n        'Created_at': issue.get('created_at'),\n        'Updated_at': issue.get('updated_at'),\n        'Closed_at': issue.get('closed_at'),\n        'Closed_by': closed_by,\n        'Unique_ID': issue.get('id'),\n    }\n    return form\n\n\ndef create_issue_table(issue_list, response, limit):\n    \"\"\" Get an HTTP response and a list containing several issues, sends each issue to be reformatted.\n\n    Args:\n        issue_list(list): derived from the HTTP response\n        response (dict):A raw HTTP response sent for 'Contents' field in context\n\n    Returns:\n        The issues are sent to Demisto as a list.\n    \"\"\"\n    issue_list.reverse()\n    issue_table = []\n    issue_count = 0\n    for issue in issue_list:\n        issue_table.append(issue_format(issue))\n        issue_count = issue_count + 1\n        if issue_count == limit:\n            break\n\n    context_create_issue(response, issue_table)\n\n\ndef format_commit_outputs(commit: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API commit data and format to expected context outputs\n\n    Args:\n        commit (dict): commit data returned from GitHub API\n\n    Returns:\n        (dict): commit object formatted to expected context outputs\n    \"\"\"\n    author = commit.get('author', {})\n    ec_author = {\n        'Date': author.get('date'),\n        'Name': author.get('name'),\n        'Email': author.get('email')\n    }\n    committer = commit.get('committer', {})\n    ec_committer = {\n        'Date': committer.get('date'),\n        'Name': committer.get('name'),\n        'Email': committer.get('email')\n    }\n    parents = commit.get('parents', [])\n    formatted_parents = [{'SHA': parent.get('sha')} for parent in parents]\n\n    verification = commit.get('verification', {})\n    ec_verification = {\n        'Verified': verification.get('verified'),\n        'Reason': verification.get('reason'),\n        'Signature': verification.get('signature'),\n        'Payload': verification.get('payload')\n    }\n\n    ec_object = {\n        'SHA': commit.get('sha'),\n        'Author': ec_author,\n        'Committer': ec_committer,\n        'Message': commit.get('message'),\n        'Parent': formatted_parents,\n        'TreeSHA': commit.get('tree', {}).get('sha'),\n        'Verification': ec_verification\n    }\n    return ec_object\n\n\ndef format_label_outputs(label: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API label data and format to expected context outputs\n\n    Args:\n        label (dict): label data returned from GitHub API\n\n    Returns:\n        (dict): label object formatted to expected context outputs\n    \"\"\"\n    ec_object = {\n        'ID': label.get('id'),\n        'NodeID': label.get('node_id'),\n        'Name': label.get('name'),\n        'Description': label.get('description'),\n        'Color': label.get('Color'),\n        'Default': label.get('default')\n    }\n    return ec_object\n\n\ndef format_user_outputs(user: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API user data and format to expected context outputs\n\n    Args:\n        user (dict): user data returned from GitHub API\n\n    Returns:\n        (dict): user object formatted to expected context outputs\n    \"\"\"\n    ec_user = {\n        'Login': user.get('login'),\n        'ID': user.get('id'),\n        'NodeID': user.get('node_id'),\n        'Type': user.get('type'),\n        'SiteAdmin': user.get('site_admin')\n    }\n    return ec_user\n\n\ndef format_pr_review_comment_outputs(review_comment: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API pr review comment data and format to expected context outputs\n\n    Args:\n        review_comment (dict): pre review comment data returned from GitHub API\n\n    Returns:\n        (dict): pr review comment object formatted to expected context outputs\n    \"\"\"\n    ec_pr_review_comment = {\n        'ID': review_comment.get('id'),\n        'NodeID': review_comment.get('node_id'),\n        'PullRequestReviewID': review_comment.get('pull_request_review_id'),\n        'DiffHunk': review_comment.get('diff_hunk'),\n        'Path': review_comment.get('path'),\n        'Position': review_comment.get('position'),\n        'OriginalPosition': review_comment.get('original_position'),\n        'CommitID': review_comment.get('commit_id'),\n        'OriginalCommitID': review_comment.get('original_commit_id'),\n        'InReplyToID': review_comment.get('in_reply_to_id'),\n        'User': format_user_outputs(review_comment.get('user', {})),\n        'Body': review_comment.get('body'),\n        'CreatedAt': review_comment.get('created_at'),\n        'UpdatedAt': review_comment.get('updated_at'),\n        'AuthorAssociation': review_comment.get('author_association')\n    }\n    return ec_pr_review_comment\n\n\ndef format_team_outputs(team: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API team data and format to expected context outputs\n\n    Args:\n        team (dict): team data returned from GitHub API\n\n    Returns:\n        (dict): team object formatted to expected context outputs\n    \"\"\"\n    ec_team = {\n        'ID': team.get('id'),\n        'NodeID': team.get('node_id'),\n        'Name': team.get('name'),\n        'Slug': team.get('slug'),\n        'Description': team.get('description'),\n        'Privacy': team.get('privacy'),\n        'Permission': team.get('permission'),\n        'Parent': team.get('parent')\n    }\n    return ec_team\n\n\ndef format_head_or_base_outputs(head_or_base: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API head or base branch data and format to expected context outputs\n\n    Args:\n        head_or_base (dict): head or base branch data returned from GitHub API\n\n    Returns:\n        (dict): head or base branch object formatted to expected context outputs\n    \"\"\"\n    head_or_base_user = head_or_base.get('user', {})\n    ec_head_or_base_user = format_user_outputs(head_or_base_user)\n    head_or_base_repo = head_or_base.get('repo', {})\n\n    if head_or_base_repo:\n        head_or_base_repo_owner = head_or_base_repo.get('owner', {})\n    else:  # in case of a deleted fork\n        head_or_base_repo = {}\n        head_or_base_repo_owner = {\n            \"Login\": \"Unknown\"\n        }\n\n    ec_head_or_base_repo_owner = format_user_outputs(head_or_base_repo_owner)\n    ec_head_repo = {\n        'ID': head_or_base_repo.get('id'),\n        'NodeID': head_or_base_repo.get('node_id'),\n        'Name': head_or_base_repo.get('name'),\n        'FullName': head_or_base_repo.get('full_name'),\n        'Owner': ec_head_or_base_repo_owner,\n        'Private': head_or_base_repo.get('private'),\n        'Description': head_or_base_repo.get('description'),\n        'Fork': head_or_base_repo.get('fork'),\n        'Language': head_or_base_repo.get('language'),\n        'ForksCount': head_or_base_repo.get('forks_count'),\n        'StargazersCount': head_or_base_repo.get('stargazers_count'),\n        'WatchersCount': head_or_base_repo.get('watchers_count'),\n        'Size': head_or_base_repo.get('size'),\n        'DefaultBranch': head_or_base_repo.get('default_branch'),\n        'OpenIssuesCount': head_or_base_repo.get('open_issues_count'),\n        'Topics': head_or_base_repo.get('topics'),\n        'HasIssues': head_or_base_repo.get('has_issues'),\n        'HasProjects': head_or_base_repo.get('has_projects'),\n        'HasWiki': head_or_base_repo.get('has_wiki'),\n        'HasPages': head_or_base_repo.get('has_pages'),\n        'HasDownloads': head_or_base_repo.get('has_downloads'),\n        'Archived': head_or_base_repo.get('archived'),\n        'Disabled': head_or_base_repo.get('disabled'),\n        'PushedAt': head_or_base_repo.get('pushed_at'),\n        'CreatedAt': head_or_base_repo.get('created_at'),\n        'UpdatedAt': head_or_base_repo.get('updated_at'),\n        'AllowRebaseMerge': head_or_base_repo.get('allow_rebase_merge'),\n        'AllowSquashMerge': head_or_base_repo.get('allow_squash_merge'),\n        'AllowMergeCommit': head_or_base_repo.get('allow_merge_commit'),\n        'SucscribersCount': head_or_base_repo.get('subscribers_count')\n    }\n    ec_head_or_base = {\n        'Label': head_or_base.get('label'),\n        'Ref': head_or_base.get('ref'),\n        'SHA': head_or_base.get('sha'),\n        'User': ec_head_or_base_user,\n        'Repo': ec_head_repo,\n    }\n    return ec_head_or_base\n\n\ndef format_pr_outputs(pull_request: dict = {}) -\u003e dict:\n    \"\"\"Take GitHub API Pull Request data and format to expected context outputs\n\n    Args:\n        pull_request (dict): Pull Request data returned from GitHub API\n\n    Returns:\n        (dict): Pull Request object formatted to expected context outputs\n    \"\"\"\n    user_data = safe_get(pull_request, 'user', {})\n    ec_user = format_user_outputs(user_data)\n\n    labels_data = safe_get(pull_request, 'labels', [])\n    ec_labels = [format_label_outputs(label) for label in labels_data]\n\n    milestone_data = safe_get(pull_request, 'milestone', {})\n    creator = safe_get(milestone_data, 'creator', {})\n    ec_creator = format_user_outputs(creator)\n    ec_milestone = {\n        'ID': milestone_data.get('id'),\n        'NodeID': milestone_data.get('node_id'),\n        'Number': milestone_data.get('number'),\n        'State': milestone_data.get('state'),\n        'Title': milestone_data.get('title'),\n        'Description': milestone_data.get('description'),\n        'OpenIssues': milestone_data.get('open_issues'),\n        'ClosedIssues': milestone_data.get('closed_issues'),\n        'CreatedAt': milestone_data.get('created_at'),\n        'UpdatedAt': milestone_data.get('updated_at'),\n        'ClosedAt': milestone_data.get('closed_at'),\n        'DueOn': milestone_data.get('due_on'),\n    }\n    if creator:\n        ec_milestone['Creator'] = ec_creator\n\n    assignees_data = safe_get(pull_request, 'assignees', [])\n    ec_assignee = [format_user_outputs(assignee) for assignee in assignees_data]\n\n    requested_reviewers_data = safe_get(pull_request, 'requested_reviewers', [])\n    ec_requested_reviewer = [format_user_outputs(requested_reviewer) for requested_reviewer in requested_reviewers_data]\n\n    requested_teams_data = safe_get(pull_request, 'requested_teams', [])\n    ec_requested_team = [format_team_outputs(requested_team) for requested_team in requested_teams_data]\n\n    head_data = safe_get(pull_request, 'head', {})\n    ec_head = format_head_or_base_outputs(head_data)\n\n    base_data = safe_get(pull_request, 'base', {})\n    ec_base = format_head_or_base_outputs(base_data)\n\n    merged_by_data = safe_get(pull_request, 'merged_by', {})\n    ec_merged_by = format_user_outputs(merged_by_data)\n\n    ec_object = {\n        'ID': pull_request.get('id'),\n        'NodeID': pull_request.get('node_id'),\n        'Number': pull_request.get('number'),\n        'State': pull_request.get('state'),\n        'Locked': pull_request.get('locked'),\n        'Body': pull_request.get('body'),\n        'ActiveLockReason': pull_request.get('active_lock_reason'),\n        'CreatedAt': pull_request.get('created_at'),\n        'UpdatedAt': pull_request.get('updated_at'),\n        'ClosedAt': pull_request.get('closed_at'),\n        'MergedAt': pull_request.get('merged_at'),\n        'MergeCommitSHA': pull_request.get('merge_commit_sha'),\n        'AuthorAssociation': pull_request.get('author_association'),\n        'Draft': pull_request.get('draft'),\n        'Merged': pull_request.get('merged'),\n        'Mergeable': pull_request.get('mergeable'),\n        'Rebaseable': pull_request.get('rebaseable'),\n        'MergeableState': pull_request.get('mergeable_state'),\n        'Comments': pull_request.get('comments'),\n        'ReviewComments': pull_request.get('review_comments'),\n        'MaintainerCanModify': pull_request.get('maintainer_can_modify'),\n        'Commits': pull_request.get('commits'),\n        'Additions': pull_request.get('additions'),\n        'Deletions': pull_request.get('deletions'),\n        'ChangedFiles': pull_request.get('changed_files')\n    }\n    if user_data:\n        ec_object['User'] = ec_user\n    if labels_data:\n        ec_object['Label'] = ec_labels\n    if assignees_data:\n        ec_object['Assignee'] = ec_assignee\n    if requested_reviewers_data:\n        ec_object['RequestedReviewer'] = ec_requested_reviewer\n    if requested_teams_data:\n        ec_object['RequestedTeam'] = ec_requested_team\n    if head_data:\n        ec_object['Head'] = ec_head\n    if base_data:\n        ec_object['Base'] = ec_base\n    if merged_by_data:\n        ec_object['MergedBy'] = ec_merged_by\n    if milestone_data:\n        ec_object['Milestone'] = ec_milestone\n    return ec_object\n\n\ndef format_comment_outputs(comment: dict, issue_number: Union[int, str]) -\u003e dict:\n    \"\"\"Take GitHub API Comment data and format to expected context outputs\n\n    Args:\n        comment (dict): Comment data returned from GitHub API\n        issue_number (int): The number of the issue to which the comment belongs\n\n    Returns:\n        (dict): Comment object formatted to expected context outputs\n    \"\"\"\n    ec_object = {\n        'IssueNumber': int(issue_number) if isinstance(issue_number, str) else issue_number,\n        'ID': comment.get('id'),\n        'NodeID': comment.get('node_id'),\n        'Body': comment.get('body'),\n        'User': format_user_outputs(comment.get('user', {}))\n    }\n    return ec_object\n\n\n''' COMMANDS '''\n\n\ndef test_module():\n    http_request(method='GET', url_suffix=ISSUE_SUFFIX, params={'state': 'all'})\n    demisto.results(\"ok\")\n\n\ndef create_pull_request(create_vals: dict = {}) -\u003e dict:\n    suffix = PULLS_SUFFIX\n    response = http_request('POST', url_suffix=suffix, data=create_vals)\n    return response\n\n\ndef create_pull_request_command():\n    args = demisto.args()\n    create_vals = {key: val for key, val in args.items()}\n    maintainer_can_modify = args.get('maintainer_can_modify')\n    if maintainer_can_modify:\n        create_vals['maintainer_can_modify'] = maintainer_can_modify == 'true'\n    draft = args.get('draft')\n    if draft:\n        create_vals['draft'] = draft == 'true'\n    response = create_pull_request(create_vals)\n\n    ec_object = format_pr_outputs(response)\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Created Pull Request #{response.get(\"number\")}', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef list_branch_pull_requests(branch_name: str, repository: Optional[str] = None,\n                              organization: Optional[str] = None) -\u003e List[Dict]:\n    \"\"\"\n    Performs API request to GitHub service and formats the returned pull requests details to outputs.\n    Args:\n        branch_name (str): Name of the branch to retrieve its PR.\n        repository (Optional[str]): Repository the branch resides in. Defaults to 'REPOSITORY' if not given.\n        organization (Optional[str]): Organization the branch resides in. Defaults to 'USER' if not given.\n\n    Returns:\n        (List[Dict]): List of the formatted pull requests outputs.\n    \"\"\"\n    repository = repository if repository else REPOSITORY\n    organization = organization if organization else USER\n    suffix = f'/repos/{organization}/{repository}/pulls?head={organization}:{branch_name}'\n    response = http_request('GET', url_suffix=suffix)\n    formatted_outputs = [format_pr_outputs(output) for output in response]\n\n    return formatted_outputs\n\n\ndef list_branch_pull_requests_command() -\u003e None:\n    \"\"\"\n    List all pull requests corresponding to the given 'branch_name' in 'organization'\n    Args:\n        - 'branch_name': Branch name to retrieve its pull requests.\n        - 'organization': Organization the branch belongs to.\n        - 'repository': The repository the branch belongs to. Uses 'REPOSITORY' parameter if not given.\n    Returns:\n        (None): Results to XSOAR.\n    \"\"\"\n    args = demisto.args()\n    branch_name = args.get('branch_name', '')\n    organization = args.get('organization')\n    repository = args.get('repository')\n    formatted_outputs = list_branch_pull_requests(branch_name, repository, organization)\n\n    return_results(CommandResults(\n        outputs_prefix='GitHub.PR',\n        outputs_key_field='Number',\n        outputs=formatted_outputs,\n        readable_output=tableToMarkdown(f'Pull Request For Branch #{branch_name}', formatted_outputs, removeNull=True)\n    ))\n\n\ndef is_pr_merged(pull_number: Union[int, str]):\n    suffix = PULLS_SUFFIX + f'/{pull_number}/merge'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef is_pr_merged_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n\n    # raises 404 not found error if the pr was not merged\n    is_pr_merged(pull_number)\n    demisto.results(f'Pull Request #{pull_number} was Merged')\n\n\ndef update_pull_request(pull_number: Union[int, str], update_vals: dict = {}) -\u003e dict:\n    suffix = PULLS_SUFFIX + f'/{pull_number}'\n    response = http_request('PATCH', url_suffix=suffix, data=update_vals)\n    return response\n\n\ndef update_pull_request_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n    update_vals = {key: val for key, val in args.items() if key != 'pull_number'}\n    if not update_vals:\n        return_error('You must provide a value for at least one of the command\\'s arguments \"title\", \"body\", \"state\",'\n                     ' \"base\" or \"maintainer_can_modify\" that you would like to update the pull request with')\n    maintainer_can_modify = update_vals.get('maintainer_can_modify')\n    if maintainer_can_modify:\n        update_vals['maintainer_can_modify'] = maintainer_can_modify == 'true'\n    response = update_pull_request(pull_number, update_vals)\n\n    ec_object = format_pr_outputs(response)\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Updated Pull Request #{pull_number}', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef list_teams(organization: str) -\u003e list:\n    suffix = f'/orgs/{organization}/teams'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef list_teams_command():\n    args = demisto.args()\n    organization = args.get('organization')\n    response = list_teams(organization)\n\n    ec_object = [format_team_outputs(team) for team in response]\n    ec = {\n        'GitHub.Team(val.ID === obj.ID)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Teams for Organization \"{organization}\"', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef get_pull_request(pull_number: Union[int, str], repository: str = None, organization: str = None):\n    if repository and organization and pull_number:\n        suffix = f'/repos/{organization}/{repository}/pulls/{pull_number}'\n    else:\n        suffix = PULLS_SUFFIX + f'/{pull_number}'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef get_pull_request_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n    organization = args.get('organization')\n    repository = args.get('repository')\n    response = get_pull_request(pull_number, repository, organization)\n\n    ec_object = format_pr_outputs(response)\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Pull Request #{pull_number}', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef add_label(issue_number: Union[int, str], labels: list):\n    suffix = ISSUE_SUFFIX + f'/{issue_number}/labels'\n    response = http_request('POST', url_suffix=suffix, data={'labels': labels})\n    return response\n\n\ndef add_label_command():\n    args = demisto.args()\n    issue_number = args.get('issue_number')\n    labels = argToList(args.get('labels'))\n    add_label(issue_number, labels)\n    labels_for_msg = [f'\"{label}\"' for label in labels]\n    msg = f'{\" and \".join(labels_for_msg)} Successfully Added to Issue #{issue_number}'\n    msg = 'Labels ' + msg if 'and' in msg else 'Label ' + msg\n    demisto.results(msg)\n\n\ndef get_commit(commit_sha: str) -\u003e dict:\n    suffix = USER_SUFFIX + f'/git/commits/{commit_sha}'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef get_commit_command():\n    args = demisto.args()\n    commit_sha = args.get('commit_sha')\n    response = get_commit(commit_sha)\n\n    ec_object = format_commit_outputs(response)\n    ec = {\n        'GitHub.Commit(val.SHA === obj.SHA)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Commit *{commit_sha[:10]}*', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef list_pr_reviews(pull_number: Union[int, str]) -\u003e list:\n    suffix = PULLS_SUFFIX + f'/{pull_number}/reviews'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef list_pr_reviews_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n    response = list_pr_reviews(pull_number)\n\n    formatted_pr_reviews = [\n        {\n            'ID': pr_review.get('id'),\n            'NodeID': pr_review.get('node_id'),\n            'Body': pr_review.get('body'),\n            'CommitID': pr_review.get('commit_id'),\n            'State': pr_review.get('state'),\n            'User': format_user_outputs(pr_review.get('user', {}))\n        }\n        for pr_review in response\n    ]\n    ec_object = {\n        'Number': pull_number,\n        'Review': formatted_pr_reviews\n    }\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Pull Request Reviews for #{pull_number}', formatted_pr_reviews, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef list_pr_files(pull_number: Union[int, str], organization: str = None, repository: str = None) -\u003e list:\n    if pull_number and organization and repository:\n        suffix = f'/repos/{organization}/{repository}/pulls/{pull_number}/files'\n    else:\n        suffix = PULLS_SUFFIX + f'/{pull_number}/files'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef list_pr_files_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n    organization = args.get('organization')\n    repository = args.get('repository')\n    response = list_pr_files(pull_number, organization, repository)\n\n    formatted_pr_files = [\n        {\n            'SHA': pr_file.get('sha'),\n            'Name': pr_file.get('filename'),\n            'Status': pr_file.get('status'),\n            'Additions': pr_file.get('additions'),\n            'Deletions': pr_file.get('deletions'),\n            'Changes': pr_file.get('changes')\n        }\n        for pr_file in response\n    ]\n    ec_object = {\n        'Number': pull_number,\n        'File': formatted_pr_files\n    }\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Pull Request Files for #{pull_number}', formatted_pr_files, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef list_pr_review_comments(pull_number: Union[int, str]) -\u003e list:\n    suffix = PULLS_SUFFIX + f'/{pull_number}/comments'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef list_pr_review_comments_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n    response = list_pr_review_comments(pull_number)\n\n    formatted_pr_review_comments = [format_pr_review_comment_outputs(review_comment) for review_comment in response]\n    ec_object = {\n        'Number': pull_number,\n        'ReviewComment': formatted_pr_review_comments\n    }\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Pull Request Review Comments for #{pull_number}', formatted_pr_review_comments,\n                                     removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef list_issue_comments(issue_number: Union[int, str]) -\u003e list:\n    suffix = ISSUE_SUFFIX + f'/{issue_number}/comments'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef list_issue_comments_command():\n    args = demisto.args()\n    issue_number = args.get('issue_number')\n    response = list_issue_comments(issue_number)\n\n    ec_object = [format_comment_outputs(comment, issue_number) for comment in response]\n    ec = {\n        'GitHub.Comment(val.IssueNumber === obj.IssueNumber \u0026\u0026 val.ID === obj.ID)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Comments for Issue #{issue_number}', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef create_comment(issue_number: Union[int, str], msg: str) -\u003e dict:\n    suffix = ISSUE_SUFFIX + f'/{issue_number}/comments'\n    response = http_request('POST', url_suffix=suffix, data={'body': msg})\n    return response\n\n\ndef create_comment_command():\n    args = demisto.args()\n    issue_number = args.get('issue_number')\n    body = args.get('body')\n    response = create_comment(issue_number, body)\n\n    ec_object = format_comment_outputs(response, issue_number)\n    ec = {\n        'GitHub.Comment(val.IssueNumber === obj.IssueNumber \u0026\u0026 val.ID === obj.ID)': ec_object\n    }\n    human_readable = tableToMarkdown('Created Comment', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef request_review(pull_number: Union[int, str], reviewers: list) -\u003e dict:\n    \"\"\"Make an API call to GitHub to request reviews from a list of users for a given PR\n\n    Args:\n        pull_number (int): The number of the PR for which the review request(s) is/are being made\n        reviewers (list): The list of GitHub usernames from which you wish to request a review\n\n    Returns:\n        dict: API response\n\n    Raises:\n        Exception: An exception will be raised if one or more of the requested reviewers is not\n            a collaborator of the repo and therefore the API call returns a 'Status: 422 Unprocessable Entity'\n    \"\"\"\n    suffix = PULLS_SUFFIX + f'/{pull_number}/requested_reviewers'\n    response = http_request('POST', url_suffix=suffix, data={'reviewers': reviewers})\n    return response\n\n\ndef request_review_command():\n    args = demisto.args()\n    pull_number = args.get('pull_number')\n    reviewers = argToList(args.get('reviewers'))\n    response = request_review(pull_number, reviewers)\n\n    requested_reviewers = response.get('requested_reviewers', [])\n    formatted_requested_reviewers = [format_user_outputs(reviewer) for reviewer in requested_reviewers]\n    ec_object = {\n        'Number': response.get('number'),\n        'RequestedReviewer': formatted_requested_reviewers\n    }\n    ec = {\n        'GitHub.PR(val.Number === obj.Number)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Requested Reviewers for #{response.get(\"number\")}',\n                                     formatted_requested_reviewers, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef get_team_membership(team_id: Union[int, str], user_name: str) -\u003e dict:\n    suffix = f'/teams/{team_id}/memberships/{user_name}'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef get_team_members(organization: str, team_slug: str, maximum_users: int = 30) -\u003e list:\n    page = 1\n    results: list = []\n    while len(results) \u003c maximum_users:\n        results_per_page = maximum_users - len(results)\n        results_per_page = min(results_per_page, 100)\n        params = {'page': page, 'per_page': results_per_page}\n        suffix = f'/orgs/{organization}/teams/{team_slug}/members'\n        response = http_request('GET', url_suffix=suffix, params=params)\n        if not response:\n            break\n        results.extend(response)\n        page += 1\n\n    return results\n\n\ndef get_team_membership_command():\n    args = demisto.args()\n    team_id = args.get('team_id')\n    try:\n        team_id = int(team_id)\n    except ValueError as e:\n        return_error('\"team_id\" command argument must be an integer value.', e)\n    user_name = args.get('user_name')\n    response = get_team_membership(team_id, user_name)\n\n    ec_object = {\n        'ID': team_id,\n        'Member': {\n            'Login': user_name,\n            'Role': response.get('role'),\n            'State': response.get('state')\n        }\n    }\n    ec = {\n        'GitHub.Team': ec_object\n    }\n    human_readable = tableToMarkdown(f'Team Membership of {user_name}', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef get_branch(branch: str) -\u003e dict:\n    suffix = USER_SUFFIX + f'/branches/{branch}'\n    response = http_request('GET', url_suffix=suffix)\n    return response\n\n\ndef get_branch_command():\n    args = demisto.args()\n    branch_name = args.get('branch_name')\n    response = get_branch(branch_name)\n\n    commit = response.get('commit', {})\n    author = commit.get('author', {})\n    parents = commit.get('parents', [])\n    ec_object = {\n        'Name': response.get('name'),\n        'CommitSHA': commit.get('sha'),\n        'CommitNodeID': commit.get('node_id'),\n        'CommitAuthorID': author.get('id'),\n        'CommitAuthorLogin': author.get('login'),\n        'CommitParentSHA': [parent.get('sha') for parent in parents],\n        'Protected': response.get('protected')\n    }\n    ec = {\n        'GitHub.Branch(val.Name === obj.Name \u0026\u0026 val.CommitSHA === obj.CommitSHA)': ec_object\n    }\n    human_readable = tableToMarkdown(f'Branch \"{branch_name}\"', ec_object, removeNull=True)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=response)\n\n\ndef create_branch(name: str, sha: str) -\u003e dict:\n    suffix = USER_SUFFIX + '/git/refs'\n    data = {\n        'ref': f'refs/heads/{name}',\n        'sha': sha\n    }\n    response = http_request('POST', url_suffix=suffix, data=data)\n    return response\n\n\ndef create_branch_command():\n    args = demisto.args()\n    branch_name = args.get('branch_name')\n    commit_sha = args.get('commit_sha')\n    create_branch(branch_name, commit_sha)\n    msg = f'Branch \"{branch_name}\" Created Successfully'\n    demisto.results(msg)\n\n\ndef delete_branch(name: str):\n    suffix = USER_SUFFIX + f'/git/refs/heads/{name}'\n    http_request('DELETE', url_suffix=suffix)\n\n\ndef delete_branch_command():\n    args = demisto.args()\n    branch_name = args.get('branch_name')\n    delete_branch(branch_name)\n    msg = f'Branch \"{branch_name}\" Deleted Successfully'\n    demisto.results(msg)\n\n\ndef get_stale_prs(stale_time: str, label: str) -\u003e list:\n    time_range_start, _ = parse_date_range(stale_time)\n    # regex for removing the digits from the end of the isoformat timestamp that don't conform to API expectations\n    timestamp_regex = re.compile(r'\\.\\d{6}$')\n    timestamp, _ = timestamp_regex.subn('', time_range_start.isoformat())\n    query = f'repo:{USER}/{REPOSITORY} is:open updated:\u003c{timestamp} is:pr'\n    if label:\n        query += f' label:{label}'\n    matching_issues = search_issue(query, 100).get('items', [])\n    relevant_prs = [get_pull_request(issue.get('number')) for issue in matching_issues]\n    return relevant_prs\n\n\ndef get_stale_prs_command():\n    args = demisto.args()\n    stale_time = args.get('stale_time', '3 days')\n    label = args.get('label')\n    results = get_stale_prs(stale_time, label)\n    if results:\n        formatted_results = []\n        for pr in results:\n            requested_reviewers = [\n                requested_reviewer.get('login') for requested_reviewer in pr.get('requested_reviewers', [])\n            ]\n            formatted_pr = {\n                'URL': f'\u003c{pr.get(\"html_url\")}\u003e',\n                'Number': pr.get('number'),\n                'RequestedReviewer': requested_reviewers\n            }\n            formatted_results.append(formatted_pr)\n        ec = {\n            'GitHub.PR(val.Number === obj.Number)': formatted_results\n        }\n        human_readable = tableToMarkdown('Stale PRs', formatted_results, removeNull=True)\n        return_outputs(readable_output=human_readable, outputs=ec, raw_response=results)\n    else:\n        demisto.results('No stale external PRs found')\n\n\ndef create_issue(title, body, labels, assignees):\n    data = data_formatting(title=title,\n                           body=body,\n                           labels=labels,\n                           assignees=assignees,\n                           state=None)\n\n    response = http_request(method='POST',\n                            url_suffix=ISSUE_SUFFIX,\n                            data=data)\n    return response\n\n\ndef create_command():\n    args = demisto.args()\n    response = create_issue(args.get('title'), args.get('body'),\n                            args.get('labels'), args.get('assignees'))\n    issue = issue_format(response)\n    context_create_issue(response, issue)\n\n\ndef close_issue(id):\n    response = http_request(method='PATCH',\n                            url_suffix=ISSUE_SUFFIX + '/{}'.format(str(id)),\n                            data={'state': 'closed'})\n    return response\n\n\ndef close_command():\n    id = demisto.args().get('ID')\n    response = close_issue(id)\n    issue = issue_format(response)\n    context_create_issue(response, issue)\n\n\ndef update_issue(id, title, body, state, labels, assign):\n    data = data_formatting(title=title,\n                           body=body,\n                           labels=labels,\n                           assignees=assign,\n                           state=state)\n\n    response = http_request(method='PATCH',\n                            url_suffix=ISSUE_SUFFIX + '/{}'.format(str(id)),\n                            data=data)\n    return response\n\n\ndef update_command():\n    args = demisto.args()\n    response = update_issue(args.get('ID'), args.get('title'), args.get('body'), args.get('state'),\n                            args.get('labels'), args.get('assignees'))\n    issue = issue_format(response)\n    context_create_issue(response, issue)\n\n\ndef list_all_issue(state, page=1):\n    params = {'state': state, 'page': page, 'per_page': MAX_FETCH_PAGE_RESULTS, }\n    response = http_request(method='GET',\n                            url_suffix=ISSUE_SUFFIX,\n                            params=params)\n    if len(response) == MAX_FETCH_PAGE_RESULTS:\n        return response + list_all_issue(state=state, page=page + 1)\n    else:\n        return response\n\n\ndef get_cards(url, header, page=1):\n    resp = requests.get(url=url,\n                        headers=header,\n                        verify=USE_SSL,\n                        params={'page': page, 'per_page': MAX_FETCH_PAGE_RESULTS}\n                        )\n    cards = resp.json()\n    column_issues = []\n    for card in cards:\n        if \"content_url\" in card:\n            column_issues.append({\"CardID\": card[\"id\"], \"ContentNumber\": int(card[\"content_url\"].rsplit('/', 1)[1])})\n    if len(cards) == MAX_FETCH_PAGE_RESULTS:\n        return column_issues + get_cards(url=url, header=header, page=page + 1)\n    else:\n        return column_issues\n\n\ndef get_project_details(project, header):\n    resp_column = requests.get(url=project[\"columns_url\"],\n                               headers=header,\n                               verify=USE_SSL)\n\n    json_column = resp_column.json()\n    columns_data = {}\n    all_project_issues = []\n\n    for column in json_column:\n        cards = get_cards(url=column[\"cards_url\"], header=header)\n        columns_data[column[\"name\"]] = {'Name': column[\"name\"],\n                                        'ColumnID': column[\"id\"],\n                                        'Cards': cards}\n        for card in cards:\n            all_project_issues.append(card[\"ContentNumber\"])\n\n    return {'Name': project[\"name\"],\n            'ID': project[\"id\"],\n            'Number': project[\"number\"],\n            'Columns': columns_data,\n            'Issues': all_project_issues,\n            }\n\n\ndef list_all_projects_command():\n\n    project_f = demisto.args().get('project_filter', [])\n    limit = demisto.args().get('limit', MAX_FETCH_PAGE_RESULTS)\n\n    if int(limit) \u003e MAX_FETCH_PAGE_RESULTS or project_f:\n        limit = MAX_FETCH_PAGE_RESULTS\n\n    if project_f:\n        project_f = project_f.split(\",\")\n\n    header = HEADERS\n    header.update({'Accept': PROJECTS_PREVIEW})\n    params = {'per_page': limit}\n    resp_projects = requests.get(url=BASE_URL + PROJECT_SUFFIX,\n                                 headers=header,\n                                 verify=USE_SSL,\n                                 params=params\n                                 )\n    projects = resp_projects.json()\n    projects_obj = []\n    for proj in projects:\n        if project_f:\n            if str(proj[\"number\"]) in project_f:\n                projects_obj.append(get_project_details(project=proj, header=header))\n        else:\n            projects_obj.append(get_project_details(project=proj, header=header))\n\n    human_readable_projects = [{'Name': proj['Name'], 'ID': proj['ID'], 'Number': proj['Number'], 'Columns':\n                                [column for column in proj['Columns']]} for proj in projects_obj]\n\n    if projects_obj:\n        human_readable = tableToMarkdown('Projects:', t=human_readable_projects, headers=PROJECT_HEADERS,\n                                         removeNull=True)\n    else:\n        human_readable = f'Not found projects with number - {\",\".join(project_f)}.'\n\n    command_results = CommandResults(\n        outputs_prefix='GitHub.Project',\n        outputs_key_field='Name',\n        outputs=projects_obj,\n        readable_output=human_readable\n    )\n    return_results(command_results)\n\n\ndef add_issue_to_project_board_command():\n    content_type = \"Issue\"\n\n    args = demisto.args()\n    column_id = args.get('column_id')\n    content_id = int(args.get('issue_unique_id'))\n    if \"content_type\" in demisto.args():\n        content_type = args.get('content_type')\n\n    header = HEADERS\n    header.update({'Accept': PROJECTS_PREVIEW})\n\n    post_url = \"%s/projects/columns/%s/cards\" % (BASE_URL, column_id)\n    post_data = {\"content_id\": content_id,\n                 \"content_type\": content_type,\n                 }\n    response = requests.post(url=post_url,\n                             headers=header,\n                             verify=USE_SSL,\n                             data=json.dumps(post_data)\n                             )\n\n    if response.status_code \u003e= 400:\n        message = response.json().get('message', f'Failed to add the issue with ID {content_id} to column with ID '\n                                                 f'{column_id}')\n        return_error(f\"Post result {response}\\nMessage: {message}\")\n\n    return_results(f\"The issue was successfully added to column ID {column_id}.\")\n\n\ndef list_all_command():\n    state = demisto.args().get('state')\n    limit = int(demisto.args().get('limit'))\n    if limit \u003e 200:\n        limit = 200\n\n    response = list_all_issue(state)\n    create_issue_table(response, response, limit)\n\n\ndef search_code(query, page=None, page_size=None):\n    headers = copy.deepcopy(HEADERS)\n    headers['Accept'] = 'application/vnd.github.v3+json'\n    params = {\n        'q': query\n    }\n\n    if page is not None:\n        params['page'] = page\n    if page_size is not None:\n        params['per_page'] = page_size\n\n    response = http_request(method='GET',\n                            url_suffix='/search/code',\n                            params=params,\n                            headers=headers)\n    return response\n\n\ndef search_code_command():\n    q = demisto.args().get('query')\n    page_number = demisto.args().get('page_number')\n    page_size = demisto.args().get('page_size')\n    limit = demisto.args().get('limit')\n\n    response = None\n\n    if limit and page_number:\n        raise ValueError('Must pass either limit or page_number with page_size')\n    elif limit:\n        tmp_limit = int(limit)\n\n        page_size = int(page_size or 100)\n        while tmp_limit \u003e 0:\n            page_number = int(tmp_limit / page_size)\n            res = search_code(\n                query=q,\n                page=page_number,\n                page_size=min(page_size, tmp_limit)\n            )\n\n            if not response:\n                response = res\n            else:\n                response['items'].extend(res.get('items', []))\n\n            tmp_limit = tmp_limit - page_size\n\n    else:\n        page_number = int(page_number or 0)\n        page_size = int(page_size or 50)\n\n        response = search_code(\n            query=q,\n            page=page_number,\n            page_size=page_size\n        )\n\n    total_count = response.get('total_count') if response else 0\n    items = response.get('items', []) if response else []\n    outputs = []\n    md_table = []\n    for item in items:\n        outputs.append({\n            'name': item.get('name'),\n            'path': item.get('path'),\n            'html_url': item.get('html_url'),\n            'repository': {\n                'desrciption': item.get('repository', {}).get('description'),\n                'full_name': item.get('repository', {}).get('full_name'),\n                'html_url': item.get('repository', {}).get('html_url'),\n                'branches_url': item.get('repository', {}).get('branches_url'),\n                'releases_url': item.get('repository', {}).get('releases_url'),\n                'commits_url': item.get('repository', {}).get('commits_url'),\n                'private': item.get('repository', {}).get('private'),\n                'id': item.get('repository', {}).get('id')\n            }\n        })\n\n        md_table.append({\n            'Name': f'[{item.get(\"name\")}]({item.get(\"html_url\")})',\n            'Path': item.get('path'),\n            'Repository Name': item.get('repository', {}).get('full_name'),\n            'Repository Description': item.get('repository', {}).get('description'),\n            'Is Repository Private': item.get('repository', {}).get('private')\n        })\n    md = tableToMarkdown(f'Returned {len(md_table)} out of {total_count} total results.', md_table,\n                         headers=['Name', 'Path', 'Repository Name', 'Repository Description', 'Is Repository Private'])\n\n    results = CommandResults(\n        outputs_prefix='GitHub.CodeSearchResults',\n        outputs_key_field='html_url',\n        outputs=outputs,\n        raw_response=response,\n        readable_output=md\n    )\n\n    return_results(results)\n\n\ndef search_issue(query, limit, page=1):\n\n    params = {'q': query, 'page': page, 'per_page': MAX_FETCH_PAGE_RESULTS, }\n    response = http_request(method='GET',\n                            url_suffix='/search/issues',\n                            params=params)\n    if len(response[\"items\"]) == MAX_FETCH_PAGE_RESULTS:\n        next_res = search_issue(query=query, limit=limit, page=page + 1)\n        response[\"items\"] = response[\"items\"] + next_res[\"items\"]\n        return response\n    else:\n        return response\n\n\ndef search_command():\n    q = demisto.args().get('query')\n    limit = int(demisto.args().get('limit'))\n    if limit \u003e 1000:\n        limit = 1000  # per GitHub limitation.\n    response = search_issue(q, limit)\n    create_issue_table(response['items'], response, limit)\n\n\ndef get_download_count():\n    response = http_request(method='GET',\n                            url_suffix=RELEASE_SUFFIX)\n\n    count_per_release = []\n    for release in response:\n        total_download_count = 0\n        for asset in release.get('assets', []):\n            total_download_count = total_download_count + asset['download_count']\n\n        release_info = {\n            'ID': release.get('id'),\n            'Download_count': total_download_count,\n            'Name': release.get('name'),\n            'Body': release.get('body'),\n            'Created_at': release.get('created_at'),\n            'Published_at': release.get('published_at')\n        }\n        count_per_release.append(release_info)\n\n    ec = {\n        'GitHub.Release( val.ID == obj.ID )': count_per_release\n    }\n    return_outputs(tableToMarkdown('Releases:', count_per_release, headers=RELEASE_HEADERS, removeNull=True), ec,\n                   response)\n\n\ndef list_owner_repositories(owner_name, repo_type):\n    \"\"\" List organization repositories.\n\n    Args:\n        owner_name (str): repositories owner.\n        repo_type (str): repository type, possible values: all, public, private, forks, sources, member, internal.\n\n    Returns:\n        list: organization repositories names.\n    \"\"\"\n    url_suffix = f\"/orgs/{owner_name}/repos\"\n    params = {'type': repo_type}\n    repos_info = http_request(method=\"GET\", url_suffix=url_suffix, params=params)\n\n    return [r.get('name') for r in repos_info]\n\n\ndef list_repository_workflows(owner_name, repository_name):\n    \"\"\" Lists the workflows in a repository.\n\n    Args:\n        owner_name (str): repositories owner.\n        repository_name (str): repository name.\n\n    Returns:\n        list: list of dictionaries of workflow data.\n    \"\"\"\n    url_suffix = f\"/repos/{owner_name}/{repository_name}/actions/workflows\"\n    repository_workflows = http_request(method=\"GET\", url_suffix=url_suffix)\n\n    return [w for w in repository_workflows.get('workflows') if w.get('state') == \"active\"]\n\n\ndef get_workflow_usage(owner_name, repository_name, workflow_id):\n    \"\"\" Gets the number of billable minutes used by a specific workflow during the current billing cycle.\n\n    Args:\n        owner_name (str): repositories owner.\n        repository_name (str): repository name.\n        workflow_id (str): workflow id.\n\n    Returns:\n        dict: milliseconds usage on ubuntu, macos and windows os.\n    \"\"\"\n    url_suffix = f\"/repos/{owner_name}/{repository_name}/actions/workflows/{workflow_id}/timing\"\n    workflow_usage = http_request(method=\"GET\", url_suffix=url_suffix).get('billable', {})\n\n    return workflow_usage\n\n\ndef list_team_members_command():\n    args = demisto.args()\n    org = args.get('organization')\n    team_slug = args.get('team_slug')\n    maximum_users = int(args.get('maximum_users'))\n    response = get_team_members(org, team_slug, maximum_users)\n    members = []\n    for member in response:\n        context_data = {\n            'ID': member.get(\"id\"),\n            'Login': member.get(\"login\"),\n            'Team': team_slug,\n        }\n        members.append(context_data)\n    if members:\n        human_readable = tableToMarkdown(f'Team Member of team {team_slug} in organization {org}', t=members, removeNull=True)\n    else:\n        human_readable = f'There is no team members under team {team_slug} in organization {org}'\n\n    return_results(CommandResults(\n        readable_output=human_readable,\n        outputs_prefix='GitHub.TeamMember',\n        outputs_key_field='ID',\n        outputs=members if members else None,\n        raw_response=response,\n    ))\n\n\ndef get_github_actions_usage():\n    \"\"\" List github actions workflows usage of private repositories.\n\n    \"\"\"\n    command_args = demisto.args()\n    owner_name = command_args.get('owner', '')\n    usage_result = []\n\n    private_repositories = list_owner_repositories(owner_name=owner_name, repo_type=\"private\")\n\n    for repository_name in private_repositories:\n        repository_workflows = list_repository_workflows(owner_name=owner_name, repository_name=repository_name)\n\n        for workflow in repository_workflows:\n            workflow_id = workflow.get('id', '')\n            workflow_name = workflow.get('name', '')\n            workflow_usage = get_workflow_usage(owner_name=owner_name, repository_name=repository_name,\n                                                workflow_id=workflow_id)\n\n            if workflow_usage:\n                usage_result.append({\n                    'WorkflowName': workflow_name,\n                    'WorkflowID': workflow_id,\n                    'RepositoryName': repository_name,\n                    'WorkflowUsage': workflow_usage,\n                })\n\n    ec = {\n        'GitHub.ActionsUsage': usage_result\n    }\n    human_readable = tableToMarkdown('Github Actions Usage', usage_result,\n                                     headerTransform=string_to_table_header)\n\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=usage_result)\n\n\ndef get_file_content_from_repo():\n    \"\"\"Gets the content of a file from GitHub.\n    \"\"\"\n    args = demisto.args()\n\n    file_path = args.get('file_path')\n    branch_name = args.get('branch_name')\n    media_type = args.get('media_type', 'raw')\n    organization = args.get('organization') or USER\n    repository = args.get('repository') or REPOSITORY\n    create_file_from_content = argToBoolean(args.get('create_file_from_content', False))\n\n    url_suffix = f'/repos/{organization}/{repository}/contents/{file_path}'\n    if branch_name:\n        url_suffix += f'?ref={branch_name}'\n\n    headers = {\n        'Authorization': \"Bearer \" + TOKEN,\n        'Accept': f'application/vnd.github.VERSION.{media_type}',\n    }\n\n    file_data = http_request(method=\"GET\", url_suffix=url_suffix, headers=headers, is_raw_response=True)\n\n    if create_file_from_content:\n        file_name = file_path.split('/')[-1]\n        demisto.results(fileResult(filename=file_name, data=file_data, file_type=EntryType.ENTRY_INFO_FILE))\n        return\n\n    file_processed_data = {\n        'Path': file_path,\n        'Content': file_data,\n        'MediaType': media_type,\n    }\n    if branch_name:\n        file_processed_data['Branch'] = branch_name\n\n    results = CommandResults(\n        outputs_prefix='GitHub.FileContent',\n        outputs_key_field=['Path', 'Branch', 'MediaType'],\n        outputs=file_processed_data,\n        readable_output=f'File {file_path} successfully fetched.',\n        raw_response=file_data,\n    )\n\n    return_results(results)\n\n\ndef list_files_command():\n    args = demisto.args()\n    path = args.get('path', '')\n    organization = args.get('organization')\n    repository = args.get('repository')\n    branch = args.get('branch')\n\n    if organization and repository:\n        suffix = f'/repos/{organization}/{repository}/contents/{path}'\n    else:\n        suffix = f'{USER_SUFFIX}/contents/{path}'\n\n    params = {}\n    if branch:\n        params['ref'] = branch\n\n    res = http_request(method='GET', url_suffix=suffix, params=params)\n\n    ec_object = []\n    for file in res:\n        ec_object.append({\n            'Type': file.get('type'),\n            'Name': file.get('name'),\n            'Size': file.get('size'),\n            'Path': file.get('path'),\n            'SHA': file.get('sha'),\n            'DownloadUrl': file.get('download_url')\n        })\n\n    ec = {'GitHub.File(val.Path === obj.Path)': ec_object}\n    human_readable = tableToMarkdown(f'Files in path: {path}', ec_object, removeNull=True, headers=FILE_HEADERS)\n    return_outputs(readable_output=human_readable, outputs=ec, raw_response=res)\n\n\ndef commit_file_command():\n    args = demisto.args()\n    commit_message = args.get('commit_message')\n    path_to_file = args.get('path_to_file')\n    branch = args.get('branch_name')\n    entry_id = args.get('entry_id')\n    file_text = args.get('file_text')\n    file_sha = args.get('file_sha')\n\n    if not entry_id and not file_text:\n        raise DemistoException('You must specify either the \"file_text\" or the \"entry_id\" of the file.')\n    elif entry_id:\n        file_path = demisto.getFilePath(entry_id).get('path')\n        with open(file_path, 'rb') as f:\n            content = f.read()\n    else:\n        content = bytes(file_text, encoding='utf8')\n\n    data = {\n        'message': commit_message,\n        'content': base64.b64encode(content).decode(\"utf-8\"),\n        'branch': branch,\n    }\n    if file_sha:\n        data['sha'] = file_sha\n    res = http_request(method='PUT', url_suffix='{}/{}'.format(FILE_SUFFIX, path_to_file), data=data)\n\n    return_results(CommandResults(\n        readable_output=f\"The file {path_to_file} committed successfully. Link to the commit:\"\n                        f\" {res['commit'].get('html_url')}\",\n        raw_response=res\n    ))\n\n\ndef list_check_runs(owner_name, repository_name, run_id, commit_id):\n    url_suffix = None\n\n    if run_id:\n        url_suffix = f\"/repos/{owner_name}/{repository_name}/check-runs/{run_id}\"\n    elif commit_id:\n        url_suffix = f\"/repos/{owner_name}/{repository_name}/commits/{commit_id}/check-runs\"\n    else:\n        raise DemistoException(\"You have to specify either the check run id of the head commit reference\")\n\n    check_runs = http_request(method=\"GET\", url_suffix=url_suffix)\n\n    return [r for r in check_runs.get('check_runs')]\n\n\ndef get_github_get_check_run():\n    \"\"\" List github check runs.\n\n    \"\"\"\n    command_args = demisto.args()\n    owner_name = command_args.get('owner', '')\n    repository_name = command_args.get('repository', '')\n    run_id = command_args.get('run_id', '')\n    commit_id = command_args.get('commit_id', '')\n\n    check_run_result = []\n\n    check_runs = list_check_runs(owner_name=owner_name, repository_name=repository_name, run_id=run_id, commit_id=commit_id)\n\n    for check_run in check_runs:\n        check_run_id = check_run.get('id', '')\n        check_external_id = check_run.get('external_id', '')\n        check_run_name = check_run.get('name', '')\n        check_run_app_name = check_run['app'].get('name', '')\n        check_run_pr = check_run.get('pull_requests')\n        check_run_status = check_run.get('status', '')\n        check_run_conclusion = check_run.get('conclusion', '')\n        check_run_started_at = check_run.get('started_at', '')\n        check_run_completed_at = check_run.get('completed_at', '')\n        check_run_output = check_run.get('output', '')\n\n        check_run_result.append({\n            'CheckRunID': check_run_id,\n            'CheckExternalID': check_external_id,\n            'CheckRunName': check_run_name,\n            'CheckRunAppName': check_run_app_name,\n            'CheckRunPR': check_run_pr,\n            'CheckRunStatus': check_run_status,\n            'CheckRunConclusion': check_run_conclusion,\n            'CheckRunStartedAt': check_run_started_at,\n            'CheckRunCompletedAt': check_run_completed_at,\n            'CheckRunOutPut': check_run_output\n        })\n    command_results = CommandResults(\n        outputs_prefix='GitHub.CheckRuns',\n        outputs_key_field='CheckRunID',\n        outputs=check_run_result,\n        raw_response=check_run_result,\n    )\n    return_results(command_results)\n\n\ndef create_release_command():\n    args = demisto.args()\n    tag_name = args.get('tag_name')\n    data = {\n        'tag_name': tag_name,\n        'name': args.get('name'),\n        'body': args.get('body'),\n        'draft': argToBoolean(args.get('draft')),\n    }\n    response = http_request('POST', url_suffix=RELEASE_SUFFIX, data=data)\n    release_url = response.get('html_url')\n\n    return_results(CommandResults(\n        outputs_prefix='GitHub.Release',\n        outputs=response,\n        outputs_key_field='id',\n        readable_output=f'Release {tag_name} created successfully for repo {REPOSITORY}: {release_url}',\n        raw_response=response\n    ))\n\n\ndef get_issue_events_command():\n    args = demisto.args()\n    issue_number = args.get('issue_number')\n    res = http_request(method='GET', url_suffix=f'{ISSUE_SUFFIX}/{issue_number}/events')\n    return_results(CommandResults(outputs_prefix='GitHub.IssueEvent', outputs_key_field='id', outputs=res,\n                                  readable_output=tableToMarkdown(f'GitHub Issue Events For Issue {issue_number}',\n                                                                  res)))\n\n\ndef fetch_incidents_command_rec(start_time, last_time, page=1):\n    incidents = []\n\n    if demisto.params().get('fetch_object') == \"Pull_requests\":\n        pr_list = http_request(method='GET',\n                               url_suffix=PULLS_SUFFIX,\n                               params={\n                                   'state': 'open',\n                                   'sort': 'created',\n                                   'page': page,\n                                   'per_page': MAX_FETCH_PAGE_RESULTS,\n                               })\n        for pr in pr_list:\n            updated_at_str = pr.get('created_at')\n            updated_at = datetime.strptime(updated_at_str, '%Y-%m-%dT%H:%M:%SZ')\n            if updated_at \u003e start_time:\n                inc = {\n                    'name': pr.get('url'),\n                    'occurred': updated_at_str,\n                    'rawJSON': json.dumps(pr)\n                }\n                incidents.append(inc)\n                if updated_at \u003e last_time:\n                    last_time = updated_at\n\n        if len(pr_list) == MAX_FETCH_PAGE_RESULTS:\n            rec_prs, rec_last_time = fetch_incidents_command_rec(start_time=start_time, last_time=last_time,\n                                                                 page=page + 1)\n            incidents = incidents + rec_prs\n            if rec_last_time \u003e last_time:\n                last_time = rec_last_time\n    else:\n        params = {'page': page, 'per_page': MAX_FETCH_PAGE_RESULTS, 'state': 'all'}\n        # params.update({'labels': 'DevOps'})\n        issue_list = http_request(method='GET',\n                                  url_suffix=ISSUE_SUFFIX,\n                                  params=params)\n\n        for issue in issue_list:\n            updated_at_str = issue.get('created_at')\n            updated_at = datetime.strptime(updated_at_str, '%Y-%m-%dT%H:%M:%SZ')\n            if updated_at \u003e start_time:\n                inc = {\n                    'name': issue.get('url'),\n                    'occurred': updated_at_str,\n                    'rawJSON': json.dumps(issue)\n                }\n                incidents.append(inc)\n                if updated_at \u003e last_time:\n                    last_time = updated_at\n\n        if len(issue_list) == MAX_FETCH_PAGE_RESULTS:\n            rec_incidents, rec_last_time = fetch_incidents_command_rec(start_time=start_time, last_time=last_time,\n                                                                       page=page + 1)\n            incidents = incidents + rec_incidents\n            if rec_last_time \u003e last_time:\n                last_time = rec_last_time\n    return incidents, last_time\n\n\ndef get_path_data():\n    \"\"\"\n    Get path data from given relative file path, repository and organization corresponding to branch name if given.\n    Returns:\n        Outputs to XSOAR.\n    \"\"\"\n    args = demisto.args()\n\n    relative_path: str = args.get('relative_path', '')\n    repo: str = args.get('repository') or REPOSITORY\n    organization: str = args.get('organization') or USER\n    branch_name: Optional[str] = args.get('branch_name')\n\n    url_suffix = f'/repos/{organization}/{repo}/contents/{relative_path}'\n    url_suffix = f'{url_suffix}?ref={branch_name}' if branch_name else url_suffix\n\n    headers = {\n        'Authorization': \"Bearer \" + TOKEN,\n        'Accept': 'application/vnd.github.VERSION.object',\n    }\n    try:\n        raw_response = http_request(method=\"GET\", url_suffix=url_suffix, headers=headers)\n    except DemistoException as e:\n        if '[404]' in str(e):\n            err_msg = 'Could not find path.'\n            if branch_name:\n                err_msg += f' Make sure branch {branch_name} exists.'\n            err_msg += f' Make sure relative path {relative_path} is correct.'\n            raise DemistoException(err_msg)\n        raise e\n\n    # Content is given as str of base64, need to encode and decode in order to retrieve its human readable content.\n    file_data = copy.deepcopy(raw_response)\n    if 'content' in file_data:\n        file_data['content'] = codecs.decode(file_data.get('content', '').encode(), 'base64').decode('utf-8')\n    # Links are duplications of the Git/HTML/URL. Deleting duplicate data from context.\n    file_data.pop('_links', None)\n    for entry in file_data.get('entries', []):\n        entry.pop('_links', None)\n\n    results = CommandResults(\n        outputs_prefix='GitHub.PathData',\n        outputs_key_field='url',\n        outputs=file_data,\n        readable_output=tableToMarkdown(f'File Data For File {relative_path}', file_data, removeNull=True),\n        raw_response=raw_response,\n    )\n    return_results(results)\n\n\ndef github_releases_list_command():\n    \"\"\"\n    Gets releases data of given repository in given organization.\n    Returns:\n        CommandResults data.\n    \"\"\"\n    args: Dict[str, Any] = demisto.args()\n\n    repo: str = args.get('repository') or REPOSITORY\n    organization: str = args.get('organization') or USER\n    page_number: Optional[int] = arg_to_number(args.get('page'))\n    page_size: Optional[int] = arg_to_number(args.get('page_size'))\n    limit = arg_to_number(args.get('limit'))\n    if (page_number or page_size) and limit:\n        raise DemistoException('page_number and page_size arguments cannot be given with limit argument.\\n'\n                               'If limit is given, please do not use page or page_size arguments.')\n\n    results: List[Dict] = []\n    if limit:\n        page_number = 1\n        page_size = 100\n        while len(results) \u003c limit:\n            url_suffix: str = f'/repos/{organization}/{repo}/releases?per_page={page_size}\u0026page={page_number}'\n            response = http_request(method='GET', url_suffix=url_suffix)\n            # No more releases to bring from GitHub services.\n            if not response:\n                break\n            results.extend(response)\n            page_number += 1\n\n        results = results[:limit]\n    else:\n        page_size = page_size if page_size else DEFAULT_PAGE_SIZE\n        page_number = page_number if page_number else DEFAULT_PAGE_NUMBER\n        url_suffix = f'/repos/{organization}/{repo}/releases?per_page={page_size}\u0026page={page_number}'\n        results = http_request(method='GET', url_suffix=url_suffix)\n\n    result: CommandResults = CommandResults(\n        outputs_prefix='GitHub.Release',\n        outputs_key_field='id',\n        outputs=results,\n        readable_output=tableToMarkdown(f'Releases Data Of {repo}', results, removeNull=True)\n    )\n    return_results(result)\n\n\ndef fetch_incidents_command():\n    last_run = demisto.getLastRun()\n    if last_run and 'start_time' in last_run:\n        start_time = datetime.strptime(last_run.get('start_time'), '%Y-%m-%dT%H:%M:%SZ')\n\n    else:\n        start_time = datetime.now() - timedelta(days=int(FETCH_TIME))\n\n    incidents, last_time = fetch_incidents_command_rec(start_time=start_time, last_time=start_time)\n\n    demisto.setLastRun({'start_time': datetime.strftime(last_time, '%Y-%m-%dT%H:%M:%SZ')})\n    demisto.incidents(incidents)\n\n\n''' COMMANDS MANAGER / SWITCH PANEL '''\n\nCOMMANDS = {\n    'test-module': test_module,\n    'fetch-incidents': fetch_incidents_command,\n    'GitHub-create-issue': create_command,\n    'GitHub-close-issue': close_command,\n    'GitHub-update-issue': update_command,\n    'GitHub-list-all-issues': list_all_command,\n    'GitHub-list-all-projects': list_all_projects_command,\n    'GitHub-search-issues': search_command,\n    'GitHub-get-download-count': get_download_count,\n    'GitHub-get-stale-prs': get_stale_prs_command,\n    'GitHub-get-branch': get_branch_command,\n    'GitHub-create-branch': create_branch_command,\n    'GitHub-get-team-membership': get_team_membership_command,\n    'GitHub-request-review': request_review_command,\n    'GitHub-create-comment': create_comment_command,\n    'GitHub-list-issue-comments': list_issue_comments_command,\n    'GitHub-list-pr-files': list_pr_files_command,\n    'GitHub-list-pr-reviews': list_pr_reviews_command,\n    'GitHub-get-commit': get_commit_command,\n    'GitHub-add-label': add_label_command,\n    'GitHub-get-pull-request': get_pull_request_command,\n    'GitHub-list-teams': list_teams_command,\n    'GitHub-delete-branch': delete_branch_command,\n    'GitHub-list-pr-review-comments': list_pr_review_comments_command,\n    'GitHub-update-pull-request': update_pull_request_command,\n    'GitHub-is-pr-merged': is_pr_merged_command,\n    'GitHub-create-pull-request': create_pull_request_command,\n    'Github-get-github-actions-usage': get_github_actions_usage,\n    'Github-list-files': list_files_command,\n    'GitHub-get-file-content': get_file_content_from_repo,\n    'GitHub-search-code': search_code_command,\n    'GitHub-list-team-members': list_team_members_command,\n    'GitHub-list-branch-pull-requests': list_branch_pull_requests_command,\n    'Github-get-check-run': get_github_get_check_run,\n    'Github-commit-file': commit_file_command,\n    'GitHub-create-release': create_release_command,\n    'Github-list-issue-events': get_issue_events_command,\n    'GitHub-add-issue-to-project-board': add_issue_to_project_board_command,\n    'GitHub-get-path-data': get_path_data,\n    'GitHub-releases-list': github_releases_list_command,\n}\n\n\ndef main():\n    global BASE_URL\n    global USER\n    global TOKEN\n    global PRIVATE_KEY\n    global INTEGRATION_ID\n    global INSTALLATION_ID\n    global REPOSITORY\n    global USE_SSL\n    global FETCH_TIME\n    global MAX_FETCH_PAGE_RESULTS\n    global USER_SUFFIX\n    global ISSUE_SUFFIX\n    global PROJECT_SUFFIX\n    global RELEASE_SUFFIX\n    global PULLS_SUFFIX\n    global FILE_SUFFIX\n    global HEADERS\n\n    params = demisto.params()\n    BASE_URL = params.get('url', 'https://api.github.com')\n    USER = params.get('user')\n    TOKEN = params.get('token', '')\n    creds: dict = params.get('credentials', {})\n    PRIVATE_KEY = creds.get('sshkey', '') if creds else ''\n    INTEGRATION_ID = params.get('integration_id')\n    INSTALLATION_ID = params.get('installation_id')\n    REPOSITORY = params.get('repository')\n    USE_SSL = not params.get('insecure', False)\n    FETCH_TIME = params.get('fetch_time', '3')\n    MAX_FETCH_PAGE_RESULTS = 100\n\n    USER_SUFFIX = '/repos/{}/{}'.format(USER, REPOSITORY)\n    PROJECT_SUFFIX = USER_SUFFIX + '/projects'\n    ISSUE_SUFFIX = USER_SUFFIX + '/issues'\n    RELEASE_SUFFIX = USER_SUFFIX + '/releases'\n    PULLS_SUFFIX = USER_SUFFIX + '/pulls'\n    FILE_SUFFIX = USER_SUFFIX + '/contents'\n\n    if TOKEN == '' and PRIVATE_KEY != '':\n        try:\n            import jwt  # noqa\n        except Exception:\n            return_error(\"You need to update the docker image so that the jwt package could be used\")\n\n        generated_jwt_token = create_jwt(PRIVATE_KEY, INTEGRATION_ID)\n        TOKEN = get_installation_access_token(INSTALLATION_ID, generated_jwt_token)\n\n    if TOKEN == '' and PRIVATE_KEY == '':\n        return_error(\"Insert api token or private key\")\n\n    HEADERS = {\n        'Authorization': \"Bearer \" + TOKEN\n    }\n\n    handle_proxy()\n    cmd = demisto.command()\n    LOG(f'command is {cmd}')\n    try:\n        if cmd in COMMANDS.keys():\n            COMMANDS[cmd]()\n    except Exception as e:\n        return_error(str(e))\n\n\n# python2 uses __builtin__ python3 uses builtins\nif __name__ == '__builtin__' or __name__ == 'builtins' or __name__ == '__main__':\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.3.7","modified":"2021-09-05T10:49:33.528686+03:00","name":"GitHub","packID":"GitHub","packPropagationLabels":["all"],"prevName":"GitHub","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Identity and Access Management","commitMessage":"","configuration":[{"defaultValue":"","display":"GitHub URL https://\u003cdomain\u003e.github.com/","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"token","options":null,"required":true,"type":4},{"defaultValue":"","display":"Organization name","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"org","options":null,"required":true,"type":0},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow creating users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"create-user-enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow updating users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"update-user-enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow disabling users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"disable-user-enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Automatically create user if not found in update and enable commands","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"create-if-not-exists","options":null,"required":false,"type":8},{"defaultValue":"User Profile - SCIM (Incoming)","display":"Incoming Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mapper_in","options":null,"required":true,"type":0},{"defaultValue":"User Profile - SCIM (Outgoing)","display":"Outgoing Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mapper_out","options":null,"required":true,"type":0}],"definitionId":"","description":"Integrate with GitHub services to perform Identity Lifecycle Management operations.","detailedDescription":"\n To access the requested repository, you need to provide \n the username, repository name, and API key as parameters when configuring the\n integration instance.\n \n To generate your personal access token, visit:\n https://github.com/settings/tokens\n \n \n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/git-hub-iam)","display":"GitHub IAM","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"GitHub IAM","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"User Profile indicator details.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a user.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-create-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"If true, the employee's status is active, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Indicates if the API was successful or provides error information.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates an existing user with the data passed in the user-profile argument.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-update-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"If true, the employee's status is active, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Indicates if the API was successful or provides error information.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves a single user resource.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-get-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"If true, the employee's status is active, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Indicates if the API was successful or provides error information.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Disable an active user.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-disable-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"If true, the employee's status is active, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Indicates if the API was successful or provides error information.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"If true, the command was executed successfully, otherwise false.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Retrieves a User Profile schema which holds all of the user fields within the application. Used for outgoing-mapping through the Get Schema option.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-mapping-fields","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.5.21272","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":true,"isRemoteSyncIn":false,"isRemoteSyncOut":true,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\nimport traceback\nimport requests\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\nDEFAULT_OUTGOING_MAPPER = \"User Profile - SCIM (Outgoing)\"\nDEFAULT_INCOMING_MAPPER = \"User Profile - SCIM (Incoming)\"\n\n\nclass Client(BaseClient):\n\n    def __init__(self, base_url, org, headers, ok_codes=None, verify=True, proxy=False):\n        super().__init__(base_url, verify=verify, proxy=proxy, ok_codes=ok_codes, headers=headers)\n        self.org = org\n\n    def get_user(self, input_type, user_term):\n\n        uri = f'scim/v2/organizations/{self.org}/Users?filter={input_type} eq \\\"{user_term}\\\"'\n\n        return self._http_request(\n            method='GET',\n            url_suffix=uri,\n        )\n\n    def create_user(self, data):\n        uri = f'scim/v2/organizations/{self.org}/Users'\n        return self._http_request(\n            method='POST',\n            url_suffix=uri,\n            json_data=data,\n        )\n\n    def update_user(self, user_term, data):\n        uri = f'scim/v2/organizations/{self.org}/Users/{user_term}'\n        return self._http_request(\n            method='PUT',\n            url_suffix=uri,\n            json_data=data,\n        )\n\n    def disable_user(self, data):\n        uri = f'scim/v2/organizations/{self.org}/Users/{data}'\n        return self._http_request(\n            method='DELETE',\n            url_suffix=uri,\n            resp_type='text'\n        )\n\n    def get_user_id_by_mail(self, email):\n        user_id = \"\"\n        uri = f\"scim/v2/organizations/{self.org}/Users?filter=emails eq \\\"{email}\\\"\"\n\n        res = self._http_request(\n            method='GET',\n            url_suffix=uri\n        )\n        if not res.get('totalResults', 0) == 0:\n            if isinstance(res.get('Resources'), list):\n                item = res.get('Resources')[0]\n                if item:\n                    user_id = item.get('id')\n\n        return user_id\n\n\ndef github_handle_error(e):\n    \"\"\"\n    Handles an error from the Github API\n    an error example: Error in API call [401] - Unauthorized\n    {\"message\": \"Bad credentials\", \"documentation_url\": \"https://docs.github.com/rest\"}\n    The error might contain error_code, error_reason and error_message\n    The error_reason and error_message might be the same but usually, the error_reason adds more information that\n    the error_message doesn't provide\n    examples:\n        error_code = 401\n        error_message = 'Bad credentials'\n        error_reason = 'Unauthorized'\n    :param e: the client object\n    :return: error_code and  error_message\n    \"\"\"\n    try:\n        error_code = \"\"\n        error_message = str(e)\n        if e.__class__ is DemistoException and e.res is not None:\n            error_res = e.res\n            if isinstance(error_res, dict):\n                error_code = str(error_res.get(\"status\"))\n                error_message = str(error_res.get(\"detail\"))\n            else:\n                error_code = e.res.status_code\n                if not e.res.ok:\n                    if e.res.json():\n                        error_message = error_res.json().get(\"message\", \"\")\n                        if not error_message:\n                            error_message = error_res.json().get(\"detail\", \"\")\n                        error_reason = error_res.reason\n                        if error_reason and error_reason != error_message:\n                            error_message += f' {error_reason}'\n        return error_code, error_message\n\n    except Exception as e:\n        error_code = \"\"\n        error_message = str(e)\n        return error_code, error_message\n\n\ndef test_module(client):\n    \"\"\"\n    Trying to get a user by a fake id,\n    if the command returns with no errors the connection is ok\n    :param client: the client object\n    :return: ok if got a valid accesses token\n    \"\"\"\n    client.get_user(\"id\", \"1234\")\n    return 'ok'\n\n\ndef get_user_command(client, args, mapper_in):\n    try:\n        user_profile = args.get(\"user-profile\")\n        iam_user_profile = IAMUserProfile(user_profile=user_profile)\n\n        email = iam_user_profile.get_attribute('email')\n        res = client.get_user('emails', email)\n\n        if res.get('totalResults', 0) == 0:\n            error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n            iam_user_profile.set_result(success=False,\n                                        email=email,\n                                        error_message=error_message,\n                                        error_code=error_code,\n                                        action=IAMActions.GET_USER)\n\n        else:\n            github_user = res.get('Resources')[0]\n            iam_user_profile.update_with_app_data(github_user, mapper_in)\n            iam_user_profile.set_result(success=True,\n                                        iden=github_user.get('id', None),\n                                        email=email,\n                                        username=github_user.get('userName', None),\n                                        action=IAMActions.GET_USER,\n                                        details=res,\n                                        active=github_user.get('active', None))\n\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, error_message = github_handle_error(e)\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=error_message,\n                                    action=IAMActions.GET_USER\n                                    )\n        return iam_user_profile\n\n\ndef create_user_command(client, args, mapper_out, is_create_enabled, is_update_enabled):\n    try:\n        user_profile = args.get(\"user-profile\")\n        iam_user_profile = IAMUserProfile(user_profile=user_profile)\n\n        if not is_create_enabled:\n            iam_user_profile.set_result(action=IAMActions.CREATE_USER,\n                                        skip=True,\n                                        skip_reason='Command is disabled.')\n\n        else:\n            email = iam_user_profile.get_attribute('email')\n            user_id = client.get_user_id_by_mail(email)\n\n            if user_id:\n                # if user exists - update it\n                create_if_not_exists = False\n                iam_user_profile = update_user_command(client, args, mapper_out, is_update_enabled,\n                                                       is_create_enabled, create_if_not_exists)\n\n            else:\n                github_user = iam_user_profile.map_object(mapper_name=mapper_out,\n                                                          incident_type=IAMUserProfile.CREATE_INCIDENT_TYPE)\n                # make sure the email is transformer to a list\n                emails = github_user.get(\"emails\")\n                if not isinstance(emails, list):\n                    github_user[\"emails\"] = [emails]\n\n                res = client.create_user(github_user)\n                user_id = res.get('id', None)\n                iam_user_profile.set_result(success=True,\n                                            iden=user_id,\n                                            email=res.get('email'),\n                                            username=res.get('userName'),\n                                            action=IAMActions.CREATE_USER,\n                                            details=res,\n                                            active=True)\n\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, error_message = github_handle_error(e)\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=error_message,\n                                    action=IAMActions.CREATE_USER\n                                    )\n        return iam_user_profile\n\n\ndef update_user_command(client, args, mapper_out, is_update_enabled, is_create_enabled, create_if_not_exists):\n    try:\n        user_profile = args.get(\"user-profile\")\n        iam_user_profile = IAMUserProfile(user_profile=user_profile)\n\n        if not is_update_enabled:\n            iam_user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                        skip=True,\n                                        skip_reason='Command is disabled.')\n\n        else:\n            email = iam_user_profile.get_attribute('email')\n            user_id = client.get_user_id_by_mail(email)\n\n            if not user_id:\n                # user doesn't exists\n                if create_if_not_exists:\n                    iam_user_profile = create_user_command(client, args, mapper_out, is_create_enabled, False)\n                else:\n                    error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                    iam_user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                                error_code=error_code,\n                                                skip=True,\n                                                skip_reason=error_message)\n            else:\n                github_user = iam_user_profile.map_object(mapper_name=mapper_out,\n                                                          incident_type=IAMUserProfile.UPDATE_INCIDENT_TYPE)\n                emails = github_user.get(\"emails\")\n                if not isinstance(emails, list):\n                    github_user[\"emails\"] = [emails]\n\n                res = client.update_user(user_term=user_id, data=github_user)\n                iam_user_profile.set_result(success=True,\n                                            iden=user_id,\n                                            email=github_user.get('email'),\n                                            username=github_user.get('userName'),\n                                            action=IAMActions.UPDATE_USER,\n                                            details=res,\n                                            active=True)\n\n        return iam_user_profile\n\n    except Exception as e:\n        error_code, error_message = github_handle_error(e)\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=error_message,\n                                    action=IAMActions.UPDATE_USER\n                                    )\n        return iam_user_profile\n\n\ndef disable_user_command(client, args, mapper_out, is_disable_enabled):\n    try:\n        user_profile = args.get(\"user-profile\")\n        iam_user_profile = IAMUserProfile(user_profile=user_profile)\n\n        if not is_disable_enabled:\n            iam_user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                        skip=True,\n                                        skip_reason='Command is disabled.')\n\n        else:\n            email = iam_user_profile.get_attribute('email')\n            user_id = client.get_user_id_by_mail(email)\n\n            if not user_id:\n                error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                iam_user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                            error_code=error_code,\n                                            skip=True,\n                                            skip_reason=error_message)\n            else:\n                res = client.disable_user(user_id)\n                iam_user_profile.set_result(success=True,\n                                            iden=user_id,\n                                            email=email,\n                                            action=IAMActions.DISABLE_USER,\n                                            details=res,\n                                            active=False)\n\n        return iam_user_profile\n    except Exception as e:\n        error_code, error_message = github_handle_error(e)\n        iam_user_profile.set_result(success=False,\n                                    error_code=error_code,\n                                    error_message=error_message,\n                                    action=IAMActions.DISABLE_USER\n                                    )\n        return iam_user_profile\n\n\ndef get_mapping_fields_command():\n    scheme = [\n        \"userName\",\n        \"externalId\",\n        \"title\",\n        \"userType\",\n        \"name\",\n        \"emails\",\n        \"phoneNumbers\",\n        \"urn:scim:schemas:extension:enterprise:1.0\"\n    ]\n    incident_type_scheme = SchemeTypeMapping(type_name=IAMUserProfile.DEFAULT_INCIDENT_TYPE)\n\n    for field in scheme:\n        incident_type_scheme.add_field(field, \"Field\")\n\n    return GetMappingFieldsResponse([incident_type_scheme])\n\n\ndef main():\n\n    params = demisto.params()\n    args = demisto.args()\n\n    base_url = params.get('url')\n    # checks for '/' at the end url, if it is not available add it\n    if base_url[-1] != '/':\n        base_url += '/'\n    token = params.get('token')\n    org = params.get('org')\n\n    mapper_in = params.get('mapper_in', DEFAULT_INCOMING_MAPPER)\n    mapper_out = params.get('mapper_out', DEFAULT_OUTGOING_MAPPER)\n    is_create_enabled = params.get(\"create-user-enabled\")\n    is_disable_enabled = params.get(\"disable-user-enabled\")\n    is_update_enabled = demisto.params().get(\"update-user-enabled\")\n    create_if_not_exists = demisto.params().get(\"create-if-not-exists\")\n\n    verify_certificate = not demisto.params().get('insecure', False)\n\n    headers = {\n        'accept': 'application/json',\n        'content-type': 'application/json',\n        'Authorization': f'Bearer {token}'\n    }\n\n    proxy = demisto.params().get('proxy', False)\n    command = demisto.command()\n\n    demisto.debug(f'Command being called is {command}')\n\n    try:\n        client = Client(\n            base_url=base_url,\n            org=org,\n            verify=verify_certificate,\n            proxy=proxy,\n            headers=headers,\n            ok_codes=(200, 201, 204)\n        )\n        if command == 'test-module':\n            return_results(test_module(client))\n\n        elif command == 'iam-get-user':\n            user_profile = get_user_command(client, args, mapper_in)\n            return_results(user_profile)\n\n        elif command == 'iam-create-user':\n            user_profile = create_user_command(client, args, mapper_out, is_create_enabled, is_update_enabled)\n            return_results(user_profile)\n\n        elif command == 'iam-update-user':\n            user_profile = update_user_command(client, args, mapper_out, is_update_enabled,\n                                               is_create_enabled, create_if_not_exists)\n            return_results(user_profile)\n\n        elif command == 'iam-disable-user':\n            user_profile = disable_user_command(client, args, mapper_out, is_disable_enabled)\n            return_results(user_profile)\n\n        elif command == 'get-mapping-fields':\n            return_results(get_mapping_fields_command())\n\n    except Exception as e:\n        # For any other integration command exception, return an error\n        return_error(f'Failed to execute {command} command. Exception: {e}. Traceback: {traceback.format_exc()}')\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\n\nclass IAMErrors(object):\n    \"\"\"\n    An enum class to manually handle errors in IAM integrations\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    BAD_REQUEST = 400, 'Bad request - failed to perform operation'\n    USER_DOES_NOT_EXIST = 404, 'User does not exist'\n    USER_ALREADY_EXISTS = 409, 'User already exists'\n\n\nclass IAMActions(object):\n    \"\"\"\n    Enum: contains all the IAM actions (e.g. get, update, create, etc.)\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    GET_USER = 'get'\n    UPDATE_USER = 'update'\n    CREATE_USER = 'create'\n    DISABLE_USER = 'disable'\n    ENABLE_USER = 'enable'\n\n\nclass IAMVendorActionResult:\n    \"\"\" This class is used in IAMUserProfile class to represent actions data.\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    def __init__(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                 error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        self._brand = demisto.callingContext.get('context', {}).get('IntegrationBrand')\n        self._instance_name = demisto.callingContext.get('context', {}).get('IntegrationInstance')\n        self._success = success\n        self._active = active\n        self._iden = iden\n        self._username = username\n        self._email = email\n        self._error_code = error_code\n        self._error_message = error_message\n        self._details = details\n        self._skip = skip\n        self._skip_reason = skip_reason\n        self._action = action\n        self._return_error = return_error\n\n    def should_return_error(self):\n        return self._return_error\n\n    def create_outputs(self):\n        \"\"\" Sets the outputs in `_outputs` attribute.\n        \"\"\"\n        outputs = {\n            'brand': self._brand,\n            'instanceName': self._instance_name,\n            'action': self._action,\n            'success': self._success,\n            'active': self._active,\n            'id': self._iden,\n            'username': self._username,\n            'email': self._email,\n            'errorCode': self._error_code,\n            'errorMessage': self._error_message,\n            'details': self._details,\n            'skipped': self._skip,\n            'reason': self._skip_reason\n        }\n        return outputs\n\n    def create_readable_outputs(self, outputs):\n        \"\"\" Sets the human readable output in `_readable_output` attribute.\n\n        :param outputs: (dict) the command outputs.\n        \"\"\"\n        title = self._action.title() + ' User Results ({})'.format(self._brand)\n\n        if not self._skip:\n            headers = [\"brand\", \"instanceName\", \"success\", \"active\", \"id\", \"username\",\n                       \"email\", \"errorCode\", \"errorMessage\", \"details\"]\n        else:\n            headers = [\"brand\", \"instanceName\", \"skipped\", \"reason\"]\n\n        readable_output = tableToMarkdown(\n            name=title,\n            t=outputs,\n            headers=headers,\n            removeNull=True\n        )\n\n        return readable_output\n\n\nclass IAMUserProfile:\n    \"\"\" A User Profile object class for IAM integrations.\n\n    :type _user_profile: ``str``\n    :param _user_profile: The user profile information.\n\n    :type _user_profile_delta: ``str``\n    :param _user_profile_delta: The user profile delta.\n\n    :type _vendor_action_results: ``list``\n    :param _vendor_action_results: A List of data returned from the vendor.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    DEFAULT_INCIDENT_TYPE = 'User Profile'\n    CREATE_INCIDENT_TYPE = 'User Profile - Create'\n    UPDATE_INCIDENT_TYPE = 'User Profile - Update'\n\n    def __init__(self, user_profile, user_profile_delta=None):\n        self._user_profile = safe_load_json(user_profile)\n        self._user_profile_delta = safe_load_json(user_profile_delta) if user_profile_delta else {}\n        self._vendor_action_results = []\n\n    def get_attribute(self, item, use_old_user_data=False):\n        if use_old_user_data and self._user_profile.get('olduserdata', {}).get(item):\n            return self._user_profile.get('olduserdata', {}).get(item)\n        return self._user_profile.get(item)\n\n    def to_entry(self):\n        \"\"\" Generates a XSOAR IAM entry from the data in _vendor_action_results.\n        Note: Currently we are using only the first element of the list, in the future we will support multiple results.\n\n        :return: A XSOAR entry.\n        :rtype: ``dict``\n        \"\"\"\n\n        outputs = self._vendor_action_results[0].create_outputs()\n        readable_output = self._vendor_action_results[0].create_readable_outputs(outputs)\n\n        entry_context = {\n            'IAM.UserProfile(val.email \u0026\u0026 val.email == obj.email)': self._user_profile,\n            'IAM.Vendor(val.instanceName \u0026\u0026 val.instanceName == obj.instanceName \u0026\u0026 '\n            'val.email \u0026\u0026 val.email == obj.email)': outputs\n        }\n\n        return_entry = {\n            'ContentsFormat': EntryFormat.JSON,\n            'Contents': outputs,\n            'EntryContext': entry_context\n        }\n\n        if self._vendor_action_results[0].should_return_error():\n            return_entry['Type'] = EntryType.ERROR\n        else:\n            return_entry['Type'] = EntryType.NOTE\n            return_entry['HumanReadable'] = readable_output\n\n        return return_entry\n\n    def return_outputs(self):\n        return_results(self.to_entry())\n\n    def set_result(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                   error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        if not email:\n            email = self.get_attribute('email')\n\n        vendor_action_result = IAMVendorActionResult(\n            success=success,\n            active=active,\n            iden=iden,\n            username=username,\n            email=email,\n            error_code=error_code,\n            error_message=error_message if error_message else '',\n            details=details,\n            skip=skip,\n            skip_reason=skip_reason if skip_reason else '',\n            action=action,\n            return_error=return_error\n        )\n\n        self._vendor_action_results.append(vendor_action_result)\n\n    def map_object(self, mapper_name, incident_type):\n        \"\"\" Returns the user data, in an application data format.\n\n        :type mapper_name: ``str``\n        :param mapper_name: The outgoing mapper from XSOAR to the application.\n\n        :type incident_type: ``str``\n        :param incident_type: The incident type used.\n\n        :return: the user data, in the app data format.\n        :rtype: ``dict``\n        \"\"\"\n        if incident_type not in [IAMUserProfile.CREATE_INCIDENT_TYPE, IAMUserProfile.UPDATE_INCIDENT_TYPE]:\n            raise DemistoException('You must provide a valid incident type to the map_object function.')\n        if not self._user_profile:\n            raise DemistoException('You must provide the user profile data.')\n        app_data = demisto.mapObject(self._user_profile, mapper_name, incident_type)\n        return app_data\n\n    def update_with_app_data(self, app_data, mapper_name, incident_type=None):\n        \"\"\" updates the user_profile attribute according to the given app_data\n\n        :type app_data: ``dict``\n        :param app_data: The user data in app\n\n        :type mapper_name: ``str``\n        :param mapper_name: Incoming mapper name\n\n        :type incident_type: ``str``\n        :param incident_type: Optional - incident type\n        \"\"\"\n        if not incident_type:\n            incident_type = IAMUserProfile.DEFAULT_INCIDENT_TYPE\n        if not isinstance(app_data, dict):\n            app_data = safe_load_json(app_data)\n        self._user_profile = demisto.mapObject(app_data, mapper_name, incident_type)\n\n\nclass IAMUserAppData:\n    \"\"\" Holds user attributes retrieved from an application.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, user_id, username, is_active, app_data):\n        self.id = user_id\n        self.username = username\n        self.is_active = is_active\n        self.full_data = app_data\n\n\nclass IAMCommand:\n    \"\"\" A class that implements the IAM CRUD commands - should be used.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, is_create_enabled=True, is_enable_enabled=True, is_disable_enabled=True, is_update_enabled=True,\n                 create_if_not_exists=True, mapper_in=None, mapper_out=None, attr='email'):\n        \"\"\" The IAMCommand c'tor\n\n        :param is_create_enabled: (bool) Whether or not to allow creating users in the application.\n        :param is_enable_enabled: (bool) Whether or not to allow enabling users in the application.\n        :param is_disable_enabled: (bool) Whether or not to allow disabling users in the application.\n        :param is_update_enabled: (bool) Whether or not to allow updating users in the application.\n        :param create_if_not_exists: (bool) Whether or not to create a user if does not exist in the application.\n        :param mapper_in: (str) Incoming mapper from the application to Cortex XSOAR\n        :param mapper_out: (str) Outgoing mapper from the Cortex XSOAR to the application\n        \"\"\"\n        self.is_create_enabled = is_create_enabled\n        self.is_enable_enabled = is_enable_enabled\n        self.is_disable_enabled = is_disable_enabled\n        self.is_update_enabled = is_update_enabled\n        self.create_if_not_exists = create_if_not_exists\n        self.mapper_in = mapper_in\n        self.mapper_out = mapper_out\n        self.attr = attr\n\n    def get_user(self, client, args):\n        \"\"\" Searches a user in the application and updates the user profile object with the data.\n            If not found, the error details will be resulted instead.\n        :param client: (Client) The integration Client object that implements a get_user() method\n        :param args: (dict) The `iam-get-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        try:\n            identifier = user_profile.get_attribute(self.attr)\n            user_app_data = client.get_user(identifier)\n            if not user_app_data:\n                error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                user_profile.set_result(action=IAMActions.GET_USER,\n                                        success=False,\n                                        error_code=error_code,\n                                        error_message=error_message)\n            else:\n                user_profile.update_with_app_data(user_app_data.full_data, self.mapper_in)\n                user_profile.set_result(\n                    action=IAMActions.GET_USER,\n                    active=user_app_data.is_active,\n                    iden=user_app_data.id,\n                    email=user_profile.get_attribute('email'),\n                    username=user_app_data.username,\n                    details=user_app_data.full_data\n                )\n\n        except Exception as e:\n            client.handle_exception(user_profile, e, IAMActions.GET_USER)\n\n        return user_profile\n\n    def disable_user(self, client, args):\n        \"\"\" Disables a user in the application and updates the user profile object with the updated data.\n            If not found, the command will be skipped.\n\n        :param client: (Client) The integration Client object that implements get_user() and disable_user() methods\n        :param args: (dict) The `iam-disable-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        if not self.is_disable_enabled:\n            user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if not user_app_data:\n                    _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                    user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                            skip=True,\n                                            skip_reason=error_message)\n                else:\n                    if user_app_data.is_active:\n                        user_app_data = client.disable_user(user_app_data.id)\n                    user_profile.set_result(\n                        action=IAMActions.DISABLE_USER,\n                        active=False,\n                        iden=user_app_data.id,\n                        email=user_profile.get_attribute('email'),\n                        username=user_app_data.username,\n                        details=user_app_data.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.DISABLE_USER)\n\n        return user_profile\n\n    def create_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If a user in the app already holds the email in the given user profile, updates\n            its data with the given data.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-create-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n\n        if not self.is_create_enabled:\n            user_profile.set_result(action=IAMActions.CREATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    # if user exists, update it\n                    user_profile = self.update_user(client, args)\n\n                else:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.CREATE_INCIDENT_TYPE)\n                    created_user = client.create_user(app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.CREATE_USER,\n                        active=created_user.is_active,\n                        iden=created_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=created_user.username,\n                        details=created_user.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.CREATE_USER)\n\n        return user_profile\n\n    def update_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If the user is disabled and `allow-enable` argument is `true`, also enables the user.\n            If the user does not exist in the app and the `create-if-not-exist` parameter is checked, creates the user.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-update-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        allow_enable = args.get('allow-enable') == 'true'\n        if not self.is_update_enabled:\n            user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr, use_old_user_data=True)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.UPDATE_INCIDENT_TYPE)\n\n                    if allow_enable and self.is_enable_enabled and not user_app_data.is_active:\n                        client.enable_user(user_app_data.id)\n\n                    updated_user = client.update_user(user_app_data.id, app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.UPDATE_USER,\n                        active=updated_user.is_active,\n                        iden=updated_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=updated_user.username,\n                        details=updated_user.full_data\n                    )\n                else:\n                    if self.create_if_not_exists:\n                        user_profile = self.create_user(client, args)\n                    else:\n                        _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                        user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                                skip=True,\n                                                skip_reason=error_message)\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.UPDATE_USER)\n\n        return user_profile\n\n\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.3.7","modified":"2021-09-05T10:49:33.528539+03:00","name":"GitHub IAM","packID":"GitHub","packPropagationLabels":["all"],"prevName":"GitHub IAM","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"https://gitlab.com/api/v4","display":"Server URL (e.g. https://gitlab.com/api/v4)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"api_key","options":null,"required":true,"type":4},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"An integration with GitLab.","detailedDescription":"### Community Contributed Integration\n #### Integration Author: Ayman Mahmoud\n No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).\n***\n## Gitlab\nFrom project planning and source code management to CI/CD and monitoring, GitLab is a complete DevOps platform, delivered as a single application.\n\n### Generate an API Access Key\n1. Login to your Gitlab service account, go to **Account Settings**.\n2. Click the **Access Tokens** tab to get access to the integration tokens\n3. Generate a Token with selected Scopes and Permissions as needed.\n4. Copy and paste the key.\n\n### URL\nThe Base URL of Gitlab API v4.0: https://gitlab.com/api/v4\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/git-lab)","display":"GitLab (Community Contribution)","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"GitLab","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"Limits the results to projects stored on repository_storage. Available for administrators only.","name":"repository_storage","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits the results to projects with last_activity before a specified time.","name":"last_activity_before","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the minimal access level of the current user.","name":"min_access_level","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Returns only limited fields for each project. This is a no operation without authentication as only simple fields are returned.","name":"simple","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Returns the projects sorted in ascending or descending order.","name":"sort","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the projects that the current user is a member of.","name":"membership","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Includes the ancestor namespaces when matching search criteria.","name":"search_namespaces","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by archived status.","name":"archived","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Returns a list of projects that match the search criteria.","name":"search","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits the results to projects with IDs that are less than the specified ID.","name":"id_before","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits the results to projects with last_activity after a specified time.","name":"last_activity_after","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the projects starred by the current user.","name":"starred","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits the results to projects with IDs greater than the specified ID.","name":"id_after","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the projects explicitly owned by the current user.","name":"owned","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Returns the projects ordered by id, name, path, created_at, updated_at, or last_activity_at fields. Repository_size, storage_size, and wiki_size fields are only allowed for administrators. The default is created_at.","name":"order_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Includes the project statistics.","name":"statistics","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by visibility; public, internal, or private.","name":"visibility","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Includes the custom attributes in the response (administrators only).","name":"with_custom_attributes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the enabled issues feature.","name":"with_issues_enabled","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the enabled merge requests feature.","name":"with_merge_requests_enabled","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Limits by the projects that use the given programming language.","name":"with_programming_language","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets a list of all visible projects across GitLab for the authenticated user. When accessed without authentication, only public projects with simple fields are returned.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-get-projects","outputs":[{"contentPath":"","contextPath":"GitLab.Projects.web_url","description":"Project Web URL.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Projects.name","description":"Project Name.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Projects.path","description":"Project Path.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Projects.created_at","description":"Project Created At.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Projects.visibility","description":"Project Visiblity.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Projects.id","description":"Project ID.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets a list of the access requests viewable by the authenticated user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-get-access-requests","outputs":[{"contentPath":"","contextPath":"GitLab.AccessRequests.id","description":"Access Request ID.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.username","description":"Access Request User.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.requested_at","description":"Access Request Create Time.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.state","description":"Access Request State.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Requests the authenticated user access to a group or project.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-request-access","outputs":[{"contentPath":"","contextPath":"GitLab.AccessRequests.id","description":"Access Request ID.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.username","description":"Access Request User.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.requested_at","description":"Access Request Create Time.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.state","description":"Access Request State.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project owned by the authenticated user.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The user ID of the access requester.","name":"user_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A valid access level (defaults: 30, developer access level).","name":"access_level","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Approves an access request for the given user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-approve-access","outputs":[{"contentPath":"","contextPath":"GitLab.AccessRequests.id","description":"Access Request ID.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.username","description":"Access Request User.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.requested_at","description":"Access Request Create Time.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.state","description":"Access Request State.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The user ID of the access requester.","name":"user_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Denies an access request for the given user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-deny-access","outputs":[{"contentPath":"","contextPath":"GitLab.AccessRequests.id","description":"Access Request ID.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.AccessRequests.state","description":"Access Request State.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Returns a list of branches containing the search string. You can use ^term and term$ to find branches that begin and end with term, respectively.","name":"search","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets a list of repository branches from a project, sorted by name alphabetically.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-get-repository-branches","outputs":[{"contentPath":"","contextPath":"GitLab.Branches.name","description":"Branch Name.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Branches.web_url","description":"Branch Web URL.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Branches.commit.id","description":"Branch Head Commit ID.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the branch.","name":"branch","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Branch name, or commit SHA to create a branch from.","name":"ref","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a new branch in the repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-create-repository-branch","outputs":[{"contentPath":"","contextPath":"GitLab.Branches.name","description":"Branch Name.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Branches.web_url","description":"Branch Web URL.","type":"Unknown"},{"contentPath":"","contextPath":"GitLab.Branches.commit.id","description":"Branch Head Commit ID.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the branch.","name":"branch","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Deletes a branch from the repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-delete-repository-branch","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ID or URL encoded path of the project that is owned by the authenticated user.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Deletes all branches that are merged into the project’s default branch.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-projects-delete-repository-merged-branches","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Retrieves the version information for the GitLab instance, and responds 200 OK for authenticated users.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-get-version","outputs":[{"contentPath":"","contextPath":"GitLab.version","description":"GitLab Verion","type":"String"},{"contentPath":"","contextPath":"GitLab.revision","description":"GitLab Revision","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Project ID from which to retrieve pipeline schedules.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"ID of the specific pipeline schedule from which to retrieve its details.","name":"pipeline_schedule_id","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the details of the pipeline schedules.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-pipelines-schedules-list","outputs":[{"contentPath":"","contextPath":"GitLab.PipelineSchedule.id","description":"Pipeline schedule ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.description","description":"Pipeline schedule description.","type":"String"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.ref","description":"Pipeline schedule reference.","type":"String"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.next_run_at","description":"Pipeline schedule next run scheduled time.","type":"Date"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.active","description":"Whether pipeline schedule is active.","type":"Boolean"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.created_at","description":"When pipeline schedule was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.updated_at","description":"When the pipeline schedule was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.last_pipeline.id","description":"ID of the last pipeline that was run by the scheduled pipeline. Relevant only when the pipeline schedule ID is given.","type":"Number"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.last_pipeline.sha","description":"SHA of the last pipeline that was run by the scheduled pipeline. Relevant only when the pipeline schedule ID is given.","type":"String"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.last_pipeline.ref","description":"Reference of the last pipeline that was run by the scheduled pipeline. Relevant only when the pipeline schedule ID is given.","type":"String"},{"contentPath":"","contextPath":"GitLab.PipelineSchedule.last_pipeline.status","description":"Status of the last pipeline that was run by the scheduled pipeline. Relevant only when the pipeline schedule ID is given.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Project ID from which to retrieve pipelines.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"ID of specific pipeline from which to retrieve its details.","name":"pipeline_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Reference name of the pipelines, e.g., 'master'.","name":"ref","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Retrieves pipelines of which status matches the given status.","name":"status","predefined":["created","waiting_for_resource","preparing","pending","running","success","failed","canceled","skipped","manual","scheduled"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the details of the pipelines.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-pipelines-list","outputs":[{"contentPath":"","contextPath":"GitLab.Pipeline.id","description":"Pipeline ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Pipeline.project_id","description":"Project ID that the pipeline belongs to.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Pipeline.status","description":"Status of the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.ref","description":"Reference of the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.sha","description":"SHA of the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.created_at","description":"Time when the pipeline was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Pipeline.updated_at","description":"Time when the pipeline was last updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Pipeline.started_at","description":"Time when the pipeline was started.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Pipeline.finished_at","description":"Time when the pipeline was finished.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Pipeline.duration","description":"Duration of the pipeline in seconds.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Pipeline.web_url","description":"Web URL of the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.user.name","description":"Name of the user who triggered the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.user.username","description":"Username that triggered the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.user.id","description":"ID of the user who triggered the pipeline.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Pipeline.user.state","description":"State of the user who triggered the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.user.avatar_url","description":"Avatar URL of the user who trigerred the pipeline.","type":"String"},{"contentPath":"","contextPath":"GitLab.Pipeline.user.web_url","description":"Web URL of the user who triggered the pipeline.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Project ID from which to retrieve jobs details.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"ID of the pipeline from which to retrieve its jobs.","name":"pipeline_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets job details.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-jobs-list","outputs":[{"contentPath":"","contextPath":"GitLab.Job.status","description":"The status of the job.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.created_at","description":"Time the job was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Job.started_at","description":"Time the job was started.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Job.finished_at","description":"Time the job was finished.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Job.duration","description":"Duration of the job in seconds.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Job.id","description":"ID of the job.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Job.name","description":"Name of the job.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.pipeline.id","description":"Pipeline the job belongs to.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Job.pipeline.project_id","description":"Project ID the job belongs to.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Job.pipeline.ref","description":"Reference of the pipeline the job belongs to.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.pipeline.sha","description":"SHA of the pipeline the job belongs to.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.pipeline.status","description":"Status of the pipeline the job belongs to.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.ref","description":"Reference name of the job.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.stage","description":"Stage of the job.","type":"String"},{"contentPath":"","contextPath":"GitLab.Job.web_url","description":"Web URL of the job.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Project ID from which to retrieve an artifact.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"ID of a specific job from which to retrieve its artifact.","name":"job_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Suffix to the path of an artifact from which to retrieve its data.","name":"artifact_path_suffix","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets an artifact from a given artifact path, corresponding to a given job ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-artifact-get","outputs":[{"contentPath":"","contextPath":"GitLab.Artifact.job_id","description":"Job ID from which the artifact was taken.","type":"String"},{"contentPath":"","contextPath":"GitLab.Artifact.artifact_path_suffix","description":"Suffix of the given artifact path.","type":"String"},{"contentPath":"","contextPath":"GitLab.Artifact.artifact_data","description":"Data of the artifact requested.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"master","deprecated":false,"description":"The target branch of the Merge Request.","name":"target_branch","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"opened","deprecated":false,"description":"The state of the Merge Request.","name":"state","predefined":["opened","closed","locked","merged"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Project ID from which to retrieve the Merge Requests.","name":"project_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"List all merge requests","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-merge-requests-list","outputs":[{"contentPath":"","contextPath":"GitLab.MergeRequest.id","description":"The merge request ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.MergeRequest.iid","description":"The merge request IID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.MergeRequest.project_id","description":"The project ID of the merge request.","type":"Number"},{"contentPath":"","contextPath":"GitLab.MergeRequest.title","description":"The merge request title.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.description","description":"The merge request description","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.state","description":"The merge request state.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.created_at","description":"The time the merge request was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.updated_at","description":"The time the merge request was updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.merged_at","description":"The time the merge request was merged.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.closed_by","description":"The user who closed the merge request.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.closed_at","description":"The time the merge request was closed.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.target_branch","description":"The merge request target branch.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.source_branch","description":"The merge request source branch.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.assignee","description":"The merge request assignee.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.sha","description":"The merge request commit SHA.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.merge_commit_sha","description":"The merge request merge commit SHA.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.squash_commit_sha","description":"The merge request squash commit SHA.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Project ID from which to retrieve the Merge Requests.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Merge Request IID.","name":"merge_request_iid","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a Merge Request","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-merge-request-get","outputs":[{"contentPath":"","contextPath":"GitLab.MergeRequest.id","description":"The merge request ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.MergeRequest.iid","description":"The merge request IID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.MergeRequest.project_id","description":"The project ID of the merge request.","type":"Number"},{"contentPath":"","contextPath":"GitLab.MergeRequest.title","description":"The merge request title.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.description","description":"The merge request description","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.state","description":"The merge request state.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.created_at","description":"The time the merge request was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.updated_at","description":"The time the merge request was updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.merged_at","description":"The time the merge request was merged.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.closed_by","description":"The user who closed the merge request.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.closed_at","description":"The time the merge request was closed.","type":"Date"},{"contentPath":"","contextPath":"GitLab.MergeRequest.target_branch","description":"The merge request target branch.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.source_branch","description":"The merge request source branch.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.assignee","description":"The merge request assignee.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.sha","description":"The merge request commit SHA.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.merge_commit_sha","description":"The merge request merge commit SHA.","type":"String"},{"contentPath":"","contextPath":"GitLab.MergeRequest.squash_commit_sha","description":"The merge request squash commit SHA.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Comma seperated values of labels to search issues by.","name":"labels","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"title,description","deprecated":false,"description":"On what scope to perform the search on.","name":"scope","predefined":["title","description","title,description"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The search clause.","name":"search","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"all","deprecated":false,"description":"The state of the issue.","name":"state","predefined":["opened","closed","all"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Project ID from which to retrieve the Merge Requests.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"filter by assignee username","name":"assignee_username","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List all issues","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-issues-list","outputs":[{"contentPath":"","contextPath":"GitLab.Issue.id","description":"The issue ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.iid","description":"The issue IID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.project_id","description":"The project ID of the issue.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.title","description":"The issue title.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.description","description":"The issue description.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.state","description":"The issue state.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.created_at","description":"The time the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.updated_at","description":"The time the issue was updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.closed_at","description":"The time the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.closed_by","description":"The user who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.labels","description":"Comma seperated values of the issue's labels.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.merge_requests_count","description":"merge requests count","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.has_tasks","description":"Whether the issue has tasks or not.","type":"Boolean"},{"contentPath":"","contextPath":"GitLab.Issue.task_status","description":"The status of the issue's tasks.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Comma separated values of labels to add to the issue.","name":"labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The issue title.","name":"title","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The issue description.","name":"description","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Project ID of the created issue.","name":"project_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create an issue","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-issue-create","outputs":[{"contentPath":"","contextPath":"GitLab.Issue.id","description":"The issue ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.iid","description":"The issue IID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.project_id","description":"The project ID of the issue.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.title","description":"The issue title.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.description","description":"The issue description.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.state","description":"The issue state.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.created_at","description":"The time the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.updated_at","description":"The time the issue was updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.closed_at","description":"The time the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.closed_by","description":"The user who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.labels","description":"Comma seperated values of the issue's labels.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.merge_requests_count","description":"merge requests count","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.has_tasks","description":"Whether the issue has tasks or not.","type":"Boolean"},{"contentPath":"","contextPath":"GitLab.Issue.task_status","description":"The status of the issue's tasks.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The labels to add to the issue.","name":"add_labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The labels to remove from the issue.","name":"remove_labels","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The description of the issue.","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Project ID from which to retrieve the issue.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Issue ID.","name":"issue_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Edit an issue","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-issue-edit","outputs":[{"contentPath":"","contextPath":"GitLab.Issue.id","description":"The issue ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.iid","description":"The issue IID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.project_id","description":"The project ID of the issue.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.title","description":"The issue title.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.description","description":"The issue description.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.state","description":"The issue state.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.created_at","description":"The time the issue was created.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.updated_at","description":"The time the issue was updated.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.closed_at","description":"The time the issue was closed.","type":"Date"},{"contentPath":"","contextPath":"GitLab.Issue.closed_by","description":"The user who closed the issue.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.labels","description":"Comma seperated values of the issue's labels.","type":"String"},{"contentPath":"","contextPath":"GitLab.Issue.merge_requests_count","description":"Merge requests count","type":"Number"},{"contentPath":"","contextPath":"GitLab.Issue.has_tasks","description":"Whether the issue has tasks or not.","type":"Boolean"},{"contentPath":"","contextPath":"GitLab.Issue.task_status","description":"The status of the issue's tasks.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Group ID from which to retrieve the projects.","name":"group_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get the list of projects of a given group.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-group-projects-list","outputs":[{"contentPath":"","contextPath":"GitLab.Project.id","description":"The project ID.","type":"Number"},{"contentPath":"","contextPath":"GitLab.Project.name","description":"The project name.","type":"String"},{"contentPath":"","contextPath":"GitLab.Project.path_with_namespace","description":"The project path with namespace.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Project ID to get the file from.","name":"project_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The file path.","name":"file_path","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The branch to retrieve the file from.","name":"ref","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get raw file","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"gitlab-raw-file-get","outputs":[{"contentPath":"","contextPath":"GitLab.File.ref","description":"The branch the file's content was taken from.","type":"String"},{"contentPath":"","contextPath":"GitLab.File.path","description":"The file path.","type":"String"},{"contentPath":"","contextPath":"GitLab.File.content","description":"The file content.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.24019","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\nimport urllib3\n\n\nJOB_FIELDS_TO_EXTRACT = {'created_at', 'started_at', 'finished_at', 'duration', 'id', 'name', 'pipeline', 'ref',\n                         'stage', 'web_url', 'status'}\nPIPELINE_SCHEDULE_FIELDS_TO_EXTRACT = {'id', 'description', 'ref', 'next_run_at', 'active', 'created_at', 'updated_at',\n                                       'last_pipeline'}\nPIPELINE_FIELDS_TO_EXTRACT = {'id', 'project_id', 'status', 'ref', 'sha', 'created_at', 'updated_at', 'started_at',\n                              'finished_at', 'duration', 'web_url', 'user'}\n\n\nclass Client(BaseClient):\n    def __init__(self, server_url, verify, proxy, headers):\n        super().__init__(base_url=server_url, verify=verify, proxy=proxy, headers=headers)\n\n    def get_projects_request(self, repository_storage, last_activity_before, min_access_level, simple, sort,\n                             membership, search_namespaces, archived, search, id_before, last_activity_after, starred,\n                             id_after, owned, order_by, statistics, visibility, with_custom_attributes,\n                             with_issues_enabled, with_merge_requests_enabled, with_programming_language):\n        params = assign_params(repository_storage=repository_storage, last_activity_before=last_activity_before,\n                               min_access_level=min_access_level, simple=simple, sort=sort, membership=membership,\n                               search_namespaces=search_namespaces, archived=archived, search=search,\n                               id_before=id_before, last_activity_after=last_activity_after,\n                               starred=starred, id_after=id_after, owned=owned, order_by=order_by,\n                               statistics=statistics, visibility=visibility,\n                               with_custom_attributes=with_custom_attributes, with_issues_enabled=with_issues_enabled,\n                               with_merge_requests_enabled=with_merge_requests_enabled,\n                               with_programming_language=with_programming_language)\n        headers = self._headers\n        response = self._http_request('get', 'projects', params=params, headers=headers)\n        return response\n\n    def projects_get_access_requests_request(self, id_):\n        headers = self._headers\n        response = self._http_request('get', f'projects/{id_}/access_requests', headers=headers)\n        return response\n\n    def projects_request_access_request(self, id_):\n        headers = self._headers\n        response = self._http_request('post', f'projects/{id_}/access_requests', headers=headers)\n        return response\n\n    def projects_approve_access_request(self, id_, user_id, access_level):\n        params = assign_params(access_level=access_level)\n        headers = self._headers\n        response = self._http_request('put', f'projects/{id_}/access_requests/{user_id}/approve', params=params,\n                                      headers=headers)\n        return response\n\n    def projects_deny_access_request(self, id_, user_id):\n        headers = self._headers\n        self._http_request('delete', f'projects/{id_}/access_requests/{user_id}', headers=headers, resp_type='text')\n        response = {\n            'id': user_id,\n            'state': 'denied'\n        }\n        return response\n\n    def projects_get_repository_branches_request(self, id_, search):\n        params = assign_params(search=search)\n        headers = self._headers\n        response = self._http_request('get', f'projects/{id_}/repository/branches', params=params, headers=headers)\n        return response\n\n    def projects_create_repository_branch_request(self, id_, branch, ref):\n        params = assign_params(branch=branch, ref=ref)\n        headers = self._headers\n        response = self._http_request('post', f'projects/{id_}/repository/branches', params=params, headers=headers)\n        return response\n\n    def projects_delete_repository_branch_request(self, id_, branch):\n        headers = self._headers\n        self._http_request('delete', f'projects/{id_}/repository/branches/{branch}', headers=headers, resp_type='text')\n        response = {\n            'message': f'Branch \\'{branch}\\' is deleted.',\n        }\n        return response\n\n    def projects_delete_repository_merged_branches_request(self, id_):\n        headers = self._headers\n        response = self._http_request('delete', f'projects/{id_}/repository/merged_branches', headers=headers)\n        return response\n\n    def get_version_request(self):\n        headers = self._headers\n        response = self._http_request('get', 'version', headers=headers)\n        return response\n\n    def get_pipeline_schedules_request(self, project_id: str, pipeline_schedule_id: Optional[str]):\n        headers = self._headers\n        base_suffix = f'projects/{project_id}/pipeline_schedules'\n        final_suffix = f'{base_suffix}/{pipeline_schedule_id}' if pipeline_schedule_id else base_suffix\n        response = self._http_request('get', final_suffix, headers=headers)\n        return response\n\n    def get_pipeline_request(self, project_id: str, pipeline_id: Optional[str], ref: Optional[str],\n                             status: Optional[str]):\n        headers = self._headers\n        base_suffix = f'projects/{project_id}/pipelines'\n        final_suffix = f'{base_suffix}/{pipeline_id}' if pipeline_id else base_suffix\n        response = self._http_request('get', final_suffix, headers=headers,\n                                      params=assign_params(ref=ref, status=status))\n        return response\n\n    def get_pipeline_job_request(self, project_id: str, pipeline_id: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/pipelines/{pipeline_id}/jobs'\n        response = self._http_request('get', suffix, headers=headers)\n        return response\n\n    def get_job_artifact_request(self, project_id: str, job_id: str, artifact_path_suffix: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/jobs/{job_id}/artifacts/{artifact_path_suffix}'\n        response = self._http_request('get', suffix, headers=headers, resp_type='text')\n        return response\n\n    def get_merge_requests_list_request(self, project_id: str, state: str, target_branch: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/merge_requests'\n        params = assign_params(\n            state=state,\n            target_branch=target_branch,\n            per_page=100\n        )\n        response = self._http_request('get', suffix, headers=headers, params=params)\n        return response\n\n    def get_merge_request_request(self, project_id: str, merge_request_iid: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/merge_requests/{merge_request_iid}'\n        response = self._http_request('get', suffix, headers=headers)\n        return response\n\n    def get_issues_list_request(self, project_id: str, labels: str, state: str, search: str, scope: str,\n                                assignee_username: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/issues'\n        params = assign_params(\n            assignee_username=assignee_username,\n            state=state,\n            labels=labels,\n            search=search,\n            per_page=100\n        )\n        params['in'] = scope\n        response = self._http_request('get', suffix, headers=headers, params=params)\n        return response\n\n    def create_issue_request(self, project_id: str, labels: str, title: str, description: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/issues'\n        params = assign_params(\n            labels=labels,\n            title=title,\n            description=description\n        )\n        response = self._http_request('post', suffix, headers=headers, params=params)\n        return response\n\n    def edit_issue_request(self, project_id: str, issue_id: str, add_labels: str, description: str, remove_labels: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/issues/{issue_id}'\n        params = assign_params(\n            description=description,\n            add_labels=add_labels,\n            remove_labels=remove_labels\n        )\n        response = self._http_request('put', suffix, headers=headers, params=params)\n        return response\n\n    def group_projects_list_request(self, group_id: str):\n        headers = self._headers\n        suffix = f'groups/{group_id}/projects'\n        params = {'per_page': 100}\n        response = self._http_request('get', suffix, headers=headers, params=params)\n        return response\n\n    def get_raw_file_request(self, project_id: str, file_path: str, ref: str):\n        headers = self._headers\n        suffix = f'projects/{project_id}/repository/files/{file_path}/raw'\n        params = {'ref': ref}\n        response = self._http_request('get', suffix, headers=headers, params=params, resp_type='text')\n        response = response.strip(\"'\").strip('\"')\n        return response\n\n\ndef get_projects_command(client, args):\n    repository_storage = str(args.get('repository_storage', ''))\n    last_activity_before = str(args.get('last_activity_before', ''))\n    min_access_level = str(args.get('min_access_level', ''))\n    simple = argToBoolean(args.get('simple', False))\n    sort = str(args.get('sort', ''))\n    membership = argToBoolean(args.get('membership', False))\n    search_namespaces = argToBoolean(args.get('search_namespaces', False))\n    archived = argToBoolean(args.get('archived', False))\n    search = str(args.get('search', ''))\n    id_before = str(args.get('id_before', ''))\n    last_activity_after = str(args.get('last_activity_after', ''))\n    starred = argToBoolean(args.get('starred', False))\n    id_after = str(args.get('id_after', ''))\n    owned = argToBoolean(args.get('owned', False))\n    order_by = str(args.get('order_by', ''))\n    statistics = argToBoolean(args.get('statistics', False))\n    visibility = str(args.get('visibility', ''))\n    with_custom_attributes = argToBoolean(args.get('with_custom_attributes', False))\n    with_issues_enabled = argToBoolean(args.get('with_issues_enabled', False))\n    with_merge_requests_enabled = argToBoolean(args.get('with_merge_requests_enabled', False))\n    with_programming_language = str(args.get('with_programming_language', ''))\n\n    response = client.get_projects_request(repository_storage, last_activity_before, min_access_level, simple, sort,\n                                           membership, search_namespaces, archived, search, id_before,\n                                           last_activity_after, starred, id_after, owned, order_by, statistics,\n                                           visibility, with_custom_attributes, with_issues_enabled,\n                                           with_merge_requests_enabled, with_programming_language)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.Projects',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef projects_get_access_requests_command(client, args):\n    id_ = args.get('id', None)\n    response = client.projects_get_access_requests_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.AccessRequests',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n    return command_results\n\n\ndef projects_request_access_command(client, args):\n    id_ = args.get('id', None)\n    response = client.projects_request_access_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.AccessRequests',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n    return command_results\n\n\ndef projects_approve_access_command(client, args):\n    id_ = args.get('id', None)\n    user_id = args.get('user_id', None)\n    access_level = args.get('access_level', None)\n    response = client.projects_approve_access_request(id_, user_id, access_level)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.AccessRequests',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n    return command_results\n\n\ndef projects_deny_access_command(client, args):\n    id_ = args.get('id', None)\n    user_id = args.get('user_id', None)\n    response = client.projects_deny_access_request(id_, user_id)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.AccessRequests',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n    return command_results\n\n\ndef projects_get_repository_branches_command(client, args):\n    id_ = args.get('id', None)\n    search = str(args.get('search', ''))\n\n    response = client.projects_get_repository_branches_request(id_, search)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.Branches',\n        outputs_key_field='web_url',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef projects_create_repository_branch_command(client, args):\n    id_ = args.get('id', None)\n    branch = str(args.get('branch', ''))\n    ref = str(args.get('ref', ''))\n\n    response = client.projects_create_repository_branch_request(id_, branch, ref)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.Branches',\n        outputs_key_field='web_url',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef projects_delete_repository_branch_command(client, args):\n    id_ = args.get('id', None)\n    branch = str(args.get('branch', ''))\n\n    response = client.projects_delete_repository_branch_request(id_, branch)\n    command_results = CommandResults(\n        outputs_prefix='GitLab.Branches',\n        outputs_key_field='web_url',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef projects_delete_repository_merged_branches_command(client, args):\n    id_ = args.get('id', None)\n\n    response = client.projects_delete_repository_merged_branches_request(id_)\n    command_results = CommandResults(\n        outputs_prefix='GitLab',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_version_command(client, args):\n    response = client.get_version_request()\n    command_results = CommandResults(\n        outputs_prefix='GitLab',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef gitlab_pipelines_schedules_list_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns pipeline schedules corresponding to given arguments.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve pipeline schedules from.\n            - 'pipeline_schedule_id': ID of specific pipeline schedule to retrieve its details.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    pipeline_schedule_id = args.get('pipeline_schedule_id')\n    response = client.get_pipeline_schedules_request(project_id, pipeline_schedule_id)\n    response = response if isinstance(response, list) else [response]\n    outputs = [{k: v for k, v in output.items() if k in PIPELINE_SCHEDULE_FIELDS_TO_EXTRACT} for output in response]\n\n    return CommandResults(\n        outputs_prefix='GitLab.PipelineSchedule',\n        outputs_key_field='id',\n        outputs=outputs,\n        raw_response=response,\n        readable_output=tableToMarkdown('GitLab Pipeline Schedules', outputs, removeNull=True)\n    )\n\n\ndef gitlab_pipelines_list_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns pipelines corresponding to given arguments.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve pipeline schedules from.\n            - 'pipeline_id': ID of specific pipeline to retrieve its details.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    pipeline_id = args.get('pipeline_id')\n    ref = args.get('ref')\n    status = args.get('status')\n    response = client.get_pipeline_request(project_id, pipeline_id, ref, status)\n    response = response if isinstance(response, list) else [response]\n    outputs = [{k: v for k, v in output.items() if k in PIPELINE_FIELDS_TO_EXTRACT} for output in response]\n\n    return CommandResults(\n        outputs_prefix='GitLab.Pipeline',\n        outputs_key_field='id',\n        outputs=outputs,\n        raw_response=response,\n        readable_output=tableToMarkdown('GitLab Pipelines', outputs, removeNull=True)\n    )\n\n\ndef gitlab_jobs_list_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns pipeline jobs corresponding to given arguments.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve pipeline schedules from.\n            - 'pipeline_id': ID of specific pipeline to retrieve its jobs.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    pipeline_id = args.get('pipeline_id', '')\n    response = client.get_pipeline_job_request(project_id, pipeline_id)\n    response = response if isinstance(response, list) else [response]\n    outputs = [{k: v for k, v in output.items() if k in JOB_FIELDS_TO_EXTRACT} for output in response]\n\n    return CommandResults(\n        outputs_prefix='GitLab.Job',\n        outputs_key_field='id',\n        outputs=outputs,\n        raw_response=response,\n        readable_output=tableToMarkdown('GitLab Jobs', outputs, removeNull=True)\n    )\n\n\ndef gitlab_artifact_get_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns artifact corresponding to given artifact path suffix of the given job ID.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve pipeline schedules from.\n            - 'job_id': ID of specific job to retrieve artifact from.\n            - 'artifact_path_suffix': Suffix to artifact in the artifacts directory of the job.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    job_id = args.get('job_id', '')\n    artifact_path_suffix = args.get('artifact_path_suffix', '')\n    response = client.get_job_artifact_request(project_id, job_id, artifact_path_suffix)\n    outputs = {\n        'job_id': job_id,\n        'artifact_path_suffix': artifact_path_suffix,\n        'artifact_data': response\n    }\n    if len(response) \u003c= 100:\n        human_readable = tableToMarkdown(f'Artifact {artifact_path_suffix} From Job {job_id}', outputs, removeNull=True)\n    else:\n        human_readable = f'## Data for artifact {artifact_path_suffix} From Job {job_id} Has Been Retrieved.'\n\n    return CommandResults(\n        outputs_prefix='GitLab.Artifact',\n        outputs_key_field=['job_id', 'artifact_path_suffix'],\n        readable_output=human_readable,\n        outputs=outputs,\n        raw_response=response\n    )\n\n\ndef gitlab_merge_requests_list_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns a list of merge requests.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve merge requests from.\n            - 'state': The state of the merge request.\n            - 'target_branch': The target branch of the merge request.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    state = args.get('state', '')\n    target_branch = args.get('target_branch', '')\n    response = client.get_merge_requests_list_request(project_id, state, target_branch)\n    human_readable = tableToMarkdown(f'Merge Request Lists to branch {target_branch} in state {state}', response)\n    return CommandResults(\n        outputs_prefix='GitLab.MergeRequest',\n        outputs_key_field=['iid', 'project_id'],\n        readable_output=human_readable,\n        outputs=response,\n        raw_response=response\n    )\n\n\ndef gitlab_get_merge_request_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns a merge request.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve merge requests from.\n            - 'merge_request_iid': The merge request IID.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    merge_request_iid = args.get('merge_request_iid', '')\n    response = client.get_merge_request_request(project_id, merge_request_iid)\n    human_readable = tableToMarkdown(f'Merge Request {merge_request_iid}', response)\n    return CommandResults(\n        outputs_prefix='GitLab.MergeRequest',\n        outputs_key_field=['iid', 'project_id'],\n        readable_output=human_readable,\n        outputs=response,\n        raw_response=response\n    )\n\n\ndef gitlab_issues_list_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns a list of issues.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve issues from.\n            - 'state': The state of the issue.\n            - 'labels': Retrieve only issues with the given labels.\n            - 'assignee_username': Retrieve issues by assignee username.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    labels = args.get('labels', '')\n    state = args.get('state', '')\n    assignee_username = args.get('assignee_username', '')\n    search = args.get('search', '')\n    scope = args.get('scope', '')\n    response = client.get_issues_list_request(project_id, labels, state, search, scope, assignee_username)\n    human_readable = tableToMarkdown('Issues Lists', response)\n    return CommandResults(\n        outputs_prefix='GitLab.Issue',\n        outputs_key_field=['iid', 'project_id'],\n        readable_output=human_readable,\n        outputs=response,\n        raw_response=response\n    )\n\n\ndef gitlab_create_issue_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Creates an issue.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve issues from.\n            - 'state': The state of the issue.\n            - 'labels': Retrieve only issues with the given labels.\n            - 'assignee_username': Retrieve issues by assignee username.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    labels = args.get('labels', '')\n    title = args.get('title', '')\n    description = args.get('description', '')\n    response = client.create_issue_request(project_id, labels, title, description)\n    human_readable = tableToMarkdown('Create Issue', response)\n    return CommandResults(\n        outputs_prefix='GitLab.Issue',\n        outputs_key_field=['iid', 'project_id'],\n        readable_output=human_readable,\n        outputs=response,\n        raw_response=response\n    )\n\n\ndef gitlab_edit_issue_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns a list of merge requests.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to retrieve the issue from.\n            - 'issue_id' (Required): The issue ID.\n            - 'add_labels': The labels to add to the issue.\n            - 'remove_labels': The labels to remove from the issue.\n            - 'description': The description of the issue.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    issue_id = args.get('issue_id', '')\n    add_labels = args.get('add_labels', '')\n    remove_labels = args.get('remove_labels', '')\n    description = args.get('description', '')\n    response = client.edit_issue_request(project_id, issue_id, add_labels, description, remove_labels)\n    human_readable = tableToMarkdown(f'Edit Issue {issue_id}', response)\n    return CommandResults(\n        outputs_prefix='GitLab.Issue',\n        outputs_key_field=['iid', 'project_id'],\n        readable_output=human_readable,\n        outputs=response,\n        raw_response=response\n    )\n\n\ndef gitlab_group_projects_list_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns a list of projects within a group.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'group_id' (Required): group ID to retrieve the projects from.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    group_id = args.get('group_id', '')\n    response = client.group_projects_list_request(group_id)\n    human_readable = tableToMarkdown('List Group Projects', response)\n    return CommandResults(\n        outputs_prefix='GitLab.Project',\n        outputs_key_field=['path_with_namespace', 'id'],\n        readable_output=human_readable,\n        outputs=response,\n        raw_response=response\n    )\n\n\ndef gitlab_get_raw_file_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"\n    Returns the content of a given file.\n    Args:\n        client (Client): Client to perform calls to GitLab services.\n        args (Dict[str, Any]): XSOAR arguments:\n            - 'project_id' (Required): Project ID to get the file from.\n            - 'file_path' (Required): The file path.\n            - 'ref' (Required): The branch to retrieve the file from.\n\n    Returns:\n        (CommandResults).\n    \"\"\"\n    project_id = args.get('project_id', '')\n    ref = args.get('ref', '')\n    file_path = args.get('file_path', '')\n    response = client.get_raw_file_request(project_id, file_path, ref)\n    outputs = {'path': file_path, 'content': response, 'ref': ref}\n    human_readable = tableToMarkdown(f'Raw file {file_path} on branch {ref}', outputs)\n    return CommandResults(\n        outputs_prefix='GitLab.File',\n        outputs_key_field=['path', 'ref'],\n        readable_output=human_readable,\n        outputs=outputs,\n        raw_response=response\n    )\n\n\ndef test_module(client):\n    # Test functions here\n    response = client.get_version_request()\n    if response.get('version'):\n        demisto.results('ok')\n    else:\n        demisto.results('Test Failed:' + response)\n\n\ndef main():\n    params = demisto.params()\n    args = demisto.args()\n    url = params.get('url')\n    verify_certificate = not params.get('insecure', False)\n    proxy = params.get('proxy', False)\n    headers = {}\n    headers['PRIVATE-TOKEN'] = f'{params[\"api_key\"]}'\n\n    command = demisto.command()\n    LOG(f'Command being called is {command}')\n\n    try:\n        urllib3.disable_warnings()\n        client = Client(urljoin(url, \"\"), verify_certificate, proxy, headers=headers)\n        commands = {\n            'gitlab-get-projects': get_projects_command,\n            'gitlab-projects-get-access-requests': projects_get_access_requests_command,\n            'gitlab-projects-request-access': projects_request_access_command,\n            'gitlab-projects-approve-access': projects_approve_access_command,\n            'gitlab-projects-deny-access': projects_deny_access_command,\n            'gitlab-projects-get-repository-branches': projects_get_repository_branches_command,\n            'gitlab-projects-create-repository-branch': projects_create_repository_branch_command,\n            'gitlab-projects-delete-repository-branch': projects_delete_repository_branch_command,\n            'gitlab-projects-delete-repository-merged-branches': projects_delete_repository_merged_branches_command,\n            'gitlab-get-version': get_version_command,\n            'gitlab-pipelines-schedules-list': gitlab_pipelines_schedules_list_command,\n            'gitlab-pipelines-list': gitlab_pipelines_list_command,\n            'gitlab-jobs-list': gitlab_jobs_list_command,\n            'gitlab-artifact-get': gitlab_artifact_get_command,\n            'gitlab-merge-requests-list': gitlab_merge_requests_list_command,\n            'gitlab-merge-request-get': gitlab_get_merge_request_command,\n            'gitlab-issues-list': gitlab_issues_list_command,\n            'gitlab-issue-create': gitlab_create_issue_command,\n            'gitlab-issue-edit': gitlab_edit_issue_command,\n            'gitlab-group-projects-list': gitlab_group_projects_list_command,\n            'gitlab-raw-file-get': gitlab_get_raw_file_command\n        }\n\n        if command == 'test-module':\n            test_module(client)\n        else:\n            return_results(commands[command](client, args))\n\n    except Exception as e:\n        return_error(str(e))\n\n\nif __name__ in ['__main__', 'builtin', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.2","modified":"2021-09-05T10:49:33.528045+03:00","name":"GitLab","packID":"DevSecOps","packPropagationLabels":["all"],"prevName":"GitLab","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Authentication","commitMessage":"","configuration":[{"defaultValue":"","display":"Service Account Private Key file contents (JSON)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"serviceAccountJsonFile","options":null,"required":true,"type":14},{"defaultValue":"","display":"Email of user with admin capabilities","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AdminUserEmail","options":null,"required":true,"type":0},{"defaultValue":"","display":"Immutable Google Apps Id","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"immutableGoogleAppsId","options":null,"required":false,"type":0},{"defaultValue":"","display":"Import emails as incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"","display":"Events query (e.g. \"from:Demisto\")","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"FetchQuery","options":null,"required":false,"type":0},{"defaultValue":"","display":"Events user key (e.g. example@demisto.com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"FetchQueryUser","options":null,"required":false,"type":0},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13}],"definitionId":"","description":"Google apps Admin API, or GSuite","detailedDescription":"This API enables the usage of Google Admin API. In order to enable it, you will need to create an account service private key **json** file and copy its content.\nFollow the steps here to create such a private key and authorize the API for usage: [https://developers.google.com/admin-sdk/directory/v1/guides/delegation](https://developers.google.com/admin-sdk/directory/v1/guides/delegation)\nIt is necessary to authrize the next API's for that service account:\n[https://www.googleapis.com/auth/admin.directory.user.readonly](https://www.googleapis.com/auth/admin.directory.user.readonly)\n\nIn order to fetch user roles, please authrize this api too: [https://www.googleapis.com/auth/admin.directory.rolemanagement.readonly](https://www.googleapis.com/auth/admin.directory.rolemanagement.readonly)\n\nIn order to revoke user roles, please authrize this api too: [https://www.googleapis.com/auth/admin.directory.rolemanagement](https://www.googleapis.com/auth/admin.directory.rolemanagement)\n\nIn order to search user mailboxes, please authrize this api too: [https://www.googleapis.com/auth/gmail.readonly](https://www.googleapis.com/auth/gmail.readonly)\n\nIn order to to fetch user security tokens, please authrize this api too: [https://www.googleapis.com/auth/admin.directory.user.security](https://www.googleapis.com/auth/admin.directory.user.security)\n\nIn order to to fetch mobile info, please authrize this api too: [https://www.googleapis.com/auth/admin.directory.device.mobile.readonly](https://www.googleapis.com/auth/admin.directory.device.mobile.readonly)\n\nIn order to to preform actions on mobile devices, please authrize this api too: [https://www.googleapis.com/auth/admin.directory.device.mobile.action](https://www.googleapis.com/auth/admin.directory.device.mobile.action)\n\nIn order to to preform actions on chorme devices, please authrize this api too: [https://www.googleapis.com/auth/admin.directory.device.chromeos](https://www.googleapis.com/auth/admin.directory.device.chromeos)\n\nFor the email user param, please choose a user with admin permissions and make sure that you follow the steps to perform Google Apps Domain-Wide Delegation of Authority.\n\nIn order to revoke/fetch user role, you will need the Immutable Google Apps ID param.\nTo get an Immutable Google Apps ID (or customerId):\n1. Go to [https://admin.google.com](https://admin.google.com)\n2. Security -\u003e Set up single sign-on (SSO)\n\nYou will see there URLs in the format:\n[https://accounts.google.com/o/saml2/idp?idpid=Cxxxxxxxx](https://accounts.google.com/o/saml2/idp?idpid=Cxxxxxxxx)\n\nCxxxxxxxx is your Immutable Google Apps ID (customerId).","display":"GoogleApps API","fromServerVersion":"","hidden":false,"icon":"google-api.png","id":"google","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.557886+03:00","name":"google","packID":"","prevName":"google","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"https://soar.monstersofhack.com","display":"Server URL (e.g. https://soar.monstersofhack.com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"10","display":"Maximum number of incidents per fetch","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"max_fetch","options":null,"required":false,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apikey","options":null,"required":true,"type":4},{"defaultValue":"65","display":"Score threshold for IP reputation command","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Set this to determine the HelloWorld score that will determine if an IP is malicious (0-100)","name":"threshold_ip","options":null,"required":false,"type":0},{"defaultValue":"65","display":"Score threshold for domain reputation command","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Set this to determine the HelloWorld score that will determine if a domain is malicious (0-100)","name":"threshold_domain","options":null,"required":false,"type":0},{"defaultValue":"ACTIVE","display":"Fetch alerts with status (ACTIVE, CLOSED)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"alert_status","options":["ACTIVE","CLOSED"],"required":false,"type":15},{"defaultValue":"","display":"Fetch alerts with type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Comma-separated list of types of alerts to fetch. Types might change over time. Some examples are 'Bug' and 'Vulnerability'","name":"alert_type","options":null,"required":false,"type":0},{"defaultValue":"Low","display":"Minimum severity of alerts to fetch","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"min_severity","options":["Low","Medium","High","Critical"],"required":true,"type":15},{"defaultValue":"3 days","display":"First fetch time","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"first_fetch","options":null,"required":false,"type":0},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19}],"defaultClassifier":"HelloWorld","defaultMapperIn":"HelloWorld-mapper","definitionId":"","description":"This is the Hello World integration for getting started.","detailedDescription":"### Community Contributed Integration\n #### Integration Author: Cortex XSOAR\n No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).\n***\n## Hello World\n- This section explains how to configure the instance of HelloWorld in Cortex XSOAR.\n- You can use the following API Key: `43ea9b2d-4998-43a6-ae91-aba62a26868c`\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/hello-world)","display":"HelloWorld (Community Contribution)","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"HelloWorld","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The name of whom you want to say hello to.","name":"name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Hello command - prints hello to anyone.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-say-hello","outputs":[{"contentPath":"","contextPath":"hello","description":"Should be Hello **something** here.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Filter by alert severity. Comma-separated value (Low,Medium,High,Critical)","name":"severity","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Filter by alert status.","name":"status","predefined":["ACTIVE","CLOSED"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Filter by alert type","name":"alert_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Maximum results to return.","name":"max_results","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Filter by start time. \nExamples:\n  \"3 days ago\"\n  \"1 month\"\n  \"2019-10-10T12:22:00\"\n  \"2019-10-10\"","name":"start_time","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search HelloWorld Alerts.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-search-alerts","outputs":[{"contentPath":"","contextPath":"HelloWorld.Alert.alert_id","description":"Alert ID.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.alert_status","description":"Alert status. Can be 'ACTIVE' or 'CLOSED'.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.alert_type","description":"Alert type. For example 'Bug' or 'Vulnerability'.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.created","description":"Alert created time. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.Alert.name","description":"Alert name.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.severity","description":"Alert severity. Can be 'Low', 'Medium', 'High' or 'Critical'.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Alert ID.","name":"alert_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve alert extra data by ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-get-alert","outputs":[{"contentPath":"","contextPath":"HelloWorld.Alert.alert_id","description":"Alert ID.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.created","description":"Alert created time. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.Alert.description","description":"Alert description.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.device_id","description":"ID of the device involved in the alert.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.device_ip","description":"IP Address of the device involved in the alert.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.location","description":"Location of the device involved in the alert.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.user","description":"User involved in the alert.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Alert ID to update.","name":"alert_id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"New status of the alert.","name":"status","predefined":["ACTIVE","CLOSED"],"required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Update the status for an alert.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-update-alert-status","outputs":[{"contentPath":"","contextPath":"HelloWorld.Alert.alert_id","description":"Alert ID.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Alert.updated","description":"Alert update time. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.Alert.alert_status","description":"Alert status. Can be 'ACTIVE' or 'CLOSED'.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"List of IPs.","isArray":true,"name":"ip","required":false,"secret":false},{"default":false,"defaultValue":"65","deprecated":false,"description":"If the IP has reputation above the threshold then the IP defined as malicious. If threshold not set, then threshold from instance configuration is used.","name":"threshold","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Return IP information and reputation","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ip","outputs":[{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.asn","description":"The autonomous system name for the IP address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.asn_cidr","description":"The ASN CIDR.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.asn_country_code","description":"The ASN country code.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.asn_date","description":"The date on which the ASN was assigned.","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.IP.asn_description","description":"The ASN description.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.asn_registry","description":"The registry the ASN belongs to.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.entities","description":"Entities associated to the IP.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.ip","description":"The actual IP address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.cidr","description":"Network CIDR for the IP address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.country","description":"The country of the IP address.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.IP.network.end_address","description":"The last IP address of the CIDR.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.events.action","description":"The action that happened on the event.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.events.actor","description":"The actor that performed the action on the event.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.IP.network.events.timestamp","description":"The timestamp when the event occurred.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.handle","description":"The handle of the network.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.ip_version","description":"The IP address version.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.links","description":"Links associated to the IP address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.name","description":"The name of the network.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.notices.description","description":"The description of the notice.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.notices.links","description":"Links associated with the notice.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.IP.network.notices.title","description":"Title of the notice.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.parent_handle","description":"Handle of the parent network.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.raw","description":"Additional raw data for the network.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.IP.network.remarks","description":"Additional remarks for the network.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.IP.network.start_address","description":"The first IP address of the CIDR.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.status","description":"Status of the network.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.network.type","description":"The type of the network.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.query","description":"IP address that was queried.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.IP.raw","description":"Additional raw data for the IP address.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.IP.score","description":"Reputation score from HelloWorld for this IP (0 to 100, where higher is worse).","type":"Number"},{"contentPath":"","contextPath":"IP.Address","description":"IP address.","type":"String"},{"contentPath":"","contextPath":"IP.Malicious.Vendor","description":"The vendor reporting the IP address as malicious.","type":"String"},{"contentPath":"","contextPath":"IP.Malicious.Description","description":"A description explaining why the IP address was reported as malicious.","type":"String"},{"contentPath":"","contextPath":"IP.ASN","description":"The autonomous system name for the IP address.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"List of Domains.","isArray":true,"name":"domain","required":false,"secret":false},{"default":false,"defaultValue":"65","deprecated":false,"description":"If the domain has reputation above the threshold then the domain defined as malicious. If threshold not set, then threshold from instance configuration is used.","name":"threshold","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns Domain information and reputation.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"domain","outputs":[{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"Domain.Name","description":"The domain name.","type":"String"},{"contentPath":"","contextPath":"Domain.Malicious.Vendor","description":"The vendor reporting the domain as malicious.","type":"String"},{"contentPath":"","contextPath":"Domain.Malicious.Description","description":"A description explaining why the domain was reported as malicious.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.Name","description":"The name of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.Country","description":"The country of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Organization","description":"The organization of the domain.","type":"String"},{"contentPath":"","contextPath":"Domain.CreationDate","description":"The creation date of the domain. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"Domain.ExpirationDate","description":"The expiration date of the domain. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"Domain.UpdatedDate","description":"The date when the domain was last updated. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"Domain.NameServers","description":"Name servers of the domain.","type":"String"},{"contentPath":"","contextPath":"Domain.WHOIS.NameServers","description":"A CSV string of name servers, for example 'ns1.bla.com, ns2.bla.com'.","type":"String"},{"contentPath":"","contextPath":"Domain.WHOIS.CreationDate","description":"The creation date of the domain. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"Domain.WHOIS.UpdatedDate","description":"The date when the domain was last updated. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').","type":"Date"},{"contentPath":"","contextPath":"Domain.WHOIS.ExpirationDate","description":"The expiration date of the domain.","type":"Date"},{"contentPath":"","contextPath":"Domain.WHOIS.Registrar.Name","description":"The name of the registrar, for example 'GoDaddy'","type":"String"},{"contentPath":"","contextPath":"IP.ASN","description":"The autonomous system name for the IP address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.address","description":"Domain admin address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.city","description":"Domain admin city.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.country","description":"Domain admin country.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.creation_date","description":"Domain creation date. Format is ISO8601.","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.Domain.dnssec","description":"DNSSEC status.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.domain","description":"The domain name.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.domain_name","description":"Domain name options.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.emails","description":"Contact emails.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.expiration_date","description":"Expiration date. Format is ISO8601.","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.Domain.name","description":"Domain admin name.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.name_servers","description":"Name server.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.org","description":"Domain organization.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.referral_url","description":"Referral URL.","type":"Unknown"},{"contentPath":"","contextPath":"HelloWorld.Domain.registrar","description":"Domain registrar.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.score","description":"Reputation score from HelloWorld for this domain (0 to 100, where higher is worse).","type":"Number"},{"contentPath":"","contextPath":"HelloWorld.Domain.state","description":"Domain admin state.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.status","description":"Domain status.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.updated_date","description":"Updated date. Format is ISO8601.","type":"Date"},{"contentPath":"","contextPath":"HelloWorld.Domain.whois_server","description":"WHOIS server.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Domain.zipcode","description":"Domain admin zipcode.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Asset to start the scan against.","name":"hostname","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Start scan on an asset.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-scan-start","outputs":[{"contentPath":"","contextPath":"HelloWorld.Scan.scan_id","description":"Unique ID of the scan.","type":"string"},{"contentPath":"","contextPath":"HelloWorld.Scan.status","description":"Status of the scan ('RUNNING' or 'COMPLETE').","type":"string"},{"contentPath":"","contextPath":"HelloWorld.Scan.hostname","description":"The hostname the scan is run against.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"List of Scan IDs. helloworld-scan-start returns \"scan_id\".","isArray":true,"name":"scan_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve scan status for one or more scan IDs.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-scan-status","outputs":[{"contentPath":"","contextPath":"HelloWorld.Scan.scan_id","description":"Unique ID of the scan.","type":"string"},{"contentPath":"","contextPath":"HelloWorld.Scan.status","description":"Status of the scan ('RUNNING' or 'COMPLETE').","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":false,"defaultValue":"file","deprecated":false,"description":"Results format (file or JSON).","name":"format","predefined":["json","file"],"required":true,"secret":false},{"default":false,"deprecated":false,"description":"Unique ID of the scan.","name":"scan_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve scan status in Context or as a File (default) for a Scan.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-scan-results","outputs":[{"contentPath":"","contextPath":"HelloWorld.Scan.entities.entity-id","description":"Scanned entity ID.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Scan.entities.ip_address","description":"Scanned entity IP address.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Scan.entities.type","description":"Scanned entity type.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Scan.entities.vulnerability_status","description":"Scanned entity vulnerability status.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Scan.entities.vulns","description":"Scanned entity CVE.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Scan.scan_id","description":"Unique ID of the scan.","type":"String"},{"contentPath":"","contextPath":"HelloWorld.Scan.status","description":"Status of the scan ('RUNNING' or 'COMPLETE').","type":"String"},{"contentPath":"","contextPath":"InfoFile.EntryID","description":"The EntryID of the report file.","type":"Unknown"},{"contentPath":"","contextPath":"InfoFile.Extension","description":"The extension of the report file.","type":"string"},{"contentPath":"","contextPath":"InfoFile.Name","description":"The name of the report file.","type":"string"},{"contentPath":"","contextPath":"InfoFile.Info","description":"The info of the report file.","type":"string"},{"contentPath":"","contextPath":"InfoFile.Size","description":"The size of the report file.","type":"number"},{"contentPath":"","contextPath":"InfoFile.Type","description":"The type of the report file.","type":"string"},{"contentPath":"","contextPath":"CVE.ID","description":"The ID of the CVE.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.5.21272","feed":false,"isFetch":true,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\"\"\"HelloWorld Integration for Cortex XSOAR (aka Demisto)\n\nThis integration is a good example on you can build a Cortex XSOAR Integration\nusing Python 3. Please follow the documentation links below and make sure that\nyour integration follows the Code Conventions and passes the Linting phase.\n\nDeveloper Documentation: https://xsoar.pan.dev/docs/welcome\nCode Conventions: https://xsoar.pan.dev/docs/integrations/code-conventions\nLinting: https://xsoar.pan.dev/docs/integrations/linting\n\nWhen building a Cortex XSOAR integration that is reusable, a lot of effort\nmust be placed in the design. We recommend to fill a Design Document template,\nthat allows you to capture Use Cases, Requirements and Inputs/Outputs.\n\nExample Design document for the this Integration (HelloWorld):\nhttps://docs.google.com/document/d/1wETtBEKg37PHNU8tYeB56M1LE314ux086z3HFeF_cX0\n\n\nHelloWorld API\n--------------\n\nThe HelloWorld API is a simple API that shows a realistic use case for an XSOAR\nintegration. It's actually a real API that is available to the following URL:\nhttps://soar.mastersofhack.com - if you need an API Key to test it out please\nreach out to your Cortex XSOAR contacts.\n\nThis API has a few basic functions:\n- Alerts: the endpoint returns mocked alerts and allows you to search based on\na number of parameters, such as state (ACTIVE or CLOSED), type, timestamp. It\ncan also return a single alert by ID. This is used to create new Incidents in\nXSOAR by using the ``fetch-incidents`` command, which is by default invoked\nevery minute.\nThere is also an endpoint that allows to retrieve additional details about a\nspecific alert by ID, and one to change the alert status to \"CLOSED\" once\nit has been resolved.\n\n- Reputation (ip and domain): these endpoints return, for an IP and\ndomain respectively, a WHOIS lookup of the entity as well as a reputation score\n(from 0 to 100) that is used to determine whether the entity is malicious. This\nendpoint is called by XSOAR reputation commands ``ip`` and ``domain`` that\nare run automatically every time an indicator is extracted in XSOAR. As a best\npractice of design, it is important to map and document the mapping between\na score in the original API format (0 to 100 in this case) to a score in XSOAR\nformat (0 to 3). This score is called ``DBotScore``, and is returned in the\ncontext to allow automated handling of indicators based on their reputation.\nMore information: https://xsoar.pan.dev/docs/integrations/dbot\n\n\n- Scan: to demonstrate how to run commands that are not returning instant data,\nthe API provides a scan endpoint that simulates scanning a host and generating\na report after the scan is completed. The API has endpoints to start a scan,\nwhich returns a job ID, poll for the scan status and, if the scan is completed,\nretrieved the job results.\nThis function is used in conjunction of the HelloWorld Scan playbook that uses\nthe GenericPolling mechanism to implement the job polling loop. The results\ncan be returned in JSON or attachment file format.\nInfo on GenericPolling: https://xsoar.pan.dev/docs/playbooks/generic-polling\n\nPlease check the HelloWorld Design Document referenced above for details about\nthe raw API responsens as well as the design details for this integration.\n\nThis integration also has a ``say-hello`` command for backward compatibility,\nthat doesn't connect to an API and just returns a ``Hello {name}`` string,\nwhere name is the input value provided.\n\n\nIntegration File Structure\n--------------------------\n\nAn integration usually consists of the following parts:\n- Imports\n- Constants\n- Client Class\n- Helper Functions\n- Command Functions\n- Main Function\n- Entry Point\n\n\nImports\n-------\n\nHere you can import Python module you need for your integration. If you need\na module that is not part of the default XSOAR Docker images, you can add\na custom one. More details: https://xsoar.pan.dev/docs/integrations/docker\n\nThere are also internal imports that are used by XSOAR:\n- demistomock (imported as demisto): allows your code to work offline for\ntesting. The actual ``demisto`` module is provided at runtime when the\ncode runs in XSOAR.\n- CommonServerPython.py: contains a set of helper functions, base classes\nand other useful components that will make your integration code easier\nto maintain.\n- CommonServerUserPython.py: includes a set of user defined commands that\nare specific to an XSOAR installation. Do not use it for integrations that\nare meant to be shared externally.\n\nThese imports are automatically loaded at runtime within the XSOAR script\nrunner, so you shouldn't modify them\n\nConstants\n---------\n\nUsually some constants that do not require user parameters or inputs, such\nas the default API entry point for your service, or the maximum numbers of\nincidents to fetch every time.\n\n\nClient Class\n------------\n\nWe recommend to use a Client class to wrap all the code that needs to interact\nwith your API. Moreover, we recommend, when possible, to inherit from the\nBaseClient class, defined in CommonServerPython.py. This class already handles\na lot of the work, such as system proxy settings, SSL certificate verification\nand exception handling for HTTP errors.\n\nNote that the Client class should NOT contain any Cortex XSOAR specific code,\ni.e. it shouldn't use anything in the ``demisto`` class (functions such as\n``demisto.args()`` or ``demisto.results()`` or even ``return_results`` and\n``return_error``.\nYou will use the Command Functions to handle XSOAR inputs and outputs.\n\nWhen calling an API, you should use the ``_http.request()`` method and you\ncan return the raw data to the calling function (usually a Command function).\n\nYou should usually have one function for each API endpoint.\n\nLook at the code and the commends of this specific class to better understand\nthe implementation details.\n\n\nHelper Functions\n----------------\n\nHelper functions are usually used as utility functions that are used by several\ncommand functions throughout your code. For example they map arguments to types\nor convert severity formats from integration-specific to XSOAR.\nMany helper functions are already defined in ``CommonServerPython.py`` and are\noften very handy.\n\n\nCommand Functions\n-----------------\n\nCommand functions perform the mapping between XSOAR inputs and outputs to the\nClient class functions inputs and outputs. As a best practice, they shouldn't\ncontain calls to ``demisto.args()``, ``demisto.results()``, ``return_error``\nand ``demisto.command()`` as those should be handled through the ``main()``\nfunction.\nHowever, in command functions, use ``demisto`` or ``CommonServerPython.py``\nartifacts, such as ``demisto.debug()`` or the ``CommandResults`` class and the\n``Common.*`` classes.\nUsually you will have one command function for every specific XSOAR command\nyou want to implement in your integration, plus ``test-module``,\n``fetch-incidents`` and ``fetch-indicators``(if the latter two are supported\nby your integration). Each command function should invoke one specific function\nof the Client class.\n\nCommand functions, when invoked through an XSOAR command usually return data\nusing the ``CommandResults`` class, that is then passed to ``return_results()``\nin the ``main()`` function.\n``return_results()`` is defined in ``CommonServerPython.py`` to return\nthe data to XSOAR. ``return_results()`` actually wraps ``demisto.results()``.\nYou should never use ``demisto.results()`` directly.\n\nSometimes you will need to return values in a format that is not compatible\nwith ``CommandResults`` (for example files): in that case you must return a\ndata structure that is then pass passed to ``return.results()``. (i.e.\ncheck the ``scan_results_command`` function in this file that has the option\nto return a file to Cortex XSOAR).\n\nIn any case you should never call ``return_results()`` directly from the\ncommand functions.\n\nWhen you use create the CommandResults object in command functions, you\nusually pass some types of data:\n\n- Human Readable: usually in Markdown format. This is what is presented to the\nanalyst in the War Room. You can use ``tableToMarkdown()``, defined in\n``CommonServerPython.py``, to convert lists and dicts in Markdown and pass it\nto ``return_results()`` using the ``readable_output`` argument, or the\n``return_results()`` function will call ``tableToMarkdown()`` automatically for\nyou.\n\n- Context Output: this is the machine readable data, JSON based, that XSOAR can\nparse and manage in the Playbooks or Incident's War Room. The Context Output\nfields should be defined in your integration YML file and is important during\nthe design phase. Make sure you define the format and follow best practices.\nYou can use ``demisto-sdk json-to-outputs`` to autogenerate the YML file\noutputs section. Context output is passed as the ``outputs`` argument in ``demisto_results()``,\nand the prefix (i.e. ``HelloWorld.Alert``) is passed via the ``outputs_prefix``\nargument.\n\nMore information on Context Outputs, Standards, DBotScore and demisto-sdk:\nhttps://xsoar.pan.dev/docs/integrations/code-conventions#outputs\nhttps://xsoar.pan.dev/docs/integrations/context-and-outputs\nhttps://xsoar.pan.dev/docs/integrations/context-standards\nhttps://xsoar.pan.dev/docs/integrations/dbot\nhttps://github.com/demisto/demisto-sdk/blob/master/demisto_sdk/commands/json_to_outputs/README.md\n\nAlso, when you write data in the Context, you want to make sure that if you\nreturn updated information for an entity, to update it and not append to\nthe list of entities (i.e. in HelloWorld you want to update the status of an\nexisting ``HelloWorld.Alert`` in the context when you retrieve it, rather than\nadding a new one if you already retrieved it). To update data in the Context,\nyou can define which is the key attribute to use, such as (using the example):\n``outputs_key_field='alert_id'``. This means that you are using the ``alert_id``\nkey to determine whether adding a new entry in the context or updating an\nexisting one that has the same ID. You can look at the examples to understand\nhow it works.\nMore information here:\nhttps://xsoar.pan.dev/docs/integrations/context-and-outputs\nhttps://xsoar.pan.dev/docs/integrations/code-conventions#outputs\nhttps://xsoar.pan.dev/docs/integrations/dt\n\n- Raw Output: this is usually the raw result from your API and is used for\ntroubleshooting purposes or for invoking your command from Automation Scripts.\nIf not specified, ``return_results()`` will use the same data as ``outputs``.\n\n\nMain Function\n-------------\n\nThe ``main()`` function takes care of reading the integration parameters via\nthe ``demisto.params()`` function, initializes the Client class and checks the\ndifferent options provided to ``demisto.commands()``, to invoke the correct\ncommand function passing to it ``demisto.args()`` and returning the data to\n``return_results()``. If implemented, ``main()`` also invokes the function\n``fetch_incidents()``with the right parameters and passes the outputs to the\n``demisto.incidents()`` function. ``main()`` also catches exceptions and\nreturns an error message via ``return_error()``.\n\n\nEntry Point\n-----------\n\nThis is the integration code entry point. It checks whether the ``__name__``\nvariable is ``__main__`` , ``__builtin__`` (for Python 2) or ``builtins`` (for\nPython 3) and then calls the ``main()`` function. Just keep this convention.\n\n\"\"\"\n\n\n\n\nimport json\nimport urllib3\nimport dateparser\nimport traceback\nfrom typing import Any, Dict, Tuple, List, Optional, Union, cast\n\n# Disable insecure warnings\nurllib3.disable_warnings()\n\n\n''' CONSTANTS '''\n\n\nDATE_FORMAT = '%Y-%m-%dT%H:%M:%SZ'\nMAX_INCIDENTS_TO_FETCH = 50\nHELLOWORLD_SEVERITIES = ['Low', 'Medium', 'High', 'Critical']\n\n''' CLIENT CLASS '''\n\n\nclass Client(BaseClient):\n    \"\"\"Client class to interact with the service API\n\n    This Client implements API calls, and does not contain any Demisto logic.\n    Should only do requests and return data.\n    It inherits from BaseClient defined in CommonServer Python.\n    Most calls use _http_request() that handles proxy, SSL verification, etc.\n    For this HelloWorld implementation, no special attributes defined\n    \"\"\"\n\n    def get_ip_reputation(self, ip: str) -\u003e Dict[str, Any]:\n        \"\"\"Gets the IP reputation using the '/ip' API endpoint\n\n        :type ip: ``str``\n        :param ip: IP address to get the reputation for\n\n        :return: dict containing the IP reputation as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/ip',\n            params={\n                'ip': ip\n            }\n        )\n\n    def get_domain_reputation(self, domain: str) -\u003e Dict[str, Any]:\n        \"\"\"Gets the Domain reputation using the '/domain' API endpoint\n\n        :type domain: ``str``\n        :param domain: domain name to get the reputation for\n\n        :return: dict containing the domain reputation as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/domain',\n            params={\n                'domain': domain\n            }\n        )\n\n    def search_alerts(self, alert_status: Optional[str], severity: Optional[str],\n                      alert_type: Optional[str], max_results: Optional[int],\n                      start_time: Optional[int]) -\u003e List[Dict[str, Any]]:\n        \"\"\"Searches for HelloWorld alerts using the '/get_alerts' API endpoint\n\n        All the parameters are passed directly to the API as HTTP POST parameters in the request\n\n        :type alert_status: ``Optional[str]``\n        :param alert_status: status of the alert to search for. Options are: 'ACTIVE' or 'CLOSED'\n\n        :type severity: ``Optional[str]``\n        :param severity:\n            severity of the alert to search for. Comma-separated values.\n            Options are: \"Low\", \"Medium\", \"High\", \"Critical\"\n\n        :type alert_type: ``Optional[str]``\n        :param alert_type: type of alerts to search for. There is no list of predefined types\n\n        :type max_results: ``Optional[int]``\n        :param max_results: maximum number of results to return\n\n        :type start_time: ``Optional[int]``\n        :param start_time: start timestamp (epoch in seconds) for the alert search\n\n        :return: list containing the found HelloWorld alerts as dicts\n        :rtype: ``List[Dict[str, Any]]``\n        \"\"\"\n\n        request_params: Dict[str, Any] = {}\n\n        if alert_status:\n            request_params['alert_status'] = alert_status\n\n        if alert_type:\n            request_params['alert_type'] = alert_type\n\n        if severity:\n            request_params['severity'] = severity\n\n        if max_results:\n            request_params['max_results'] = max_results\n\n        if start_time:\n            request_params['start_time'] = start_time\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/get_alerts',\n            params=request_params\n        )\n\n    def get_alert(self, alert_id: str) -\u003e Dict[str, Any]:\n        \"\"\"Gets a specific HelloWorld alert by id\n\n        :type alert_id: ``str``\n        :param alert_id: id of the alert to return\n\n        :return: dict containing the alert as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/get_alert_details',\n            params={\n                'alert_id': alert_id\n            }\n        )\n\n    def update_alert_status(self, alert_id: str, alert_status: str) -\u003e Dict[str, Any]:\n        \"\"\"Changes the status of a specific HelloWorld alert\n\n        :type alert_id: ``str``\n        :param alert_id: id of the alert to return\n\n        :type alert_status: ``str``\n        :param alert_status: new alert status. Options are: 'ACTIVE' or 'CLOSED'\n\n        :return: dict containing the alert as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/change_alert_status',\n            params={\n                'alert_id': alert_id,\n                'alert_status': alert_status\n            }\n        )\n\n    def scan_start(self, hostname: str) -\u003e Dict[str, Any]:\n        \"\"\"Starts a HelloWorld scan on a specific hostname\n\n        :type hostname: ``str``\n        :param hostname: hostname of the machine to scan\n\n        :return: dict containing the scan status as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/start_scan',\n            params={\n                'hostname': hostname\n            }\n        )\n\n    def scan_status(self, scan_id: str) -\u003e Dict[str, Any]:\n        \"\"\"Gets the status of a HelloWorld scan\n\n        :type scan_id: ``str``\n        :param scan_id: ID of the scan to retrieve status for\n\n        :return: dict containing the scan status as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/check_scan',\n            params={\n                'scan_id': scan_id\n            }\n        )\n\n    def scan_results(self, scan_id: str) -\u003e Dict[str, Any]:\n        \"\"\"Gets the results of a HelloWorld scan\n\n        :type scan_id: ``str``\n        :param scan_id: ID of the scan to retrieve results for\n\n        :return: dict containing the scan results as returned from the API\n        :rtype: ``Dict[str, Any]``\n        \"\"\"\n\n        return self._http_request(\n            method='GET',\n            url_suffix='/get_scan_results',\n            params={\n                'scan_id': scan_id\n            }\n        )\n\n    def say_hello(self, name: str) -\u003e str:\n        \"\"\"Returns 'Hello {name}'\n\n        :type name: ``str``\n        :param name: name to append to the 'Hello' string\n\n        :return: string containing 'Hello {name}'\n        :rtype: ``str``\n        \"\"\"\n\n        return f'Hello {name}'\n\n\n''' HELPER FUNCTIONS '''\n\n\ndef parse_domain_date(domain_date: Union[List[str], str], date_format: str = '%Y-%m-%dT%H:%M:%S.000Z') -\u003e Optional[str]:\n    \"\"\"Converts whois date format to an ISO8601 string\n\n    Converts the HelloWorld domain WHOIS date (YYYY-mm-dd HH:MM:SS) format\n    in a datetime. If a list is returned with multiple elements, takes only\n    the first one.\n\n    :type domain_date: ``Union[List[str],str]``\n    :param date_format:\n        a string or list of strings with the format 'YYYY-mm-DD HH:MM:SS'\n\n    :return: Parsed time in ISO8601 format\n    :rtype: ``Optional[str]``\n    \"\"\"\n\n    if isinstance(domain_date, str):\n        # if str parse the value\n        domain_date_dt = dateparser.parse(domain_date)\n        if domain_date_dt:\n            return domain_date_dt.strftime(date_format)\n    elif isinstance(domain_date, list) and len(domain_date) \u003e 0 and isinstance(domain_date[0], str):\n        # if list with at least one element, parse the first element\n        domain_date_dt = dateparser.parse(domain_date[0])\n        if domain_date_dt:\n            return domain_date_dt.strftime(date_format)\n    # in any other case return nothing\n    return None\n\n\ndef convert_to_demisto_severity(severity: str) -\u003e int:\n    \"\"\"Maps HelloWorld severity to Cortex XSOAR severity\n\n    Converts the HelloWorld alert severity level ('Low', 'Medium',\n    'High', 'Critical') to Cortex XSOAR incident severity (1 to 4)\n    for mapping.\n\n    :type severity: ``str``\n    :param severity: severity as returned from the HelloWorld API (str)\n\n    :return: Cortex XSOAR Severity (1 to 4)\n    :rtype: ``int``\n    \"\"\"\n\n    # In this case the mapping is straightforward, but more complex mappings\n    # might be required in your integration, so a dedicated function is\n    # recommended. This mapping should also be documented.\n    return {\n        'Low': IncidentSeverity.LOW,\n        'Medium': IncidentSeverity.MEDIUM,\n        'High': IncidentSeverity.HIGH,\n        'Critical': IncidentSeverity.CRITICAL\n    }[severity]\n\n\n''' COMMAND FUNCTIONS '''\n\n\ndef test_module(client: Client, first_fetch_time: int) -\u003e str:\n    \"\"\"Tests API connectivity and authentication'\n\n    Returning 'ok' indicates that the integration works like it is supposed to.\n    Connection to the service is successful.\n    Raises exceptions if something goes wrong.\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type name: ``str``\n    :param name: name to append to the 'Hello' string\n\n    :return: 'ok' if test passed, anything else will fail the test.\n    :rtype: ``str``\n    \"\"\"\n\n    # INTEGRATION DEVELOPER TIP\n    # Client class should raise the exceptions, but if the test fails\n    # the exception text is printed to the Cortex XSOAR UI.\n    # If you have some specific errors you want to capture (i.e. auth failure)\n    # you should catch the exception here and return a string with a more\n    # readable output (for example return 'Authentication Error, API Key\n    # invalid').\n    # Cortex XSOAR will print everything you return different than 'ok' as\n    # an error\n    try:\n        client.search_alerts(max_results=1, start_time=first_fetch_time, alert_status=None, alert_type=None,\n                             severity=None)\n    except DemistoException as e:\n        if 'Forbidden' in str(e):\n            return 'Authorization Error: make sure API Key is correctly set'\n        else:\n            raise e\n    return 'ok'\n\n\ndef say_hello_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"helloworld-say-hello command: Returns Hello {somename}\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``str``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['name']`` is used as input name\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains the hello world message\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    # INTEGRATION DEVELOPER TIP\n    # In this case 'name' is an argument set in the HelloWorld.yml file as mandatory,\n    # so the null check here as XSOAR will always check it before your code is called.\n    # Although it's not mandatory to check, you are welcome to do so.\n\n    name = args.get('name', None)\n    if not name:\n        raise ValueError('name not specified')\n\n    # Call the Client function and get the raw response\n    result = client.say_hello(name)\n\n    # Create the human readable output.\n    # It will  be in markdown format - https://www.markdownguide.org/basic-syntax/\n    # More complex output can be formatted using ``tableToMarkDown()`` defined\n    # in ``CommonServerPython.py``\n    readable_output = f'## {result}'\n\n    # More information about Context:\n    # https://xsoar.pan.dev/docs/integrations/context-and-outputs\n    # We return a ``CommandResults`` object, and we want to pass a custom\n    # markdown here, so the argument ``readable_output`` is explicit. If not\n    # passed, ``CommandResults``` will do a ``tableToMarkdown()`` do the data\n    # to generate the readable output.\n    return CommandResults(\n        readable_output=readable_output,\n        outputs_prefix='hello',\n        outputs_key_field='',\n        outputs=result\n    )\n\n\ndef fetch_incidents(client: Client, max_results: int, last_run: Dict[str, int],\n                    first_fetch_time: Optional[int], alert_status: Optional[str],\n                    min_severity: str, alert_type: Optional[str]\n                    ) -\u003e Tuple[Dict[str, int], List[dict]]:\n    \"\"\"This function retrieves new alerts every interval (default is 1 minute).\n\n    This function has to implement the logic of making sure that incidents are\n    fetched only onces and no incidents are missed. By default it's invoked by\n    XSOAR every minute. It will use last_run to save the timestamp of the last\n    incident it processed. If last_run is not provided, it should use the\n    integration parameter first_fetch_time to determine when to start fetching\n    the first time.\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type max_results: ``int``\n    :param max_results: Maximum numbers of incidents per fetch\n\n    :type last_run: ``Optional[Dict[str, int]]``\n    :param last_run:\n        A dict with a key containing the latest incident created time we got\n        from last fetch\n\n    :type first_fetch_time: ``Optional[int]``\n    :param first_fetch_time:\n        If last_run is None (first time we are fetching), it contains\n        the timestamp in milliseconds on when to start fetching incidents\n\n    :type alert_status: ``Optional[str]``\n    :param alert_status:\n        status of the alert to search for. Options are: 'ACTIVE'\n        or 'CLOSED'\n\n    :type min_severity: ``str``\n    :param min_severity:\n        minimum severity of the alert to search for.\n        Options are: \"Low\", \"Medium\", \"High\", \"Critical\"\n\n    :type alert_type: ``Optional[str]``\n    :param alert_type:\n        type of alerts to search for. There is no list of predefined types\n\n    :return:\n        A tuple containing two elements:\n            next_run (``Dict[str, int]``): Contains the timestamp that will be\n                    used in ``last_run`` on the next fetch.\n            incidents (``List[dict]``): List of incidents that will be created in XSOAR\n\n    :rtype: ``Tuple[Dict[str, int], List[dict]]``\n    \"\"\"\n\n    # Get the last fetch time, if exists\n    # last_run is a dict with a single key, called last_fetch\n    last_fetch = last_run.get('last_fetch', None)\n    # Handle first fetch time\n    if last_fetch is None:\n        # if missing, use what provided via first_fetch_time\n        last_fetch = first_fetch_time\n    else:\n        # otherwise use the stored last fetch\n        last_fetch = int(last_fetch)\n\n    # for type checking, making sure that latest_created_time is int\n    latest_created_time = cast(int, last_fetch)\n\n    # Initialize an empty list of incidents to return\n    # Each incident is a dict with a string as a key\n    incidents: List[Dict[str, Any]] = []\n\n    # Get the CSV list of severities from min_severity\n    severity = ','.join(HELLOWORLD_SEVERITIES[HELLOWORLD_SEVERITIES.index(min_severity):])\n\n    alerts = client.search_alerts(\n        alert_type=alert_type,\n        alert_status=alert_status,\n        max_results=max_results,\n        start_time=last_fetch,\n        severity=severity\n    )\n\n    for alert in alerts:\n        # If no created_time set is as epoch (0). We use time in ms so we must\n        # convert it from the HelloWorld API response\n        incident_created_time = int(alert.get('created', '0'))\n        incident_created_time_ms = incident_created_time * 1000\n\n        # to prevent duplicates, we are only adding incidents with creation_time \u003e last fetched incident\n        if last_fetch:\n            if incident_created_time \u003c= last_fetch:\n                continue\n\n        # If no name is present it will throw an exception\n        incident_name = alert['name']\n\n        # INTEGRATION DEVELOPER TIP\n        # The incident dict is initialized with a few mandatory fields:\n        # name: the incident name\n        # occurred: the time on when the incident occurred, in ISO8601 format\n        # we use timestamp_to_datestring() from CommonServerPython.py to\n        # handle the conversion.\n        # rawJSON: everything else is packed in a string via json.dumps()\n        # and is included in rawJSON. It will be used later for classification\n        # and mapping inside XSOAR.\n        # severity: it's not mandatory, but is recommended. It must be\n        # converted to XSOAR specific severity (int 1 to 4)\n        # Note that there are other fields commented out here. You can do some\n        # mapping of fields (either out of the box fields, like \"details\" and\n        # \"type\") or custom fields (like \"helloworldid\") directly here in the\n        # code, or they can be handled in the classification and mapping phase.\n        # In either case customers can override them. We leave the values\n        # commented out here, but you can use them if you want.\n        incident = {\n            'name': incident_name,\n            # 'details': alert['name'],\n            'occurred': timestamp_to_datestring(incident_created_time_ms),\n            'rawJSON': json.dumps(alert),\n            # 'type': 'Hello World Alert',  # Map to a specific XSOAR incident Type\n            'severity': convert_to_demisto_severity(alert.get('severity', 'Low')),\n            # 'CustomFields': {  # Map specific XSOAR Custom Fields\n            #     'helloworldid': alert.get('alert_id'),\n            #     'helloworldstatus': alert.get('alert_status'),\n            #     'helloworldtype': alert.get('alert_type')\n            # }\n        }\n\n        incidents.append(incident)\n\n        # Update last run and add incident if the incident is newer than last fetch\n        if incident_created_time \u003e latest_created_time:\n            latest_created_time = incident_created_time\n\n    # Save the next_run as a dict with the last_fetch key to be stored\n    next_run = {'last_fetch': latest_created_time}\n    return next_run, incidents\n\n\ndef ip_reputation_command(client: Client, args: Dict[str, Any], default_threshold: int) -\u003e List[CommandResults]:\n    \"\"\"ip command: Returns IP reputation for a list of IPs\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['ip']`` is a list of IPs or a single IP\n        ``args['threshold']`` threshold to determine whether an IP is malicious\n\n    :type default_threshold: ``int``\n    :param default_threshold:\n        default threshold to determine whether an IP is malicious\n        if threshold is not specified in the XSOAR arguments\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains IPs\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    # INTEGRATION DEVELOPER TIP\n    # Reputation commands usually support multiple inputs (i.e. arrays), so\n    # they can be invoked once in XSOAR. In this case the API supports a single\n    # IP at a time, so we will cycle this for all the members of the array.\n    # We use argToList(), implemented in CommonServerPython.py to automatically\n    # return a list of a single element even if the provided input is a scalar.\n\n    ips = argToList(args.get('ip'))\n    if len(ips) == 0:\n        raise ValueError('IP(s) not specified')\n\n    # It's a good practice to document the threshold you use to determine\n    # if a score is malicious in your integration documentation.\n    # Thresholds should also be possible to override, as in this case,\n    # where threshold is an actual argument of the command.\n    threshold = int(args.get('threshold', default_threshold))\n\n    # Initialize an empty list of CommandResults to return\n    # each CommandResult will contain context standard for IP\n    command_results: List[CommandResults] = []\n\n    for ip in ips:\n        ip_data = client.get_ip_reputation(ip)\n        ip_data['ip'] = ip\n\n        # HelloWorld score to XSOAR reputation mapping\n        # See: https://xsoar.pan.dev/docs/integrations/dbot\n        # We are using Common.DBotScore as macros to simplify\n        # the mapping.\n\n        score = 0\n        reputation = int(ip_data.get('score', 0))\n        if reputation == 0:\n            score = Common.DBotScore.NONE  # unknown\n        elif reputation \u003e= threshold:\n            score = Common.DBotScore.BAD  # bad\n        elif reputation \u003e= threshold / 2:\n            score = Common.DBotScore.SUSPICIOUS  # suspicious\n        else:\n            score = Common.DBotScore.GOOD  # good\n\n        # The context is bigger here than other commands, as it consists in 3\n        # parts: the vendor-specific context (HelloWorld), the standard-context\n        # (IP) and the DBotScore.\n        # More information:\n        # https://xsoar.pan.dev/docs/integrations/context-and-outputs\n        # https://xsoar.pan.dev/docs/integrations/context-standards\n        # https://xsoar.pan.dev/docs/integrations/dbot\n        # Also check the HelloWorld Design Document\n\n        # Create the DBotScore structure first using the Common.DBotScore class.\n        dbot_score = Common.DBotScore(\n            indicator=ip,\n            indicator_type=DBotScoreType.IP,\n            integration_name='HelloWorld',\n            score=score,\n            malicious_description=f'Hello World returned reputation {reputation}'\n        )\n\n        # Create the IP Standard Context structure using Common.IP and add\n        # dbot_score to it.\n        ip_standard_context = Common.IP(\n            ip=ip,\n            asn=ip_data.get('asn'),\n            dbot_score=dbot_score\n        )\n\n        # INTEGRATION DEVELOPER TIP\n        # In the integration specific Context output (HelloWorld.IP) in this\n        # example you want to provide a lot of information as it can be used\n        # programmatically from within Cortex XSOAR in playbooks and commands.\n        # On the other hand, this API is way to verbose, so we want to select\n        # only certain keys to be returned in order not to clog the context\n        # with useless information. What to actually return in the context and\n        # to define as a command output is subject to design considerations.\n\n        # INTEGRATION DEVELOPER TIP\n        # To generate the Context Outputs on the YML use ``demisto-sdk``'s\n        # ``json-to-outputs`` option.\n\n        # Define which fields we want to exclude from the context output as\n        # they are too verbose.\n        ip_context_excluded_fields = ['objects', 'nir']\n        ip_data = {k: ip_data[k] for k in ip_data if k not in ip_context_excluded_fields}\n\n        # In this case we want to use an custom markdown to specify the table title,\n        # but otherwise ``CommandResults()`` will call ``tableToMarkdown()``\n        #  automatically\n        readable_output = tableToMarkdown('IP', ip_data)\n\n        # INTEGRATION DEVELOPER TIP\n        # The output key will be ``HelloWorld.IP``, using ``ip`` as the key field.\n        # ``indicator`` is used to provide the context standard (IP)\n        command_results.append(CommandResults(\n            readable_output=readable_output,\n            outputs_prefix='HelloWorld.IP',\n            outputs_key_field='ip',\n            outputs=ip_data,\n            indicator=ip_standard_context\n        ))\n    return command_results\n\n\ndef domain_reputation_command(client: Client, args: Dict[str, Any], default_threshold: int) -\u003e List[CommandResults]:\n    \"\"\"domain command: Returns domain reputation for a list of domains\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['domain']`` list of domains or a single domain\n        ``args['threshold']`` threshold to determine whether a domain is malicious\n\n    :type default_threshold: ``int``\n    :param default_threshold:\n        default threshold to determine whether an domain is malicious\n        if threshold is not specified in the XSOAR arguments\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains Domains\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    # INTEGRATION DEVELOPER TIP\n    # Reputation commands usually support multiple inputs (i.e. arrays), so\n    # they can be invoked once in XSOAR. In this case the API supports a single\n    # IP at a time, so we will cycle this for all the members of the array.\n    # We use argToList(), implemented in CommonServerPython.py to automatically\n    # return a list of a single element even if the provided input is a scalar.\n\n    domains = argToList(args.get('domain'))\n    if len(domains) == 0:\n        raise ValueError('domain(s) not specified')\n\n    threshold = int(args.get('threshold', default_threshold))\n\n    # Initialize an empty list of CommandResults to return,\n    # each CommandResult will contain context standard for Domain\n    command_results: List[CommandResults] = []\n\n    for domain in domains:\n        domain_data = client.get_domain_reputation(domain)\n        domain_data['domain'] = domain\n\n        # INTEGRATION DEVELOPER TIP\n        # We want to convert the dates to ISO8601 as\n        # Cortex XSOAR customers and integrations use this format by default\n        if 'creation_date' in domain_data:\n            domain_data['creation_date'] = parse_domain_date(domain_data['creation_date'])\n        if 'expiration_date' in domain_data:\n            domain_data['expiration_date'] = parse_domain_date(domain_data['expiration_date'])\n        if 'updated_date' in domain_data:\n            domain_data['updated_date'] = parse_domain_date(domain_data['updated_date'])\n\n        # HelloWorld score to XSOAR reputation mapping\n        # See: https://xsoar.pan.dev/docs/integrations/dbot\n        # We are using Common.DBotScore as macros to simplify\n        # the mapping.\n\n        score = 0\n        reputation = int(domain_data.get('score', 0))\n        if reputation == 0:\n            score = Common.DBotScore.NONE  # unknown\n        elif reputation \u003e= threshold:\n            score = Common.DBotScore.BAD  # bad\n        elif reputation \u003e= threshold / 2:\n            score = Common.DBotScore.SUSPICIOUS  # suspicious\n        else:\n            score = Common.DBotScore.GOOD  # good\n\n        # INTEGRATION DEVELOPER TIP\n        # The context is bigger here than other commands, as it consists in 3\n        # parts: the vendor-specific context (HelloWorld), the standard-context\n        # (Domain) and the DBotScore.\n        # More information:\n        # https://xsoar.pan.dev/docs/integrations/context-and-outputs\n        # https://xsoar.pan.dev/docs/integrations/context-standards\n        # https://xsoar.pan.dev/docs/integrations/dbot\n        # Also check the sample Design Document\n\n        dbot_score = Common.DBotScore(\n            indicator=domain,\n            integration_name='HelloWorld',\n            indicator_type=DBotScoreType.DOMAIN,\n            score=score,\n            malicious_description=f'Hello World returned reputation {reputation}'\n        )\n\n        # Create the Domain Standard Context structure using Common.Domain and\n        # add dbot_score to it.\n        domain_standard_context = Common.Domain(\n            domain=domain,\n            creation_date=domain_data.get('creation_date', None),\n            expiration_date=domain_data.get('expiration_date', None),\n            updated_date=domain_data.get('updated_date', None),\n            organization=domain_data.get('org', None),\n            name_servers=domain_data.get('name_servers', None),\n            registrant_name=domain_data.get('name', None),\n            registrant_country=domain_data.get('country', None),\n            registrar_name=domain_data.get('registrar', None),\n            dbot_score=dbot_score\n        )\n\n        # In this case we want to use an custom markdown to specify the table title,\n        # but otherwise ``CommandResults()`` will call ``tableToMarkdown()``\n        #  automatically\n        readable_output = tableToMarkdown('Domain', domain_data)\n\n        # INTEGRATION DEVELOPER TIP\n        # The output key will be ``HelloWorld.Domain``, using ``domain`` as the key\n        # field.\n        # ``indicator`` is used to provide the context standard (Domain)\n        command_results.append(CommandResults(\n            readable_output=readable_output,\n            outputs_prefix='HelloWorld.Domain',\n            outputs_key_field='domain',\n            outputs=domain_data,\n            indicator=domain_standard_context\n        ))\n    return command_results\n\n\ndef search_alerts_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"helloworld-search-alerts command: Search alerts in HelloWorld\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['status']`` alert status. Options are 'ACTIVE' or 'CLOSED'\n        ``args['severity']`` alert severity CSV\n        ``args['alert_type']`` alert type\n        ``args['start_time']``  start time as ISO8601 date or seconds since epoch\n        ``args['max_results']`` maximum number of results to return\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains alerts\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    status = args.get('status')\n\n    # Check if severity contains allowed values, use all if default\n    severities: List[str] = HELLOWORLD_SEVERITIES\n    severity = args.get('severity', None)\n    if severity:\n        severities = severity.split(',')\n        if not all(s in HELLOWORLD_SEVERITIES for s in severities):\n            raise ValueError(\n                f'severity must be a comma-separated value '\n                f'with the following options: {\",\".join(HELLOWORLD_SEVERITIES)}')\n\n    alert_type = args.get('alert_type')\n\n    # Convert the argument to a timestamp using helper function\n    start_time = arg_to_datetime(\n        arg=args.get('start_time'),\n        arg_name='start_time',\n        required=False\n    )\n\n    # Convert the argument to an int using helper function\n    max_results = arg_to_number(\n        arg=args.get('max_results'),\n        arg_name='max_results',\n        required=False\n    )\n\n    # Severity is passed to the API as a CSV\n    alerts = client.search_alerts(\n        severity=','.join(severities),\n        alert_status=status,\n        alert_type=alert_type,\n        start_time=int(start_time.timestamp()) if start_time else None,\n        max_results=max_results\n    )\n\n    # INTEGRATION DEVELOPER TIP\n    # We want to convert the \"created\" time from timestamp(s) to ISO8601 as\n    # Cortex XSOAR customers and integrations use this format by default\n    for alert in alerts:\n        if 'created' not in alert:\n            continue\n        created_time_ms = int(alert.get('created', '0')) * 1000\n        alert['created'] = timestamp_to_datestring(created_time_ms)\n\n    # in this example we are not providing a custom markdown, we will\n    # let ``CommandResults`` generate it by default.\n    return CommandResults(\n        outputs_prefix='HelloWorld.Alert',\n        outputs_key_field='alert_id',\n        outputs=alerts\n    )\n\n\ndef get_alert_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"helloworld-get-alert command: Returns a HelloWorld alert\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['alert_id']`` alert ID to return\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains an alert\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    alert_id = args.get('alert_id', None)\n    if not alert_id:\n        raise ValueError('alert_id not specified')\n\n    alert = client.get_alert(alert_id=alert_id)\n\n    # INTEGRATION DEVELOPER TIP\n    # We want to convert the \"created\" time from timestamp(s) to ISO8601 as\n    # Cortex XSOAR customers and integrations use this format by default\n    if 'created' in alert:\n        created_time_ms = int(alert.get('created', '0')) * 1000\n        alert['created'] = timestamp_to_datestring(created_time_ms)\n\n    # tableToMarkdown() is defined is CommonServerPython.py and is used very\n    # often to convert lists and dicts into a human readable format in markdown\n    readable_output = tableToMarkdown(f'HelloWorld Alert {alert_id}', alert)\n\n    return CommandResults(\n        readable_output=readable_output,\n        outputs_prefix='HelloWorld.Alert',\n        outputs_key_field='alert_id',\n        outputs=alert\n    )\n\n\ndef update_alert_status_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"helloworld-update-alert-status command: Changes the status of an alert\n\n    Changes the status of a HelloWorld alert and returns the updated alert info\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['alert_id']`` alert ID to update\n        ``args['status']`` new status, either ACTIVE or CLOSED\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains an updated alert\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    alert_id = args.get('alert_id', None)\n    if not alert_id:\n        raise ValueError('alert_id not specified')\n\n    status = args.get('status', None)\n    if status not in ('ACTIVE', 'CLOSED'):\n        raise ValueError('status must be either ACTIVE or CLOSED')\n\n    alert = client.update_alert_status(alert_id, status)\n\n    # INTEGRATION DEVELOPER TIP\n    # We want to convert the \"updated\" time from timestamp(s) to ISO8601 as\n    # Cortex XSOAR customers and integrations use this format by default\n    if 'updated' in alert:\n        updated_time_ms = int(alert.get('updated', '0')) * 1000\n        alert['updated'] = timestamp_to_datestring(updated_time_ms)\n\n    # tableToMarkdown() is defined is CommonServerPython.py and is used very\n    # often to convert lists and dicts into a human readable format in markdown\n    readable_output = tableToMarkdown(f'HelloWorld Alert {alert_id}', alert)\n\n    return CommandResults(\n        readable_output=readable_output,\n        outputs_prefix='HelloWorld.Alert',\n        outputs_key_field='alert_id',\n        outputs=alert\n    )\n\n\ndef scan_start_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"helloworld-start-scan command: Starts a HelloWorld scan\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['hostname']`` hostname to run the scan on\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains a scan job\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    hostname = args.get('hostname', None)\n    if not hostname:\n        raise ValueError('hostname not specified')\n\n    scan = client.scan_start(hostname=hostname)\n\n    # INTEGRATION DEVELOPER TIP\n    # The API doesn't return the hostname of the scan it was called against,\n    # which is the input. It could be useful to have that information in the\n    # XSOAR context, so we are adding it manually here, based on the command\n    # input argument.\n    scan['hostname'] = hostname\n\n    scan_id = scan.get('scan_id')\n\n    readable_output = f'Started scan {scan_id}'\n\n    return CommandResults(\n        readable_output=readable_output,\n        outputs_prefix='HelloWorld.Scan',\n        outputs_key_field='scan_id',\n        outputs=scan\n    )\n\n\ndef scan_status_command(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    \"\"\"helloworld-scan-status command: Returns status for HelloWorld scans\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['scan_id']`` list of scan IDs or single scan ID\n\n    :return:\n        A ``CommandResults`` object that is then passed to ``return_results``,\n        that contains a scan status\n\n    :rtype: ``CommandResults``\n    \"\"\"\n\n    scan_id_list = argToList(args.get('scan_id', []))\n    if len(scan_id_list) == 0:\n        raise ValueError('scan_id(s) not specified')\n\n    scan_list: List[Dict[str, Any]] = []\n    for scan_id in scan_id_list:\n        scan = client.scan_status(scan_id=scan_id)\n        scan_list.append(scan)\n\n    readable_output = tableToMarkdown('Scan status', scan_list)\n\n    return CommandResults(\n        readable_output=readable_output,\n        outputs_prefix='HelloWorld.Scan',\n        outputs_key_field='scan_id',\n        outputs=scan_list\n    )\n\n\ndef scan_results_command(client: Client, args: Dict[str, Any]) -\u003e Union[Dict[str, Any], CommandResults, List[CommandResults]]:\n    \"\"\"helloworld-scan-results command: Returns results for a HelloWorld scan\n\n    :type client: ``Client``\n    :param Client: HelloWorld client to use\n\n    :type args: ``Dict[str, Any]``\n    :param args:\n        all command arguments, usually passed from ``demisto.args()``.\n        ``args['scan_id']`` scan ID to retrieve results\n        ``args['format']`` format of the results. Options are 'file' or 'json'\n\n    :return:\n        A ``CommandResults`` compatible to return ``return_results()``,\n        that contains a scan result when json format is selected, or\n        A Dict of entries also compatible to ``return_results()`` that\n        contains the output file when file format is selected.\n\n    :rtype: ``Union[Dict[str, Any],CommandResults]``\n    \"\"\"\n\n    scan_id = args.get('scan_id', None)\n    if not scan_id:\n        raise ValueError('scan_id not specified')\n\n    scan_format = args.get('format', 'file')\n\n    # INTEGRATION DEVELOPER TIP\n    # This function supports returning data in multiple formats, either in a json\n    # format that is then mapped to a table, or as a file attachment.\n    # In this case, if the format is \"file\", the return value is different and\n    # uses a raw format  and ``fileResult()`` directly instead of\n    # ``CommandResults``. In either case you should return data to main and\n    # call ``return_results()`` from there.\n    # Always use ``CommandResults`` when possible but, if you need to return\n    # anything special like a file, you can use this raw format.\n\n    results = client.scan_results(scan_id=scan_id)\n    if scan_format == 'file':\n        return (\n            fileResult(\n                filename=f'{scan_id}.json',\n                data=json.dumps(results, indent=4),\n                file_type=entryTypes['entryInfoFile']\n            )\n        )\n    elif scan_format == 'json':\n        # This scan returns CVE information. CVE is also part of the XSOAR\n        # context standard, so we must extract CVE IDs and return them also.\n        # See: https://xsoar.pan.dev/docs/integrations/context-standards#cve\n        cves: List[Common.CVE] = []\n        command_results: List[CommandResults] = []\n        entities = results.get('entities', [])\n        for e in entities:\n            if 'vulns' in e.keys() and isinstance(e['vulns'], list):\n                cves.extend([Common.CVE(id=c, cvss=None, published=None, modified=None, description=None) for c in e['vulns']])\n\n        # INTEGRATION DEVELOPER TIP\n        # We want to provide a unique result for every CVE indicator.\n        # Since every entity may contain several CVE indicators,\n        # we will split the entities result and CVE indicator results.\n        readable_output = tableToMarkdown(f'Scan {scan_id} results', entities)\n        command_results.append(CommandResults(\n            readable_output=readable_output,\n            outputs_prefix='HelloWorld.Scan',\n            outputs_key_field='scan_id',\n            outputs=results\n        ))\n\n        cves = list(set(cves))  # make the indicator list unique\n        for cve in cves:\n            command_results.append(CommandResults(\n                readable_output=f\"CVE {cve}\",\n                indicator=cve\n            ))\n        return command_results\n    else:\n        raise ValueError('Incorrect format, must be \"json\" or \"file\"')\n\n\n''' MAIN FUNCTION '''\n\n\ndef main() -\u003e None:\n    \"\"\"main function, parses params and runs command functions\n\n    :return:\n    :rtype:\n    \"\"\"\n\n    api_key = demisto.params().get('apikey')\n\n    # get the service API url\n    base_url = urljoin(demisto.params()['url'], '/api/v1')\n\n    # if your Client class inherits from BaseClient, SSL verification is\n    # handled out of the box by it, just pass ``verify_certificate`` to\n    # the Client constructor\n    verify_certificate = not demisto.params().get('insecure', False)\n\n    # How much time before the first fetch to retrieve incidents\n    first_fetch_time = arg_to_datetime(\n        arg=demisto.params().get('first_fetch', '3 days'),\n        arg_name='First fetch time',\n        required=True\n    )\n    first_fetch_timestamp = int(first_fetch_time.timestamp()) if first_fetch_time else None\n    # Using assert as a type guard (since first_fetch_time is always an int when required=True)\n    assert isinstance(first_fetch_timestamp, int)\n\n    # if your Client class inherits from BaseClient, system proxy is handled\n    # out of the box by it, just pass ``proxy`` to the Client constructor\n    proxy = demisto.params().get('proxy', False)\n\n    # INTEGRATION DEVELOPER TIP\n    # You can use functions such as ``demisto.debug()``, ``demisto.info()``,\n    # etc. to print information in the XSOAR server log. You can set the log\n    # level on the server configuration\n    # See: https://xsoar.pan.dev/docs/integrations/code-conventions#logging\n\n    demisto.debug(f'Command being called is {demisto.command()}')\n    try:\n        headers = {\n            'Authorization': f'Bearer {api_key}'\n        }\n        client = Client(\n            base_url=base_url,\n            verify=verify_certificate,\n            headers=headers,\n            proxy=proxy)\n\n        if demisto.command() == 'test-module':\n            # This is the call made when pressing the integration Test button.\n            result = test_module(client, first_fetch_timestamp)\n            return_results(result)\n\n        elif demisto.command() == 'fetch-incidents':\n            # Set and define the fetch incidents command to run after activated via integration settings.\n            alert_status = demisto.params().get('alert_status', None)\n            alert_type = demisto.params().get('alert_type', None)\n            min_severity = demisto.params().get('min_severity', None)\n\n            # Convert the argument to an int using helper function or set to MAX_INCIDENTS_TO_FETCH\n            max_results = arg_to_number(\n                arg=demisto.params().get('max_fetch'),\n                arg_name='max_fetch',\n                required=False\n            )\n            if not max_results or max_results \u003e MAX_INCIDENTS_TO_FETCH:\n                max_results = MAX_INCIDENTS_TO_FETCH\n\n            next_run, incidents = fetch_incidents(\n                client=client,\n                max_results=max_results,\n                last_run=demisto.getLastRun(),  # getLastRun() gets the last run dict\n                first_fetch_time=first_fetch_timestamp,\n                alert_status=alert_status,\n                min_severity=min_severity,\n                alert_type=alert_type\n            )\n\n            # saves next_run for the time fetch-incidents is invoked\n            demisto.setLastRun(next_run)\n            # fetch-incidents calls ``demisto.incidents()`` to provide the list\n            # of incidents to create\n            demisto.incidents(incidents)\n\n        elif demisto.command() == 'ip':\n            default_threshold_ip = int(demisto.params().get('threshold_ip', '65'))\n            return_results(ip_reputation_command(client, demisto.args(), default_threshold_ip))\n\n        elif demisto.command() == 'domain':\n            default_threshold_domain = int(demisto.params().get('threshold_domain', '65'))\n            return_results(domain_reputation_command(client, demisto.args(), default_threshold_domain))\n\n        elif demisto.command() == 'helloworld-say-hello':\n            return_results(say_hello_command(client, demisto.args()))\n\n        elif demisto.command() == 'helloworld-search-alerts':\n            return_results(search_alerts_command(client, demisto.args()))\n\n        elif demisto.command() == 'helloworld-get-alert':\n            return_results(get_alert_command(client, demisto.args()))\n\n        elif demisto.command() == 'helloworld-update-alert-status':\n            return_results(update_alert_status_command(client, demisto.args()))\n\n        elif demisto.command() == 'helloworld-scan-start':\n            return_results(scan_start_command(client, demisto.args()))\n\n        elif demisto.command() == 'helloworld-scan-status':\n            return_results(scan_status_command(client, demisto.args()))\n\n        elif demisto.command() == 'helloworld-scan-results':\n            return_results(scan_results_command(client, demisto.args()))\n\n    # Log exceptions and return errors\n    except Exception as e:\n        demisto.error(traceback.format_exc())  # print the traceback\n        return_error(f'Failed to execute {demisto.command()} command.\\nError:\\n{str(e)}')\n\n\n''' ENTRY POINT '''\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.2.5","modified":"2021-08-24T19:09:02.295814+03:00","name":"HelloWorld","packID":"HelloWorld","packPropagationLabels":["all"],"prevName":"HelloWorld","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":2},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"true","display":"Fetch indicators","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feed","options":null,"required":false,"type":8},{"defaultValue":"https://openphish.com/feed.txt","display":"Server's URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Should be feed of type .txt. For using other types of feed, modify the parsing in the python file.","name":"url","options":null,"required":true,"type":0},{"defaultValue":"Bad","display":"Indicator Reputation","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Indicators from this integration instance will be marked with this reputation","name":"feedReputation","options":["None","Good","Suspicious","Bad"],"required":false,"type":18},{"defaultValue":"F - Reliability cannot be judged","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data","name":"feedReliability","options":["A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Traffic Light Protocol Color","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The Traffic Light Protocol (TLP) designation to apply to indicators fetched from the feed","name":"tlp_color","options":["RED","AMBER","GREEN","WHITE"],"required":false,"type":15},{"defaultValue":"30","display":"Feed Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedFetchInterval","options":null,"required":false,"type":19},{"defaultValue":"true","display":"Bypass exclusion list","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, the exclusion list is ignored for indicators from this feed. This means that if an indicator from this feed is on the exclusion list, the indicator might still be added to the system.","name":"feedBypassExclusionList","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationPolicy","options":["never","interval","indicatorType","suddenDeath"],"required":false,"type":17},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationInterval","options":null,"required":false,"type":1},{"defaultValue":"","display":"Tags","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Supports CSV values.","name":"feedTags","options":null,"required":false,"type":0}],"definitionId":"","description":"This is the Feed Hello World integration for getting started with your feed integration.","detailedDescription":"### Community Contributed Integration\n #### Integration Author: Cortex XSOAR\n No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).\n***\n## Feed Hello World\n- This text is markdown\n- This section explains how to configure the instance of FeedHelloWorld in Cortex XSOAR.\n","display":"HelloWorld Feed (Community Contribution)","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"HelloWorld Feed","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"The maximum number of results to return.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets indicators from the feed.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"helloworld-get-indicators","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.5.21272","feed":true,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\"\"\"HelloWorld Feed Integration for Cortex XSOAR (aka Demisto)\n\nThis feed integration is a good example on you can build a Cortex XSOAR feed\nusing Python 3. Please follow the documentation links below and make sure that\nyour feed integration follows the Code Conventions and required parameters, and passes the Linting phase.\n\nDeveloper Documentation: https://xsoar.pan.dev/docs/welcome\nCode Conventions: https://xsoar.pan.dev/docs/integrations/code-conventions\nFeed Required Parameters: https://xsoar.pan.dev/docs/integrations/feeds#required-parameters\nLinting: https://xsoar.pan.dev/docs/integrations/linting\n\n\nThe API\n--------------\n\nFor this template, the feed used as API is OpenPhish, supplying a feed of URLs.\nThis API's output is of type freetext, and the suitable handling for this type can be seen in the function\n'fetch_indicators'. Other APIs may have different formats, so when using this template for other feed APIs\nmake sure you handle the output properly according to its format.\n\n\nFeed Integration File Structure\n--------------------------\n\nA feed integration usually consists of the following parts:\n- Imports\n- Constants\n- Client Class\n- Helper Functions\n- Command Functions\n- Main Function\n- Entry Point\n\n\nImports\n-------\n\nHere you can import Python module you need for your feed integration. If you need\na module that is not part of the default XSOAR Docker images, you can add\na custom one. More details: https://xsoar.pan.dev/docs/integrations/docker\n\nThere are also internal imports that are used by XSOAR:\n- demistomock (imported as demisto): allows your code to work offline for\ntesting. The actual ``demisto`` module is provided at runtime when the\ncode runs in XSOAR.\n- CommonServerPython.py: contains a set of helper functions, base classes\nand other useful components that will make your feed integration code easier\nto maintain.\n- CommonServerUserPython.py: includes a set of user defined commands that\nare specific to an XSOAR installation. Do not use it for feed integrations that\nare meant to be shared externally.\n\nThese imports are automatically loaded at runtime within the XSOAR script\nrunner, so you shouldn't modify them\n\nConstants\n---------\n\nUsually some constants that do not require user parameters or inputs, such\nas the default API entry point for your service, or the maximum numbers of\nincidents to fetch every time.\n\n\nClient Class\n------------\n\nWe recommend to use a Client class to wrap all the code that needs to interact\nwith your API. Moreover, we recommend, when possible, to inherit from the\nBaseClient class, defined in CommonServerPython.py. This class already handles\na lot of the work, such as system proxy settings, SSL certificate verification\nand exception handling for HTTP errors.\n\nNote that the Client class should NOT contain any Cortex XSOAR specific code,\ni.e. it shouldn't use anything in the ``demisto`` class (functions such as\n``demisto.args()`` or ``demisto.results()`` or even ``return_results`` and\n``return_error``.\nYou will use the Command Functions to handle XSOAR inputs and outputs.\n\nWhen calling an API, you should use the ``_http.request()`` method and you\ncan return the raw data to the calling function (usually a Command function).\n\nYou should usually have one function for each API endpoint.\n\nLook at the code and the commands of this specific class to better understand\nthe implementation details.\n\n\nHelper Functions\n----------------\n\nHelper functions are usually used as utility functions that are used by several\ncommand functions throughout your code. For example they map arguments to types\nor convert severity formats from feed integration-specific to XSOAR.\nMany helper functions are already defined in ``CommonServerPython.py`` and are\noften very handy.\n\n\nCommand Functions\n-----------------\n\nCommand functions perform the mapping between XSOAR inputs and outputs to the\nClient class functions inputs and outputs. As a best practice, they shouldn't\ncontain calls to ``demisto.args()``, ``demisto.results()``, ``return_error``\nand ``demisto.command()`` as those should be handled through the ``main()``\nfunction.\nHowever, in command functions, use ``demisto`` or ``CommonServerPython.py``\nartifacts, such as ``demisto.debug()`` or the ``CommandResults`` class and the\n``Common.*`` classes.\n\nEvery feed integration should have these three base commands:\n``\u003cproduct-prefix\u003e-get-indicators`` - where \u003cproduct-prefix\u003e is replaced by the name\nof the Product or Vendor source providing the feed. So for example, if you were\ndeveloping a feed integration for Microsoft Intune this command might be called\nmsintune-get-indicators. This command should fetch a limited number of indicators\nfrom the feed source and display them in the war room.\n``fetch-indicators`` - this command will initiate a request to the feed endpoint, format\nthe data fetched from the endpoint to conform to Cortex XSOAR's expected input format\nand create new indicators. If the integration instance is configured to Fetch indicators,\nthen this is the command that will be executed at the specified Feed Fetch Interval.\n``test-module`` - this is the command that is run when the Test button in the configuration\n panel of a feed integration is clicked.\n\nMore information on Context Outputs, Standards, DBotScore and demisto-sdk:\nhttps://xsoar.pan.dev/docs/integrations/code-conventions#outputs\nhttps://xsoar.pan.dev/docs/integrations/context-and-outputs\nhttps://xsoar.pan.dev/docs/integrations/context-standards\nhttps://xsoar.pan.dev/docs/integrations/dbot\nhttps://github.com/demisto/demisto-sdk/blob/master/demisto_sdk/commands/json_to_outputs/README.md\nhttps://xsoar.pan.dev/docs/integrations/context-and-outputs\nhttps://xsoar.pan.dev/docs/integrations/code-conventions#outputs\nhttps://xsoar.pan.dev/docs/integrations/dt\n\n\nMain Function\n-------------\n\nThe ``main()`` function takes care of reading the feed integration parameters via\nthe ``demisto.params()`` function, initializes the Client class and checks the\ndifferent options provided to ``demisto.commands()``, to invoke the correct\ncommand function passing to it ``demisto.args()`` and returning the data to\n``return_results()``. ``main()`` also catches exceptions and\nreturns an error message via ``return_error()``.\n\n\nEntry Point\n-----------\n\nThis is the integration code entry point. It checks whether the ``__name__``\nvariable is ``__main__`` , ``__builtin__`` (for Python 2) or ``builtins`` (for\nPython 3) and then calls the ``main()`` function. Just keep this convention.\n\n\"\"\"\n\nfrom typing import Dict, List, Optional\n\nimport urllib3\n\n\n\n\n# disable insecure warnings\nurllib3.disable_warnings()\n\n\nclass Client(BaseClient):\n    \"\"\"Client class to interact with the service API\n\n    This Client implements API calls, and does not contain any Demisto logic.\n    Should only do requests and return data.\n    It inherits from BaseClient defined in CommonServer Python.\n    Most calls use _http_request() that handles proxy, SSL verification, etc.\n    For this HelloWorld Feed implementation, no special attributes defined\n    \"\"\"\n\n    def build_iterator(self) -\u003e List:\n        \"\"\"Retrieves all entries from the feed.\n        Returns:\n            A list of objects, containing the indicators.\n        \"\"\"\n\n        result = []\n\n        res = self._http_request('GET',\n                                 url_suffix='',\n                                 full_url=self._base_url,\n                                 resp_type='text',\n                                 )\n\n        # In this case the feed output is in text format, so extracting the indicators from the response requires\n        # iterating over it's lines solely. Other feeds could be in other kinds of formats (CSV, MISP, etc.), or might\n        # require additional processing as well.\n        try:\n            indicators = res.split('\\n')\n\n            for indicator in indicators:\n                # Infer the type of the indicator using 'auto_detect_indicator_type(indicator)' function\n                # (defined in CommonServerPython).\n                if auto_detect_indicator_type(indicator):\n                    result.append({\n                        'value': indicator,\n                        'type': auto_detect_indicator_type(indicator),\n                        'FeedURL': self._base_url\n                    })\n\n        except ValueError as err:\n            demisto.debug(str(err))\n            raise ValueError(f'Could not parse returned data as indicator. \\n\\nError massage: {err}')\n        return result\n\n\ndef test_module(client: Client) -\u003e str:\n    \"\"\"Builds the iterator to check that the feed is accessible.\n    Args:\n        client: Client object.\n    Returns:\n        Outputs.\n    \"\"\"\n    # INTEGRATION FEED DEVELOPER TIP\n    # Client class should raise the exceptions, but if the test fails\n    # the exception text is printed to the Cortex XSOAR UI.\n    # If you have some specific errors you want to capture (i.e. auth failure)\n    # you should catch the exception here and return a string with a more\n    # readable output (for example return 'Authentication Error, API Key\n    # invalid').\n    # Cortex XSOAR will print everything you return different than 'ok' as\n    # an error\n\n    client.build_iterator()\n    return 'ok'\n\n\ndef fetch_indicators(client: Client, tlp_color: Optional[str] = None, feed_tags: List = [], limit: int = -1) \\\n        -\u003e List[Dict]:\n    \"\"\"Retrieves indicators from the feed\n    Args:\n        client (Client): Client object with request\n        tlp_color (str): Traffic Light Protocol color\n        feed_tags (list): tags to assign fetched indicators\n        limit (int): limit the results\n    Returns:\n        Indicators.\n    \"\"\"\n    iterator = client.build_iterator()\n    indicators = []\n    if limit \u003e 0:\n        iterator = iterator[:limit]\n\n    # extract values from iterator\n    for item in iterator:\n        value_ = item.get('value')\n        type_ = item.get('type')\n        raw_data = {\n            'value': value_,\n            'type': type_,\n        }\n\n        # Create indicator object for each value.\n        # The object consists of a dictionary with required and optional keys and values, as described blow.\n        for key, value in item.items():\n            raw_data.update({key: value})\n        indicator_obj = {\n            # The indicator value.\n            'value': value_,\n            # The indicator type as defined in Cortex XSOAR.\n            # One can use the FeedIndicatorType class under CommonServerPython to populate this field.\n            'type': type_,\n            # The name of the service supplying this feed.\n            'service': 'HelloWorld',\n            # A dictionary that maps values to existing indicator fields defined in Cortex XSOAR.\n            # One can use this section in order to map custom indicator fields previously defined\n            # in Cortex XSOAR to their values.\n            'fields': {},\n            # A dictionary of the raw data returned from the feed source about the indicator.\n            'rawJSON': raw_data\n        }\n\n        if feed_tags:\n            indicator_obj['fields']['tags'] = feed_tags\n\n        if tlp_color:\n            indicator_obj['fields']['trafficlightprotocol'] = tlp_color\n\n        indicators.append(indicator_obj)\n\n    return indicators\n\n\ndef get_indicators_command(client: Client,\n                           params: Dict[str, str],\n                           args: Dict[str, str]\n                           ) -\u003e CommandResults:\n    \"\"\"Wrapper for retrieving indicators from the feed to the war-room.\n    Args:\n        client: Client object with request\n        params: demisto.params()\n        args: demisto.args()\n    Returns:\n        Outputs.\n    \"\"\"\n    limit = int(args.get('limit', '10'))\n    tlp_color = params.get('tlp_color')\n    feed_tags = argToList(params.get('feedTags', ''))\n    indicators = fetch_indicators(client, tlp_color, feed_tags, limit)\n    human_readable = tableToMarkdown('Indicators from HelloWorld Feed:', indicators,\n                                     headers=['value', 'type'], headerTransform=string_to_table_header, removeNull=True)\n    return CommandResults(\n        readable_output=human_readable,\n        outputs_prefix='',\n        outputs_key_field='',\n        raw_response=indicators,\n        outputs={},\n    )\n\n\ndef fetch_indicators_command(client: Client, params: Dict[str, str]) -\u003e List[Dict]:\n    \"\"\"Wrapper for fetching indicators from the feed to the Indicators tab.\n    Args:\n        client: Client object with request\n        params: demisto.params()\n    Returns:\n        Indicators.\n    \"\"\"\n    feed_tags = argToList(params.get('feedTags', ''))\n    tlp_color = params.get('tlp_color')\n    indicators = fetch_indicators(client, tlp_color, feed_tags)\n    return indicators\n\n\ndef main():\n    \"\"\"\n    main function, parses params and runs command functions\n    \"\"\"\n\n    params = demisto.params()\n\n    # Get the service API url\n    base_url = params.get('url')\n\n    # If your Client class inherits from BaseClient, SSL verification is\n    # handled out of the box by it, just pass ``verify_certificate`` to\n    # the Client constructor\n    insecure = not params.get('insecure', False)\n\n    # If your Client class inherits from BaseClient, system proxy is handled\n    # out of the box by it, just pass ``proxy`` to the Client constructor\n    proxy = params.get('proxy', False)\n\n    command = demisto.command()\n    args = demisto.args()\n\n    # INTEGRATION DEVELOPER TIP\n    # You can use functions such as ``demisto.debug()``, ``demisto.info()``,\n    # etc. to print information in the XSOAR server log. You can set the log\n    # level on the server configuration\n    # See: https://xsoar.pan.dev/docs/integrations/code-conventions#logging\n    demisto.debug(f'Command being called is {command}')\n\n    try:\n        client = Client(\n            base_url=base_url,\n            verify=insecure,\n            proxy=proxy,\n        )\n\n        if command == 'test-module':\n            # This is the call made when pressing the integration Test button.\n            return_results(test_module(client))\n\n        elif command == 'helloworld-get-indicators':\n            # This is the command that fetches a limited number of indicators from the feed source\n            # and displays them in the war room.\n            return_results(get_indicators_command(client, params, args))\n\n        elif command == 'fetch-indicators':\n            # This is the command that initiates a request to the feed endpoint and create new indicators objects from\n            # the data fetched. If the integration instance is configured to fetch indicators, then this is the command\n            # that will be executed at the specified feed fetch interval.\n            indicators = fetch_indicators_command(client, params)\n            for iter_ in batch(indicators, batch_size=2000):\n                demisto.createIndicators(iter_)\n\n        else:\n            raise NotImplementedError(f'Command {command} is not implemented.')\n\n    # Log exceptions and return errors\n    except Exception as e:\n        demisto.error(traceback.format_exc())  # Print the traceback\n        return_error(f'Failed to execute {command} command.\\nError:\\n{str(e)}')\n\n\nif __name__ in ['__main__', 'builtin', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.2.5","modified":"2021-08-24T19:09:02.295692+03:00","name":"HelloWorld Feed","packID":"HelloWorld","packPropagationLabels":["all"],"prevName":"HelloWorld Feed","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":2},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"","display":"A CSV of language codes of the language to use for OCR (leave empty to use defaults).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"langs","options":null,"required":false,"type":0}],"definitionId":"","description":"Extracts text from images.","detailedDescription":"## Image OCR\nUse the Image OCR integration to extract text from images. The integration utilizes the open-source [**tesseract**](https://github.com/tesseract-ocr/tesseract/) OCR engine.\n\nThe default language used for OCR is English. To configure additional languages, in the **Languages** parameter specify a CSV list of language codes. For example, to set the integration for English and French, set this value: *eng,fra*. To see all supported language codes,run the following command:\n```\n!image-ocr-list-languages\n```\n \n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/image-ocr)","display":"Image OCR","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Image OCR","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":null,"cartesian":false,"deprecated":false,"description":"Lists supported languages for which the integration can extract text.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"image-ocr-list-languages","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Entry ID of the image file to process.","name":"entryid","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A CSV of language codes of the language to use for OCR. Overrides the default configured language list.","isArray":true,"name":"langs","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Extracts text from an image.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"image-ocr-extract-text","outputs":[{"contentPath":"","contextPath":"File.Text","description":"Extracted text from the passed image file.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/tesseract:1.0.0.24037","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\nimport subprocess\nimport traceback\nfrom typing import List\n\nTESSERACT_EXE = 'tesseract'\n\n\ndef list_languages() -\u003e List[str]:\n    lang_out = subprocess.check_output([TESSERACT_EXE, '--list-langs'], universal_newlines=True)\n    if not lang_out:  # something went wrong\n        raise ValueError('No output from --list-langs')\n    lines = lang_out.splitlines()\n    if len(lines) \u003c= 1:\n        raise ValueError('No output from --list-langs')\n    return sorted(lines[1:])  # ignore first line\n\n\ndef extract_text(image_path: str, languages: List[str] = None) -\u003e str:\n    exe_params = [TESSERACT_EXE, image_path, 'stdout']\n    if languages:\n        exe_params.extend(['-l', '+'.join(languages)])\n    res = subprocess.run(exe_params, capture_output=True, check=True, text=True)\n    if res.stderr:\n        demisto.debug('tesseract returned ok but stderr contains warnings: {}'.format(res.stderr))\n    return res.stdout\n\n\ndef list_languages_command() -\u003e CommandResults:\n    langs = list_languages()\n    return CommandResults(\n        readable_output=\"## Image OCR Supported Languages\\n\\n\" + \"\\n\".join(['* ' + s for s in langs]),\n        raw_response=langs\n    )\n\n\ndef extract_text_command(args: dict, instance_languages: list) -\u003e CommandResults:\n    langs = argToList(args.get('langs')) or instance_languages\n    demisto.debug(\"Using langs settings: {}\".format(langs))\n\n    entry_id = args.get('entryid')\n    file_path = demisto.getFilePath(entry_id)\n    if not file_path:\n        raise DemistoException(\"Couldn't find entry id: {}\".format(entry_id))\n\n    demisto.debug('Extracting text from file: {}'.format(file_path))\n    res = extract_text(file_path['path'], langs)\n    file_entry = {'EntryID': entry_id, 'Text': res}\n\n    return CommandResults(\n        readable_output=\"## Image OCR Extracted Text\\n\\n\" + res,\n        outputs_prefix='File',\n        outputs_key_field='EntryID',\n        outputs=file_entry,\n        raw_response=res\n    )\n\n\ndef run_test_module(instance_languages: list) -\u003e str:\n    try:\n        supported_langs = list_languages()\n        if instance_languages:\n            for language in instance_languages:\n                if language not in supported_langs:\n                    raise DemistoException('Unsupported language configured: {}'.format(language))\n        return 'ok'\n    except Exception as exception:\n        raise Exception('Failed testing {}: {}'.format(TESSERACT_EXE, str(exception)))\n\n\ndef main() -\u003e None:\n    command = demisto.command()\n    args = demisto.args()\n    instance_languages = argToList(demisto.params().get('langs'))\n    try:\n        if command == 'test-module':\n            return_results(run_test_module(instance_languages))\n        elif command == 'image-ocr-list-languages':\n            return_results(list_languages_command())\n        elif command == 'image-ocr-extract-text':\n            return_results(extract_text_command(args, instance_languages))\n        else:\n            raise NotImplementedError(f'Command {command} was not implemented.')\n    except subprocess.CalledProcessError as cpe:\n        return_error(\"Failed {} execution. Return status: {}.\\nError:\\n{}\".format(cpe.cmd, cpe.returncode, cpe.stderr))\n    except Exception as err:\n        return_error(\"Failed with error: {}\\n\\nTrace:\\n{}\".format(str(err), traceback.format_exc()))\n\n\n# python2 uses __builtin__ python3 uses builtins\nif __name__ in (\"__builtin__\", \"builtins\", '__main__'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.1.2","modified":"2021-09-02T18:10:27.422056+03:00","name":"Image OCR","packID":"ImageOCR","packPropagationLabels":["all"],"prevName":"Image OCR","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":false,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"The Kafka brokers to connect to, as a comma separated list, in the form: ip:port,ip2:port2 ","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Address","options":null,"required":true,"type":0},{"defaultValue":"Demisto","display":"Client ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ClientID","options":null,"required":true,"type":0},{"defaultValue":"","display":"CA certificate of Kafka server (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"cafile","options":null,"required":false,"type":12},{"defaultValue":"","display":"Client certificate (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"clientcert","options":null,"required":false,"type":12},{"defaultValue":"","display":"Client certificate key (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"clientkey","options":null,"required":false,"type":14},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Import messges as incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"0","display":"Import from offset","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"offset","options":null,"required":false,"type":0},{"defaultValue":"","display":"Import from topic","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"topic","options":null,"required":false,"type":0},{"defaultValue":"0","display":"Import from partition","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"partition","options":null,"required":false,"type":0}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Kafka v2 integration instead.","detailedDescription":"By default, the Kafka instance uses a non SSL connection. Turnning on the insecure flag, or providing any certificate will switch to SSL connection.\nTo generate the files needed for SSL, you will need to create a Kafka client keystore. You can use the script at:\n[https://github.com/confluentinc/confluent-platform-security-tools/blob/master/kafka-generate-ssl.sh](https://github.com/confluentinc/confluent-platform-security-tools/blob/master/kafka-generate-ssl.sh)\nThen run the command **\"keytool -list -rfc -keystore kafka.client.keystore.jks\"** to verify that there are 3 entries in that keystore.\nrun \"keytool -exportcert -alias localhost -keystore kafka.client.keystore.jks -rfc -file certificate.pem\" to export the certificate.pem, this is the Client certificate.\nNext, you need to extract the private.key. You can do this using the following commands:\n**keytool -v -importkeystore -srckeystore kafka.client.keystore.jks -srcalias localhost -destkeystore cert_and_key.p12 -deststoretype PKCS12 openssl pkcs12 -in cert_and_key.p12 -nocerts -nodes**\n\nThis wil print the stdout the content of the private key, copy the lines (inclusive) between —–BEGIN PRIVATE KEY—– and —–END PRIVATE KEY—– to a new key.pem file. This is the Client certificate key nano key.pem.\n\nFinally, you need to extract the CA certificate:\n**keytool -exportcert -alias CARoot -keystore kafka.client.keystore.jks -rfc -file CARoot.pem**","display":"Kafka (Deprecated)","fromServerVersion":"","hidden":false,"icon":"kafka.png","id":"kafka","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.639752+03:00","name":"kafka","packID":"","prevName":"kafka","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"https://lgtm.com/api/v1.0","display":"Server URL (e.g. https://lgtm.com/api/v1.0)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"api_key","options":null,"required":true,"type":4},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"An Integration with LGTM API","detailedDescription":"### Community Contributed Integration\n #### Integration Author: Ayman Mahmoud\n No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).\n***\n## LGTM\nLGTM is a code analysis platform for finding zero-days and preventing critical vulnerabilities\n\n### Generate an API Token\n1. Login to your LGTM service account, go to **Account Settings**.\n2. Click the **+Create Token** button in the **Your authorized applications** section\n3. Generate a Token with selected Scopes and Permissions as needed.\n4. Copy and paste the key.\n5. From the ID column, copy the Key ID.\n\n### URL\nThe Base URL of LGTM API v1.0: https://lgtm.com/api/v1.0\n\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/lgtm)","display":"LGTM (Community Contribution)","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"LGTM","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The URL of the repository to analyze. LGTM tests this against the [repository providers](https://lgtm.com/admin/help/adding-repository-providers) defined for the system. If it doesn't match any of them, the request fails.","name":"repository","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Optional, a [language code](https://lgtm.com/help/lgtm/analysis-faqs#which-languages-are-supported) to specify which language to analyze. To request the analysis of more than one language, specify a query  meter for each language. By default, LGTM tries to analyze all supported languages.","isArray":true,"name":"language","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The analysis mode of the new project. When set to `full` all commits of the project are analyzed; when set to `sparse` the latest commit of the project is analyzed periodically; when set to `upload`, no automatic analysis is performed, instead externally-generated databases should be uploaded. For new projects the default value is `full`. The `mode` meter cannot be used to change the analysis mode of existing projects. Therefore, for existing projects, it should either be left blank or set to match the analysis mode of the project.","name":"mode","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Required when `mode=upload`, specify the identifier of the commit used to generate the database.","name":"commit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Optional when `mode=upload`, specify the date and time of the commit used to generate the database; defaults to the current time.","name":"date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Optional, any [labels](https://lgtm.com/admin/help/defining-worker-labels) required by workers to analyze this project. To specify more than one label, repeat the query  meter. ","isArray":true,"name":"worker-label","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Add a project to LGTM","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-add-project","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The analysis identifier.","name":"analysis-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The desired version of the SARIF format. Currently supported versions are `1.0.0`, `2.0.0`, and `2.1.0`.","name":"sarif-version","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set `true` to include results in files that are excluded from the output by default. This includes results in test code and generated files. For more information, see [File classification](https://lgtm.com/help/lgtm/file-classification).","name":"excluded-files","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get detailed alert information","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-alerts","outputs":[{"contentPath":"","contextPath":"LGTM.alerts.runs.results.ruleId","description":"LGTM Alerts by Rule ID","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.alerts.runs.results.partialFingerprints.primaryLocationLineHash","description":"LGTM Alert location by line hash","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The analysis identifier.","name":"analysis-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get analysis summary","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-analysis","outputs":[{"contentPath":"","contextPath":"LGTM.analysis_summary.id","description":"The analysis identifier.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.commit-id","description":"The commit identifier. The commit identifier is included only if the same commit was successfully analyzed for all languages. A detailed  eakdown of which commit was analyzed for each language is provided in the `languages` property.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.language","description":"The short name for the language.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.status","description":"The status of the analysis of this language.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.alerts","description":"The number of alerts for this language.","type":"Number"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.lines","description":"The number of lines of code for this language.","type":"Number"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.commit-id","description":"The latest successfully analyzed commit for the language. All statistics refer to this commit.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.commit-date","description":"The time of the commit.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.analysis-date","description":"The time the commit was analyzed.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.log-url","description":"A page on LGTM to view the logs for this analysis.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.results-url","description":"A page on LGTM to view the results of this analysis.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The numeric project identifier.","name":"project-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The identifier of a specific commit. Alternatively, use `latest` for the most recent analyzed commit.","name":"commit-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get analysis summary for a specific commit","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-analysis-for-commit","outputs":[{"contentPath":"","contextPath":"LGTM.analysis_summary.id","description":"The analysis identifier.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.commit-id","description":"The commit identifier. The commit identifier is included only if the same commit was successfully analyzed for all languages. A detailed  eakdown of which commit was analyzed for each language is provided in the `languages` property.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.language","description":"The short name for the language.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.status","description":"The status of the analysis of this language.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.alerts","description":"The number of alerts for this language.","type":"Number"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.lines","description":"The number of lines of code for this language.","type":"Number"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.commit-id","description":"The latest successfully analyzed commit for the language. All statistics refer to this commit.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.commit-date","description":"The time of the commit.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.languages.analysis-date","description":"The time the commit was analyzed.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.log-url","description":"A page on LGTM to view the logs for this analysis.","type":"String"},{"contentPath":"","contextPath":"LGTM.analysis_summary.results-url","description":"A page on LGTM to view the results of this analysis.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The identifier for the review (from the `task-result-url`).","name":"review-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get results of code review","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-code-review","outputs":[{"contentPath":"","contextPath":"LGTM.code_review_result.id","description":"The identifier for the review.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.results-url","description":"A page on LGTM to view the status and results of this code review.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.status","description":"The status of the code review.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.status-message","description":"A summary of the current status of the code review.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.language","description":"The language analyzed.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.status","description":"The status for analysis of this language.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.status-message","description":"The current state of analysis of this langauge. When available, a summary of analysis results.","type":"String"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.new","description":"The total number of alerts introduced by the patch for this language.","type":"Number"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.fixed","description":"The total number of alerts fixed by the patch for this language.","type":"Number"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.alerts.new","description":"The number of alerts introduced by the patch for this query.","type":"Number"},{"contentPath":"","contextPath":"LGTM.code_review_result.languages.alerts.fixed","description":"The number of alerts fixed by the patch for this query.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The numeric project identifier","name":"project-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get project by numeric identifier","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-project","outputs":[{"contentPath":"","contextPath":"LGTM.project_details.languages.grade","description":"The grade of the code for this language.","type":"String"},{"contentPath":"","contextPath":"LGTM.project_details.id","description":"LGTM Project id","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.project_details.name","description":"LGTM Project name","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The first part of the URL identifier of a project, which represents the repository host.","name":"provider","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The second part of the URL identifier of a project, the organization.","name":"org","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The third part of the URL identifier of a project, the repository name.","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get project by URL identifier","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-project-by-url-identifier","outputs":[{"contentPath":"","contextPath":"LGTM.project_details.languages.grade","description":"The grade of the code for this language.","type":"String"},{"contentPath":"","contextPath":"LGTM.project_details.id","description":"LGTM Project id","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.project_details.name","description":"LGTM Project name","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The numeric project identifier","name":"project-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The type of project configuration to retrieve. If this  meter isn't specified, the request retrieves the effective configuration. That is, the configuration that is actually applied to the project, which may be from: the repository the administrator-set, project configuration the global configuration. If you do specify this value, it must be one of: `repository` to retrieve the configuration specified by a YAML file in the repository. A 404 status is returned if there is no repository configuration. `administrator` to retrieve the administrator-set, project configuration. A 404 status is returned if there is no administrator configuration.","name":"source","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get configuration for a project identified by numeric identifier","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-project-config","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The maximum number of projects to return in each response (1-100).","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An opaque identifier generated by the API.","name":"start","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"List projects","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-projects","outputs":[{"contentPath":"","contextPath":"LGTM.project-list.data.id","description":"The numeric identifier of the project.","type":"Number"},{"contentPath":"","contextPath":"LGTM.project-list.data.url-identifier","description":"The URL identifier of the project.","type":"String"},{"contentPath":"","contextPath":"LGTM.project-list.data.name","description":"The display name of the project.","type":"String"},{"contentPath":"","contextPath":"LGTM.project-list.data.url","description":"The full URL of the project on LGTM.","type":"String"},{"contentPath":"","contextPath":"LGTM.project-list.nextPageUrl","description":"The URL to retrieve the next page of projects. Omitted if there is no next page.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Version information","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-version","outputs":[{"contentPath":"","contextPath":"LGTM.version.apiVersion","description":"The version number of the API.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The numeric project identifier.","name":"project-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The identifier of the commit to analyze.","name":"commit","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The language codes of the languages to analyze. For a list of available languages, see [Supported languages](https://lgtm.com/help/lgtm/analysis-faqs#which-languages-are-supported). To specify more than one language, this  meter can be repeated. If no language is specified, all the project's languages will be analyzed.","isArray":true,"name":"language","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Run analysis of a specific commit","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-request-analysis","outputs":[{"contentPath":"","contextPath":"LGTM.analysis.id","description":"LGTM request id","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.analysis.status","description":"LGTM analysis status","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.analysis_request.task-result.id","description":"LGTM analysis task id","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.analysis_request.task-result.commit-id","description":"LGTM analysis commit id","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The numeric project identifier.","name":"project-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The identifier for the base commit.","name":"base","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Your reference number for the code review.","name":"external-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The callback URL for LGTM to post to on completion of the review. When the code review is complete, the API sends an HTTP POST request to the callback URL with the result of the code review in the request body. The code review results in the request body are identical to the results accessed through the [`/codereviews/{review-id}`](https://lgtm.com/help/lgtm/api/api-v1#opIdgetCodeReview) end-point. If you specify a `callback-secret`, the request also includes an `x-lgtm-signature` header with a digital signature of the request's contents.","name":"callback-url","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The `callback-secret` is used to compute a signature which is included in the `x-lgtm-signature` header of the callback response. The receiver of the callback can check the validity of the response by computing the signature using HMAC-SHA1 and verifying that it matches the `x-lgtm-signature` header value. The HMAC algorithm requires byte sequences as inputs for both the secret and the message. The callback secret string must be converted to bytes using UTF-8 encoding. The response body should ideally be read as a plain byte sequence. Conversion to, for example a JSON object, and back to a byte sequence might change the formatting, and would invalidate the signature.","name":"callback-secret","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Entry ID of the Patch File , you can use git diff --binary to generate patch file","name":"patch-entry-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Run code review for a patch","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-request-review","outputs":[{"contentPath":"","contextPath":"LGTM.code_review_request.id","description":"LGTM Code Review request id","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.code_review_request.status","description":"LGTM Code Review request status","type":"Unknown"},{"contentPath":"","contextPath":"LGTM.code_review_request.task-result.id","description":"LGTM Code Review request task id","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The [language](https://lgtm.com/help/lgtm/analysis-faqs#which-languages-are-supported) you want to analyze.","name":"language","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The identifier of the project to analyze. Either `project-id` or `projects-list` must be specified.","isArray":true,"name":"project-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The CodeQL query stored in an XSOAR list","name":"query-list","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Run a CodeQL query on one or more projects","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-create-query-job","outputs":[{"contentPath":"","contextPath":"LGTM.Queries.task-result.id","description":"Query ID","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The identifier of the query job, from the `task-result` given in the response to the initial `POST /queryjobs` request.","name":"queryjob-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get the status of a query job","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-query-job","outputs":[{"contentPath":"","contextPath":"LGTM.queryjob.id","description":"The identifier for the QueryJob.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The identifier of the query job, from the `task-result` given in the response to the initial `POST /queryjobs` request.","name":"queryjob-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The identifier for the project.","name":"project-id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Start point for the page of results.","name":"start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The maximum number of results to display (less than 100).","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Include results that are not part of the source tree. These results are filtered out by default.","name":"nofilter","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Fetch the results of a query job for a specific project","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-query-job-results-for-project","outputs":[{"contentPath":"","contextPath":"LGTM.queryjob-project-results.data.line","description":"LGTM Query Job Project Data Line","type":"Number"},{"contentPath":"","contextPath":"LGTM.queryjob-project-results.data.file","description":"LGTM Query Job Project Data File","type":"String"},{"contentPath":"","contextPath":"LGTM.queryjob-project-results.data.value","description":"LGTM Query Job Project Data Value","type":"String"},{"contentPath":"","contextPath":"LGTM.queryjob-project-results.data.url","description":"LGTM Query Job Project Data URL","type":"String"},{"contentPath":"","contextPath":"LGTM.queryjob-project-results.next","description":"URL for retrieving the next part of the results (if applicable).","type":"String"},{"contentPath":"","contextPath":"LGTM.queryjob_project_results.project.id","description":"Project ID","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The identifier of the query job, from the `task-result` given in the response to the initial `POST /queryjobs` request.","name":"queryjob-id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Provide a summary of results for the projects in the query job","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"lgtm-get-query-job-results-overview","outputs":[{"contentPath":"","contextPath":"LGTM.queryjob-results-overview.data.status","description":"Describes whether the query was sucessfully executed against the project.","type":"String"},{"contentPath":"","contextPath":"LGTM.queryjob-results-overview.data.total","description":"Number of results returned by the query. This is  oken down further into `internal` and `external` results. Only applies if `status` is `success`.","type":"Number"},{"contentPath":"","contextPath":"LGTM.queryjob-results-overview.data.internal","description":"Number of results that refer to elements within the source tree. Only applies if `status` is `success`.","type":"Number"},{"contentPath":"","contextPath":"LGTM.queryjob-results-overview.data.external","description":"Number of results that refer to elements outside the source tree (e.g., li aries). Only applies if `status` is `success`.","type":"Number"},{"contentPath":"","contextPath":"LGTM.queryjob-results-overview.data.error","description":"Error message. Only applies if `status` is `error`.","type":"String"},{"contentPath":"","contextPath":"LGTM.queryjob-results-overview.next","description":"LGTM Query Job Results Overview Next","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.5.20070","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\nimport urllib3\n\n\n\nclass Client(BaseClient):\n    def __init__(self, server_url, verify, proxy, headers, auth):\n        super().__init__(base_url=server_url, verify=verify, proxy=proxy, headers=headers, auth=auth)\n\n    def abort_upload_request(self, session_id):\n        response = self._http_request('delete', f'snapshots/uploads/{session_id}')\n\n        return response\n\n    def add_project_request(self, repository, language, mode, commit, date, worker_label):\n        params = assign_params(repository=repository, language=language, mode=mode,\n                               commit=commit, date=date, worker_label=worker_label)\n        headers = self._headers\n        headers['Content-Type'] = 'application/x-yaml'\n        response = self._http_request('post', 'projects', params=params, headers=headers)\n\n        return response\n\n    def get_alerts_request(self, analysis_id, sarif_version, excluded_files):\n        params = assign_params(sarif_version=sarif_version, excluded_files=excluded_files)\n        response = self._http_request('get', f'analyses/{analysis_id}/alerts', params=params)\n\n        return response\n\n    def get_analysis_request(self, analysis_id):\n        response = self._http_request('get', f'analyses/{analysis_id}')\n\n        return response\n\n    def get_analysis_for_commit_request(self, project_id, commit_id):\n        response = self._http_request('get', f'analyses/{project_id}/commits/{commit_id}')\n\n        return response\n\n    def get_code_review_request(self, review_id):\n        response = self._http_request('get', f'codereviews/{review_id}')\n\n        return response\n\n    def get_project_request(self, project_id):\n        response = self._http_request('get', f'projects/{project_id}')\n\n        return response\n\n    def get_project_by_url_identifier_request(self, provider, org, name):\n        response = self._http_request('get', f'projects/{provider}/{org}/{name}')\n\n        return response\n\n    def get_project_config_request(self, project_id, source):\n        params = assign_params(source=source)\n        response = self._http_request(\n            'get', f'projects/{project_id}/settings/analysis-configuration', params=params, resp_type='text')\n\n        return response\n\n    def get_projects_request(self, limit, start):\n        params = assign_params(limit=limit, start=start)\n        response = self._http_request('get', 'projects', params=params)\n\n        return response\n\n    def get_version_request(self):\n        response = self._http_request('get', '')\n\n        return response\n\n    def request_analysis_request(self, project_id, commit, language):\n        params = assign_params(commit=commit, language=language)\n        response = self._http_request('post', f'analyses/{project_id}', params=params)\n\n        return response\n\n    def request_review_request(self, project_id, base, external_id,\n                               callback_url, callback_secret, patch_file):\n        params = {\n            \"base\": base,\n            \"external-id\": external_id,\n            \"callback-url\": callback_url,\n            \"callback-secret\": callback_secret\n        }\n        headers = self._headers\n        headers['Content-Type'] = 'application/octet-stream'\n        response = self._http_request('post', f'codereviews/{project_id}', params=params,\n                                      headers=headers, files=patch_file)\n\n        return response\n\n    def create_query_job_request(self, language, project_id, query):\n        parameters = {\n            'project-id': project_id,\n            'language': language\n        }\n        response = self._http_request('post', 'queryjobs', params=parameters, data=query)\n\n        return response\n\n    def get_query_job_request(self, queryjob_id):\n        response = self._http_request('get', f'queryjobs/{queryjob_id}')\n\n        return response\n\n    def get_query_job_results_for_project_request(self, queryjob_id, project_id, start, limit, nofilter):\n        params = assign_params(start=start, limit=limit, nofilter=nofilter)\n        response = self._http_request('get', f'queryjobs/{queryjob_id}/results/{project_id}', params=params)\n\n        return response\n\n    def get_query_job_results_overview_request(self, queryjob_id):\n        response = self._http_request('get', f'queryjobs/{queryjob_id}/results')\n\n        return response\n\n\ndef add_project_command(client, args):\n    repository = str(args.get('repository', ''))\n    language = argToList(args.get('language', []))\n    mode = str(args.get('mode', ''))\n    commit = str(args.get('commit', ''))\n    date = str(args.get('date', ''))\n    worker_label = argToList(args.get('worker-label', []))\n\n    response = client.add_project_request(repository, language, mode, commit, date, worker_label)\n    command_results = CommandResults(\n        outputs_prefix='LGTM',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_alerts_command(client, args):\n    analysis_id = str(args.get('analysis-id', ''))\n    sarif_version = str(args.get('sarif-version', ''))\n    excluded_files = argToBoolean(args.get('excluded-files', False))\n\n    response = client.get_alerts_request(analysis_id, sarif_version, excluded_files)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.alerts',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_analysis_command(client, args):\n    analysis_id = str(args.get('analysis-id', ''))\n\n    response = client.get_analysis_request(analysis_id)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.analysis_summary',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_analysis_for_commit_command(client, args):\n    project_id = args.get('project-id', None)\n    commit_id = str(args.get('commit-id', ''))\n\n    response = client.get_analysis_for_commit_request(project_id, commit_id)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.analysis_summary',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_code_review_command(client, args):\n    review_id = str(args.get('review-id', ''))\n\n    response = client.get_code_review_request(review_id)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.code_review_result',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_project_command(client, args):\n    project_id = args.get('project-id', None)\n\n    response = client.get_project_request(project_id)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.project_details',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_project_by_url_identifier_command(client, args):\n    provider = str(args.get('provider', ''))\n    org = str(args.get('org', ''))\n    name = str(args.get('name', ''))\n\n    response = client.get_project_by_url_identifier_request(provider, org, name)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.project_details',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_project_config_command(client, args):\n    project_id = args.get('project-id', None)\n    source = str(args.get('source', ''))\n\n    response = client.get_project_config_request(project_id, source)\n    human_readable = tableToMarkdown(t=response, name='Project Config', headers='Config')\n\n    command_results = CommandResults(\n        outputs_prefix='LGTM.config',\n        outputs_key_field='',\n        outputs=response,\n        readable_output=human_readable,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_projects_command(client, args):\n    limit = args.get('limit', None)\n    start = str(args.get('start', ''))\n\n    response = client.get_projects_request(limit, start)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.project_list',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_version_command(client, args):\n\n    response = client.get_version_request()\n    command_results = CommandResults(\n        outputs_prefix='LGTM.version',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef request_analysis_command(client, args):\n    project_id = args.get('project-id', None)\n    commit = str(args.get('commit', ''))\n    language = argToList(args.get('language', []))\n\n    response = client.request_analysis_request(project_id, commit, language)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.analysis_request',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef request_review_command(client, args):\n    project_id = args.get('project-id', None)\n    base = str(args.get('base', ''))\n    external_id = args.get('external-id', None)\n    callback_url = str(args.get('callback-url', ''))\n    callback_secret = str(args.get('callback-secret', ''))\n    patch_file_entry_id = args.get('patch-entry-id', None)\n\n    patch_file_info = demisto.getFilePath(patch_file_entry_id)\n    uploaded_patch_file = open(patch_file_info['path'], 'rb')\n    patch_file = {'file': (patch_file_info['name'], uploaded_patch_file)}\n\n    response = client.request_review_request(project_id, base, external_id, callback_url, callback_secret, patch_file)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.code_review_request',\n        outputs_key_field='id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef create_query_job_command(client, args):\n    language = str(args.get('language', ''))\n    project_id = argToList(args.get('project-id', []))\n    query = str(args.get('query-list', ''))\n\n    response = client.create_query_job_request(language, project_id, query)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.queryjob',\n        outputs_key_field='LGTM.queryjob.task-result.id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_query_job_command(client, args):\n    queryjob_id = str(args.get('queryjob-id', ''))\n\n    response = client.get_query_job_request(queryjob_id)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.queryjob',\n        outputs_key_field='LGTM.queryjob.id',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_query_job_results_for_project_command(client, args):\n    queryjob_id = str(args.get('queryjob-id', ''))\n    project_id = str(args.get('project-id', ''))\n    start = args.get('start', None)\n    limit = args.get('limit', None)\n    nofilter = argToBoolean(args.get('nofilter', False))\n\n    response = client.get_query_job_results_for_project_request(queryjob_id, project_id, start, limit, nofilter)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.queryjob_project_results',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef get_query_job_results_overview_command(client, args):\n    queryjob_id = str(args.get('queryjob-id', ''))\n\n    response = client.get_query_job_results_overview_request(queryjob_id)\n    command_results = CommandResults(\n        outputs_prefix='LGTM.queryjob_results_overview',\n        outputs_key_field='',\n        outputs=response,\n        raw_response=response\n    )\n\n    return command_results\n\n\ndef test_module(client):\n    # Test functions here\n    client.get_version_request()\n    demisto.results('ok')\n\n\ndef main():\n\n    params = demisto.params()\n    args = demisto.args()\n    url = params.get('url')\n    verify_certificate = not params.get('insecure', False)\n    proxy = params.get('proxy', False)\n    headers = {}\n    headers['Authorization'] = 'Bearer ' + f'{params[\"api_key\"]}'\n    headers['Content-Type'] = 'text/plain'\n\n    command = demisto.command()\n    LOG(f'Command being called is {command}')\n\n    try:\n        urllib3.disable_warnings()\n        client = Client(urljoin(url, \"\"), verify_certificate, proxy, headers=headers, auth=None)\n        commands = {\n            'lgtm-add-project': add_project_command,\n            'lgtm-create-query-job': create_query_job_command,\n            'lgtm-get-alerts': get_alerts_command,\n            'lgtm-get-analysis': get_analysis_command,\n            'lgtm-get-analysis-for-commit': get_analysis_for_commit_command,\n            'lgtm-get-code-review': get_code_review_command,\n            'lgtm-get-project': get_project_command,\n            'lgtm-get-project-by-url-identifier': get_project_by_url_identifier_command,\n            'lgtm-get-project-config': get_project_config_command,\n            'lgtm-get-projects': get_projects_command,\n            'lgtm-get-query-job': get_query_job_command,\n            'lgtm-get-query-job-results-for-project': get_query_job_results_for_project_command,\n            'lgtm-get-query-job-results-overview': get_query_job_results_overview_command,\n            'lgtm-get-version': get_version_command,\n            'lgtm-request-analysis': request_analysis_command,\n            'lgtm-request-review': request_review_command\n        }\n\n        if command == 'test-module':\n            test_module(client)\n\n        else:\n            return_results(commands[command](client, args))\n\n    except Exception as e:\n        return_error(str(e))\n\n\nif __name__ in ['__main__', 'builtin', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.2","modified":"2021-09-05T10:49:33.527836+03:00","name":"LGTM","packID":"DevSecOps","packPropagationLabels":["all"],"prevName":"LGTM","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"Mail server hostname or IP address","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"MailServerURL","options":null,"required":true,"type":0},{"defaultValue":"143","display":"IMAP port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"port","options":null,"required":true,"type":1},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9},{"defaultValue":"false","display":"Delete processed emails","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"deleteEmails","options":null,"required":false,"type":8},{"defaultValue":"INBOX","display":"Incoming mail folder","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"folder","options":null,"required":true,"type":0},{"defaultValue":"false","display":"Include raw body","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"includeRawBody","options":null,"required":false,"type":8},{"defaultValue":"","display":"Forward mails from this sender address only (eg. admin@demo.com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"permittedFromAdd","options":null,"required":false,"type":0},{"defaultValue":"","display":"Forward mails from this domain only (eg. demo.com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"permittedFromDomain","options":null,"required":false,"type":0},{"defaultValue":"","display":"Timezone of mail server in minutes e.g. for gmt +3 set +180 (set only if different than Cortex XSOAR server)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Timezone","options":null,"required":false,"type":0},{"defaultValue":"","display":"Use TLS for connection","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tls","options":null,"required":false,"type":8},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Filter by SINCE date for IMAP that supports it. Lotus Notes does not by default.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"filterByDate","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13}],"defaultClassifier":"mail-listener","defaultMapperIn":"mail-listener-mapper","definitionId":"","deprecated":true,"description":"Deprecated. Use the Mail Listener v2 integration instead.","display":"Mail Listener","fromServerVersion":"","hidden":false,"icon":"mail-listener.png","id":"mail-listener","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:27.836678+03:00","name":"mail-listener","packID":"","prevName":"mail-listener","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"Mail server hostname or IP address","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"MailServerURL","options":null,"required":true,"type":0},{"defaultValue":"25","display":"SMTP Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"smtpPort","options":null,"required":true,"type":1},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Sender address","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"from","options":null,"required":true,"type":0},{"defaultValue":"","display":"Use TLS for connection","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tls","options":null,"required":false,"type":8},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Mail Sender v2 integration instead.","display":"Mail Sender (Deprecated)","fromServerVersion":"","hidden":false,"icon":"mail-sender.png","id":"mail-sender","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.876005+03:00","name":"mail-sender","packID":"","prevName":"mail-sender","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"Mattermost server address (e.g. https://1.2.3.4:8065)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0},{"defaultValue":"","display":"Team name (e.g. my-team-name)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"teamName","options":null,"required":true,"type":0},{"defaultValue":"","display":"Personal Access Token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"accessToken","options":null,"required":true,"type":4},{"defaultValue":"general","display":"Notifications channel (You will need to invite the Demisto Bot user to this channel)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentNotificationChannel","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Should anyone be allowed to create incidents by DM","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"allowIncidents","options":null,"required":false,"type":8},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8}],"definitionId":"","description":"Send messages and notifications to your Mattermost Team","detailedDescription":"### To use the mattermost integration:\n\n1. Create a new Mattermost user (to act as the Mattermost Bot)\n2. Under \"Manage Members\", make it a Team Admin\n3. Create a Personal Access Token for the new account ([Detailed Instructions...](https://docs.mattermost.com/developer/personal-access-tokens.html))\n4. Copy the Access Token to the \"Personal Access Token\" field","display":"Mattermost","fromServerVersion":"","hidden":false,"icon":"mattermost.png","id":"mattermost","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:28.761621+03:00","name":"mattermost","packID":"","prevName":"mattermost","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"","display":"https://\u003caddress\u003e:port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"authentication","options":null,"required":true,"type":9},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13}],"definitionId":"","description":"McAfee ePolicy Orchestrator","detailedDescription":"Integration with Intel Security's ePolicy Orchestrator using the official API. ","display":"McAfee ePO","fromServerVersion":"","hidden":false,"icon":"","id":"epo V2","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"String to search for in help.","name":"search","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Command for which to print help.","name":"command","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Prints help (information) for ePO commands. If no command argument is specified, returns all ePO commands.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-help","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Checks the latest DAT file in the McAfee repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-latest-dat","outputs":[{"contentPath":"mcAfeeLatestDatVersion","contextPath":"McAfee.ePO.latestDAT","description":"Latest McAfee DAT file version.","type":"number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Checks the existing DAT file version in ePO.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-current-dat","outputs":[{"contentPath":"","contextPath":"McAfee.ePO.epoDAT","description":"Current McAfee DAT file in ePO repository","type":"number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Executes the ePO command. Receives the mandatory ''command'' argument, and other optional arguments. Run the ''epo-help'' command to get a list of available commands. You can also specify the ''headers'' argument to filter table headers. Example/:/ !epo-command command=system.find searchText=10.0.0.1 headers=EPOBranchNode.AutoID,EPOComputerProperties.ComputerName","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-command","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":true,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\n\nimport json\nimport urllib3\nimport traceback\nfrom typing import Any, Dict, Tuple, List, Optional, Union, cast\n\n# Disable insecure warnings\nurllib3.disable_warnings()\n\n''' CONSTANTS '''\n\nDATE_FORMAT = '%Y-%m-%dT%H:%M:%SZ'\nEPO_SYSTEM_ATTRIBUTE_MAP = {\n    'EPOComputerProperties.ComputerName': 'Name',\n    'EPOComputerProperties.DomainName': 'Domain',\n    'EPOComputerProperties.IPHostName': 'Hostname',\n    'EPOComputerProperties.IPAddress': 'IPAddress',\n    'EPOComputerProperties.OSType': 'OS',\n    'EPOComputerProperties.OSVersion': 'OSVersion',\n    'EPOComputerProperties.CPUType': 'Processor',\n    'EPOComputerProperties.NumOfCPU': 'Processors',\n    'EPOComputerProperties.TotalPhysicalMemory': 'Memory',\n}\n\n''' CLIENT CLASS '''\n\n\nclass Client(BaseClient):\n    def epo_help(self, sub_command: str) -\u003e json:\n        if sub_command:\n            params = {\n                \"command\": sub_command,\n                \":output\": \"json\"\n            }\n        else:\n            params = {\n                \":output\": \"json\"\n            }\n        return self._http_request(\n            'get',\n            url_suffix='core.help',\n            params=params,\n            resp_type='text'\n        )\n\n    @staticmethod\n    def parse_response(response: str):\n        \"\"\"\n        Parses the raw response returned from a remote command invocation, returning\n        its content, which is trimmed of leading and trailing whitespace.\n        The input will look like the following:\n\n        OK:\\r\\ntrue                                ----\u003e  returns \"true\"\n\n        or in the error case,\n\n        \"Error # :\\r\\nSome error string goes here  ----\u003e  throws CommandInvokerError(#, \"Some error string goes here\")\n\n        where # is the integer representing the error code returned.\n\n        @param s - the raw response from the server\n        @throws CommandInvokerError if the response from the server indicates an Error state\n        @returns response from the server stripped of the protocol\n\n        \"\"\"\n        demisto.debug(f'{response}')\n        res = {}\n        code = 0\n        try:\n            status = response[:response.index(':')].split(' ')[0]\n            result = response[response.index(':') + 1:].strip()\n            if status == 'Error':\n                code = int(response[:response.index(':')].split(' ')[1])\n            else:\n                code = 0\n            res = {'status': status, 'code': code, 'result': result}\n        except Exception as e:\n            # for thoroughness, in case there's no colon in the output or something else\n            # Or there was an error parsing the returned result from the server\n            res = {'status': 'Error', 'code': code, 'result': 'Unable to parse the server\\'s response'}\n            err_msg = 'Error in API call [{}] - {}' \\\n                .format(demisto.command, res['result'])\n            try:\n                # Try to parse json error response\n                error_entry = res.json()\n                err_msg += '\\n{}'.format(json.dumps(error_entry))\n                raise DemistoException(err_msg, res=res)\n            except ValueError:\n                err_msg += '\\n{}'.format(res.text)\n                raise DemistoException(err_msg, res=res)\n\n        if res['status'] == 'OK':\n            pass\n        elif res['status'] == 'Error':\n            raise DemistoException(res['result'], res=res)\n        else:\n            raise DemistoException('Unknown error occurred.  Status: (%s) Result: %s' % (res['status'], res['result']))\n        return res['result']\n\n    def call_epo(self, method='get', epo_command=None, params=None, full_url=None, url_suffix=None, resp_type='text'):\n        \"\"\"A wrapper for requests lib to communicate with ePO Server and handle requests and responses better.\n\n        :type method: ``str``\n        :param method: The HTTP method, for example: GET, POST, and so on.\n\n        :type epo_command: ``str``\n        :param epo_command: The ePO command to execute, for example: 'core.help' and so on.\n\n        :type params: ``dict``\n        :param params: URL parameters to specify the query.\n\n        :type url_suffix: ``str``\n        :param url_suffix: The API endpoint.\n\n        :type full_url: ``str``\n        :param full_url:\n            Bypasses the use of self._base_url + url_suffix. This is useful if you need to\n            make a request to an address outside of the scope of the integration\n            API.\n\n        :type resp_type: ``str``\n        :param resp_type:\n            Determines which data format to return from the HTTP request. The default\n            is 'json'. Other options are 'text', 'content', 'xml' or 'response'. Use 'response'\n             to return the full response object.\n\n        \"\"\"\n        try:\n            response = self._http_request(\n                method,\n                full_url=full_url,\n                url_suffix=epo_command,\n                params=params,\n                resp_type=resp_type\n            )\n            response = self.parse_response(response)\n            return response\n        except Exception:\n            raise\n\n    def epo_get_latest_dat(self, dat_url: str) -\u003e str:\n        return self._http_request(\n            'get',\n            full_url=dat_url,\n            resp_type='text'\n        )\n\n    def epo_get_current_dat(self) -\u003e str:\n        params = {\n            \"searchText\": \"VSCANDAT1000\"\n        }\n        return self._http_request(\n            'get',\n            url_suffix='repository.findPackages',\n            params=params,\n            resp_type='text'\n        )\n\n\n''' COMMAND FUNCTIONS '''\n\n\ndef test_module(client: Client) -\u003e str:\n    \"\"\"Tests API connectivity and authentication'\n\n    Returning 'ok' (case sensitive) indicates that the integration works like it is supposed to.\n    Connection to the service is successful.\n    Raises exceptions if something goes wrong.\n\n    :type client: ``Client``\n    :param Client: McAfeeEPO client to use\n\n    :return: 'ok' if test passed, anything else will fail the test.\n    :rtype: ``str``\n    \"\"\"\n\n    try:\n        client.call_epo(epo_command='core.help')\n    except DemistoException as e:\n        if 'Forbidden' in str(e):\n            return 'Authorization Error: make sure credentials are correctly set'\n        else:\n            raise e\n    return 'ok'\n\n\ndef epo_help(client: Client, args: Dict[str, Any]) -\u003e CommandResults:\n    try:\n        # raw_response = client.epo_help(sub_command=args['command'] if 'command' in args else '')\n        if 'command' in args:\n            params = {\n                \"command\": args['command'],\n                \":output\": \"json\"\n            }\n        else:\n            params = {\n                \":output\": \"json\"\n            }\n        raw_response = client.call_epo(epo_command='core.help', params=params)\n    except DemistoException as e:\n        if 'Forbidden' in str(e):\n            return 'Authorization Error: make sure API Key is correctly set'\n        else:\n            raise e\n    if 'command' in args:\n        arr_response = json.loads(raw_response)\n        readable_output = f\"#### ePO Help - {args['command']} \\n \"\n        for line in arr_response:\n            readable_output += line\n    else:\n        arr_response = json.loads(raw_response)\n        readable_output = f'#### ePO Help\\n'\n        for line in arr_response:\n            line = line.replace(\"\\r\\n\", ' ')\n            line = line.replace('\\n', ' ')\n\n            if ('search' not in args) or (args['search'].lower() and (args['search'].lower() in line.lower())):\n                desc = ''\n                cmd = ''\n                if '-' in line:\n                    desc = line.split('-')[1] if line.split('-')[1] else 'N/A'\n                    cmd = line.split('-')[0].rstrip() if line.split('-')[0] else 'N/A'\n                    readable_output += \"- **\" + cmd + \"** - \" + desc + '\\n'\n\n    return CommandResults(\n        readable_output=readable_output,\n        outputs_prefix='McAfeeEPO.Help',\n        outputs=raw_response\n    )\n\n\ndef epo_get_latest_dat_command(client: Client):\n    dat_file_url = 'http://update.nai.com/products/commonupdater/gdeltaavv.ini'\n    raw_response = client.epo_get_latest_dat(dat_url=dat_file_url)\n\n    latest_version = {\n        'LatestVersion': raw_response.split('\\r\\n\\r\\n')[0].split('CurrentVersion=')[1]\n    }\n\n    latest_dat_version = latest_version.get('LatestVersion')\n    readable_output = f'McAfee Latest DAT file version is: **' + latest_dat_version + '**\\n'\n    dat_ec = {\"latestDAT\": latest_dat_version}\n    ec = {\n        'mcafee(val.latestDAT \u0026\u0026 val.latestDAT == obj.latestDAT)': dat_ec,\n        \"McAfee.ePO.latestDAT\": latest_dat_version\n    }\n\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['markdown'],\n        'Contents': ec,\n        'HumanReadable': readable_output,\n        'EntryContext': ec\n    })\n\n    # return CommandResults(\n    #     readable_output=readable_output,\n    #     outputs_prefix='McAfeeEPO.LatestDat',\n    #     outputs_key_field='latest_version',\n    #     outputs=latest_version,\n    # )\n\n\ndef epo_get_current_dat_command(client: Client):\n    params = {\n        \"searchText\": \"VSCANDAT1000\"\n    }\n    url_suffix = 'repository.findPackages'\n\n    # raw_response = client.epo_get_current_dat()\n    raw_response = client.call_epo(epo_command=url_suffix, params=params)\n\n    current_version = {\n        'CurrentVersion': raw_response.split('productDetectionProductVersion: ')[1].split('.')[0]\n    }\n    current_dat_version = current_version.get('CurrentVersion')\n    readable_output = f'McAfee ePO Current DAT file version in repository is: **' + current_dat_version + '**\\n'\n    dat_ec = {\"epoDAT\": current_dat_version}\n    ec = {\n        'mcafee(val.epoDAT \u0026\u0026 val.epoDat == obj.epoDat)': dat_ec,\n        \"McAfee.ePO.epoDAT\": current_dat_version\n    }\n\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['markdown'],\n        'Contents': ec,\n        'HumanReadable': readable_output,\n        'EntryContext': ec\n    })\n\n    # return CommandResults(\n    #     readable_output=readable_output,\n    #     outputs_prefix='McAfeeEPO.CurrentDat',\n    #     outputs_key_field='current_version',\n    #     outputs=ec\n    # )\n\n\n# def epo_command_command(client, args: Dict[str, Any]) -\u003e CommandResults:\n#     params = {\":output\": \"json\"}\n#\n#     if 'command' not in args:\n#         raise DemistoException('ePO error: command argument is missing')\n#\n#     for key in args:\n#         if key != 'command' and key != 'headers':\n#             params[key] = args[key]\n#\n#     response = client.call_epo(epo_command=args['command'], params=params)\n#     demisto.debug('response: ' + response)\n#     dict_output = json.loads(response)\n#     if 'headers' in args:\n#         headers_list = list(args['headers'].split(','))\n#         md = tableToMarkdown('ePO command *' + args['command'] + '* results:', dict_output, headers_list)\n#     else:\n#         md = tableToMarkdown('ePO command *' + args['command'] + '* results:', dict_output)\n#\n#     contents = response\n#\n#     return CommandResults(\n#         readable_output=md,\n#         outputs_prefix='McAfeeEPO.cmd.output',\n#         outputs_key_field=''\n#     )\n\n\ndef epo_command_command(client, args: Dict[str, Any]) -\u003e CommandResults:\n    params = {\":output\": \"json\"}\n\n    if 'command' not in args:\n        raise DemistoException('ePO error: command argument is missing')\n\n    for key in args:\n        if key != 'command' and key != 'headers':\n            params[key] = args[key]\n\n    response = client.call_epo(epo_command=args['command'], params=params)\n    demisto.debug('response: ' + response)\n    md = \"#### ePO command *\" + args['command'] + \"* results:\\n\" + response\n    contents = {'result': response}\n    # try:\n    #     dict_output = json.loads(response)\n    #     if 'headers' in args:\n    #         headers_list = list(args['headers'].split(','))\n    #         md = tableToMarkdown('ePO command *' + args['command'] + '* results:', dict_output, headers_list)\n    #     else:\n    #         md = tableToMarkdown('ePO command *' + args['command'] + '* results:', dict_output)\n    # except Exception as e:\n    #     md = \"#### ePO command *\" + args['command'] + \"* results:\\n\" + response\n    #     contents = {'result': response}\n\n    contents = response\n\n    return CommandResults(\n        readable_output=md,\n        outputs_prefix='McAfeeEPO.cmd.output',\n        outputs_key_field=''\n    )\n\n\ndef main() -\u003e None:\n    \"\"\"main function, parses params and runs command functions\n\n    :return:\n    :rtype:\n    \"\"\"\n\n    # get the epo service url\n    base_url = urljoin(demisto.params()['address'], 'remote/')\n\n    verify_certificate = not demisto.params().get('insecure', False)\n\n    proxy = demisto.params().get('proxy', False)\n\n    demisto.debug(f'Command being called is {demisto.command()}')\n\n    try:\n        headers = {\n            'accept': \"application/json\"\n        }\n        client = Client(\n            base_url=base_url,\n            verify=verify_certificate,\n            headers=headers,\n            proxy=proxy,\n            auth=(demisto.params().get(\"authentication\", {}).get('identifier', ''),\n                  demisto.params().get(\"authentication\", {}).get('password', ''))\n        )\n        if demisto.command() == 'test-module':\n            # This is the call made when pressing the integration Test button.\n            result = test_module(client)\n            return_results(result)\n        elif demisto.command() == 'epo-help':\n            return_results(epo_help(client, demisto.args()))\n        elif demisto.command() == 'epo-get-latest-dat':\n            epo_get_latest_dat_command(client)\n        elif demisto.command() == 'epo-get-current-dat':\n            epo_get_current_dat_command(client)\n        elif demisto.command() == 'epo-command':\n            return_results(epo_command_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-update-client-dat':\n        #     return_results(epo_update_client_dat_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-update-repository':\n        #     return_results(epo_update_repository_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-get-system-tree-group':\n        #     return_results(epo_get_system_tree_group_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-find-systems':\n        #     return_results(epo_find_systems_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-wakeup-agent':\n        #     return_results(epo_wakeup_agent_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-apply-tag':\n        #     return_results(epo_apply_tag_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-clear-tag':\n        #     return_results(epo_clear_tag_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-get-tables':\n        #     return_results(epo - get - tables_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-query-table':\n        #     return_results(epo_query_table_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-get-version':\n        #     return_results(epo_get_version_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-move-system':\n        #     return_results(epo_move_system_command(client, demisto.args()))\n        # elif demisto.command() == 'epo-advanced-command':\n        #     return_results(epo_advanced_command_command(client, demisto.args()))\n        #     # Log exceptions and return errors\n    except Exception as e:\n        demisto.error(traceback.format_exc())  # print the traceback\n        return_error(f'Failed to execute {demisto.command()} command.\\nError:\\n{str(e)}')\n\n\n''' ENTRY POINT '''\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"","modified":"2021-09-07T11:20:36.201747+03:00","name":"epo V2","packID":"","prevName":"epo V2","propagationLabels":["all"],"shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":133},{"brand":"","canGetSamples":true,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"","display":"https://\u003caddress\u003e:port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"authentication","options":null,"required":true,"type":9},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"McAfee ePolicy Orchestrator","detailedDescription":"Integration with Intel Security's ePolicy Orchestrator using the official API. ","display":"McAfee ePO","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"epo","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"String to search for in help.","name":"search","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Command for which to print help.","name":"command","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Prints help (information) for ePO commands. If no command argument is specified, returns all ePO commands.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-help","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Checks the latest DAT file in the McAfee repository.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-latest-dat","outputs":[{"contentPath":"mcAfeeLatestDatVersion","contextPath":"McAfee.ePO.latestDAT","description":"Latest McAfee DAT file version.","type":"number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Checks the existing DAT file version in ePO.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-current-dat","outputs":[{"contentPath":"","contextPath":"McAfee.ePO.epoDAT","description":"Current McAfee DAT file in ePO repository","type":"number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A CSV list of IP addresses or system names.","name":"systems","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Number of times the server will attempt to send the task to the client. Default is 1 retry.","name":"retryAttempts","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Retry interval in seconds. Default is 30.","name":"retryIntervalInSeconds","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The threshold (in minutes) after which attempts to send the task to the client are aborted. Default is 5.","name":"abortAfterMinutes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The threshold (in minutes) that the client task is allowed to run. Defaults to 20.","name":"stopAfterMinutes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Duration (in minutes) over which to randomly spread task execution. Default is 0 (executes on all clients immediately).","name":"randomizationInterval","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Runs a client task to update the DAT file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-update-client-dat","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Triggers a server task in specific ePO servers to retrieve the latest signatures from the update server.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-update-repository","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"String to search for in the system tree group.","name":"search","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns system tree groups.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-system-tree-group","outputs":[{"contentPath":"","contextPath":"McAfee.ePO.SystemTreeGroups.groupId","description":"System tree group ID.","type":"number"},{"contentPath":"","contextPath":"McAfee.ePO.SystemTreeGroups.groupPath","description":"System tree group path.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"System tree group ID.","name":"groupId","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether to return all system data.","name":"verbose","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Finds computers within a specified group in the ePO tree.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-find-systems","outputs":[{"contentPath":"","contextPath":"Endpoint.Name","description":"Endpoint name","type":"string"},{"contentPath":"","contextPath":"Endpoint.Domain","description":"Endpoint domain.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Hostname","description":"Endpoint hostname.","type":"string"},{"contentPath":"","contextPath":"Endpoint.IPAddress","description":"Endpoint IP address.","type":"string"},{"contentPath":"","contextPath":"Endpoint.OS","description":"Endpoint OS.","type":"string"},{"contentPath":"","contextPath":"Endpoint.OSVersion","description":"Endpoint OS version.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Processor","description":"Processor model.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Processors","description":"Number of processors.","type":"number"},{"contentPath":"","contextPath":"Endpoint.Memory","description":"Endpoint memory.","type":"number"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Name","description":"Endpoint name.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Domain","description":"Endpoint domain.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Hostname","description":"Endpoint hostname.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.IPAddress","description":"Endpoint IP address.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.OS","description":"Endpoint OS.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.OSVersion","description":"Endpoint OS version.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Processor","description":"Processor model.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Processors","description":"Number of processors.","type":"number"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Memory","description":"Endpoint memory.","type":"number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Executes the ePO command. Receives the mandatory ''command'' argument, and other optional arguments. Run the ''epo-help'' command to get a list of available commands. You can also specify the ''headers'' argument to filter table headers. Example/:/ !epo-command command=system.find searchText=10.0.0.1 headers=EPOBranchNode.AutoID,EPOComputerProperties.ComputerName","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-command","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The command to execute. Run either th core.help command or the !epo-help to get all available commands.","name":"command","required":true,"secret":false},{"default":false,"deprecated":false,"description":"CSV list of key value pairs as additional arguments to pass, for example, \"argName1:argValue1,argName2:argValue2\".","name":"commandArgs","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Executes the ePO command. Run the ''epo-help'' command to get a list of available commands. For example/:/  !epo-advanced-command command=clienttask.find commandArgs=searchText:On-demand. You can also specify the ''headers'' argument to filter table headers, for example/:/ !epo-command command=system.find searchText=10.0.0.1 headers=EPOBranchNode.AutoID,EPOComputerProperties.ComputerName.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-advanced-command","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Agent hostname.","name":"names","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Wakes up an agent.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-wakeup-agent","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Hostnames on which to apply tags.","name":"names","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Tag name.","name":"tagName","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Applies a tag to hostnames.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-apply-tag","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Hostnames from which to clear tags.","name":"names","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Tag name.","name":"tagName","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Clears a tag from hostnames.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-clear-tag","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Table name","name":"target","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The columns to select, in SQUID syntax. Example: \"(select EPOEvents.AutoID EPOEvents.DetectedUTC EPOEvents.ReceivedUTC)\"","name":"select","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Filter results, in SQUID syntax. Example: \"(where ( eq ( OrionTaskLogTask .UserName \"ga\" )))\"","name":"where","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order in which to return the results, in SQUID syntax. Example: \"(order (asc OrionTaskLogTask.StartDate) )\")","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Group the results, in SQUID Syntax. Example: \"(group EPOBranchNode.NodeName)\"","name":"group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Perform join, in SQUID syntax.","name":"joinTables","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Name for the query to appear in the context","name":"query_name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Queries an ePO table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-query-table","outputs":[{"contentPath":"","contextPath":"McAfee.ePO.Query","description":"Query result.","type":""}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Name of the table.","name":"table","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns an ePO table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-tables","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Hostname to search.","name":"searchText","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether to print all system data.","isArray":true,"name":"verbose","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Finds systems in the system tree.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-find-system","outputs":[{"contentPath":"","contextPath":"Endpoint.Name","description":"Endpoint name.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Domain","description":"Endpoint domain.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Hostname","description":"Endpoint hostname.","type":"string"},{"contentPath":"","contextPath":"Endpoint.IPAddress","description":"Endpoint IP address.","type":"string"},{"contentPath":"","contextPath":"Endpoint.OS","description":"Endpoint OS.","type":"string"},{"contentPath":"","contextPath":"Endpoint.OSVersion","description":"Endpoint OS version.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Processor","description":"Processor model.","type":"string"},{"contentPath":"","contextPath":"Endpoint.Processors","description":"Number of processors.","type":"number"},{"contentPath":"","contextPath":"Endpoint.Memory","description":"Endpoint memory. '","type":"number"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Name","description":"Endpoint name.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Domain","description":"Endpoint domain.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Hostname","description":"Endpoint hostname.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.IPAddress","description":"Endpoint IP address.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.OS","description":"Endpoint OS","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.OSVersion","description":"Endpoint OS version","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Processor","description":"Processor model.","type":"string"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Processors","description":"Number of processors.","type":"number"},{"contentPath":"","contextPath":"McAfee.ePO.Endpoint.Memory","description":"Endpoint memory.","type":"number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Gets the ePO version. This requires global admin permissions.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-get-version","outputs":[{"contentPath":"","contextPath":"McAfee.ePO.Version","description":"ePO version","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Asset name.","name":"names","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Group ID.","name":"parentGroupId","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Moves a system to a different group.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"epo-move-system","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"//GLOBALS//\nvar serverUrl = params.address;\nif (serverUrl[serverUrl.length - 1] !== '/') {\n    serverUrl += '/';\n}\n\nvar EPO_SYSTEM_ATTRIBUTE_MAP = {\n    'EPOComputerProperties.ComputerName': 'Name',\n    'EPOComputerProperties.DomainName': 'Domain',\n    'EPOComputerProperties.IPHostName': 'Hostname',\n    'EPOComputerProperties.IPAddress': 'IPAddress',\n    'EPOComputerProperties.OSType': 'OS',\n    'EPOComputerProperties.OSVersion': 'OSVersion',\n    'EPOComputerProperties.CPUType': 'Processor',\n    'EPOComputerProperties.NumOfCPU': 'Processors',\n    'EPOComputerProperties.TotalPhysicalMemory': 'Memory',\n};\n\n//HELPER//\nfunction callEpo(pCommand, pArgs) {\n    var url = serverUrl + 'remote/' + pCommand;\n    url += encodeToURLQuery(pArgs);\n    url += (Object.keys(pArgs).length \u003e 0) ? '\u0026' : '?';\n    url += ':output=json';\n    var result = http(\n        url,\n        {\n            Method: 'GET',\n            Username: params.authentication.identifier,\n            Password: params.authentication.password\n        },\n        params.insecure,\n        params.proxy\n    );\n\n    if (isResponseOK(result)) {\n        trimmedRes = result.Body.substring(okStr.length);\n        trimmedRes = trimmedRes.replace('\\n',' ');\n        parsedRes = JSON.parse(trimmedRes);\n        return parsedRes;\n    } else if (result.StatusCode == 200){\n        throw 'Error accessing ePO interface. Command: ' + url + \". Body: \" + result.Body;\n    } else {\n        throw 'Error accessing ePO interface. Command: ' + url + \". Response: \" + JSON.stringify(result);\n    }\n}\n\nfunction doRawHttp(method, url, parameters, body) {\n    if (!parameters) {\n        parameters = {};\n    }\n    var result = http(\n        url + encodeToURLQuery(parameters),\n        {\n            Headers: {'Content-Type': ['application/json']},\n            Method: method,\n            Body: ''\n        },\n        params.insecure,\n        params.proxy\n    );\n    if (result.StatusCode \u003c 200 \u0026\u0026 result.StatusCode \u003e 299) {\n        throw 'Failed to perform request ' + url + encodeToURLQuery(parameters) + ', request status code: ' + result.StatusCode;\n    }\n    return result;\n}\n\nfunction isResponseOK(response) {\n    // EPO response if of format: OK -\u003e data. Error: error string\n    if (response.StatusCode === 200) {\n        okStr = 'OK:';\n        if (response.Body.indexOf(okStr) === 0) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction systemsToMd(systems,verbose) {\n    var i;\n    var md='';\n    if (verbose==\"true\") {\n        for (i=0;i\u003csystems.length;i++) {\n            md += systemToMd(systems[i],verbose);\n        }\n    } else {\n        var tmpHead='|';\n        var tmpLine='|';\n        for (var key in EPO_SYSTEM_ATTRIBUTE_MAP) {\n            tmpHead += EPO_SYSTEM_ATTRIBUTE_MAP[key] + '|';\n            tmpLine += '-|';\n        }\n        md += tmpHead + '\\n'+tmpLine+'\\n';\n        for (i=0;i\u003csystems.length;i++) {\n            md += systemToMd(systems[i],verbose);\n        }\n    }\n    return md;\n}\n\nfunction systemToMd(system,verbose) {\n    var md='';\n    var key;\n    if (verbose==\"true\") {\n        md += '#### '+ system[\"EPOComputerProperties.ComputerName\"]+'\\n';\n        md += \"Attribute|Value\\n-|-\\n\";\n        for (key in system) {\n            md += key +\"|\"+system[key]+\"\\n\";\n        }\n        md += \"---\\n\";\n    } else {\n        md +='|';\n        for (key in EPO_SYSTEM_ATTRIBUTE_MAP) {\n            md += system[key] +\"|\";\n        }\n        md += '\\n';\n    }\n    return md;\n}\n\n//COMMANDS//\nfunction epoHelp() {\n    var pArgs = {};\n    if (args.command) {\n        pArgs.command = args.command;\n    }\n    var readyRes = callEpo('core.help',pArgs);\n    var md;\n    var line;\n    var cmd;\n    var desc;\n\n    if (args.command) {\n        md = '#### ePO Help - ' + args.command + '\\n';\n        md += readyRes;\n    } else {\n        parsedRes = Array.isArray(parsedRes) ? parsedRes : [parsedRes];\n        md = '#### ePO Help\\n';\n        for (var i=0;i\u003cparsedRes.length;i++) {\n            line = parsedRes[i];\n            line = line.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n            if (!args.search || (args.search.toLowerCase() \u0026\u0026 line.toLowerCase().indexOf(args.search.toLowerCase())\u003e=0)) {\n                desc = line.split('-')[1] ? line.split('-')[1].trim() : 'N/A';\n                cmd = line.split('-')[0] ? line.split('-')[0].trim() : 'N/A';\n                md += '- **' + cmd + \"** - \" + desc + '\\n';\n            }\n        }\n    }\n    return {\n        Type: entryTypes.note,\n        Contents: readyRes,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoGetLatestDatRaw() {\n    var url = \"http://update.nai.com/products/commonupdater/gdeltaavv.ini\"\n    //Another option is to use avvdat.ini - provided here in case any additional data from that file is needed in the future\n    //var url = \"http://update.nai.com/Products/CommonUpdater/avvdat.ini\"\n    result = doRawHttp(\"GET\",url);\n    var res = '';\n    var sections = result.Body.split('\\r\\n\\r\\n');\n    var lines = sections[0].split('\\r\\n');\n    for (var i=0;i\u003clines.length;i++) {\n        if (lines[i].indexOf(\"CurrentVersion\")===0){\n            return lines[i].split('=')[1];\n        }\n    }\n    throw 'Cannot get McAfee latest DAT file version';\n}\n\nfunction epoGetLatestDat() {\n    var datVersion = epoGetLatestDatRaw();\n    var md='McAfee Latest DAT file version is: **' + datVersion + '**\\n';\n    ec = {};\n    ec.mcafee = {\"latestDAT\": datVersion};\n    return {\n        Type: entryTypes.note,\n        Contents: datVersion,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext: {\n                \"mcafee(val.latestDAT === obj.latestDAT)\": ec.mcafee, //backward compatability\n                \"McAfee.ePO.latestDAT\": datVersion\n        }\n    };\n}\n\nfunction epoGetCurrentDat() {\n    var pArgs = {\"searchText\":\"VSCANDAT1000\"};\n    var result = callEpo('repository.findPackages', pArgs);\n    if (result \u0026\u0026 result.length\u003e0) {\n        result = result[0];\n        var epoDAT = result.productDetectionProductVersion.split('.')[0];\n        ec = {};\n        ec.mcafee = {\"epoDAT\": epoDAT};\n        var md = \"McAfee ePO Current DAT file version in repository is: **\" + epoDAT + '**\\n';\n        return {\n            Type: entryTypes.note,\n            Contents: result,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: {\n                \"mcafee(val.epoDAT==obj.epoDAT)\": ec.mcafee, //backward compatability\n                \"McAfee.ePO.epoDAT\": epoDAT\n            }\n        };\n    } else {\n        throw 'Error getting current DAT version. Please check that the DAT file exists. Response: ' + JSON.stringify(result);\n    }\n}\n\nfunction epoUpdateClientDatTask() {\n    var pArgs = {'searchText': 'VSEContentUpdateDemisto'}; //need to configure this task in ePO beforehand\n    var result = callEpo('clienttask.find', pArgs);\n    if (result \u0026\u0026 Array.isArray(result)) {\n        result = result[0];\n    }\n    if (result) {\n          return result.objectId;\n        }\n         // If reached here then the response is an empty \"OK:\", which means VSEContentUpdateDemisto was not found in the server\n        throw 'Error getting DAT update task. It seems the task \"VSEContentUpdateDemisto\" is missing from the EPO server. Please contact support for more details';\n}\n\nfunction epoUpdateClientDat() {\n    var clientTask = epoUpdateClientDatTask();\n    var pArgs = {'names':args.systems, 'productId':'EPOAGENTMETA', 'taskId':clientTask};\n\n    var options = ['retryAttempts', 'retryIntervalInSeconds', 'abortAfterMinutes', 'stopAfterMinutes', 'randomizationInterval'];\n    for (var i=0;i\u003coptions.length;i++) {\n        if (args[options[i]]) {\n            pArgs[options[i]] = args[options[i]];\n        }\n    }\n    var result = callEpo('clienttask.run', pArgs);\n    var md = \"ePO client DAT update task started: \" + result;\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoUpdateRepository() {\n    var pArgs = {\n        'sourceRepository': 'McAfeeHttp',\n        'targetBranch':'Current'\n    };\n    var result = callEpo('repository.pull', pArgs);\n\n    var md = \"ePO repository update started.\\n\";\n    md += result;\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction prettifySystemTree(SystemTree) {\n    var prettySystemTree = [];\n    for (i=0; i \u003c SystemTree.length; i++) {\n        var system = SystemTree[i];\n        prettySystemTree[i] = {\n            'groupId': system.groupId,\n            'groupPath': system.groupPath\n        };\n    }\n    return prettySystemTree;\n}\n\nfunction epoGetSystemTreeGroups() {\n    var pArgs = {};\n    if (args.search) {\n        pArgs.searchText=args.search;\n    }\n    var result = callEpo('system.findGroups', pArgs);\n    if (result.length === 0) {\n        return 'System Tree Group was not found.';\n    }\n    var md = \"#### ePO System Tree groups\\n\";\n    md += \"Group ID | Group path\\n-|-\\n\";\n    for (var i=0;i\u003cresult.length;i++) {\n        md += result[i].groupId + \"|\" + result[i].groupPath + \"\\n\";\n    }\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext: {\n            \"McAfee.ePO(val.groupId==obj.groupId)\": {'SystemTreeGroups': prettifySystemTree(result)}\n        }\n    };\n}\n\nfunction epoGetSystemGroupPath(groupId) {\n    var result = epoGetSystemTreeGroups();\n    result = result.Contents;\n    for (var i=0;i\u003cresult.length;i++) {\n        if (groupId == result[i].groupId) {\n            return result[i].groupPath;\n        }\n    }\n    return null;\n}\n\nfunction prettifyFindSystem(FindSystem) {\n    var prettyFindSystem = [];\n    for (i=0; i \u003c FindSystem.length; i++) {\n        var system = FindSystem[i];\n        prettyFindSystem[i] = {\n            'Name': system['EPOComputerProperties.ComputerName'],\n            'Domain': system['EPOComputerProperties.DomainName'],\n            'Hostname': system['EPOComputerProperties.IPHostName'],\n            'IPAddress': system['EPOComputerProperties.IPAddress'],\n            'OS': system['EPOComputerProperties.OSType'],\n            'OSVersion': system['EPOComputerProperties.OSVersion'],\n            'Processor': system['EPOComputerProperties.CPUType'],\n            'Processors': system['EPOComputerProperties.NumOfCPU'],\n            'Memory': system['EPOComputerProperties.TotalPhysicalMemory'],\n        };\n    }\n    return prettyFindSystem;\n}\n\nfunction epoFindSystems() {\n    var name = epoGetSystemGroupPath(args.groupId);\n\n    if (!name) {\n        throw 'System Tree group not found';\n    }\n    var pArgs = {'groupId':args.groupId};\n    var result = callEpo('epogroup.findSystems', pArgs);\n    if (result) {\n        var md = '#### Systems in '+name+'\\n';\n        if (result.length\u003e0) {\n            md += systemsToMd(result,args.verbose);\n        } else {\n            md += 'No systems found\\n';\n        }\n        return {\n            Type: entryTypes.note,\n            Contents: result,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: {\n                'Endpoint(val.IPAddress==obj.IPAddress)': prettifyFindSystem(result),\n                'McAfee.ePO.Endpoint(val.IPAddress==obj.IPAddress)': prettifyFindSystem(result),\n            }\n        };\n    } else {\n        throw 'No systems found. Response: ' + JSON.stringify(result);\n    }\n}\n\nfunction epoFindSystem() {\n    var pArgs = {'searchText':args.searchText};\n    var result = callEpo('system.find', pArgs);\n    if (result) {\n        var md = '#### Systems in the System Tree\\n';\n        if (result.length\u003e0) {\n            md += systemsToMd(result,args.verbose);\n        } else {\n            md += 'No systems found\\n';\n        }\n        return {\n            Type: entryTypes.note,\n            Contents: result,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: {\n                'Endpoint(val.IPAddress==obj.IPAddress)': prettifyFindSystem(result),\n                'McAfee.ePO.Endpoint(val.IPAddress==obj.IPAddress)': prettifyFindSystem(result),\n            }\n        };\n    } else {\n        throw 'No systems found. Response: ' + JSON.stringify(result);\n    }\n}\n\nfunction epoWakeupAgent() {\n    var pArgs = {'names':args.names};\n    var result = callEpo('system.wakeupAgent', pArgs);\n\n    var md = \"ePO agent was awaken.\\n\";\n    md += result;\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoApplyTag() {\n    var pArgs = {\n        'names': args.names,\n        'tagName': args.tagName\n    };\n    var result = callEpo('system.applyTag', pArgs);\n\n    var md = \"ePO applied the tags on the hostnames successfully.\\n\";\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoClearTag() {\n    var pArgs = {\n        'names': args.names,\n        'tagName': args.tagName\n    };\n    var result = callEpo('system.clearTag', pArgs);\n\n    var md = \"ePO cleared the tags from the hostnames successfully.\\n\";\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoGetTables() {\n    var result;\n    var pArgs = {};\n    if (args.table) {\n        pArgs.table = args.table;\n    }\n\n    result = callEpo('core.listTables', pArgs);\n\n    var md = tableToMarkdown(\n            'ePO tables:',\n            Object.keys(result || {}).map(function (k) { return result[k]; }), // object keys\n            args.headers \u0026\u0026 args.headers.split(',')\n        );\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoQueryTable() {\n    var pArgs = {'target': args.target};\n    var result;\n    var ec = {};\n    var ec_key = '';\n    if (args.select) {\n        pArgs.select = args.select;\n    }\n    if (args.where) {\n        pArgs.where = args.where;\n    }\n    if (args.order) {\n        pArgs.order = args.order;\n    }\n    if (args.group) {\n        pArgs.group = args.group;\n    }\n    if (args.joinTables) {\n        pArgs.joinTables = args.joinTables;\n    }\n\n    result = callEpo('core.executeQuery', pArgs);\n\n    var md = tableToMarkdown(\n            'ePO Table Query:',\n            Object.keys(result || {}).map(function (k) { return result[k]; }), // object keys\n            args.headers \u0026\u0026 args.headers.split(',')\n        );\n\n    if (args.query_name) {\n        ec_key = 'McAfee.ePO.Query.' + args.query_name;\n    } else {\n        var ts = (new Date()).getTime() / 1000;\n        ec_key = 'McAfee.ePO.Query.' + ts;\n    }\n    ec[ec_key] = result;\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n}\n\nfunction epoGetVersion() {\n    var pArgs = {};\n    var result;\n\n    result = callEpo('epo.getVersion', pArgs);\n\n    var md = \"### ePO version is:\\n\" + result;\n    var ec = {\"McAfee.ePO.Version\": result};\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.text,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n\n}\n\nfunction epoMoveSystem() {\n    var pArgs = {\n        'names': args.names,\n        'parentGroupId': args.parentGroupId\n    };\n\n    var result;\n    result = callEpo('system.move', pArgs);\n\n    if (result === true) {\n        result = 'System ' + args.names + ' moved successfully to GroupId ' + args.parentGroupId;\n        return {\n            Type: entryTypes.note,\n            Contents: result,\n            ContentsFormat: formats.text,\n            HumanReadable: result\n        };\n    } else {\n        result = 'System ' + args.names + ' failed to move to GroupId ' + args.parentGroupId;\n        return {\n            Type: entryTypes.error,\n            Contents: result,\n            ContentsFormat: formats.text,\n            HumanReadable: result\n          };\n    }\n}\n\nfunction parseCommandArgs(command, commandArgs) {\n    //commandArgs should be in the format of:  keyName1:keyValue1, keyName2:KeyValue2\n    if (!commandArgs) {\n        return null;\n    }\n    var commandArgsDict = {};\n    commandArgsDict.command = command;\n    var commandArgsList = commandArgs.split(',');\n    var temp = [];\n    for (i=0; i \u003c commandArgsList.length; i++) {\n        //commandArgsVal in commandArgsList:\n        temp = commandArgsList[i].split(':');\n        commandArgsDict[temp[0]] = temp[1];\n    }\n    return commandArgsDict;\n}\n\nfunction epoCommand(parsedArgs) {\n    if (parsedArgs) {\n        args = parsedArgs;\n    }\n    var pArgs = {};\n    for (var key in args) {\n        if (key != 'command' \u0026\u0026 key != 'headers') {\n            pArgs[key] = args[key];\n        }\n    }\n    var result = callEpo(args.command, pArgs);\n\n    var md;\n    var contents;\n    if (typeof result === 'string') {\n        md = \"#### ePO command *\" + args.command + \"* results:\\n\" + result;\n        contents = {result: result};\n    } else {\n\n        md = tableToMarkdown(\n            'ePO command *' + args.command + '* results:',\n            Object.keys(result || {}).map(function (k) { return result[k]; }), // object keys\n            args.headers \u0026\u0026 args.headers.split(',')\n        );\n        contents = result;\n    }\n    return {\n        Type: entryTypes.note,\n        Contents: contents,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nswitch (command) {\n    // This is the call made when pressing the integration test button.\n    case 'test-module':\n        epoHelp();\n        return 'ok';\n\n    case 'epo-help':\n        return epoHelp();\n\n    case 'epo-get-latest-dat':\n        return epoGetLatestDat();\n\n    case 'epo-get-current-dat':\n        return epoGetCurrentDat();\n\n    case 'epo-update-client-dat':\n        return epoUpdateClientDat();\n\n    case 'epo-update-repository':\n        return epoUpdateRepository();\n\n    case 'epo-get-system-tree-group':\n        return epoGetSystemTreeGroups();\n\n    case 'epo-find-systems':\n        return epoFindSystems();\n\n    case 'epo-find-system':\n        return epoFindSystem();\n\n    case 'epo-wakeup-agent':\n        return epoWakeupAgent();\n\n    case 'epo-apply-tag':\n        return epoApplyTag();\n\n    case 'epo-clear-tag':\n        return epoClearTag();\n\n    case 'epo-get-tables':\n        return epoGetTables();\n\n    case 'epo-query-table':\n        return epoQueryTable();\n\n    case 'epo-get-version':\n        return epoGetVersion();\n\n    case 'epo-move-system':\n        return epoMoveSystem();\n\n\n    case 'epo-command':\n        if (!args.command) {\n            throw 'ePO error: command argument is missing';\n        }\n        return epoCommand(undefined);\n\n    case 'epo-advanced-command':\n        if (!args.command) {\n            throw 'ePO error: command argument is missing';\n        }\n        if (!args.commandArgs) {\n            throw 'ePO error: commandArgs argument is missing';\n        }\n        var parsedArgs = parseCommandArgs(args.command, args.commandArgs);\n        return epoCommand(parsedArgs);\n\n    default:\n        throw 'ePO Error: unknown command';\n}","subtype":"","type":"javascript"},"itemVersion":"1.0.2","modified":"2021-08-24T19:36:38.155385+03:00","name":"epo","packID":"epo","packPropagationLabels":["all"],"prevName":"epo","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Analytics \u0026 SIEM","commitMessage":"","configuration":[{"defaultValue":"","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ServerURL","options":null,"required":true,"type":0},{"defaultValue":"443","display":"Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"port","options":null,"required":false,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"Import alarms as incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tlsCheck","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Timezone of Nitro ESM server in minutes e.g. for gmt +3 set +180 (set only if different than Cortex XSOAR server)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"timezone","options":null,"required":false,"type":0}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the McAfee ESM v2 integration instead.","detailedDescription":"The integration pulls the Mcafee SIEM triggered alarms that are unacknowledged.\nAs soon as the instance is set-up, the first pull will get the alarms generated in the last 10 minutes. After that, new alarms will be fetched every other minute, starting the last pull index.","display":"McAfee ESM (Deprecated)","fromServerVersion":"","hidden":false,"icon":"mcafee.png","id":"esm","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.757931+03:00","name":"esm","packID":"","prevName":"esm","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Database","commitMessage":"","configuration":[{"defaultValue":"","display":"Server Name or Address (e.g. 8.8.8.8)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"server","options":null,"required":true,"type":0},{"defaultValue":"9000","display":"Port Number","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"port","options":null,"required":true,"type":0},{"defaultValue":"","display":"Access Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"access_key","options":null,"required":true,"type":4},{"defaultValue":"","display":"Access Secret","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"access_secret","options":null,"required":true,"type":4},{"defaultValue":"","display":"Connect over SSL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ssl","options":null,"required":false,"type":8}],"definitionId":"","description":"An Integration with MinIO Object Storage","detailedDescription":"### Community Contributed Integration\n #### Integration Author: Ayman Mahmoud\n No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).\n***\n## MinIO\nMinIO's high-performance object storage suite is software defined and enables customers to build cloud-native data infrastructure for machine learning, analytics and application data workloads.\n\n### Create a new MinIO User\nMinIO admin utility can be used to create a new user's access key and access secret, for more information.\nhttps://docs.minio.io/docs/minio-admin-complete-guide.html#user\n\n### URL\nThe Base URL of MinIO API : http://minio-server:9000\n\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/min-io)","display":"MinIO (Community Contribution)","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"MinIO","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a new bucket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-make-bucket","outputs":[{"contentPath":"","contextPath":"MinIO.Buckets.bucket","description":"MinIO Bucket Name","type":"Unknown"},{"contentPath":"","contextPath":"MinIO.Buckets.status","description":"MinIO Bucket Status","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Remove an existing bucket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-remove-bucket","outputs":[{"contentPath":"","contextPath":"MinIO.Buckets.bucket","description":"MinIO Bucket Name","type":"Unknown"},{"contentPath":"","contextPath":"MinIO.Buckets.status","description":"MinIO Bucket Status","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"List All MinIO Buckets","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-list-buckets","outputs":[{"contentPath":"","contextPath":"MinIO.Buckets","description":"MinIO Buckets","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Name of the bucket.","name":"bucket_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Object name starts with prefix.","name":"prefix","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List objects after this key name.","name":"start_after","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"MinIO specific flag to control to include user metadata.","name":"include_user_meta","predefined":["True","False"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Lists object information of a bucket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-list-objects","outputs":[{"contentPath":"","contextPath":"MinIO.Objects","description":"MinIO Objects","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"bucket_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Object Name","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Start byte position of object data.","name":"offset","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Number of bytes of object data from offset.","name":"length","predefined":[""],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Any additional headers to be added with GET request.","name":"request_headers","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Extra query parameters for advanced usage.","name":"extra_query_params","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets data from offset to length of an object.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-get-object","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"bucket_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Object Name","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Extra query parameters for advanced usage.","name":"extra_query_params","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get object information and metadata of an object.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-stat-object","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"bucket_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Object Name","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Remove an object.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-remove-object","outputs":[{"contentPath":"","contextPath":"MinIO.Objects.name","description":"Object Name","type":"Unknown"},{"contentPath":"","contextPath":"MinIO.Objects.status","description":"Object Status","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"bucket_name","predefined":[""],"required":true,"secret":false},{"default":false,"deprecated":false,"description":"File Entry ID","name":"entry_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"File Type","name":"content_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Any additional metadata to be uploaded along with your PUT request.","name":"metadata","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Uploads data from a file to an object in a bucket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-fput-object","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Bucket Name","name":"bucket_name","predefined":[""],"required":true,"secret":false},{"default":false,"deprecated":false,"description":"Contains object data","name":"data","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Object name in the bucket","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"File Type","name":"content_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Any additional metadata to be uploaded along with your PUT request.","name":"metadata","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Uploads data from a stream to an object in a bucket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"minio-put-object","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/minio:1.0.0.19143","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\nimport urllib3\nfrom minio import Minio\nimport io\n\n\nclass Client(Minio):\n    def __init__(self, endpoint, access_key, secret_key, secure=False):\n        super().__init__(endpoint=endpoint, access_key=access_key, secret_key=secret_key, secure=secure)\n\n\ndef make_bucket_command(client, args):\n\n    response = []\n\n    name = str(args.get('name', ''))\n\n    client.make_bucket(bucket_name=name)\n\n    response.append({\n        'bucket': name,\n        'status': 'created'\n    })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Buckets',\n        outputs_key_field='bucket',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef remove_bucket_command(client, args):\n\n    response = []\n    name = str(args.get('name', ''))\n\n    client.remove_bucket(bucket_name=name)\n    response.append({\n        'bucket': name,\n        'status': 'removed'\n    })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Buckets',\n        outputs_key_field='bucket',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef list_buckets_command(client, args):\n    response = []\n    buckets = client.list_buckets()\n\n    for bucket in buckets:\n        response.append({\n            'bucket': bucket.name,\n            'creation_date': str(bucket.creation_date)\n        })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Buckets',\n        outputs_key_field='bucket',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef list_objects_command(client, args):\n    response = []\n\n    bucket_name = str(args.get('bucket_name'))\n    prefix = args.get('prefix')\n    start_after = args.get('start_after')\n    include_user_meta = args.get('include_user_meta', False)\n\n    objects = client.list_objects(bucket_name=bucket_name, prefix=prefix, start_after=start_after,\n                                  include_user_meta=include_user_meta)\n\n    for stored_object in objects:\n        response.append({\n            'bucket': bucket_name,\n            'object': stored_object.object_name,\n            'is_dir': stored_object.is_dir,\n            'size': stored_object.size,\n            'etag': stored_object.etag,\n            'last_modified': str(stored_object.last_modified)\n        })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Objects',\n        outputs_key_field='bucket,object',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef get_object_command(client, args):\n    response = None\n\n    bucket_name = str(args.get('bucket_name'))\n    object_name = str(args.get('name'))\n    offset = int(args.get('offset', 0))\n    length = int(args.get('length', 0))\n    extra_query_params = args.get('extra_query_params', None)\n    request_headers = args.get('request_headers', None)\n    object_bytes = None\n    try:\n        response = client.get_object(\n            bucket_name=bucket_name,\n            object_name=object_name,\n            offset=offset,\n            length=length,\n            extra_query_params=extra_query_params,\n            request_headers=request_headers\n        )\n        object_bytes = response.read()\n    finally:\n        if response:\n            response.close()\n            response.release_conn()\n\n    return fileResult(filename=object_name, data=object_bytes)\n\n\ndef stat_object_command(client, args):\n\n    response = []\n    bucket_name = str(args.get('bucket_name'))\n    object_name = str(args.get('name'))\n    extra_query_params = args.get('extra_query_params', None)\n\n    object_stats = client.stat_object(bucket_name=bucket_name, object_name=object_name,\n                                      extra_query_params=extra_query_params)\n\n    response.append({\n        'bucket': bucket_name,\n        'object': object_name,\n        'content-type': object_stats.metadata.get('Content-Type'),\n        'etag': object_stats.metadata.get('ETag'),\n        'size': object_stats.size\n    })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Objects',\n        outputs_key_field='bucket,object',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef remove_object_command(client, args):\n\n    response = []\n    name = str(args.get('name', ''))\n    bucket_name = str(args.get('bucket_name', ''))\n\n    client.remove_object(object_name=name, bucket_name=bucket_name)\n    response.append({\n        'bucket': bucket_name,\n        'object': name,\n        'status': 'removed'\n    })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Objects',\n        outputs_key_field='bucket,object',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef fput_object_command(client, args):\n\n    response = []\n    bucket_name = str(args.get('bucket_name', ''))\n    entry_id = args.get('entry_id', '')\n    content_type = args.get('content_type', 'application/octet-stream')\n    metadata = args.get('metadata', None)\n\n    get_file_path_res = demisto.getFilePath(entry_id)\n    object_path = get_file_path_res[\"path\"]\n    object_name = get_file_path_res[\"name\"]\n\n    client.fput_object(object_name=object_name, bucket_name=bucket_name,\n                       file_path=object_path, content_type=content_type,\n                       metadata=metadata)\n\n    response.append({\n        'bucket': bucket_name,\n        'object': object_name,\n        'status': 'uploaded'\n    })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Objects',\n        outputs_key_field='bucket,object',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef put_object_command(client, args):\n\n    response = []\n    bucket_name = str(args.get('bucket_name', ''))\n    object_name = str(args.get('name'))\n    data_bytes = args.get('data').encode('utf-8')\n    content_type = args.get('content_type', 'application/octet-stream')\n    metadata = args.get('metadata', None)\n\n    data = io.BytesIO(data_bytes)\n\n    client.put_object(object_name=object_name, bucket_name=bucket_name,\n                      data=data, content_type=content_type,\n                      metadata=metadata, length=len(data_bytes))\n\n    response.append({\n        'bucket': bucket_name,\n        'object': object_name,\n        'status': 'uploaded'\n    })\n\n    command_results = CommandResults(\n        outputs_prefix='MinIO.Objects',\n        outputs_key_field='bucket,object',\n        outputs=response,\n        raw_response=response,\n    )\n\n    return command_results\n\n\ndef test_module(client):\n    # Test functions here\n    client.list_buckets()\n    demisto.results('ok')\n\n\ndef main():\n\n    params = demisto.params()\n    args = demisto.args()\n\n    server = params.get('server')\n    port = params.get('port', '9000')\n    access_key = params.get('access_key')\n    access_secret = params.get('access_secret')\n    secure_connection = params.get('ssl', False)\n\n    endpoint = server + \":\" + port\n\n    command = demisto.command()\n\n    LOG(f'Command being called is {command}')\n\n    try:\n        urllib3.disable_warnings()\n        client = Client(\n            endpoint=endpoint,\n            access_key=access_key,\n            secret_key=access_secret,\n            secure=secure_connection\n        )\n        commands = {\n            'minio-make-bucket': make_bucket_command,\n            'minio-remove-bucket': remove_bucket_command,\n            'minio-list-buckets': list_buckets_command,\n            'minio-list-objects': list_objects_command,\n            'minio-get-object': get_object_command,\n            'minio-stat-object': stat_object_command,\n            'minio-remove-object': remove_object_command,\n            'minio-fput-object': fput_object_command,\n            'minio-put-object': put_object_command\n        }\n\n        if command == 'test-module':\n            test_module(client)\n\n        else:\n            return_results(commands[command](client, args))\n\n    except Exception as e:\n        return_error(str(e))\n\n\nif __name__ in ['__main__', 'builtin', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.2","modified":"2021-09-05T10:49:33.527055+03:00","name":"MinIO","packID":"DevSecOps","packPropagationLabels":["all"],"prevName":"MinIO","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":false,"category":"Database","commitMessage":"","configuration":[{"defaultValue":"","display":"DB Address (ip:port) , If ip is a literal IPv6 address, it must be enclosed in square brackets","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"username","options":null,"required":true,"type":0},{"defaultValue":"","display":"Password","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"password","options":null,"required":true,"type":4},{"defaultValue":"","display":"Database Name","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"dbname","options":null,"required":false,"type":0},{"defaultValue":"tcp","display":"Protocol - tcp","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"protocol","options":null,"required":true,"type":0},{"defaultValue":"","display":"Connection params, format : param1=value1\u0026...\u0026paramN=valueN","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"params","options":null,"required":false,"type":0},{"defaultValue":"","display":"Full path for CA certificate of MySQL server (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"cafile","options":null,"required":false,"type":0},{"defaultValue":"","display":"Full path for Client certificate for MySQL server (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"clientcert","options":null,"required":false,"type":0},{"defaultValue":"","display":"Full path for Client certificate key for MySQL server (type pem)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"clientkey","options":null,"required":false,"type":0}],"definitionId":"","deprecated":true,"description":"Deprecated. Use The Generic SQL integration instead.","detailedDescription":"Use to query MySQL Database, using a remote (TCP) connection to the DB.","display":"MySQL (Deprecated)","fromServerVersion":"","hidden":false,"icon":"mysql.png","id":"mysql","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.440436+03:00","name":"mysql","packID":"","prevName":"mysql","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Vulnerability Management","commitMessage":"","configuration":[{"defaultValue":"","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Address","options":null,"required":true,"type":0},{"defaultValue":"3780","display":"Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Port","options":null,"required":true,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9},{"defaultValue":"1.2","display":"API Version","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Version","options":null,"required":true,"type":0},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"IgnoreTls","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Rapid7 Nexpose integration instead.","display":"Nexpose (Deprecated)","fromServerVersion":"","hidden":false,"icon":"rapid7.png","id":"nexpose","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.034997+03:00","name":"nexpose","packID":"","prevName":"nexpose","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Forensics \u0026 Malware Analysis","commitMessage":"","configuration":null,"definitionId":"","description":"OSX Collector","display":"OSX Collector","fromServerVersion":"","hidden":false,"icon":"osxcollector.png","id":"osxcollector","image":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAQCAYAAADdw7vlAAAM5UlEQVR42tWZe3DU1RXHCSGkBBq0yIwoYEEMIqAiiDwEtKCBkA3Z7Ht/799vd3+7mwAFsQiIo8VHADUWQREUdVpIVRQYazFABUcqyGjxQX1BEa11tPhCWl8g28/dbHaym92If+SPZubO7t577rnnnO953ZtOLX/hcLgg4PMNiOl6fVhR9oZk+TVb11+L6vo2W1UjtZbVu1OOP3vs2L7QLIf2ecaeqKZtZb9lSFJpRNdvjShKraBjbkFUVTcw1qfGOkZDRNOGRGS5q60oOr8bxVqK7gnmZPYXt5wF784hRbmYc+61Ne0l5NoTU5TnmL8F+p7IHmBtWUjTSjqdxl+N01kWN4wtMU1rYu/b8LGS5yjKIObuQq8mznkFngsYRZ3+X/9Mn68gattVKPPZrHD4mTGXXz6gZc0yjDEY4W91odCByunTR7XeV1VZ2T9qGC+FVTXcMuesqupVZ5rLmX+V8Z0dDi9JOkJ1dRkGuzNmGN8wEhHDqAeIgcFgMAmGoeu9oqa5EJoEjvEJ4C2xdD0tBwYuBADNNoyjfL8lIknJfZGxY7vZodB8ZH8dvocZm+BxWgAfPniwq6+iYmjcNNdEkck2zQVJe7hcxTjSuTYywu8HeN/P6NoRtufcEkb3DgXY8vunCMMSMdtyrWPQ84SHA/S/4pZ1YdKwRBNz94nozbUnpKqLhXEw/pKMeUVZKwBGqe0YsLj1GryqanX9fZ/bXZPNDwN74rr+Pec25DqPeTVmWSfguxl5z/gp+gPw1BTAizLkUbVByPoJZz/QUQCjc5iz53cYuGHT7AVwh1DkGFFzbT66GOkWulMI86TX4+kuy3IRez4ApKqcAAeDZ5PmDmCYFSHdKGiZDzocpZrXe0CAjLMsSCsaifRG2U2kx1uzeYk1zn2Ps76NxmJ9cp0n+3w9LUV5GjlfJF33/okATxcAw//GDNvI0mD4dSjAEQJBlJWOA9gwNGFsjPtWWNe7teNpYwSgKJyQAoGRUjD4c76fjJjm7fn22F7vKgD7XTQYyKhfDfX1v8Ko35DKv6oqLx8p5ups+zqMvI003CZdWbIsnOskDrgjGg4X5zvPUVFhzbSs5+OaNuCn2AC9cgJsqsGyqNFxANuyfBbl6K9kjps7DGAU25oCeHt7dNTZUmheF7SMxW6PpwSAvyRtHotYlgUwl2Cg0gwFAsEJqtdVHnRObwNKrareAcgJyeXaPXzIkGnU/p1xVb0ymy7g93cJa9q+GLQAXE8Zydvs+F2ui+OkO2Qpa5mbFQpddNkll3g1ny9YZxg+1oblcN6cAEdlOW8EQz+cTOHRfT6HLklOeAzK5stZRWSxqXIgEDA0TWZPOaWkC/OF8Luazw1CL/Y28tvLUKG5MCPCFWX0sMGD/eguU4Lcmiz/Mu2YHk8Z9CYZIAgmV/NZCK8z4VMdY0RFqUKBD2PNqXdDewDPMs3OGO/lVP18UvH7SxCwnu9CQDHe4fsjUcuaA/NKlD+33dSEg4hOmO48cV08/ncrEJiTxwHP48x3GQLgmQBcmI+nUJD13pzdPWWca2pNc5dj6tRHRU+gBQJrkXmXriiV2QCztw3Adh6AiTqHuF3EQ6H6kCTVyjU1a3W//2my2RWtUm8v0Ylz3rZaw7gT+tsYO9m7mKzWE37X8/vNWLPt3uD3Q3w+qwQCVYaiJEsavIPweJG+ZRX63xQNBjdYqvqs0+kcmwTY7b6KxnSzkJ31g/AeAr+F7HkhxfdmYZSvWTyJIKt/LNqJthcBRBhiJ0xKbEk6Ayb3YIj3Fbc7IdYEECl+z3oqKyOHDh4sbid7XMb+Y3WWdVzyeKbmooHPWPi9nwJYB8DOp1V6NG0wvI/OikQezmrW7kf5T5VgcHD+FJ0fYGQYDN1HpNUVrWnvveuuzXogsJ/rYJ8UwHci+4kwpa2FBpttEefggGNSDlnBSDAWi9/YL92rhAxD6H0iLMsL0zo5HIWc2wTPg9i7Xys7Ps7YDZ8G9F6IzNcks6PT+XwnhD0uIpjDH/kxo8lu9x4BIobbQapJR9Ki2bMnPdnYOJ909QdxPYqjhDjACAQSKxsabtiycWOPXPzosAfC6z9xlKTOvuCqntGmgWJtvKj9KceJME4PYMNYKfbQlY/Mitb+UWRDznU5m6z8ABcBbhfGMuaOR3SlbxbAXhN9w16vi2wk9PocgH8vskrKUbvB48/MH+b6NyzlWFNT5y7M0Rc0Qf8NWSfjRhDS9SlJW4TDi9NyAizjHwIXnYwXJjXzjrHkT5s2TRYp+o3kBkXZ2p7BiIQiDLFf0JIK1uFZQxD60owa6HD0oKYMB6waQ5ZXEpknDb//mKO8/NIcKboI2k0Y7Bbh2XHToqs2luUA+ALOPJSUUVVvoo52aU/OEJEmFMRwuxjH2Dcow3AYGp2PQfN2uh84XYC5XzOwgX7UphjWGqYzjK5STU01KboRPgkidz79ip3qGeKRVEnhewFjCPsnpWUhgnOVBqK3G3J/iKxvsf9nWRltKPMJms0trQAW7w7i7EWmLBdnX39WC+OhzMvtGQ4Fz4buTUHLd50IdsH4j/noaSyKqT3LeSBJVFdVuXN0kHMj4fBGHjwKibLRMdP6FCG/jPg8GdcuXte6YrBX4s21fpXb6Wy3m0UuL3RKDID5PMLn+a3X4dMDnT/AWd+badtFKRucFsAYtwfj3/D81Nb0ecj+a8ZcssUcHOYOavD9yDoeQy8XdkKWICmzoL3uXTgCUXpjlq37RikDnL0Xhy7JBpjxQ8zQ/hLXg8lshtzLRFaiZjvaerzff0WqSfrADgYHtmM4TwwAoPuSGtKfKHYjxFFL0/I+KuBpY7gKfQHAngwhJelivHlfZOLEZCPmcrkKJb9/dp1I/wLMQOCCjGsSd2OAOSFAKS8vz3uVUyTpHErIInqFSUTUM/A75nW5yjL0leUSIu04Neytvn36JA00NxZrNrTf3z7ARDDjHVEyAPQ8Xvl+kRq9iLpSRtJhRCRBI2prFDvlLSmiBiteb2LdmjXpcw2fbzQPT/1Yey9OE8aVNAPgsCQNR9ZTpiJv8biqk86Do4pnVZHhJrZ9xfJ6i2xqhRAIZa5vp2lZz7pIz3MZBQyXeKlifm1eBQxjGjQH6GAnpM+rqSkE+J00aFprWldNTSkgPiEEBcgVYa5H6bMDAdH6J7OHKUmV+c4LBgKaUlOzdOuWLV0eXL36AUuSEo7KyowaTF8wYCaOVFNR8XjLHFlmuuLxJJ7auDEDYGQsywBYVbtiRGGrLwDg8jZBQL2n4x1lNwfDf6F/lLl0ivW63QV00GVE4LhUc1TpnzEjsaOpKf2ChhxLTa93YFRRt7P+LdfRzBocCHAzwBklKf3+MHHcuLtnRyIiSK/MDYSq9uXQPeJZLhcRURpB0VPcC9cQyaViLgXwKZRJhKijeTx0M958N1kiqaRJg0QX/LDoDsXrVA4DjWLtCEB/HfL5/FnRNJ6zPo6TaVB8ZJu9Xu8kouoh7/TpI8Tvpx57bAQvZp9h8NvpBwpaybSE8RVp8cJWjde0gNOZ2Ld37w057sFH4bs67UQ+32XI8AM8nkbe1nzPwqEfYs5BWSmhF9gB3++ETmmAPR5xdVpPGu+XynCTsX1iXl1dsuGbHYv14qy7LVUawCPLRB5ZvieAzFZZtBj69ew7zFt8uiEdNnTo8jnxuAjQK/I/eAAyQj6KkP+EcBmflRxWw6vQYzD9CGEXo3DPVmB4oPscAF3QroRmNwBEoZvMp8x4BkM0INSZKWMtYK65WWKQZl4AqLmpGtiNs12MTfHUPyNwuC+gfwR+/Vq9aI3g93MoKKJqFTQWvzUbYImMRmQY4a2sTBp9Y2NjAWm4ivVDokaFmh8ZRKp/N0JTlbqWiL5iKTT7hKNeV1v7NkZeisOOorZazO0WsnDeUc66hyvQSI/XW8Cnjz0fc+7LfN4IzW/RpQknU6IOR9KZuWufH+UObtMsYSuRQucjXxN0fgAuSEXwGejeiA2/pwxtF12wqevVqqoWGmqwIKapJjRHmJ+H/KIhewB+ryNXEkiRRchID5OpjpD1BMC7kGUFvEbRbHXO1YEWa4oyDMKZ0WaQ671Op/7q/v39H7zvvi5Zz4cXINi1jIIwXZ+uqsNgLrHnNxhEV/3+YRyU7ui4I47CSFNR8hrGFPHJxX100llkuQvd4pD0mhjwJtqvInJLs645JWSEcTblBAe8TciqBgKTvKT4bH1UUqLJtYE9bgCbZ4tPn68vACcNTLrtgWNPajkTGabgBBMVWe6DgS6NZsozifR4dlJ3t7uzPWFCf9u2DeH48FXhP8D2eDJsFBk/vrvt801D73nwrsUxLsJGhVlZrhTAKmlINdeMGYN9Pl96HYALuXKVYVM5jPyAX0GfcVarzHsOvMsZLTKK4JqMo/XhlpLU8X/S+8TKhGexDgAAAABJRU5ErkJggg==","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:28.171665+03:00","name":"osxcollector","packID":"","prevName":"osxcollector","readonly":true,"shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"APIKey","options":null,"required":true,"type":4},{"defaultValue":"","display":"Subdomain","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"subdomain","options":null,"required":true,"type":0},{"defaultValue":"","display":"Service Key (for triggering events only)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"serviceKey","options":null,"required":false,"type":4}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the PagerDuty v2 integration instead.","display":"PagerDuty (Deprecated)","fromServerVersion":"","hidden":false,"icon":"pagerduty.png","id":"pagerduty","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.79845+03:00","name":"pagerduty","packID":"","prevName":"pagerduty","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"https://autofocus.paloaltonetworks.com/","display":"Server URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"server","options":null,"required":true,"type":0},{"defaultValue":"v1.0","display":"Version","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"version","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apiKey","options":null,"required":true,"type":4},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Palo Alto Networks AutoFocus v2 integration instead. Palo Alto Networks AutoFocus enables you to distinguish the most important threats from everyday commodity attacks.","detailedDescription":"Step 1: Login and add your authorization code\n1. Visit [PAN support](https://support.paloaltonetworks.com).\n2. Select the Assets \u003e Site Licenses tab.\n3. Select Add Site License.\n4. Enter the authorization code.\nStep 2: Activate the API.\n1. Select the Enable action in Site Licenses.\n2. Select the API Key link.\n\nThe API key appears onscreen as shown below. Use this API\nkey for all AutoFocus API requests","display":"Palo Alto AutoFocus (Deprecated)","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Autofocus","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"auto":"PREDEFINED","default":false,"defaultValue":"public","deprecated":false,"description":"The scope for the search","name":"scope","predefined":["private","public","global"],"required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"Number of results","name":"size","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Sample number to start from","name":"from","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Sort field","name":"sort","predefined":["app_name","app_packagename","filetype","size","finish_date","create_date","update_date","md5","sha1","sha256","ssdeep"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Order of sort","name":"order","predefined":["asc","desc"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to retrieve samples","name":"query","required":true,"secret":false},{"default":false,"defaultValue":"3","deprecated":false,"description":"Time to sleep between checking for results","name":"sleep","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Number of checks before giving up on the query","name":"checks","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The af_cookie for retrieving previous search results","name":"cookie","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search for samples on Autofocus","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-search-samples","outputs":[{"contentPath":"","contextPath":"Autofocus.Cookie","description":"The cookie for the results","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.id","description":"ID of sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.md5","description":"MD5 of the sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.sha1","description":"SHA1 of the sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.sha256","description":"SHA256 of the sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.app_name","description":"Application name (if exists)","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.size","description":"The size of the sample","type":"number"},{"contentPath":"","contextPath":"Autofocus.Samples.ssdeep","description":"SSDeep of the sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.create_date","description":"The create date for the sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.finish_date","description":"The finish date for the sample","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.malware","description":"A flag (0/1) if this is malware","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.app_packagename","description":"The sample package name (if exists)","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.filetype","description":"The sample type","type":"string"},{"contentPath":"","contextPath":"Autofocus.Samples.region","description":"Where have we seen this sample","type":"number"},{"contentPath":"","contextPath":"Autofocus.Samples.tag","description":"Sample tags","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"50","deprecated":false,"description":"Number of results","name":"size","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Sample number to start from","name":"from","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Sort field","name":"sort","predefined":["app","device_country","device_countrycode","device_hostname","device_serial","vsys","dst_country","dst_countrycode","dst_ip","dst_port","emailsbjcharset","device_industry","src_country","src_countrycode","src_ip","src_port","sha256","tstamp","upload_src"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Order of sort","name":"order","predefined":["asc","desc"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to retrieve samples","name":"query","required":true,"secret":false},{"default":false,"defaultValue":"3","deprecated":false,"description":"Time to sleep between checking for results","name":"sleep","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Number of checks before giving up on the query","name":"checks","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The af_cookie for retrieving previous search results","name":"cookie","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search for sessions on Autofocus","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-search-sessions","outputs":[{"contentPath":"","contextPath":"Autofocus.Cookie","description":"The cookie for the results","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.id","description":"ID of the session","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.device_industry","description":"Device industry","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.filename","description":"The name of the file","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.region","description":"Region for the session","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.sha256","description":"SHA256 of the file","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.tstamp","description":"Timestamp for session","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.upload_src","description":"Where did we get the file","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The session ID to retrieve details for","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get details of a specific session","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-session","outputs":[{"contentPath":"","contextPath":"Autofocus.Sessions.id","description":"ID of the session","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.device_industry","description":"Device industry","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.filename","description":"The name of the file","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.region","description":"Region for the session","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.sha256","description":"SHA256 of the file","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.tstamp","description":"Timestamp for session","type":"string"},{"contentPath":"","contextPath":"Autofocus.Sessions.upload_src","description":"Where did we get the file","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The sample id","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"Should we display coverage","name":"coverage","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"file","deprecated":false,"description":"comma-separated list of sections to display: apk_app_icon, apk_app_name, apk_cert_file, apk_certificate_id, apk_defined_activity, apk_defined_intent_filter, apk_defined_receiver, apk_defined_sensor, apk_defined_service, apk_digital_signer, apk_embedded_library, apk_embeded_url, apk_internal_file, apk_isrepackaged, apk_packagename, apk_requested_permission, apk_sensitive_api_call, apk_suspicious_behavior, apk_suspicious_file, apk_suspicious_pattern, apk_suspicious_action_monitored, apk_suspicious_file, apk_suspicious_string, apk_version_num, behavior_type, connection, coverage, dns, file, http, japi, mac_embedded_url, misc, mutex, process, registry, service, user_agent","name":"sections","required":false,"secret":false},{"default":false,"deprecated":false,"description":"comma-separated list of platforms: win7, winxp, android, staticAnalyzer, mac","name":"platforms","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve the sample analysis","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-sample-analysis","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Hash of the file to query. Supports MD5, SHA1 and SHA256.","name":"file","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Check file reputation of the given hash","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file","outputs":[{"contentPath":"","contextPath":"File.MD5","description":"File MD5 hash","type":"string"},{"contentPath":"","contextPath":"File.SHA1","description":"File SHA1 hash","type":"string"},{"contentPath":"","contextPath":"File.SHA256","description":"File SHA256 hash","type":"string"},{"contentPath":"","contextPath":"File.Malicious.Vendor","description":"For malicious files, the vendor that made the decision","type":"string"},{"contentPath":"","contextPath":"File.Malicious.Description","description":"For malicious files, the reason for the vendor to make the decision","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator we tested","type":"string"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The type of the indicator","type":"string"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"Vendor used to calculate the Score","type":"string"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score","type":"number"},{"contentPath":"","contextPath":"DBotScore.Description","description":"The reason for the score (if any)","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"var SERVER = params.server.replace(/[\\/]+$/, '') + '/api/' + params.version + '/';\n\nfunction doReq(path, data) {\n    data.apiKey = params.apiKey;\n    var result = http(\n        SERVER + path,\n        {\n            Headers: {'Content-Type': ['application/json'], 'Accept': ['application/json']},\n            Method: 'POST',\n            Body: JSON.stringify(data)\n        },\n        params.insecure,\n        params.useproxy\n    );\n\n    if (result.StatusCode \u003c 200 || result.StatusCode \u003e 299) {\n        if (result.StatusCode == 503) {\n            throw '503 - Rate limit exceeded. Contact your Autofocus representative.';\n        }\n        if (result.StatusCode == 409) {\n            throw '409 - Invalid message or missing parameters.';\n        }\n        else {\n            throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode + '\\n' + result.Body;\n        }\n    }\n    if (result.Body === '') {\n        throw 'No content received.';\n    }\n    var obj;\n    try {\n        obj = JSON.parse(result.Body);\n    } catch (ex) {\n        throw 'Error parsing reply - ' + result.Body + ' - ' + ex;\n    }\n    return {\n        body: result.Body,\n        obj: obj,\n        statusCode: result.StatusCode\n    };\n}\n\n\nfunction doSearch(prefix) {\n    var cookie = args.cookie;\n    if (!cookie) {\n        var q = {};\n        q.query = JSON.parse(args.query);\n        q.from = parseInt(args.from);\n        q.size = parseInt(args.size);\n        if (args.sort) {\n            q.sort = {};\n            q.sort[args.sort] = {order: (args.order ? args.order : 'asc')};\n        }\n        if (args.scope) {\n            q.scope = args.scope;\n        }\n        var res = doReq(prefix + '/search/', q);\n        if (!res.obj.af_cookie) {\n            throw 'Unable to retrieve cookie of search results';\n        }\n        cookie = res.obj.af_cookie;\n    }\n    var checks = (args.checks) ? parseInt(args.checks) : 10;\n    var sleep = (args.sleep) ? parseInt(args.sleep) : 3;\n    var res1;\n    var ec = {'Autofocus.Cookie': cookie};\n    while (checks \u003e 0) {\n        checks--;\n        wait(sleep);\n        res1 = doReq(prefix + '/results/' + cookie, {});\n        if (res1.obj.af_message === 'complete' || res1.obj.af_in_progress === false ||\n                (res1.obj.hits \u0026\u0026 res1.obj.hits.length \u003e= parseInt(args.size))) {\n            var md = '## PAN Autofocus ' + prefix + ' result\\n';\n            md += 'Total: ' + res1.obj.total + '\\nTook: ' + res1.obj.took + '\\n';\n            var hits = [];\n            for (var i=0; i\u003cres1.obj.hits.length; i++) {\n                var data = res1.obj.hits[i]._source;\n                data.id = res1.obj.hits[i]._id;\n                hits.push(data);\n            }\n            ec['Autofocus.S' + prefix.substr(1)] = hits;\n            md += tableToMarkdown('S' + prefix.substr(1), hits);\n            return {\n                Type: entryTypes.note,\n                Contents: res1.body,\n                ContentsFormat: formats.json,\n                HumanReadable: md,\n                EntryContext: ec\n            };\n        }\n    }\n    return {\n        Type: entryTypes.note,\n        Contents: ec,\n        ContentsFormat: formats.json,\n        HumanReadable: 'PAN Autofocus timeout occured waiting for results, cookie is: ' + cookie,\n        EntryContext: ec\n    };\n}\n\n\nfunction doSession(id) {\n    var res = doReq('session/' + id, {});\n    if (res.obj.af_message === 'complete' || res.obj.af_in_progress === false || res.obj.hits.length \u003e= 1) {\n        var hits = [];\n        for (var i=0; i\u003cres.obj.hits.length; i++) {\n            var data = res.obj.hits[i]._source;\n            data.id = res.obj.hits[i]._id;\n            hits.push(data);\n        }\n        md = tableToMarkdown('PAN Autofocus session details', hits);\n        md += 'Took: ' + res.obj.took + '\\n';\n        return {\n            Type: entryTypes.note,\n            Contents: res.body,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: {'Autofocus.Sessions': hits}\n        };\n    }\n    return {\n        Type: entryTypes.note,\n        ContentsFormat: formats.markdown,\n        Contents: 'PAN Autofocus no session for: ' + id\n    };\n}\n\n\nfunction doSample() {\n    var p = {};\n    if (args.sections) {\n        p.sections = argToList(args.sections);\n    }\n    if (args.platforms) {\n        p.platforms = argToList(args.platforms);\n    }\n    if (args.coverage === 'true') {\n        p.coverage = true;\n        if (p.sections \u0026\u0026 p.sections.indexOf('coverage') \u003c 0) {\n            p.sections.push('coverage');\n        }\n    }\n    var res = doReq('sample/' + args.id + '/analysis', p);\n    md = '## PAN Autofocus Sample Analysis\\n';\n    md += '### Sections: ' + res.obj.sections.join(', ') + '\\n';\n    md += '### Platforms: ' +  res.obj.platforms.join(', ') + '\\n';\n    if (res.obj.coverage) {\n        Object.keys(res.obj.coverage).forEach(function(s) {\n            if (Object.keys(res.obj.coverage[s]).length) {\n                md += tableToMarkdown('Coverage ' + s, res.obj.coverage[s]) + '\\n';\n            }\n        });\n    }\n    res.obj.sections.forEach(function(s) {\n        if (s === 'coverage') {\n            return;\n        }\n        res.obj.platforms.forEach(function(p) {\n            if (res.obj[s][p]) {\n                md += tableToMarkdown(s + ' - ' + p, res.obj[s][p]) + '\\n';\n            }\n        });\n    });\n    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\nswitch (command) {\n\n    case 'test-module':\n        doReq('samples/search/', {query: {operator: 'all', children: [{field: 'sample.malware', operator: 'is', value: 1}]}, size: 1, from: 0, scope: 'public'});\n        return 'ok';\n\n    case 'autofocus-search-samples':\n        return doSearch('samples');\n\n    case 'autofocus-search-sessions':\n        return doSearch('sessions');\n\n    case 'autofocus-session':\n        return doSession(args.id);\n\n    case 'autofocus-sample-analysis':\n        return doSample(args.id);\n\n    case 'file':\n        args.size = 1;\n        args.from = 0;\n        args.scope = 'public';\n        var hash = args.file.length === 64 ? 'sha256' : args.file.length === 40 ? 'sha1' : 'md5';\n        args.query = JSON.stringify({operator: 'all', children: [{field: 'sample.' + hash, operator: 'is', value: args.file}]});\n        var search = doSearch('samples');\n        if (search.EntryContext \u0026\u0026 search.EntryContext['Autofocus.Samples'] \u0026\u0026 search.EntryContext['Autofocus.Samples'].length \u003e 0) {\n            var c = search.EntryContext['Autofocus.Samples'][0];\n            var dbotScore = [];\n            ['md5', 'sha1', 'sha256'].forEach(function(h) {\n                if (c[h]) {\n                    dbotScore.push({Indicator: c[h], Type: 'hash', Vendor: 'PAN Autofocus', Score: c.malware === 1 ? 3 : 1,\n                        Description: c.tag \u0026\u0026 c.tag.length \u003e 0 ? c.tag.join(', ') : c.malware === 1 ? 'Marked as malware' : ''});\n                }\n            });\n            var ec = {DBotScore: dbotScore};\n            var f = {MD5: c.md5, SHA1: c.sha1, SHA256: c.sha256, Size: c.size, SSDeep: c.ssdeep, Region: c.region ? c.region.join(',') : '', Info: c.filetype, Type: c.filetype};\n            if (c.malware === 1) {\n                f.properties_to_append = ['Malicious'];\n                f.Malicious = {Vendor: 'PAN Autofocus', Description: dbotScore[0].Description};\n            }\n            ec[outputPaths.file] = f;\n            // Now, let's add any interesting sessions we've encountered to the display\n            args.size = 50;\n            delete args.scope;\n            args.query = JSON.stringify({operator: 'all', children: [{field: 'session.sha256', operator: 'is', value: c.sha256}]});\n            var md = search.HumanReadable;\n            var sessions = doSearch('sessions');\n            if (sessions.EntryContext \u0026\u0026 sessions.EntryContext['Autofocus.Sessions'] \u0026\u0026 sessions.EntryContext['Autofocus.Sessions'].length \u003e 0) {\n                md += '\\n' + sessions.HumanReadable;\n            }\n            return {\n                Type: entryTypes.note,\n                Contents: search.Contents,\n                ContentsFormat: formats.json,\n                HumanReadable: md,\n                EntryContext: ec\n            };\n        }\n        return {\n            Type: entryTypes.note,\n            ContentsFormat: formats.markdown,\n            Contents: 'PAN Autofocus no data for: ' + args.file\n        };\n\n    default:\n        throw 'Unknown command \"' + command + '\"';\n}\n","subtype":"","type":"javascript"},"itemVersion":"1.3.9","modified":"2021-09-07T09:21:43.460639+03:00","name":"Autofocus","packID":"AutoFocus","packPropagationLabels":["all"],"prevName":"Autofocus","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":5},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"TIM customers that upgraded to version 6.2 or above, can have this value pre-configured in their main account so no additional input is needed. To use this feature, upgrade your license so it includes the license key.","name":"api_key","options":null,"required":false,"type":4},{"defaultValue":"B - Usually reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data.","name":"integrationReliability","options":["A+ - 3rd party enrichment","A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Suppress errors for non found indicators","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"handle_error","options":null,"required":false,"type":8},{"defaultValue":"","display":"Additional malicious verdicts","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mark_as_malicious","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Create relationships","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Create relationships between indicators as part of Enrichment.","name":"create_relationships","options":null,"required":false,"type":8}],"definitionId":"","description":"Use the Palo Alto Networks AutoFocus integration to distinguish the most important threats from everyday commodity attacks.","detailedDescription":"## Get Your API Key\nTo get your API key, you need to add an authorization code, and then activate the API.\n\n ### Add your authorization code\n  1. Go to the [Palo Alto Networks support site](https://support.paloaltonetworks.com).\n  2. From the left-side navigation menu, select **Assets \u003e Site Licenses**.\n  3. Click the **Add Site License** button.\n  4. Enter the authorization code.\n  \n ### Activate the API\n  1. From the **Site Licenses** page, click **Enable**.\n  2. Select the API Key link.\n\n  Enter this API key when configuring the AutoFocus integration in Cortex XSOAR.\n  For more info on activating the license see [Activating AutoFocus Licenses](https://docs.paloaltonetworks.com/autofocus/autofocus-admin/get-started-with-autofocus/activate-autofocus-licenses.html).\n\n## How to Build a Query \nThese instructions explain how to build a query, which you can use as the value for the `query` argument. You can use this argument in the **autofocus-search-samples** and **autofocus-search-sessions** commands.\n   1. Go to the [AutoFocus platform](https://autofocus.paloaltonetworks.com/#/samples/global).\n   2. From the left-side navigation menu, click **Search**.\n   3. From the top navigation bar, click **Advanced...**. \n   3. Build a query by selecting fields operators and relevant values. You can always add an additional condition by \n   selecting the **+** button on the right. For more information on how to use the search editor see [Work with the Search Editor\n](https://docs.paloaltonetworks.com/autofocus/autofocus-admin/autofocus-search/work-with-the-search-editor.html#id791798e0-2277-41b5-a723-383bd0787816_id597cae40-646e-4a2f-acf5-5fe04d9e2cf0).\n4. To export the query, click the **\u003e_API** button.\n5. Copy the query value  and paste it as the value for the `query` argument for both search commands. For example:\n```\n{\"operator\":\"all\",\"children\":[{\"field\":\"sample.malware\",\"operator\":\"is\",\"value\":1},{\"field\":\"sample.create_date\",\"operator\":\"is after\",\"value\":[\"2019-06-13\",\"2019-06-13\"]}]} \n```\n\n## Note for the autofocus-sample-analysis Command\nDue to a large amount of dynamic outputs, run the command once to get the fields and the operating system's under HTTP, Coverage, Behavior, Registry, Files, Processes, Connections, and DNS.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/auto-focus-v2)","display":"Palo Alto Networks AutoFocus v2","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"AutoFocus V2","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Use XSOAR built-in polling to retrieve the result when it's ready.","name":"polling","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query for which to retrieve samples. For additional information on how to build your query using the AF GUI, see the detailed description section.","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"Interval in seconds between each poll.","name":"interval_in_seconds","required":false,"secret":false},{"default":false,"defaultValue":"30","deprecated":false,"description":"The number of results to return.","name":"max_results","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The field by which to sort the results.","name":"sort","predefined":["App Name","App Packagename","File type","Size","Finish Date","First Seen (Create Date)","Last Updated (Update Date)","MD5","SHA1","SHA256","Ssdeep Fuzzy Hash"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The order of the results. Can be \"Ascending\" or \"Descending\".","name":"order","predefined":["Ascending","Descending"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":" The scope of the search. Can be \"Private\", \"Public\", or \"Global\".","name":"scope","predefined":["Private","Public","Global"],"required":true,"secret":false},{"default":false,"deprecated":false,"description":"The MD5, SHA1 or SHA256 hash of the file.","name":"file_hash","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The domain to search.","name":"domain","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The IP address to search.","name":"ip","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The URL to search.","name":"url","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The Wildfire verdict. Can be \"Malware\", \"Grayware\", \"Benign\", or \"Phishing\".","name":"wildfire_verdict","predefined":["Malware","Grayware","Benign","Phishing"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The date range of the creation date. Format: YYY Y-MM-DDTHH:MM:SS,YYYY-MM-DDTHH:MM:SS where the first date is the beginning and the second is the end. Example: 2019-09-09T00:00:00,2019-09-09T23:01:59","name":"first_seen","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The date range of the last updated date. Format: YYY Y-MM-DDTHH:MM:SS,YYYY-MM-DDTHH:MM:SS where the first date is the beginning and the second is the end. Example: 2019-09-09T00:00:00,2019-09-09T23:01:59","name":"last_updated","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"Whether to return artifacts of samples.","name":"artifact","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The AF Cookie for retrieving results of previous searches. The AF Cookie expires 120 seconds after the search completes.","name":"af_cookie","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Searches for samples in AutoFocus. To view results, run the autofocus-samples-search-results command with the returned AF Cookie. The AF Cookie expires 120 seconds after the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-search-samples","outputs":[{"contentPath":"","contextPath":"AutoFocus.SamplesSearch.AFCookie","description":"The AutoFocus search ID. Use this ID to retrieve search results. The AF Cookie expires 120 seconds after the search completes.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesSearch.SessionStart","description":"The time when the session began.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Size","description":"The file size in bytes.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Created","description":"The date that the file was created.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Finished","description":"Date finished.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Region","description":"Region of the sample.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.FileType","description":"The file type.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Tags","description":"The tags attached to the sample.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Verdict","description":"The verdict of the sample.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.TagGroups","description":"Groups of relevant tags.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"File.Size","description":"The size of the file in bytes.","type":"Number"},{"contentPath":"","contextPath":"File.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.Type","description":"The file type, as determined by libmagic (same as displayed in file entries).","type":"String"},{"contentPath":"","contextPath":"File.Tags","description":"Tags of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.b","description":"How many set the artifact as benign.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.g","description":"How many set the artifact as grayware.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.m","description":"How many set the artifact as malicious.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.confidence","description":"Confidence in the decision.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.indicator_type","description":"The indicator type, for example: Mutex, User agent, IPv4, Domain.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.ID","description":"ID of sample search","type":"String"}],"permitted":false,"polling":true,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Use XSOAR built-in polling to retrieve the result when it's ready.","name":"polling","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"Interval in seconds between each poll.","name":"interval_in_seconds","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The AF Cookie for retrieving the results of a previous search. The AF Cookie expires 120 seconds after the search completes.","name":"af_cookie","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query for which to retrieve samples. For additional information on how to build your query using the AF GUI, see the detailed description section.","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"30","deprecated":false,"description":"The maximum number of results to return. Default is 30.","name":"max_results","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The field by which to sort the results.","name":"sort","predefined":["Application","Device Country","Device Country Code","Device Hostname","Device Serial","Device vsys","Destination Country","Destination Country Code","Destination IP","Destination Port","Email Charset","Industry","Source Country","Source Country Code","Source IP","Source Port","SHA256","Time","Upload source"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The order of the results. Can be \"Ascending\" or \"Descending\".","name":"order","predefined":["Ascending","Descending"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The MD5, SHA1 or SHA256 hash of the file.","name":"file_hash","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The domain to search.","name":"domain","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The IP address to search.","name":"ip","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The URL to search.","name":"url","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The date range in which to search for sessions. Format: YYYY-MM-DDTHH:MM:SS,YYYY-MM-DDTHH:MM:SS where the first date is the beginning and the second is the end. Example: 2019-09-09T00:00:00,2019-09-09T23:01:59","name":"time_range","predefined":[""],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The date after which to search for sessions. Format: YYYY-MM-DDTHH:MM:SS Example: 2019-09-09T23:01:59","name":"time_after","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The date before which to search for sessions. Format: YYYY-MM-DDTHH:MM:SS Example: 2019-09-09T23:01:59","name":"time_before","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Searches for sessions in AutoFocus. To view results, run the autofocus-sessions-search-results command with the returned AF Cookie. The AF Cookie expires 120 seconds after the search completes. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-search-sessions","outputs":[{"contentPath":"","contextPath":"AutoFocus.SessionsSearch.AFCookie","description":"The AutoFocus search ID. Use this ID to get search results. The AF Cookie expires 120 seconds after the search completes.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsSearch.SessionStart","description":"The time when the session began.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.FileName","description":"The name of the file..","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.ID","description":"The session ID. Used to get session details.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Industry","description":"The related industry.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Region","description":"The regions of the sessions.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.UploadSource","description":"The source of the uploaded sample.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.FileURL","description":"The URL of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Tags","description":"Relevant tags.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"File.Name","description":"The full file name (including file extension).","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.MalwareFamily","description":"The malware family associated with the file.","type":"String"},{"contentPath":"","contextPath":"File.Tags","description":"Tags of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Seen","description":"Session seen.","type":"Date"}],"permitted":false,"polling":true,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The AF Cookie for retrieving results of previous searches. The AF Cookie expires 120 seconds after the search completes.","name":"af_cookie","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns results of a previous samples search. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-samples-search-results","outputs":[{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Size","description":"The file size in bytes.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Created","description":"The date that the file was created.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Finished","description":"Date finished.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Region","description":"Region of the sample.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.FileType","description":"The file type.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Tags","description":"The tags attached to the sample.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Verdict","description":"The verdict of the sample.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.TagGroups","description":"Groups of relevant tags.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"File.Size","description":"The size of the file in bytes.","type":"Number"},{"contentPath":"","contextPath":"File.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.Type","description":"The file type, as determined by libmagic (same as displayed in file entries).","type":"String"},{"contentPath":"","contextPath":"File.Tags","description":"Tags of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.b","description":"How many set the artifact as benign.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.g","description":"How many set the artifact as grayware.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.m","description":"How many set the artifact as malicious.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.confidence","description":"Confidence in the decision.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.Artifact.indicator_type","description":"The indicator type, for example: Mutex, User agent, IPv4, Domain.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesResults.ID","description":"ID of sample search","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The AF Cookie for retrieving the results of a previous search. The AF Cookie expires 120 seconds after the search completes.","name":"af_cookie","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns results of a previous sessions search. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-sessions-search-results","outputs":[{"contentPath":"","contextPath":"AutoFocus.SessionsResults.FileName","description":"The name of the file..","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.ID","description":"The session ID. Used to get session details.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Industry","description":"The related industry.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Region","description":"The regions of the sessions.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.UploadSource","description":"The source of the uploaded sample.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.FileURL","description":"The URL of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Tags","description":"Relevant tags.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"File.Name","description":"The full file name (including file extension).","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.MalwareFamily","description":"The malware family associated with the file.","type":"String"},{"contentPath":"","contextPath":"File.Tags","description":"Tags of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SessionsResults.Seen","description":"Session seen.","type":"Date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The session ID.","name":"session_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get session details by session ID","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-get-session-details","outputs":[{"contentPath":"","contextPath":"AutoFocus.Sessions.FileName","description":"The file name.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Sessions.ID","description":"The session ID.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Sessions.Industry","description":"The related industry.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Sessions.Region","description":"Session regions.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Sessions.SHA256","description":"TheSHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Sessions.Seen","description":"Seen date.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.Sessions.UploadSource","description":"The source that uploaded the sample.","type":"String"},{"contentPath":"","contextPath":"File.Name","description":"The full file name (including file extension).","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The SHA256 hash of the sample to analyze.","name":"sample_id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The analysis environment. Can be \"win7\", \"winxp\", \"android\", \"static_analyzer\", \"mac\", or \"bare_metal\".","name":"os","predefined":["win7","winxp","android","static_analyzer","mac","bare_metal"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"True","deprecated":false,"description":"Whether to smartly filter the data. If \"False\", the data returned will not be smartly filtered, and will significantly reduce integration performance. We recommend setting this to \"True\".","name":"filter_data","predefined":["True","False"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns properties, behaviors, and activities observed for a sample. Run the command a single time to get the fields and operating systems under HTTP, Coverage, Behavior, Registry, Files, Processes, Connections, and DNS.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-sample-analysis","outputs":[{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Http","description":"HTTP requests made when the sample was executed.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Coverage","description":"WildFire signatures that matched to the sample.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Behavior","description":"Sample behavior: created or modified files, started a process, spawned new processes, modified the registry, or installed browser help objects.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Registry","description":"Registry settings and options that showed activity when the sample was executed in the analysis environment.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Files","description":"Files that showed activity as a result of the sample being executed.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Processes","description":"Processes that showed activity when the sample was executed.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Connections","description":"Connections to other hosts on the network when the sample was executed.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Dns","description":"DNS activity observed when the sample was executed.","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.SampleAnalysis.Analysis.Mutex","description":"The mutex created when the programs start is listed with the parent process if the sample generates other program threads when executed in the analysis environment.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The public tag name. Can be retrieved from the top-tags command.","name":"tag_name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns details about the given tag.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-tag-details","outputs":[{"contentPath":"","contextPath":"AutoFocus.Tag.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.Tag.Lasthit","description":"The date that the tag was last encountered.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.Tag.TagDefinitionScope","description":"The scope of the tag (\"public\", \"private\", or \"Unit42\").","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.CustomerName","description":"The organization that created the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.Source","description":"The organization or individual that discovered the threat that is defined in the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.TagClass","description":"The classification of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.TagDefinitionStatus","description":"The status of the tag definition (\"enabled\", \"disabled\", \"removing\", or \"rescoping\").","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.TagGroup","description":"The tag group of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Tag.Description","description":"Tag description.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Scope of the search. Can be \"industry\", \"organization\", \"all\", or \"global\".","name":"scope","predefined":["industry","organization","all","global"],"required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Use XSOAR built-in polling to retrieve the result when it's ready.","name":"polling","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The AF Cookie for retrieving results of previous searches. The AF Cookie expires 120 seconds after the search completes.","name":"af_cookie","required":false,"secret":false},{"default":false,"defaultValue":"40","deprecated":false,"description":"Interval in seconds between each poll.","name":"interval_in_seconds","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Tag class. - Malware Family: group of malware that have shared properties or common functions. - Campaign:  targeted attack, which might include several incidents or sets of activities. - Actor: individual or group that initiates a campaign using malware families. - Exploit: an attack, which takes advantage of a software or network weakness, bug, or vulnerability to manipulate the behavior of the system. - Malicious Behavior: behavior that is not specific to a malware family or campaign, but indicates that your system has been compromised.","name":"class","predefined":["Actor","Campaign","Exploit","Malicious Behavior","Malware Family"],"required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"Whether the tag scope is \"private\". If \"True\", the tag scope is private. Default is \"False\".","name":"private","predefined":["True","False"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"Whether the tag scope is \"public\". If \"True\", the tag scope is public. Default is \"False\".","name":"public","predefined":["True","False"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"Whether the tag scope is \"commodity\". If \"True\", the tag scope is commodity. Default is \"False\".","name":"commodity","predefined":["True","False"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"False","deprecated":false,"description":"Whether the tag scope is \"Unit42\". If \"True\", the tag scope is unit42. Default is \"False\".","name":"unit42","predefined":["True","False"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Performs a search to identify the most popular tags. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-top-tags-search","outputs":[{"contentPath":"","contextPath":"AutoFocus.TopTagsSearch.AFCookie","description":"AutoFocus search ID. Use this ID to get search results. The AF Cookie expires 120 seconds after the search completes.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.TopTagsSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"},{"contentPath":"","contextPath":"AutoFocus.SamplesSearch.SessionStart","description":"The time when the session began.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.Lasthit","description":"The last encounter date of the tag.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.TopTagsSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"}],"permitted":false,"polling":true,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The AF Cookie for retrieving results of previous search. Note: The AF Cookie expires 120 seconds after the search completes.","name":"af_cookie","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns the results of a previous top tags search. `Autofocus Query Samples, Sessions and Tags` Playbook is recommended for querying and polling.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-top-tags-results","outputs":[{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.TopTagsResults.Lasthit","description":"The last encounter date of the tag.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.TopTagsSearch.Status","description":"The search status. Can be \"in progress\" or \"complete\".","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"IP address to check.","isArray":true,"name":"ip","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of an IP address in AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ip","outputs":[{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"IP.Address","description":"The IP address.","type":"String"},{"contentPath":"","contextPath":"IP.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"AutoFocus.IP.IndicatorValue","description":"The IP address.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.IndicatorType","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.LatestPanVerdicts","description":"Latest verdicts from Palo Alto Networks products. Can be either PAN_DB or WF_SAMPLE(WildFire).","type":"Unknown"},{"contentPath":"","contextPath":"IP.Malicious.Vendor","description":"For malicious files, the vendor that made the decision.","type":"String"},{"contentPath":"","contextPath":"IP.MalwareFamily","description":"The malware family associated with the IP.","type":"String"},{"contentPath":"","contextPath":"IP.Tags","description":"Tags that are associated with the IP.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.CustomerName","description":"The organization that created the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.Source","description":"The organization or individual that discovered the threat that is defined in the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.TagDefinitionScopeID","description":"The scope ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.TagDefinitionStatusID","description":"The definition status ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.TagClassID","description":"The classification ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.Lasthit","description":"The date that the tag was last encountered.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.IP.Tags.Description","description":"The tag description.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"URL to check.","isArray":true,"name":"url","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a URL in AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"url","outputs":[{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"URL.Data","description":"The URL address.","type":"String"},{"contentPath":"","contextPath":"URL.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"AutoFocus.URL.IndicatorValue","description":"The URL value.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.IndicatorType","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.LatestPanVerdicts","description":"Latest verdicts from Palo Alto Networks products. Can be either PAN_DB or WF_SAMPLE(WildFire).","type":"Unknown"},{"contentPath":"","contextPath":"URL.Malicious.Vendor","description":"For malicious files, the vendor that made the decision.","type":"String"},{"contentPath":"","contextPath":"URL.MalwareFamily","description":"The malware family associated with the url.","type":"String"},{"contentPath":"","contextPath":"URL.Tags","description":"Tags that are associated with the url.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.CustomerName","description":"The organization that created the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.Source","description":"The organization or individual that discovered the threat that is defined in the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.TagDefinitionScopeID","description":"The scope ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.TagDefinitionStatusID","description":"The definition status ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.TagClassID","description":"The classification ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.Lasthit","description":"The date that the tag was last encountered.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.URL.Tags.Description","description":"The tag description.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The SHA256 hash of the file.","isArray":true,"name":"file","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a file in AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file","outputs":[{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Tags.TagGroups.TagGroupName","description":"The tag's group name.","type":"String"},{"contentPath":"","contextPath":"File.Tags.Aliases","description":"Aliases of the tags.","type":"String"},{"contentPath":"","contextPath":"File.Tags.PublicTagName","description":"The public name of the tag. This is usually used as the ID of the tag.","type":"String"},{"contentPath":"","contextPath":"File.Tags.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.IndicatorValue","description":"SHA256 of the file.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.IndicatorType","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.LatestPanVerdicts","description":"Latest verdicts from Palo Alto Networks products. Can be either PAN_DB or WF_SAMPLE(WildFire).","type":"Unknown"},{"contentPath":"","contextPath":"File.Malicious.Vendor","description":"For malicious files, the vendor that made the decision.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.CustomerName","description":"The organization that created the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.Source","description":"The organization or individual that discovered the threat that is defined in the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.TagDefinitionScopeID","description":"The scope ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.TagDefinitionStatusID","description":"The definition status ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.TagClassID","description":"The classification ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.Lasthit","description":"The date that the tag was last encountered.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.File.Tags.Description","description":"The tag description.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The domain to check.","isArray":true,"name":"domain","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a domain in AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"domain","outputs":[{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.IndicatorValue","description":"The domain.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.IndicatorType","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.LatestPanVerdicts","description":"Latest verdicts from Palo Alto Networks products. Can be either PAN_DB or WF_SAMPLE(WildFire).","type":"Unknown"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.PublicTagName","description":"The public name of the tag. This is used as an ID of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.TagName","description":"The simple name of the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.CustomerName","description":"The organization that created the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.Source","description":"The organization or individual that discovered the threat that is defined in the tag.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.TagDefinitionScopeID","description":"The scope ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.TagDefinitionStatusID","description":"The definition status ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.TagClassID","description":"The classification ID of the tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.Count","description":"The number of samples that matched this tag.","type":"Number"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.Lasthit","description":"The date that the tag was last encountered.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.Domain.Tags.Description","description":"The tag description.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisAdminCountry","description":"The country of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisAdminEmail","description":"The email address of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisAdminName","description":"The name of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisDomainCreationDate","description":"The date that the domain was created.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisDomainExpireDate","description":"The date that the domain expires.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisDomainUpdateDate","description":"The date that the domain was last updated.","type":"Date"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisRegistrar","description":"The name of the registrar.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisRegistrarUrl","description":"The email address of the registrar.","type":"String"},{"contentPath":"","contextPath":"AutoFocus.Domain.WhoisRegistrant","description":"The name of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Name","description":"The domain name, for example: \"google.com\".","type":"String"},{"contentPath":"","contextPath":"Domain.Malicious.Vendor","description":"For malicious files, the vendor that made the decision.","type":"String"},{"contentPath":"","contextPath":"Domain.MalwareFamily","description":"The malware family associated with the domain.","type":"String"},{"contentPath":"","contextPath":"Domain.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Tags","description":"Tags that are associated with the domain.","type":"String"},{"contentPath":"","contextPath":"Domain.CreationDate","description":"The date that the domain was created.","type":"Date"},{"contentPath":"","contextPath":"Domain.UpdatedDate","description":"The date that the domain was last updated.","type":"String"},{"contentPath":"","contextPath":"Domain.ExpirationDate","description":"The expiration date of the domain.","type":"Date"},{"contentPath":"","contextPath":"Domain.Admin.Country","description":"The country of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.Email","description":"The email address of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.Name","description":"The name of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.Name","description":"The name of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.WHOIS.Registrar.Name","description":"The name of the registrar, for example: \"GoDaddy\"","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The label of the exported list.","name":"label","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets export list indicators from AutoFocus.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"autofocus-get-export-list-indicators","outputs":[{"contentPath":"","contextPath":"AutoFocus.ExportListIndicator.Type","description":"The indicator type in the export list. ","type":"String"},{"contentPath":"","contextPath":"AutoFocus.ExportListIndicator.Value","description":"The value of the indicator in the export list.","type":"String"},{"contentPath":"","contextPath":"IP.Address","description":"The IP address.","type":"String"},{"contentPath":"","contextPath":"URL.Data","description":"The URL address.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"Domain.Name","description":"The domain name.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.24019","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n''' IMPORTS '''\n\nimport re\nimport json\nimport requests\nimport socket\nimport traceback\nfrom typing import Callable, Tuple\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n''' GLOBALS/PARAMS '''\nPARAMS = demisto.params()\n\nAPI_KEY = AutoFocusKeyRetriever(PARAMS.get('api_key')).key\n\n# Remove trailing slash to prevent wrong URL path to service\nSERVER = 'https://autofocus.paloaltonetworks.com'\n# Should we use SSL\nUSE_SSL = not PARAMS.get('insecure', False)\n# Service base URL\nBASE_URL = SERVER + '/api/v1.0'\nVENDOR_NAME = 'AutoFocus V2'\n\n# Headers to be sent in requests\nHEADERS = {\n    'Content-Type': 'application/json'\n}\nRELATIONSHIP_TYPE_BY_TAG_CLASS_ID = {\n    1: {'entity_b_type': 'STIX Threat Actor',\n        'name': 'indicator-of'},\n    2: {'entity_b_type': 'Campaign',\n        'name': 'indicator-of'},\n    3: {'entity_b_type': 'STIX Malware',\n        'name': 'indicator-of'},\n    5: {'entity_b_type': 'STIX Attack Pattern',\n        'name': 'indicator-of'}\n}\nAPI_PARAM_DICT = {\n    'scope': {\n        'Private': 'private',\n        'Public': 'public',\n        'Global': 'global'\n    },\n    'order': {\n        'Ascending': 'asc',\n        'Descending': 'desc'\n    },\n    'artifact': 'artifactSource',\n    'sort': {\n        'App Name': 'app_name',\n        'App Packagename': 'app_packagename',\n        'File type': 'filetype',\n        'Size': 'size',\n        'Finish Date': 'finish_date',\n        'First Seen (Create Date)': 'create_date',\n        'Last Updated (Update Date)': 'update_date',\n        'MD5': 'md5',\n        'SHA1': 'sha1',\n        'SHA256': 'sha256',\n        'Ssdeep Fuzzy Hash': 'ssdeep',\n        'Application': 'app',\n        'Device Country': 'device_country',\n        'Device Country Code': 'device_countrycode',\n        'Device Hostname': 'device_hostname',\n        'Device Serial': 'device_serial',\n        'Device vsys': 'vsys',\n        'Destination Country': 'dst_country',\n        'Destination Country Code': 'dst_countrycode',\n        'Destination IP': 'dst_ip',\n        'Destination Port': 'dst_port',\n        'Email Charset': 'emailsbjcharset',\n        'Industry': 'device_industry',\n        'Source Country': 'src_country',\n        'Source Country Code': 'src_countrycode',\n        'Source IP': 'src_ip',\n        'Source Port': 'src_port',\n        'Time': 'tstamp',\n        'Upload source': 'upload_srcPossible'\n    },\n    'tag_class': {\n        'Actor': 'actor',\n        'Campaign': 'campaign',\n        'Exploit': 'exploit',\n        'Malicious Behavior': 'malicious_behavior',\n        'Malware Family': 'malware_family'\n\n    },\n    'search_arguments': {\n        'file_hash': {\n            'api_name': 'alias.hash_lookup',\n            'operator': 'is'\n        },\n        'domain': {\n            'api_name': 'alias.domain',\n            'operator': 'contains'\n        },\n        'ip': {\n            'api_name': 'alias.ip_address',\n            'operator': 'contains'\n        },\n        'url': {\n            'api_name': 'alias.url',\n            'operator': 'contains'\n        },\n        'wildfire_verdict': {\n            'api_name': 'sample.malware',\n            'operator': 'is',\n            'translate': {\n                'Malware': 1,\n                'Grayware': 2,\n                'Benign': 3,\n                'Phishing': 4,\n            }\n        },\n        'first_seen': {\n            'api_name': 'sample.create_date',\n            'operator': 'is in the range'\n        },\n        'last_updated': {\n            'api_name': 'sample.update_date',\n            'operator': 'is in the range'\n        },\n        'time_range': {\n            'api_name': 'session.tstamp',\n            'operator': 'is in the range'\n        },\n        'time_after': {\n            'api_name': 'session.tstamp',\n            'operator': 'is after'\n        },\n        'time_before': {\n            'api_name': 'session.tstamp',\n            'operator': 'is before'\n        }\n    },\n\n    'file_indicators': {\n        'Size': 'Size',\n        'SHA1': 'SHA1',\n        'SHA256': 'SHA256',\n        'FileType': 'Type',\n        'Tags': 'Tags',\n        'FileName': 'Name'\n    },\n    'search_results': {\n        'sha1': 'SHA1',\n        'sha256': 'SHA256',\n        'filetype': 'FileType',\n        'malware': 'Verdict',\n        'size': 'Size',\n        'create_date': 'Created',\n        'finish_date': 'Finished',\n        'md5': 'MD5',\n        'region': 'Region',\n        'tag': 'Tags',\n        '_id': 'ID',\n        'tstamp': 'Seen',\n        'filename': 'FileName',\n        'device_industry': 'Industry',\n        'upload_src': 'UploadSource',\n        'fileurl': 'FileURL',\n        'artifact': 'Artifact',\n    }\n}\nSAMPLE_ANALYSIS_LINE_KEYS = {\n    'behavior': {\n        'display_name': 'behavior',\n        'indexes': {\n            'risk': 0,\n            'behavior': -1\n        }\n    },\n    'process': {\n        'display_name': 'processes',\n        'indexes': {\n            'parent_process': 0,\n            'action': 1\n        }\n    },\n    'file': {\n        'display_name': 'files',\n        'indexes': {\n            'parent_process': 0,\n            'action': 1\n        }\n    },\n    'registry': {\n        'display_name': 'registry',\n        'indexes': {\n            'action': 1,\n            'parameters': 2\n        }\n    },\n    'dns': {\n        'display_name': 'DNS',\n        'indexes': {\n            'query': 0,\n            'response': 1\n        }\n    },\n    'http': {\n        'display_name': 'HTTP',\n        'indexes': {\n            'host': 0,\n            'method': 1,\n            'url': 2\n        }\n    },\n    'connection': {\n        'display_name': 'connections',\n        'indexes': {\n            'destination': 2\n        }\n    },\n    'mutex': {\n        'display_name': 'mutex',\n        'indexes': {\n            'process': 0,\n            'action': 1,\n            'parameters': 2\n        }\n    }\n}\nSAMPLE_ANALYSIS_COVERAGE_KEYS = {\n    'wf_av_sig': {\n        'display_name': 'wildfire_signatures',\n        'fields': ['name', 'create_date']\n    },\n    'fileurl_sig': {\n        'display_name': 'fileurl_signatures',\n        'fields': ['name', 'create_date']\n    },\n    'dns_sig': {\n        'display_name': 'dns_signatures',\n        'fields': ['name', 'create_date']\n    },\n    'url_cat': {\n        'display_name': 'url_categories',\n        'fields': ['url', 'cat']\n    }\n}\n\nVERDICTS_TO_DBOTSCORE = {\n    'benign': 1,\n    'malware': 3,\n    'grayware': 2,\n    'phishing': 3,\n    'c2': 3\n}\n\nERROR_DICT = {\n    '404': 'Invalid URL.',\n    '408': 'Invalid URL.',\n    '409': 'Invalid message or missing parameters.',\n    '500': 'Internal error.',\n    '503': 'Rate limit exceeded.'\n}\n\nif PARAMS.get('mark_as_malicious'):\n    verdicts = argToList(PARAMS.get('mark_as_malicious'))\n    for verdict in verdicts:\n        VERDICTS_TO_DBOTSCORE[verdict] = 3\n\n''' HELPER FUNCTIONS '''\n\n\ndef run_polling_command(args: dict, cmd: str, search_function: Callable, results_function: Callable):\n    ScheduledCommand.raise_error_if_not_supported()\n    interval_in_secs = int(args.get('interval_in_seconds', 60))\n    if 'af_cookie' not in args:\n        # create new search\n        command_results = search_function(args)\n        outputs = command_results.outputs\n        af_cookie = outputs.get('AFCookie')\n        if outputs.get('Status') != 'complete':\n            polling_args = {\n                'af_cookie': af_cookie,\n                'interval_in_seconds': interval_in_secs,\n                'polling': True,\n                **args\n            }\n            scheduled_command = ScheduledCommand(\n                command=cmd,\n                next_run_in_seconds=interval_in_secs,\n                args=polling_args,\n                timeout_in_seconds=600)\n            command_results.scheduled_command = scheduled_command\n            return command_results\n        else:\n            # continue to look for search results\n            args['af_cookie'] = af_cookie\n    # get search status\n    command_results, status = results_function(args)\n    if status != 'complete':\n        # schedule next poll\n        polling_args = {\n            'af_cookie': args.get('af_cookie'),\n            'interval_in_seconds': interval_in_secs,\n            'polling': True,\n            **args\n        }\n        scheduled_command = ScheduledCommand(\n            command=cmd,\n            next_run_in_seconds=interval_in_secs,\n            args=polling_args,\n            timeout_in_seconds=600)\n\n        # result with scheduled_command only - no update to the war room\n        command_results = CommandResults(scheduled_command=scheduled_command)\n    return command_results\n\n\ndef parse_response(resp, err_operation):\n    try:\n        # Handle error responses gracefully\n        if demisto.params().get('handle_error', True) and resp.status_code == 409:\n            raise Exception(\"Response status code: 409 \\nRequested sample not found\")\n        res_json = resp.json()\n        resp.raise_for_status()\n        return res_json\n    # Errors returned from AutoFocus\n    except requests.exceptions.HTTPError:\n        err_msg = f'{err_operation}: {res_json.get(\"message\")}'\n        if res_json.get(\"message\").find('Requested sample not found') != -1:\n            demisto.results(err_msg)\n            sys.exit(0)\n        elif res_json.get(\"message\").find(\"AF Cookie Not Found\") != -1:\n            demisto.results(err_msg)\n            sys.exit(0)\n        elif err_operation == 'Tag details operation failed' and \\\n                res_json.get(\"message\").find(\"Tag\") != -1 and res_json.get(\"message\").find(\"not found\") != -1:\n            demisto.results(err_msg)\n            sys.exit(0)\n        else:\n            return return_error(err_msg)\n    # Unexpected errors (where no json object was received)\n    except Exception as err:\n        demisto.results(f'{err_operation}: {err}')\n        sys.exit(0)\n\n\ndef http_request(url_suffix, method='POST', data={}, err_operation=None):\n    # A wrapper for requests lib to send our requests and handle requests and responses better\n    data.update({'apiKey': API_KEY})\n    try:\n        res = requests.request(\n            method=method,\n            url=BASE_URL + url_suffix,\n            verify=USE_SSL,\n            data=json.dumps(data),\n            headers=HEADERS\n        )\n    # Handle with connection error\n    except requests.exceptions.ConnectionError as err:\n        err_message = f'Error connecting to server. Check your URL/Proxy/Certificate settings: {err}'\n        return_error(err_message)\n    return parse_response(res, err_operation)\n\n\ndef validate_sort_and_order_and_artifact(sort: Optional[str] = None, order: Optional[str] = None,\n                                         artifact_source: Optional[str] = None) -\u003e bool:\n    \"\"\"\n    Function that validates the arguments combination.\n    sort and order arguments must be defined together.\n    Sort and order can't appear with artifact.\n    Args:\n        sort: variable to sort by.\n        order: the order which the results is ordered by.\n        artifact_source: true if artifacts are needed and false otherwise.\n    Returns:\n        true if arguments are valid for the request, false otherwise.\n    \"\"\"\n    if artifact_source == 'true' and sort:\n        raise Exception('Please remove or disable one of sort or artifact,'\n                        ' As they are not supported in the api together.')\n    elif sort and not order:\n        raise Exception('Please specify the order of sorting (Ascending or Descending).')\n    elif order and not sort:\n        raise Exception('Please specify a field to sort by.')\n    elif sort and order:\n        return True\n    return False\n\n\ndef do_search(search_object: str, query: dict, scope: Optional[str], size: Optional[str] = None,\n              sort: Optional[str] = None, order: Optional[str] = None, err_operation: Optional[str] = None,\n              artifact_source: Optional[str] = None) -\u003e dict:\n    \"\"\"\n    This function created the data to be sent in http request and sends it.\n    Args:\n        search_object: Type of search sessions or samples.\n        query: Query based on conditions specified within this object.\n        scope:  Scope of the search. Only available and required for: samples. e.g. Public, Global, Private.\n        size: Number of results to provide.\n        sort: Sort based on the provided artifact.\n        order: How to display sort results in ascending or descending order.\n        err_operation: String error which specificed which command failed.\n        artifact_source: Whether artifacts are wanted or not.\n    Returns:\n        raw response of the http request.\n    \"\"\"\n    path = '/samples/search' if search_object == 'samples' else '/sessions/search'\n    data = {\n        'query': query,\n        'size': size\n    }\n    if scope:\n        data.update({'scope': API_PARAM_DICT['scope'][scope]})  # type: ignore\n    if validate_sort_and_order_and_artifact(sort, order, artifact_source):\n        data.update({'sort': {API_PARAM_DICT['sort'][sort]: {'order': API_PARAM_DICT['order'][order]}}})  # type: ignore\n    if artifact_source == 'true':\n        data.update({'artifactSource': 'af'})\n        data.update({'type': 'scan'})\n    # Remove nulls\n    data = createContext(data, removeNull=True)\n    result = http_request(path, data=data, err_operation=err_operation)\n    return result\n\n\ndef run_search(search_object: str, query: str, scope: Optional[str] = None, size: str = None, sort: str = None,\n               order: str = None, artifact_source: str = None) -\u003e dict:\n    \"\"\"\n    This function searches the relevent search and returns search info for result command.\n    Args:\n        search_object: Type of search sessions or samples.\n        query: Query based on conditions specified within this object.\n        scope:  Scope of the search. Only available and required for: samples. e.g. Public, Global, Private.\n        size: Number of results to provide.\n        sort: Sort based on the provided artifact.\n        order: How to display sort results in ascending or descending order.\n        artifact_source: Whether artifacts are wanted or not.\n    Returns:\n        dict of response for result commands.\n    \"\"\"\n    result = do_search(search_object, query=json.loads(query), scope=scope, size=size, sort=sort, order=order,\n                       artifact_source=artifact_source, err_operation='Search operation failed')\n    in_progress = result.get('af_in_progress')\n    status = 'in progress' if in_progress else 'complete'\n    search_info = {\n        'AFCookie': result.get('af_cookie'),\n        'Status': status,\n        'SessionStart': datetime.now().strftime(\"%Y-%m-%dT%H:%M:%S\")\n    }\n    return search_info\n\n\ndef run_get_search_results(search_object, af_cookie):\n    path = f'/samples/results/{af_cookie}' if search_object == 'samples' else f'/sessions/results/{af_cookie}'\n    results = http_request(path, err_operation='Fetching search results failed')\n    return results\n\n\ndef get_fields_from_hit_object(result_object, response_dict_name):\n    new_object = {}\n    af_params_dict = API_PARAM_DICT.get(response_dict_name)\n    for key, value in result_object.items():\n        if key in af_params_dict:  # type: ignore\n            new_key = af_params_dict.get(key)  # type: ignore\n            new_object[new_key] = value\n        else:\n            new_object[key] = value\n    return new_object\n\n\ndef parse_hits_response(hits, response_dict_name):\n    parsed_objects = []  # type: ignore\n    if not hits:\n        return parsed_objects\n    else:\n        for hit in hits:\n            flattened_obj = {}  # type: ignore\n            flattened_obj.update(hit.get('_source'))\n            flattened_obj['_id'] = hit.get('_id')\n            parsed_obj = get_fields_from_hit_object(flattened_obj, response_dict_name)\n            parsed_objects.append(parsed_obj)\n        return parsed_objects\n\n\ndef get_search_results(search_object, af_cookie):\n    results = run_get_search_results(search_object, af_cookie)\n    retry_count = 0\n    # Checking if the query has no results because the server has not fetched them yet.\n    # In this case, the complete percentage would be 0 (or lower than 100).\n    # In a case where there really aren't results (hits), the af_complete_percentage would be 100.\n    while (not results.get('hits') and (results.get('af_complete_percentage', 0) != 100)) and retry_count \u003c 10:\n        time.sleep(5)\n        results = run_get_search_results(search_object, af_cookie)\n        retry_count += 1\n    parsed_results = parse_hits_response(results.get('hits'), 'search_results')\n    in_progress = results.get('af_in_progress')\n    status = 'in progress' if in_progress else 'complete'\n    return parsed_results, status\n\n\ndef get_session_details(session_id):\n    path = f'/session/{session_id}'\n    result = http_request(path, err_operation='Get session failed')\n    parsed_result = parse_hits_response(result.get('hits'), 'search_results')\n    return parsed_result\n\n\ndef validate_if_line_needed(category, info_line):\n    line = info_line.get('line')\n    line_values = line.split(',')\n    category_indexes = SAMPLE_ANALYSIS_LINE_KEYS.get(category).get('indexes')  # type: ignore\n    if category == 'behavior':\n        risk_index = category_indexes.get('risk')  # type: ignore\n        risk = line_values[risk_index].strip()\n        # only lines with risk higher the informational are considered\n        return not risk == 'informational'\n    elif category == 'registry':\n        action_index = category_indexes.get('action')  # type: ignore\n        action = line_values[action_index].strip()\n        # Only lines with actions SetValueKey, CreateKey or RegSetValueEx are considered\n        return action == 'SetValueKey' or action == 'CreateKey' or action == 'RegSetValueEx'\n    elif category == 'file':\n        action_index = category_indexes.get('action')  # type: ignore\n        action = line_values[action_index].strip()\n        benign_count = info_line.get('b') if info_line.get('b') else 0\n        malicious_count = info_line.get('m') if info_line.get('m') else 0\n        # Only lines with actions Create or CreateFileW where malicious count is grater than benign count are considered\n        return (action == 'Create' or action == 'CreateFileW') and malicious_count \u003e benign_count\n    elif category == 'process':\n        action_index = category_indexes.get('action')  # type: ignore\n        action = line_values[action_index].strip()\n        # Only lines with actions created, CreateKey or CreateProcessInternalW are considered\n        return action == 'created' or action == 'CreateProcessInternalW'\n    else:\n        return True\n\n\ndef get_data_from_line(line, category_name):\n    category_indexes = SAMPLE_ANALYSIS_LINE_KEYS.get(category_name).get('indexes')  # type: ignore\n    values = line.split(',')\n    sub_categories = {}  # type: ignore\n    if not category_indexes:\n        return sub_categories\n    else:\n        for sub_category in category_indexes:  # type: ignore\n            sub_category_index = category_indexes.get(sub_category)  # type: ignore\n            sub_categories.update({\n                sub_category: values[sub_category_index]\n            })\n        return sub_categories\n\n\ndef get_data_from_coverage_sub_category(sub_category_name, sub_category_data):\n    sub_categories_list = []\n    for item in sub_category_data:\n        new_sub_category = {}\n        fields_to_extract = SAMPLE_ANALYSIS_COVERAGE_KEYS.get(sub_category_name).get('fields')  # type: ignore\n        for field in fields_to_extract:  # type: ignore\n            new_sub_category[field] = item.get(field)  # type: ignore\n        sub_categories_list.append(new_sub_category)\n    return sub_categories_list\n\n\ndef parse_coverage_sub_categories(coverage_data):\n    new_coverage = {}\n    for sub_category_name, sub_category_data in coverage_data.items():\n        if sub_category_name in SAMPLE_ANALYSIS_COVERAGE_KEYS and isinstance(sub_category_data, dict):\n            new_sub_category_data = get_data_from_coverage_sub_category(sub_category_name, sub_category_data)\n            new_sub_category_name = SAMPLE_ANALYSIS_COVERAGE_KEYS.get(sub_category_name).get(  # type: ignore\n                'display_name')  # type: ignore\n            new_coverage[new_sub_category_name] = new_sub_category_data\n    return {'coverage': new_coverage}\n\n\ndef parse_lines_from_os(category_name, data, filter_data_flag):\n    new_lines = []\n    for info_line in data:\n        if not filter_data_flag or validate_if_line_needed(category_name, info_line):\n            new_sub_categories = get_data_from_line(info_line.get('line'), category_name)\n            new_lines.append(new_sub_categories)\n    return new_lines\n\n\ndef parse_sample_analysis_response(resp, filter_data_flag):\n    analysis = {}\n    for category_name, category_data in resp.items():\n        if category_name in SAMPLE_ANALYSIS_LINE_KEYS:\n            new_category = {}\n            for os_name, os_data in category_data.items():\n                os_sanitized_data = parse_lines_from_os(category_name, os_data, filter_data_flag)\n                new_category[os_name] = os_sanitized_data\n\n            category_dict = SAMPLE_ANALYSIS_LINE_KEYS.get(category_name)\n            analysis.update({category_dict['display_name']: new_category})  # type: ignore\n\n        elif category_name == 'coverage':\n            new_category = parse_coverage_sub_categories(category_data)\n            analysis.update(new_category)\n\n    return analysis\n\n\ndef sample_analysis(sample_id, os, filter_data_flag):\n    path = f'/sample/{sample_id}/analysis'\n    data = {\n        'coverage': 'true'\n    }\n    if os:\n        data['platforms'] = [os]  # type: ignore\n\n    result = http_request(path, data=data, err_operation='Sample analysis failed')\n    if 'error' in result:\n        return demisto.results(result['error'])\n    analysis_obj = parse_sample_analysis_response(result, filter_data_flag)\n\n    return analysis_obj\n\n\ndef parse_tag_details_response(resp):\n    tag_details = resp.get('tag')\n    fields_to_extract_from_tag_details = [\n        'public_tag_name',\n        'tag_name',\n        'customer_name',\n        'source',\n        'tag_definition_scope',\n        'tag_definition_status',\n        'tag_class',\n        'count',\n        'lasthit',\n        'description'\n    ]\n    new_tag_info = {}\n    for field in fields_to_extract_from_tag_details:\n        new_tag_info[field] = tag_details.get(field)\n\n    tag_group_details = resp.get('tag_groups')\n    if tag_group_details:\n        new_tag_info['tag_group'] = tag_group_details\n\n    return new_tag_info\n\n\ndef autofocus_tag_details(tag_name):\n    path = f'/tag/{tag_name}'\n    resp = http_request(path, err_operation='Tag details operation failed')\n    tag_info = parse_tag_details_response(resp)\n    return tag_info\n\n\ndef validate_tag_scopes(private, public, commodity, unit42):\n    if not private and not public and not commodity and not unit42:\n        return_error('Add at least one Tag scope by setting `commodity`, `private`, `public` or `unit42` to True')\n\n\ndef autofocus_top_tags_search(scope, tag_class_display, private, public, commodity, unit42):\n    validate_tag_scopes(private, public, commodity, unit42)\n    tag_class = API_PARAM_DICT['tag_class'][tag_class_display]  # type: ignore\n    query = {\n        \"operator\": \"all\",\n        \"children\": [\n            {\n                \"field\": \"sample.tag_class\",\n                \"operator\": \"is\",\n                \"value\": tag_class\n            }\n        ]\n    }\n    tag_scopes = list()\n    if private:\n        tag_scopes.append('private')\n    if public:\n        tag_scopes.append('public')\n    if commodity:\n        tag_scopes.append('commodity')\n    if unit42:\n        tag_scopes.append('unit42')\n    data = {\n        'query': query,\n        'scope': scope,\n        'tagScopes': tag_scopes\n    }\n    path = '/top-tags/search/'\n    resp = http_request(path, data=data, err_operation='Top tags operation failed')\n    in_progress = resp.get('af_in_progress')\n    status = 'in progress' if in_progress else 'complete'\n    search_info = {\n        'AFCookie': resp.get('af_cookie'),\n        'Status': status\n    }\n    return search_info\n\n\ndef parse_top_tags_response(response):\n    top_tags_list = []  # type: ignore\n    top_tags = response.get('top_tags')\n    if not top_tags:\n        return top_tags_list\n    else:\n        for tag in top_tags:\n            fields_to_extract_from_top_tags = ['tag_name', 'public_tag_name', 'count', 'lasthit']\n            new_tag = {}\n            for field in fields_to_extract_from_top_tags:\n                new_tag[field] = tag[field]\n            top_tags_list.append(new_tag)\n        return top_tags_list\n\n\ndef get_top_tags_results(af_cookie):\n    path = f'/top-tags/results/{af_cookie}'\n    results = http_request(path, err_operation='Fetching top tags results failed')\n    top_tags = parse_top_tags_response(results)\n    in_progress = results.get('af_in_progress')\n    status = 'in progress' if in_progress else 'complete'\n    return top_tags, status\n\n\ndef print_hr_by_category(category_name, category_data):\n    hr = content = f'### {string_to_table_header(category_name)}:\\nNo entries'\n    if category_name == 'coverage':\n        content = category_data\n        if category_data:\n            hr = tableToMarkdown(f'{string_to_table_header(category_name)}:', category_data,\n                                 headerTransform=string_to_table_header)\n        else:\n            hr = f'### {string_to_table_header(category_name)}:\\nNo entries'\n        demisto.results({\n            'Type': entryTypes['note'],\n            'ContentsFormat': formats['text'],\n            'Contents': content,\n            'HumanReadable': hr\n        })\n    else:\n        for os_name, os_data in category_data.items():\n            content = os_data\n            table_header = f'{category_name}_{os_name}'\n            if os_data:\n                hr = tableToMarkdown(f'{string_to_table_header(table_header)}:', os_data,\n                                     headerTransform=string_to_table_header)\n            else:\n                hr = f'### {string_to_table_header(table_header)}:\\nNo entries'\n            demisto.results({\n                'Type': entryTypes['note'],\n                'ContentsFormat': formats['text'],\n                'Contents': content,\n                'HumanReadable': hr\n            })\n\n\ndef get_files_data_from_results(results):\n    \"\"\"\n    Gets a list of results and for each result returns a file object includes all relevant file indicators exists\n    in that result\n    :param results: a list of dictionaries\n    :return: a list of file objects\n    \"\"\"\n    files = []\n    if results:\n        for result in results:\n            raw_file = get_fields_from_hit_object(result, 'file_indicators')\n            file_data = filter_object_entries_by_dict_values(raw_file, 'file_indicators')\n            files.append(file_data)\n    return files\n\n\ndef filter_object_entries_by_dict_values(result_object, response_dict_name):\n    \"\"\"\n    Gets a dictionary (result_object) and filters it's keys by the values of another\n    dictionary (response_dict_name)\n    input: response_dict_name = 'file_indicators' - see API_PARAM_DICT above\n           result_object = {\n                              \"app\": \"web-browsing\",\n                              \"vsys\": 1,\n                              \"SHA256\": \"18c9acd34a3aea09121f027857e0004a3ea33a372b213a8361e8a978330f0dc8\",\n                              \"UploadSource\": \"Firewall\",\n                              \"src_port\": 80,\n                              \"device_serial\": \"007051000050926\",\n                              \"Seen\": \"2019-07-24T09:37:04\",\n                              \"Name\": \"wildfire-test-pe-file.exe\",\n                              \"user_id\": \"unknown\",\n                              \"src_country\": \"United States\",\n                              \"src_countrycode\": \"US\",\n                              \"dst_port\": 65168,\n                              \"device_countrycode\": \"US\",\n                              \"Industry\": \"High Tech\",\n                              \"Region\": \"us\",\n                              \"device_country\": \"United States\",\n                              \"ID\": \"179972200903\"\n                            }\n    output: {\n                \"SHA256\": \"18c9acd34a3aea09121f027857e0004a3ea33a372b213a8361e8a978330f0dc8\",\n                \"Name\": \"wildfire-test-pe-file.exe\"\n            }\n    :param result_object: a dictionary representing an object\n    :param response_dict_name: a dictionary which it's values are the relevant fields (filters)\n    :return: the result_object filtered by the relevant fields\n    \"\"\"\n    af_params_dict = API_PARAM_DICT.get(response_dict_name)\n    result_object_filtered = {}\n    if af_params_dict and isinstance(result_object, dict) and isinstance(af_params_dict, dict):\n        for key in result_object.keys():\n            if key in af_params_dict.values():  # type: ignore\n                result_object_filtered[key] = result_object.get(key)\n    return result_object_filtered\n\n\ndef search_samples(query=None, scope=None, size=None, sort=None, order=None, file_hash=None, domain=None, ip=None,\n                   url=None, wildfire_verdict=None, first_seen=None, last_updated=None, artifact_source=None):\n    validate_no_query_and_indicators(query, [file_hash, domain, ip, url, wildfire_verdict, first_seen, last_updated])\n    if not query:\n        validate_no_multiple_indicators_for_search([file_hash, domain, ip, url])\n        query = build_sample_search_query(file_hash, domain, ip, url, wildfire_verdict, first_seen, last_updated)\n    return run_search('samples', query=query, scope=scope, size=size, sort=sort, order=order,\n                      artifact_source=artifact_source)\n\n\ndef build_sample_search_query(file_hash, domain, ip, url, wildfire_verdict, first_seen, last_updated):\n    indicator_args_for_query = {\n        'file_hash': file_hash,\n        'domain': domain,\n        'ip': ip,\n        'url': url\n    }\n    indicator_list = build_indicator_children_query(indicator_args_for_query)\n    indicator_query = build_logic_query('OR', indicator_list)\n    filtering_args_for_search = {}  # type: ignore\n    if wildfire_verdict:\n        filtering_args_for_search['wildfire_verdict'] = \\\n            demisto.get(API_PARAM_DICT, f'search_arguments.wildfire_verdict.translate.{wildfire_verdict}')\n    if first_seen:\n        filtering_args_for_search['first_seen'] = first_seen\n    if last_updated:\n        filtering_args_for_search['last_updated'] = last_updated\n    filters_list = build_children_query(filtering_args_for_search)\n    filters_list.append(indicator_query)\n    logic_query = build_logic_query('AND', filters_list)\n    return json.dumps(logic_query)\n\n\ndef search_sessions(query=None, size=None, sort=None, order=None, file_hash=None, domain=None, ip=None, url=None,\n                    from_time=None, to_time=None):\n    validate_no_query_and_indicators(query, [file_hash, domain, ip, url, from_time, to_time])\n    if not query:\n        validate_no_multiple_indicators_for_search([file_hash, domain, ip, url])\n        query = build_session_search_query(file_hash, domain, ip, url, from_time, to_time)\n    return run_search('sessions', query=query, size=size, sort=sort, order=order)\n\n\ndef build_session_search_query(file_hash, domain, ip, url, from_time, to_time):\n    indicator_args_for_query = {\n        'file_hash': file_hash,\n        'domain': domain,\n        'ip': ip,\n        'url': url\n    }\n    indicator_list = build_indicator_children_query(indicator_args_for_query)\n    indicator_query = build_logic_query('OR', indicator_list)\n    time_filters_for_search = {}  # type: ignore\n    if from_time and to_time:\n        time_filters_for_search = {'time_range': [from_time, to_time]}\n    elif from_time:\n        time_filters_for_search = {'time_after': [from_time]}\n    elif to_time:\n        time_filters_for_search = {'time_before': [to_time]}\n\n    filters_list = build_children_query(time_filters_for_search)\n    filters_list.append(indicator_query)\n    logic_query = build_logic_query('AND', filters_list)\n    return json.dumps(logic_query)\n\n\ndef build_logic_query(logic_operator, condition_list):\n    operator = None\n    if logic_operator == 'AND':\n        operator = 'all'\n    elif logic_operator == 'OR':\n        operator = 'any'\n    return {\n        'operator': operator,\n        'children': condition_list\n    }\n\n\ndef build_children_query(args_for_query):\n    children_list = []  # type: ignore\n    for key, val in args_for_query.items():\n        field_api_name = API_PARAM_DICT['search_arguments'][key]['api_name']  # type: ignore\n        operator = API_PARAM_DICT['search_arguments'][key]['operator']  # type: ignore\n        children_list += children_list_generator(field_api_name, operator, [val])\n    return children_list\n\n\ndef build_indicator_children_query(args_for_query):\n    for key, val in args_for_query.items():\n        if val:\n            field_api_name = API_PARAM_DICT['search_arguments'][key]['api_name']  # type: ignore\n            operator = API_PARAM_DICT['search_arguments'][key]['operator']  # type: ignore\n            children_list = children_list_generator(field_api_name, operator, val)\n    return children_list\n\n\ndef children_list_generator(field_name, operator, val_list):\n    query_list = []\n    for value in val_list:\n        query_list.append({\n            'field': field_name,\n            'operator': operator,\n            'value': value\n        })\n    return query_list\n\n\ndef validate_no_query_and_indicators(query, arg_list):\n    if query:\n        for arg in arg_list:\n            if arg:\n                return_error('The search command can either run a search using a custom query '\n                             'or use the builtin arguments, but not both')\n\n\ndef validate_no_multiple_indicators_for_search(arg_list):\n    used_arg = None\n    for arg in arg_list:\n        if arg and used_arg:\n            return_error(f'The search command can receive one indicator type at a time, two were given: {used_arg}, '\n                         f'{arg}. For multiple indicator types use the custom query')\n        elif arg:\n            used_arg = arg\n    if not used_arg:\n        return_error('In order to perform a samples/sessions search, a query or an indicator must be given.')\n    return\n\n\ndef search_indicator(indicator_type, indicator_value):\n    headers = HEADERS\n    headers['apiKey'] = API_KEY\n\n    params = {\n        'indicatorType': indicator_type,\n        'indicatorValue': indicator_value,\n        'includeTags': 'true',\n    }\n\n    try:\n        result = requests.request(\n            method='GET',\n            url=f'{BASE_URL}/tic',\n            verify=USE_SSL,\n            headers=headers,\n            params=params\n        )\n\n        # Handle error responses gracefully\n        result.raise_for_status()\n        result_json = result.json()\n\n    # Handle with connection error\n    except requests.exceptions.ConnectionError as err:\n        err_message = f'Error connecting to server. Check your URL/Proxy/Certificate settings: {err}'\n        return_error(err_message)\n\n    # Unexpected errors (where no json object was received)\n    except Exception as err:\n        try:\n            if demisto.params().get('handle_error', True) and result.status_code == 404:\n                return {\n                    'indicator': {\n                        'indicatorType': indicator_type,\n                        'indicatorValue': indicator_value,\n                        'latestPanVerdicts': {'PAN_DB': 'UNKNOWN'},\n                    }\n                }\n            text_error = result.json()\n        except ValueError:\n            text_error = {}\n        error_message = text_error.get('message')\n        if error_message:\n            return_error(f'Request Failed with status: {result.status_code}.\\n'\n                         f'Reason is: {str(error_message)}.')\n        elif str(result.status_code) in ERROR_DICT:\n            return_error(f'Request Failed with status: {result.status_code}.\\n'\n                         f'Reason is: {ERROR_DICT[str(result.status_code)]}.')\n        else:\n            err_msg = f'Request Failed with message: {err}.'\n        return_error(err_msg)\n\n    return result_json\n\n\ndef parse_indicator_response(res, raw_tags, indicator_type):\n    indicator = {}\n    indicator['IndicatorValue'] = res.get('indicatorValue', '')\n    indicator['IndicatorType'] = res.get('indicatorType', '')\n    indicator['LatestPanVerdicts'] = res.get('latestPanVerdicts', '')\n    indicator['WildfireRelatedSampleVerdictCounts'] = res.get('wildfireRelatedSampleVerdictCounts', '')\n    indicator['SeenBy'] = res.get('seenByDataSourceIds', '')\n\n    first_seen = res.get('firstSeenTsGlobal', '')\n    last_seen = res.get('lastSeenTsGlobal', '')\n\n    if first_seen:\n        indicator['FirstSeen'] = timestamp_to_datestring(first_seen)\n    if last_seen:\n        indicator['LastSeen'] = timestamp_to_datestring(last_seen)\n\n    if raw_tags:\n        tags = []\n        for tag in raw_tags:\n            tags.append({\n                'PublicTagName': tag.get('public_tag_name', ''),\n                'TagName': tag.get('tag_name', ''),\n                'CustomerName': tag.get('customer_name', ''),\n                'Source': tag.get('source', ''),\n                'TagDefinitionScopeID': tag.get('tag_definition_scope_id', ''),\n                'TagDefinitionStatusID': tag.get('tag_definition_status_id', ''),\n                'TagClassID': tag.get('tag_class_id', ''),\n                'Count': tag.get('count', ''),\n                'Lasthit': tag.get('lasthit', ''),\n                'Description': tag.get('description', '')})\n        indicator['Tags'] = tags\n\n    if indicator_type == 'Domain':\n        indicator['WhoisAdminCountry'] = res.get('whoisAdminCountry', '')\n        indicator['WhoisAdminEmail'] = res.get('whoisAdminEmail', '')\n        indicator['WhoisAdminName'] = res.get('whoisAdminName', '')\n        indicator['WhoisDomainCreationDate'] = res.get('whoisDomainCreationDate', '')\n        indicator['WhoisDomainExpireDate'] = res.get('whoisDomainExpireDate', '')\n        indicator['WhoisDomainUpdateDate'] = res.get('whoisDomainUpdateDate', '')\n        indicator['WhoisRegistrar'] = res.get('whoisRegistrar', '')\n        indicator['WhoisRegistrarUrl'] = res.get('whoisRegistrarUrl', '')\n        indicator['WhoisRegistrant'] = res.get('whoisRegistrant', '')\n\n    return indicator\n\n\ndef calculate_dbot_score(indicator_response, indicator_type):\n    latest_pan_verdicts = indicator_response['latestPanVerdicts']\n    if not latest_pan_verdicts:\n        raise Exception('latestPanVerdicts value is empty in indicator response.')\n\n    pan_db = latest_pan_verdicts.get('PAN_DB')\n    wf_sample = latest_pan_verdicts.get('WF_SAMPLE')\n\n    # use WF_SAMPLE value for file indicator and PAN_DB for domain,url and ip indicators\n    if indicator_type == 'File' and wf_sample:\n        return VERDICTS_TO_DBOTSCORE.get(wf_sample.lower(), 0)\n    elif pan_db:\n        return VERDICTS_TO_DBOTSCORE.get(pan_db.lower(), 0)\n    else:\n        score = next(iter(latest_pan_verdicts.values()))\n        return VERDICTS_TO_DBOTSCORE.get(score.lower(), 0)\n\n\ndef check_for_ip(indicator):\n    if '-' in indicator:\n        # check for address range\n        ip1, ip2 = indicator.split('-', 1)\n\n        if re.match(ipv4Regex, ip1) and re.match(ipv4Regex, ip2):\n            return FeedIndicatorType.IP\n\n        elif re.match(ipv6Regex, ip1) and re.match(ipv6Regex, ip2):\n            return FeedIndicatorType.IPv6\n\n        elif re.match(ipv4cidrRegex, ip1) and re.match(ipv4cidrRegex, ip2):\n            return FeedIndicatorType.CIDR\n\n        elif re.match(ipv6cidrRegex, ip1) and re.match(ipv6cidrRegex, ip2):\n            return FeedIndicatorType.IPv6CIDR\n\n        return None\n\n    if '/' in indicator:\n\n        if re.match(ipv4cidrRegex, indicator):\n            return FeedIndicatorType.CIDR\n\n        elif re.match(ipv6cidrRegex, indicator):\n            return FeedIndicatorType.IPv6CIDR\n\n        return None\n\n    else:\n        if re.match(ipv4Regex, indicator):\n            return FeedIndicatorType.IP\n\n        elif re.match(ipv6Regex, indicator):\n            return FeedIndicatorType.IPv6\n\n    return None\n\n\ndef find_indicator_type(indicator):\n    \"\"\"Infer the type of the indicator.\n\n    Args:\n        indicator(str): The indicator whose type we want to check.\n\n    Returns:\n        str. The type of the indicator.\n    \"\"\"\n    # trying to catch X.X.X.X:portNum\n    if ':' in indicator and '/' not in indicator:\n        sub_indicator = indicator.split(':', 1)[0]\n        ip_type = check_for_ip(sub_indicator)\n        if ip_type:\n            return ip_type\n\n    ip_type = check_for_ip(indicator)\n\n    if ip_type:\n        # catch URLs of type X.X.X.X/path/url or X.X.X.X:portNum/path/url\n        if '/' in indicator and (ip_type not in [FeedIndicatorType.IPv6CIDR, FeedIndicatorType.CIDR]):\n            return FeedIndicatorType.URL\n\n        else:\n            return ip_type\n\n    elif re.match(sha256Regex, indicator):\n        return FeedIndicatorType.File\n\n    # in AutoFocus, URLs include a path while domains do not - so '/' is a good sign for us to catch URLs.\n    elif '/' in indicator:\n        return FeedIndicatorType.URL\n\n    else:\n        return FeedIndicatorType.Domain\n\n\ndef resolve_ip_address(ip):\n    if check_for_ip(ip):\n        return socket.gethostbyaddr(ip)[0]\n\n    return None\n\n\ndef convert_url_to_ascii_character(url_name):\n    def convert_non_ascii_chars(non_ascii):\n        # converts non-ASCII chars to IDNA notation\n        return str(non_ascii.group(0)).encode('idna').decode(\"utf-8\")\n\n    return re.sub('([^a-zA-Z\\W]+)', convert_non_ascii_chars, url_name)\n\n\n''' COMMANDS'''\n\n\ndef test_module():\n    \"\"\"\n    Performs basic get request to get item samples\n    \"\"\"\n    query = {\n        'operator': 'all',\n        'children': [\n            {\n                'field': 'sample.malware',\n                'operator': 'is',\n                'value': 1\n            }\n        ]\n    }\n\n    do_search('samples', query=query, scope='Public', err_operation='Test module failed')\n    return\n\n\ndef search_samples_command(args):\n    file_hash = argToList(args.get('file_hash'))\n    domain = argToList(args.get('domain'))\n    ip = argToList(args.get('ip'))\n    url = argToList(args.get('url'))\n    wildfire_verdict = args.get('wildfire_verdict')\n    first_seen = argToList(args.get('first_seen'))\n    last_updated = argToList(args.get('last_updated'))\n    query = args.get('query')\n    scope = args.get('scope').capitalize()\n    max_results = args.get('max_results')\n    sort = args.get('sort')\n    order = args.get('order')\n    artifact_source = args.get('artifact')\n    info = search_samples(query=query, scope=scope, size=max_results, sort=sort, order=order, file_hash=file_hash,\n                          domain=domain, ip=ip, url=url, wildfire_verdict=wildfire_verdict, first_seen=first_seen,\n                          last_updated=last_updated, artifact_source=artifact_source)\n    md = tableToMarkdown('Search Samples Info:', info)\n    return CommandResults(outputs=info, readable_output=md, outputs_key_field='AFCookie',\n                          outputs_prefix='AutoFocus.SamplesSearch')\n\n\ndef search_samples_with_polling_command(args):\n    return run_polling_command(args, 'autofocus-search-samples', search_samples_command, samples_search_results_command)\n\n\ndef search_sessions_with_polling_command(args):\n    return run_polling_command(args, 'autofocus-search-sessions', search_sessions_command,\n                               sessions_search_results_command)\n\n\ndef search_sessions_command(args):\n    file_hash = argToList(args.get('file_hash'))\n    domain = argToList(args.get('domain'))\n    ip = argToList(args.get('ip'))\n    url = argToList(args.get('url'))\n    from_time = args.get('time_after')\n    to_time = args.get('time_before')\n    time_range = args.get('time_range')\n    query = args.get('query')\n    max_results = args.get('max_results')\n    sort = args.get('sort')\n    order = args.get('order')\n\n    if time_range:\n        if from_time or to_time:\n            return_error(\"The 'time_range' argument cannot be specified with neither 'time_after' nor 'time_before' \"\n                         \"arguments.\")\n        else:\n            from_time, to_time = time_range.split(',')\n\n    info = search_sessions(query=query, size=max_results, sort=sort, order=order, file_hash=file_hash, domain=domain,\n                           ip=ip, url=url, from_time=from_time, to_time=to_time)\n    md = tableToMarkdown('Search Sessions Info:', info)\n    cmd_results = CommandResults(\n        outputs_prefix='AutoFocus.SessionsSearch',\n        outputs_key_field='AFCookie',\n        outputs=info,\n        readable_output=md\n    )\n    return cmd_results\n\n\ndef samples_search_results_command(args):\n    af_cookie = args.get('af_cookie')\n    results, status = get_search_results('samples', af_cookie)\n    files = get_files_data_from_results(results)\n    hr = ''\n    if not results or len(results) == 0:\n        hr = 'No entries found that match the query' if status == 'complete' else f'Search Sessions Results is {status}'\n    context = {\n        'AutoFocus.SamplesResults(val.ID === obj.ID)': results,\n        'AutoFocus.SamplesSearch(val.AFCookie === obj.AFCookie)': {'Status': status, 'AFCookie': af_cookie},\n        outputPaths['file']: files\n    }\n    if not results:\n        return_outputs(readable_output=hr, outputs=context, raw_response={})\n    else:\n        # for each result a new entry will be set with two tables, one of the result and one of its artifacts\n        for result in results:\n            if 'Artifact' in result:\n                hr = samples_search_result_hr(result, status)\n                return_outputs(readable_output=hr, outputs=context, raw_response=results)\n            else:\n                hr = tableToMarkdown(f'Search Samples Result is {status}', result)\n                hr += tableToMarkdown('Artifacts for Sample: ', [])\n                return_outputs(readable_output=hr, outputs=context, raw_response=results)\n    return None, status\n\n\ndef samples_search_result_hr(result: dict, status: str) -\u003e str:\n    \"\"\"\n    Creates human readable output for a specific entry which contains two tables, one for the result's\n    and another for the artifacts that are related to it.\n    Args:\n        result: one result of the search sample command.\n        status: status of result command.\n    Returns:\n        human readable of two tables for this result.\n    \"\"\"\n    artifact = result.pop('Artifact')\n    updated_artifact = []\n    for indicator in artifact:\n        # Filter on returned indicator types, as we do not support Mutex and User Agent.\n        if 'Mutex' not in indicator.get('indicator_type') and 'User Agent' not in indicator.get('indicator_type'):\n            updated_artifact.append(indicator)\n    rest = result\n    hr = tableToMarkdown(f'Search Samples Result is {status}', rest)\n    hr += '\\n\\n'\n    hr += tableToMarkdown(\n        'Artifacts for Sample: ', updated_artifact,\n        headers=[\"b\", \"g\", \"m\", \"indicator_type\", \"confidence\", \"indicator\"])\n    return hr\n\n\ndef sessions_search_results_command(args):\n    af_cookie = args.get('af_cookie')\n    results, status = get_search_results('sessions', af_cookie)\n    files = get_files_data_from_results(results)\n    if not results or len(results) == 0:\n        md = results = 'No entries found that match the query'\n    else:\n        md = tableToMarkdown(f'Search Samples Results is {status}', results)\n    context = {\n        'AutoFocus.SessionsResults(val.ID === obj.ID)': results,\n        'AutoFocus.SessionsSearch(val.AFCookie === obj.AFCookie)': {'Status': status, 'AFCookie': af_cookie},\n        outputPaths['file']: files\n    }\n    return CommandResults(outputs=context, raw_response=results, readable_output=md), status\n\n\ndef get_session_details_command():\n    args = demisto.args()\n    session_id = args.get('session_id')\n    result = get_session_details(session_id)\n    files = get_files_data_from_results(result)\n    md = tableToMarkdown(f'Session {session_id}:', result)\n    context = {\n        'AutoFocus.Sessions(val.ID === obj.ID)': result,\n        outputPaths['file']: files\n    }\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['text'],\n        'Contents': result,\n        'EntryContext': context,\n        'HumanReadable': md\n    })\n\n\ndef sample_analysis_command():\n    args = demisto.args()\n    sample_id = args.get('sample_id')\n    os = args.get('os')\n    filter_data = False if args.get('filter_data') == 'False' else True\n    analysis = sample_analysis(sample_id, os, filter_data)\n    context = createContext(analysis, keyTransform=string_to_context_key)\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['text'],\n        'Contents': {'ID': sample_id, 'Analysis': analysis},\n        'HumanReadable': f'### Sample Analysis results for {sample_id}:',\n        'EntryContext': {'AutoFocus.SampleAnalysis(val.ID == obj.ID)': {'ID': sample_id, 'Analysis': context}},\n    })\n    for category_name, category_data in analysis.items():\n        print_hr_by_category(category_name, category_data)\n\n\ndef tag_details_command():\n    args = demisto.args()\n    tag_name = args.get('tag_name')\n    result = autofocus_tag_details(tag_name)\n    md = tableToMarkdown(f'Tag {tag_name} details:', result, headerTransform=string_to_table_header)\n    context = createContext(result, keyTransform=string_to_context_key)\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['text'],\n        'Contents': result,\n        'EntryContext': {'AutoFocus.Tag(val.ID == obj.ID)': context},\n        'HumanReadable': md\n    })\n\n\ndef top_tags_search_command(args):\n    scope = args.get('scope')\n    tag_class = args.get('class')\n    private = args.get('private') == 'True'\n    public = args.get('public') == 'True'\n    commodity = args.get('commodity') == 'True'\n    unit42 = args.get('unit42') == 'True'\n    info = autofocus_top_tags_search(scope, tag_class, private, public, commodity, unit42)\n    md = tableToMarkdown('Top tags search Info:', info)\n    return CommandResults(\n        outputs_prefix='AutoFocus.TopTagsSearch',\n        outputs_key_field='AFCookie',\n        outputs=info,\n        readable_output=md\n    )\n\n\ndef top_tags_results_command(args) -\u003e Tuple[CommandResults, str]:\n    af_cookie = args.get('af_cookie')\n    results, status = get_top_tags_results(af_cookie)\n    md = tableToMarkdown(f'Search Top Tags Results is {status}:', results, headerTransform=string_to_table_header)\n    context = createContext(results, keyTransform=string_to_context_key)\n    outputs = {\n        'AutoFocus.TopTagsResults(val.PublicTagName === obj.PublicTagName)': context,\n        'AutoFocus.TopTagsSearch(val.AFCookie === obj.AFCookie)': {'Status': status, 'AFCookie': af_cookie}\n    }\n    return CommandResults(outputs=outputs, raw_response=results, readable_output=md), status\n\n\ndef top_tags_with_polling_command(args):\n    return run_polling_command(args, 'autofocus-top-tags-search', top_tags_search_command, top_tags_results_command)\n\n\ndef search_ip_command(ip, reliability, create_relationships):\n    indicator_type = 'IP'\n    ip_list = argToList(ip)\n\n    command_results = []\n    relationships = []\n\n    for ip_address in ip_list:\n        raw_res = search_indicator('ipv4_address', ip_address)\n        if not raw_res.get('indicator'):\n            raise ValueError('Invalid response for indicator')\n\n        indicator = raw_res.get('indicator')\n        raw_tags = raw_res.get('tags')\n\n        score = calculate_dbot_score(indicator, indicator_type)\n        dbot_score = Common.DBotScore(\n            indicator=ip_address,\n            indicator_type=DBotScoreType.IP,\n            integration_name=VENDOR_NAME,\n            score=score,\n            reliability=reliability\n        )\n        if create_relationships:\n            relationships = create_relationships_list(entity_a=ip_address, entity_a_type=indicator_type, tags=raw_tags,\n                                                      reliability=reliability)\n        ip = Common.IP(\n            ip=ip_address,\n            dbot_score=dbot_score,\n            malware_family=get_tags_for_tags_and_malware_family_fields(raw_tags, True),\n            tags=get_tags_for_tags_and_malware_family_fields(raw_tags),\n            relationships=relationships\n        )\n\n        autofocus_ip_output = parse_indicator_response(indicator, raw_tags, indicator_type)\n\n        # create human readable markdown for ip\n        tags = autofocus_ip_output.get('Tags')\n        table_name = f'{VENDOR_NAME} {indicator_type} reputation for: {ip_address}'\n        if tags:\n            indicators_data = autofocus_ip_output.copy()\n            del indicators_data['Tags']\n            md = tableToMarkdown(table_name, indicators_data)\n            md += tableToMarkdown('Indicator Tags:', tags)\n        else:\n            md = tableToMarkdown(table_name, autofocus_ip_output)\n\n        command_results.append(CommandResults(\n            outputs_prefix='AutoFocus.IP',\n            outputs_key_field='IndicatorValue',\n            outputs=autofocus_ip_output,\n            readable_output=md,\n            raw_response=raw_res,\n            indicator=ip,\n            relationships=relationships\n        ))\n\n    return command_results\n\n\ndef search_domain_command(domain, reliability, create_relationships):\n    indicator_type = 'Domain'\n    domain_name_list = argToList(domain)\n\n    command_results = []\n    relationships = []\n\n    for domain_name in domain_name_list:\n        raw_res = search_indicator('domain', domain_name)\n        indicator = raw_res.get('indicator')\n\n        if indicator:\n            raw_tags = raw_res.get('tags')\n            score = calculate_dbot_score(indicator, indicator_type)\n            dbot_score = Common.DBotScore(\n                indicator=domain_name,\n                indicator_type=DBotScoreType.DOMAIN,\n                integration_name=VENDOR_NAME,\n                score=score,\n                reliability=reliability\n            )\n            if create_relationships:\n                relationships = create_relationships_list(entity_a=domain_name, entity_a_type=indicator_type,\n                                                          tags=raw_tags,\n                                                          reliability=reliability)\n            domain = Common.Domain(\n                domain=domain_name,\n                dbot_score=dbot_score,\n                creation_date=indicator.get('whoisDomainCreationDate'),\n                expiration_date=indicator.get('whoisDomainExpireDate'),\n                updated_date=indicator.get('whoisDomainUpdateDate'),\n                admin_email=indicator.get('whoisAdminEmail'),\n                admin_name=indicator.get('whoisAdminName'),\n                admin_country=indicator.get('whoisAdminCountry'),\n                registrar_name=indicator.get('whoisRegistrar'),\n                registrant_name=indicator.get('whoisRegistrant'),\n                malware_family=get_tags_for_tags_and_malware_family_fields(raw_tags, True),\n                tags=get_tags_for_tags_and_malware_family_fields(raw_tags),\n                relationships=relationships\n            )\n            autofocus_domain_output = parse_indicator_response(indicator, raw_tags, indicator_type)\n            # create human readable markdown for ip\n            tags = autofocus_domain_output.get('Tags')\n            table_name = f'{VENDOR_NAME} {indicator_type} reputation for: {domain_name}'\n            if tags:\n                indicators_data = autofocus_domain_output.copy()\n                del indicators_data['Tags']\n                md = tableToMarkdown(table_name, indicators_data)\n                md += tableToMarkdown('Indicator Tags:', tags)\n            else:\n                md = tableToMarkdown(table_name, autofocus_domain_output)\n        else:\n            dbot_score = Common.DBotScore(\n                indicator=domain_name,\n                indicator_type=DBotScoreType.DOMAIN,\n                integration_name=VENDOR_NAME,\n                score=0,\n                reliability=reliability\n            )\n            domain = Common.Domain(\n                domain=domain_name,\n                dbot_score=dbot_score\n            )\n            md = f'### The Domain indicator: {domain_name} was not found in AutoFocus'\n            autofocus_domain_output = {'IndicatorValue': domain_name}\n\n        command_results.append(CommandResults(\n            outputs_prefix='AutoFocus.Domain',\n            outputs_key_field='IndicatorValue',\n            outputs=autofocus_domain_output,\n            readable_output=md,\n            raw_response=raw_res,\n            indicator=domain,\n            relationships=relationships\n        ))\n    return command_results\n\n\ndef search_url_command(url, reliability, create_relationships):\n    indicator_type = 'URL'\n    url_list = argToList(url)\n\n    command_results = []\n    relationships = []\n\n    for url_name in url_list:\n        raw_res = search_indicator('url', convert_url_to_ascii_character(url_name))\n        if not raw_res.get('indicator'):\n            raise ValueError('Invalid response for indicator')\n\n        indicator = raw_res.get('indicator')\n        indicator['indicatorValue'] = url_name\n        raw_tags = raw_res.get('tags')\n\n        score = calculate_dbot_score(indicator, indicator_type)\n\n        dbot_score = Common.DBotScore(\n            indicator=url_name,\n            indicator_type=DBotScoreType.URL,\n            integration_name=VENDOR_NAME,\n            score=score,\n            reliability=reliability\n        )\n        if create_relationships:\n            relationships = create_relationships_list(entity_a=url_name, entity_a_type=indicator_type,\n                                                      tags=raw_tags,\n                                                      reliability=reliability)\n        url = Common.URL(\n            url=url_name,\n            dbot_score=dbot_score,\n            malware_family=get_tags_for_tags_and_malware_family_fields(raw_tags, True),\n            tags=get_tags_for_tags_and_malware_family_fields(raw_tags),\n            relationships=relationships\n        )\n\n        autofocus_url_output = parse_indicator_response(indicator, raw_tags, indicator_type)\n        autofocus_url_output = {k: v for k, v in autofocus_url_output.items() if v}\n\n        tags = autofocus_url_output.get('Tags')\n        table_name = f'{VENDOR_NAME} {indicator_type} reputation for: {url_name}'\n        if tags:\n            indicators_data = autofocus_url_output.copy()\n            del indicators_data['Tags']\n            md = tableToMarkdown(table_name, indicators_data)\n            md += tableToMarkdown('Indicator Tags:', tags)\n        else:\n            md = tableToMarkdown(table_name, autofocus_url_output)\n\n        command_results.append(CommandResults(\n            outputs_prefix='AutoFocus.URL',\n            outputs_key_field='IndicatorValue',\n            outputs=autofocus_url_output,\n            readable_output=md,\n            raw_response=raw_res,\n            indicator=url,\n            relationships=relationships\n        ))\n\n    return command_results\n\n\ndef search_file_command(file, reliability, create_relationships):\n    indicator_type = 'File'\n    file_list = argToList(file)\n\n    command_results = []\n    relationships = []\n\n    for sha256 in file_list:\n        raw_res = search_indicator('filehash', sha256.lower())\n        if not raw_res.get('indicator'):\n            raise ValueError('Invalid response for indicator')\n\n        indicator = raw_res.get('indicator')\n        raw_tags = raw_res.get('tags')\n\n        score = calculate_dbot_score(indicator, indicator_type)\n        dbot_score = Common.DBotScore(\n            indicator=sha256,\n            indicator_type=DBotScoreType.FILE,\n            integration_name=VENDOR_NAME,\n            score=score,\n            reliability=reliability\n        )\n        if create_relationships:\n            relationships = create_relationships_list(entity_a=sha256, entity_a_type=indicator_type,\n                                                      tags=raw_tags,\n                                                      reliability=reliability)\n        autofocus_file_output = parse_indicator_response(indicator, raw_tags, indicator_type)\n\n        tags = autofocus_file_output.get('Tags')\n        table_name = f'{VENDOR_NAME} {indicator_type} reputation for: {sha256}'\n        if tags:\n            indicators_data = autofocus_file_output.copy()\n            del indicators_data['Tags']\n            md = tableToMarkdown(table_name, indicators_data)\n            md += tableToMarkdown('Indicator Tags:', tags)\n        else:\n            md = tableToMarkdown(table_name, autofocus_file_output)\n\n        file = Common.File(\n            sha256=sha256,\n            dbot_score=dbot_score,\n            malware_family=get_tags_for_tags_and_malware_family_fields(raw_tags, True),\n            tags=get_tags_for_tags_and_malware_family_fields(raw_tags),\n            relationships=relationships\n        )\n\n        command_results.append(CommandResults(\n            outputs_prefix='AutoFocus.File',\n            outputs_key_field='IndicatorValue',\n            outputs=autofocus_file_output,\n\n            readable_output=md,\n            raw_response=raw_res,\n            indicator=file,\n            relationships=relationships\n        ))\n\n    return command_results\n\n\ndef get_tags_for_generic_context(tags: Optional[list]):\n    if not tags:\n        return None\n    results = []\n    keys = ['TagGroups', 'Aliases', 'PublicTagName', 'TagName']\n    sub_keys = ['TagGroupName']\n    for item in tags:\n        generic_context_tags = {key: item.get(key) for key in keys}\n        generic_context_tags['tagGroups'] = {key: item.get(key) for key in sub_keys}\n        results.append(remove_empty_elements(generic_context_tags))\n    return results\n\n\ndef get_tags_for_tags_and_malware_family_fields(tags: Optional[list], is_malware_family=False):\n    \"\"\"get specific tags for the tgas and malware_family fields\n    Args\n        tags (Optional[list]): tags from the response\n        is_malware_family (bool): indicating whether it is for the malware_family field\n    return:\n        List[str]: list of tags without duplicates and empty elements\n    \"\"\"\n    if not tags:\n        return None\n    results = []\n    for item in tags:\n        results.append(item.get('tag_name'))\n        results.append(item.get('public_tag_name'))\n        for alias in item.get('aliases', []):\n            results.append(alias)\n        if not is_malware_family:\n            for group in item.get('tagGroups', [{}]):\n                results.append(group.get('tag_group_name'))\n    # Returns a list without duplicates and empty elements\n    return list(set(filter(None, results)))\n\n\ndef create_relationships_list(entity_a, entity_a_type, tags, reliability):\n    \"\"\"\n    Create a list of relationships objects from the tags.\n\n    entity_a (str): the entity a of the relation which is the current indicator.\n    entity_a_type (str): the entity a type which is the type of the current indicator (IP/Domain/URL/File)\n    tags (list): list of tags returned from the api.\n    reliability (str): reliability of the source.\n\n    return:\n    list of EntityRelationship objects containing all the relationships from the enricher.\n    \"\"\"\n    if not tags:\n        return []\n    relationships = []\n    for tag in tags:\n        tag_class = tag.get('tag_class_id')\n        entity_b = tag.get('tag_name')\n        relation_by_type = RELATIONSHIP_TYPE_BY_TAG_CLASS_ID.get(tag_class)\n        if entity_b and relation_by_type:\n            relationships.append(EntityRelationship(relation_by_type.get('name'),\n                                                    entity_a=entity_a,\n                                                    entity_a_type=entity_a_type,\n                                                    entity_b=entity_b,\n                                                    entity_b_type=FeedIndicatorType.indicator_type_by_server_version(\n                                                        relation_by_type.get('entity_b_type')),\n                                                    source_reliability=reliability,\n                                                    brand=VENDOR_NAME))\n\n    return relationships\n\n\ndef get_export_list_command(args):\n    # the label is the name of the export list we want to fetch.\n    # panosFormatted is a flag stating that only indicators should be returned in the list.\n    data = {\n        'label': args.get('label'),\n        'panosFormatted': True,\n        'apiKey': ''\n    }\n\n    results = http_request(url_suffix='/export', method='POST', data=data,\n                           err_operation=f\"Failed to fetch export list: {args.get('label')}\")\n\n    indicators = []\n    context_ip = []\n    context_url = []\n    context_domain = []\n    context_file = []\n    for indicator_value in results.get('export_list'):\n        indicator_type = find_indicator_type(indicator_value)\n        if indicator_type in [FeedIndicatorType.IP,\n                              FeedIndicatorType.IPv6, FeedIndicatorType.IPv6CIDR, FeedIndicatorType.CIDR]:\n            if '-' in indicator_value:\n                context_ip.append({\n                    'Address': indicator_value.split('-')[0]\n                })\n                context_ip.append({\n                    'Address': indicator_value.split('-')[1]\n                })\n\n            elif \":\" in indicator_value:\n                context_ip.append({\n                    'Address': indicator_value.split(\":\", 1)[0]\n                })\n\n            else:\n                context_ip.append({\n                    'Address': indicator_value\n                })\n\n        elif indicator_type in [FeedIndicatorType.Domain]:\n            context_domain.append({\n                'Name': indicator_value\n            })\n\n        elif indicator_type in [FeedIndicatorType.File]:\n            context_file.append({\n                'SHA256': indicator_value\n            })\n\n        elif indicator_type in [FeedIndicatorType.URL]:\n            if \":\" in indicator_value:\n                resolved_address = resolve_ip_address(indicator_value.split(\":\", 1)[0])\n                semicolon_suffix = indicator_value.split(\":\", 1)[1]\n                slash_suffix = None\n\n            else:\n                resolved_address = resolve_ip_address(indicator_value.split(\"/\", 1)[0])\n                slash_suffix = indicator_value.split(\"/\", 1)[1]\n                semicolon_suffix = None\n\n            if resolved_address:\n                if semicolon_suffix:\n                    indicator_value = resolved_address + \":\" + semicolon_suffix\n\n                else:\n                    indicator_value = resolved_address + \"/\" + slash_suffix\n\n            context_url.append({\n                'Data': indicator_value,\n            })\n\n        indicators.append({\n            'Type': indicator_type,\n            'Value': indicator_value,\n        })\n\n    hr = tableToMarkdown(f\"Export list {args.get('label')}\", indicators, headers=['Type', 'Value'])\n\n    return_outputs(hr, {'AutoFocus.Indicator(val.Value == obj.Value \u0026\u0026 val.Type == obj.Type)': indicators,\n                        'IP(obj.Address == val.Address)': context_ip,\n                        'URL(obj.Data == val.Data)': context_url,\n                        'File(obj.SHA256 == val.SHA256)': context_file,\n                        'Domain(obj.Name == val.Name)': context_domain},\n                   results)\n\n\ndef main():\n    demisto.debug('Command being called is %s' % (demisto.command()))\n    reliability = PARAMS.get('integrationReliability', 'B - Usually reliable')\n    create_relationships = PARAMS.get('create_relationships', True)\n    if DBotScoreReliability.is_valid_type(reliability):\n        reliability = DBotScoreReliability.get_dbot_score_reliability_from_str(reliability)\n    else:\n        Exception(\"AutoFocus error: Please provide a valid value for the Source Reliability parameter\")\n\n    try:\n        # Remove proxy if not set to true in params\n        handle_proxy()\n        active_command = demisto.command()\n        args = {k: v for (k, v) in demisto.args().items() if v}\n        args['reliability'] = reliability\n        args['create_relationships'] = create_relationships\n        if active_command == 'test-module':\n            # This is the call made when pressing the integration test button.\n            test_module()\n            demisto.results('ok')\n        elif active_command == 'autofocus-search-samples':\n            if args.get('polling') == 'true':\n                cmd_res = search_samples_with_polling_command(args)\n                if cmd_res is not None:\n                    return_results(cmd_res)\n            else:\n                return_results(search_samples_command(args))\n        elif active_command == 'autofocus-search-sessions':\n            if args.get('polling') == 'true':\n                return_results(search_sessions_with_polling_command(args))\n            else:\n                return_results(search_sessions_command(args))\n        elif active_command == 'autofocus-samples-search-results':\n            samples_search_results_command(args)\n        elif active_command == 'autofocus-sessions-search-results':\n            return_results(sessions_search_results_command(args)[0])  # first result is CommandResults\n        elif active_command == 'autofocus-get-session-details':\n            get_session_details_command()\n        elif active_command == 'autofocus-sample-analysis':\n            sample_analysis_command()\n        elif active_command == 'autofocus-tag-details':\n            tag_details_command()\n        elif active_command == 'autofocus-top-tags-search':\n            if args.get('polling') == 'true':\n                return_results(top_tags_with_polling_command(args))\n            else:\n                return_results(top_tags_search_command(args))\n        elif active_command == 'autofocus-top-tags-results':\n            return_results(top_tags_results_command(args)[0])\n        elif active_command == 'autofocus-get-export-list-indicators':\n            get_export_list_command(args)\n        elif active_command == 'ip':\n            return_results(search_ip_command(**args))\n        elif active_command == 'domain':\n            return_results(search_domain_command(**args))\n        elif active_command == 'url':\n            return_results(search_url_command(**args))\n        elif active_command == 'file':\n            return_results(search_file_command(**args))\n\n    except Exception as e:\n        return_error(f'Unexpected error: {e}.\\ntraceback: {traceback.format_exc()}')\n\n\nif __name__ in ['__main__', 'builtin', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.3.9","modified":"2021-09-07T09:21:43.460236+03:00","name":"AutoFocus V2","packID":"AutoFocus","packPropagationLabels":["all"],"prevName":"AutoFocus V2","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":5},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":[{"defaultValue":"false","display":"Return Errors","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"with_error","options":null,"required":false,"type":8},{"defaultValue":"0","display":"Time to wait before taking a screen shot (in seconds)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"wait_time","options":null,"required":false,"type":0},{"defaultValue":"180","display":"Maximum time to wait for a page to load (in seconds)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"max_page_load_time","options":null,"required":false,"type":0},{"defaultValue":"","display":"Chrome options (Advanced. See [?])","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"chrome_options","options":null,"required":false,"type":0},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"Converts URLs, PDF files, and emails to an image file or PDF file.","detailedDescription":"## Rasterize\nCreate an image or PDF file from a URL or HTML body.\n\n**Configuration Notes:**\n* Return Errors: If this checkbox is not selected, a warning will be returned instead of an error entry.\n* Use system proxy settings: Select this checkbox to use the system's proxy settings. **Important**: this integration does not support proxies which require authentication.\n* Chrome options: Add or remove Chrome options used to rasterize. Supports a comma-separated list. If a value contains a comma (for example, when setting the user agent value), escape it with the backslash (**\\\\**) character. To remove a default option being used, put the option in square brackets. For example, to add the option *--disable-auto-reload* and remove the option *--disable-dev-shm-usage*, set the following value:\n```\n--disable-auto-reload,[--disable-dev-shm-usage]\n```\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/rasterize)","display":"Rasterize","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Rasterize","image":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAABGdBTUEAALGPC/xhBQAABGZJREFUeAHtnF2oFWUUhvfpaEoWmj8XgZoFpoUgwdEuCqJAqAi9ESKQwiAVUST0gEmggooieNOFJBSEBYIRBQkRXogGCUYSqESk+EOCiZRBRf5Uz5vzeRYbZ5+Z7Zk9a5+zFjx7vvlmvjVr1trrnTlbsKfRHfavCbPHjL3Nm9B8DO/xEUZEUVUGosBVZdaJXyt3TkK6HcaA/H677Paku0HfHhuSu3xGB9vyDMNxFHgYFtXe0ii742xs5W5ArqsO0kpusUeDjbPq6Er7jw4unbLuWhAF7q56lY7Ws0TXL8vF5NrG6U6uo4NL90R3LYgCd1e9SkfrWaKt3FkZLH2Tgy6wb8vFZNm6tHHaeRfj6GAXZaguiChwdbl14dmzRA+NLJeVXCvXxUpk43Qn19HBxYrYtWdFgbu2dMUC9yzRVu6sDA5+Z3mynDef57HY+TbOPE+1zUcH15b6zlw4CtyZPNd2Fc8SXa0s58lv2flGw8bpTq6jg2vrrc5cOArcmTzXdhXPEm3lzsrgQLLKymkV5zcaNs6B2JyMooOdFKKqMKLAVWXWiV/PEu1Xlu3v1X17bJzu5Do62EmnVRVGFLiqzDrx605ScvKSJ4Pe5nPCr286Ori+3HfkylHgjqQ5LhIZiAxEBiIDkYHIwEjLQK+TG55MHNNA24lwE/6Guu0ZAvgCTsD5uoNp5/pe3qJXE/wPGT+y/Q2+hoehXdPaQ/B4uw5YpwYQXvJ0F7dS79LNXF4/WjwHT8JKUBere9o1+ZLPp9p1EOuGLgOpwNONy8OML2T789l+ChfhJLwFqavGMn4XzsNZ2AkL4QyowNp+BzKtWQ9n4RfYDVov2wH6H1WWgK7bD8+DrvcsyD4D7VvGs9/KL4frM6//mjSblPTBl1lq5rL9A/pBxd4FR+EbeA2WgwozGmbBT3AMHgEVRfuytbAFNsIV2AqXYBNMhRdgAbwHuvaj8AQ8ALL9MAmmwDtwEH6HdZDnl0NhqYNPkwp1jzrvHMwDaw+x8xL8A0qobBtchyVwLyRbwUB+rERLAT6HBzM+YnscZB+D/NprLmJfPl4Ga1ITvSfoxVDWyu+tM0b4ZyrwJvLwPiipr0CyOQyOgLrlK7gBKohM3bUP9My+DG+CrLnA9zMnv82kx4D8/QXW7lTg1zlBPvSFkg3m99ZZI/wzFXg6eVAXqpP1Np068hRjyXGSyj8ZpwIz/N9m8Ck5Vhc+BstAhXgakv3K4ACMMvRmB4sUWPFdhU+yNWnTym86p5atXg682TUCehtmwuosuLFsVbip0A/aT7aKwVJQV38PPTAGfgbZq5D+VNrL+EVYAzNAcq/nbBGT3w/hPpDMy4/Ql+5u/LJ8+NtmblHdpg5Jpo7Vc24KvJGNVWS96ByH1MEbsmNar2fxdpCNhiOgea3TDyjj4APQl0HzV2AxyOSvlUTP5bjWNKP5Vn45HFYkA+raCTknqrv05VB3NZu6fnLTpHzp/KFWsKr8NoUfu5GByMDIyMB/DVAH+glQKKAAAAAASUVORK5CYII=","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"Time in seconds to wait before taking a screenshot","name":"wait_time","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Maximum time to wait for a page to load (in seconds)","name":"max_page_load_time","required":false,"secret":false},{"default":true,"deprecated":false,"description":"The URL to rasterize. Must be the full URL, including the http prefix.","name":"url","required":true,"secret":false},{"default":false,"defaultValue":"1024px","deprecated":false,"description":"The page width, for example, 1024px. Specify with or without the px suffix.","name":"width","required":false,"secret":false},{"default":false,"defaultValue":"800px","deprecated":false,"description":"The page height, for example, 800px. Specify with or without the px suffix.","name":"height","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The file type to which to convert the contents of the URL. Can be \"pdf\" or \"png\". Default is \"png\".","name":"type","predefined":["pdf","png","json"],"required":false,"secret":false},{"default":false,"defaultValue":"url","deprecated":false,"description":"The name the file will be saved as.","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Converts the contents of a URL to an image file or a PDF file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"rasterize","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The HTML body of the email.","name":"htmlBody","required":true,"secret":false},{"default":false,"defaultValue":"600px","deprecated":false,"description":"The html page width, for example, 600px. Specify with or without the px suffix.","name":"width","required":false,"secret":false},{"default":false,"defaultValue":"800px","deprecated":false,"description":"The html page height, for example, 800px. Specify with or without the px suffix.","name":"height","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The file type to which to convert the email body. Can be \"pdf\" or \"png\". Default is \"png\".","name":"type","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If \"true\", will block all outgoing communication.","name":"offline","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"email","deprecated":false,"description":"The name the file will be saved as.","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Converts the body of an email to an image file or a PDF file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"rasterize-email","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The entry ID of the image file.","name":"EntryID","required":true,"secret":false},{"default":false,"defaultValue":"600px","deprecated":false,"description":"The image width, for example, 600px. Specify with or without the px suffix.","name":"width","required":false,"secret":false},{"default":false,"defaultValue":"800px","deprecated":false,"description":"The image height, for example, 800px. If empty, the height is the entire image.","name":"height","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name the file will be saved as.","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Converts an image file to a PDF file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"rasterize-image","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The entry ID of PDF file.","name":"EntryID","required":true,"secret":false},{"default":false,"defaultValue":"3","deprecated":false,"description":"The maximum number of pages to render. Default is \"3\".","name":"maxPages","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The password to access the PDF.","name":"pdfPassword","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to stack the pages horizontally. If \"true\", will stack the pages horizontally. If \"false\", will stack the pages vertically. Default is \"false\".","name":"horizontal","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"image","deprecated":false,"description":"The name the file will be saved as.","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Converts a PDF file to an image file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"rasterize-pdf","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/chromium:1.0.0.23161","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\n\nfrom selenium import webdriver\nfrom selenium.common.exceptions import NoSuchElementException, InvalidArgumentException, TimeoutException\nfrom PyPDF2 import PdfFileReader\nfrom pdf2image import convert_from_path\nimport numpy as np\nfrom PIL import Image\nimport tempfile\nfrom io import BytesIO\nimport base64\nimport time\nimport subprocess\nimport traceback\nimport re\nimport os\n\n# Chrome respects proxy env params\nhandle_proxy()\n# Make sure our python code doesn't go through a proxy when communicating with chrome webdriver\nos.environ['no_proxy'] = 'localhost,127.0.0.1'\n\nWITH_ERRORS = demisto.params().get('with_error', True)\nDEFAULT_WAIT_TIME = max(int(demisto.params().get('wait_time', 0)), 0)\nDEFAULT_PAGE_LOAD_TIME = int(demisto.params().get('max_page_load_time', 180))\n\nURL_ERROR_MSG = \"Can't access the URL. It might be malicious, or unreachable for one of several reasons. \" \\\n                \"You can choose to receive this message as error/warning in the instance settings\\n\"\nEMPTY_RESPONSE_ERROR_MSG = \"There is nothing to render. This can occur when there is a refused connection.\" \\\n                           \" Please check your URL.\"\nDEFAULT_W, DEFAULT_H = '600', '800'\nDEFAULT_W_WIDE = '1024'\nCHROME_USER_AGENT = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36'  # noqa\nDRIVER_LOG = f'{tempfile.gettempdir()}/chromedriver.log'\nDEFAULT_CHROME_OPTIONS = [\n    '--no-sandbox',\n    '--headless',\n    '--disable-gpu',\n    '--hide-scrollbars',\n    '--disable_infobars',\n    '--start-maximized',\n    '--start-fullscreen',\n    '--ignore-certificate-errors',\n    '--disable-dev-shm-usage',\n    f'--user-agent={CHROME_USER_AGENT}'\n]\n\nUSER_CHROME_OPTIONS = demisto.params().get('chrome_options', \"\")\n\n\ndef return_err_or_warn(msg):\n    return_error(msg) if WITH_ERRORS else return_warning(msg, exit=True)\n\n\ndef opt_name(opt):\n    return opt.split('=', 1)[0]\n\n\ndef merge_options(default_options, user_options):\n    \"\"\"merge the defualt options and user options\n\n    Arguments:\n        default_options {list} -- list of options to use\n        user_options {string} -- user configured options comma seperated (comma value can be escaped with \\\\)\n\n    Returns:\n        list -- merged options\n    \"\"\"\n    user_options = re.split(r'(?\u003c!\\\\),', user_options) if user_options else list()\n    if not user_options:  # nothing to do\n        return default_options\n    demisto.debug(f'user chrome options: {user_options}')\n    options = []\n    remove_opts = []\n    for opt in user_options:\n        opt = opt.strip()\n        if opt.startswith('[') and opt.endswith(']'):\n            remove_opts.append(opt[1:-1])\n        else:\n            options.append(opt.replace(r'\\,', ','))\n    # remove values (such as in user-agent)\n    option_names = [opt_name(x) for x in options]\n    # add filtered defaults only if not in removed and we don't have it already\n    options.extend([x for x in default_options if (opt_name(x) not in remove_opts and opt_name(x) not in option_names)])\n    return options\n\n\ndef check_response(driver):\n    EMPTY_PAGE = '\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003c/body\u003e\u003c/html\u003e'\n    if driver.page_source == EMPTY_PAGE:\n        return_err_or_warn(EMPTY_RESPONSE_ERROR_MSG)\n\n\ndef init_driver(offline_mode=False):\n    \"\"\"\n    Creates headless Google Chrome Web Driver\n    \"\"\"\n    demisto.debug(f'Creating chrome driver. Mode: {\"OFFLINE\" if offline_mode else \"ONLINE\"}')\n    try:\n        chrome_options = webdriver.ChromeOptions()\n        for opt in merge_options(DEFAULT_CHROME_OPTIONS, USER_CHROME_OPTIONS):\n            chrome_options.add_argument(opt)\n        driver = webdriver.Chrome(options=chrome_options, service_args=[\n            f'--log-path={DRIVER_LOG}',\n        ])\n        if offline_mode:\n            driver.set_network_conditions(offline=True, latency=5, throughput=500 * 1024)\n    except Exception as ex:\n        return_error(f'Unexpected exception: {ex}\\nTrace:{traceback.format_exc()}')\n\n    demisto.debug('Creating chrome driver - COMPLETED')\n    return driver\n\n\ndef find_zombie_processes():\n    \"\"\"find zombie proceses\n    Returns:\n        ([process ids], raw ps output) -- return a tuple of zombie process ids and raw ps output\n    \"\"\"\n    ps_out = subprocess.check_output(['ps', '-e', '-o', 'pid,ppid,state,stime,cmd'],\n                                     stderr=subprocess.STDOUT, universal_newlines=True)\n    lines = ps_out.splitlines()\n    pid = str(os.getpid())\n    zombies = []\n    if len(lines) \u003e 1:\n        for line in lines[1:]:\n            pinfo = line.split()\n            if pinfo[2] == 'Z' and pinfo[1] == pid:  # zombie process\n                zombies.append(pinfo[0])\n    return zombies, ps_out\n\n\ndef quit_driver_and_reap_children(driver):\n    \"\"\"\n    Quits the driver's session and reaps all of zombie child processes\n    :param driver: The driver\n    :return: None\n    \"\"\"\n    demisto.debug(f'Quitting driver session: {driver.session_id}')\n    driver.quit()\n    try:\n        zombies, ps_out = find_zombie_processes()\n        if zombies:\n            demisto.info(f'Found zombie processes will waitpid: {ps_out}')\n            for pid in zombies:\n                waitres = os.waitpid(int(pid), os.WNOHANG)[1]\n                demisto.info(f'waitpid result: {waitres}')\n        else:\n            demisto.debug(f'No zombie processes found for ps output: {ps_out}')\n    except Exception as e:\n        demisto.error(f'Failed checking for zombie processes: {e}. Trace: {traceback.format_exc()}')\n\n\ndef rasterize(path: str, width: int, height: int, r_type: str = 'png', wait_time: int = 0,\n              offline_mode: bool = False, max_page_load_time: int = 180):\n    \"\"\"\n    Capturing a snapshot of a path (url/file), using Chrome Driver\n    :param offline_mode: when set to True, will block any outgoing communication\n    :param path: file path, or website url\n    :param width: desired snapshot width in pixels\n    :param height: desired snapshot height in pixels\n    :param r_type: result type: .png/.pdf\n    :param wait_time: time in seconds to wait before taking a screenshot\n    \"\"\"\n    driver = init_driver(offline_mode)\n    page_load_time = max_page_load_time if max_page_load_time \u003e 0 else DEFAULT_PAGE_LOAD_TIME\n    try:\n        demisto.debug(f'Navigating to path: {path}. Mode: {\"OFFLINE\" if offline_mode else \"ONLINE\"}. page load: {page_load_time}')\n        driver.set_page_load_timeout(page_load_time)\n        driver.get(path)\n        driver.implicitly_wait(5)\n        if wait_time \u003e 0 or DEFAULT_WAIT_TIME \u003e 0:\n            time.sleep(wait_time or DEFAULT_WAIT_TIME)\n        check_response(driver)\n        demisto.debug('Navigating to path - COMPLETED')\n\n        if r_type.lower() == 'pdf':\n            output = get_pdf(driver, width, height)\n        elif r_type.lower() == 'json':\n            html = driver.page_source\n            output = {'image_b64': base64.b64encode(get_image(driver, width, height)).decode('utf8'),\n                      'html': html}\n        else:\n            output = get_image(driver, width, height)\n\n        return output\n\n    except (InvalidArgumentException, NoSuchElementException) as ex:\n        if 'invalid argument' in str(ex):\n            err_msg = URL_ERROR_MSG + str(ex)\n            return_err_or_warn(err_msg)\n        else:\n            return_err_or_warn(f'Invalid exception: {ex}\\nTrace:{traceback.format_exc()}')\n    except TimeoutException as ex:\n        return_err_or_warn(f'Timeout exception with max load time of: {page_load_time} seconds. {ex}')\n    except Exception as ex:\n        err_str = f'General error: {ex}\\nTrace:{traceback.format_exc()}'\n        demisto.error(err_str)\n        return_err_or_warn(err_str)\n    finally:\n        quit_driver_and_reap_children(driver)\n\n\ndef get_image(driver, width: int, height: int):\n    \"\"\"\n    Uses the Chrome driver to generate an image out of a currently loaded path\n    :return: .png file of the loaded path\n    \"\"\"\n    demisto.debug('Capturing screenshot')\n\n    # Set windows size\n    driver.set_window_size(width, height)\n\n    image = driver.get_screenshot_as_png()\n    driver.quit()\n\n    demisto.debug('Capturing screenshot - COMPLETED')\n\n    return image\n\n\ndef get_pdf(driver, width: int, height: int):\n    \"\"\"\n    Uses the Chrome driver to generate an pdf file out of a currently loaded path\n    :return: .pdf file of the loaded path\n    \"\"\"\n    demisto.debug('Generating PDF')\n\n    driver.set_window_size(width, height)\n    resource = f'{driver.command_executor._url}/session/{driver.session_id}/chromium/send_command_and_get_result'\n    body = json.dumps({'cmd': 'Page.printToPDF', 'params': {'landscape': False}})\n    response = driver.command_executor._request('POST', resource, body)\n\n    if response.get('status'):\n        demisto.results(response.get('status'))\n        return_error(response.get('value'))\n\n    data = base64.b64decode(response.get('value').get('data'))\n    demisto.debug('Generating PDF - COMPLETED')\n\n    return data\n\n\ndef convert_pdf_to_jpeg(path: str, max_pages: int, password: str, horizontal: bool = False):\n    \"\"\"\n    Converts a PDF file into a jpeg image\n    :param path: file's path\n    :param max_pages: max pages to render\n    :param password: PDF password\n    :param horizontal: if True, will combine the pages horizontally\n    :return: stream of combined image\n    \"\"\"\n    demisto.debug(f'Loading file at Path: {path}')\n    input_pdf = PdfFileReader(open(path, \"rb\"), strict=False)\n    pages = min(max_pages, input_pdf.numPages)\n\n    with tempfile.TemporaryDirectory() as output_folder:\n        demisto.debug('Converting PDF')\n        convert_from_path(\n            pdf_path=path,\n            fmt='jpeg',\n            first_page=1,\n            last_page=pages,\n            output_folder=output_folder,\n            userpw=password,\n            output_file='converted_pdf_'\n        )\n        demisto.debug('Converting PDF - COMPLETED')\n\n        demisto.debug('Combining all pages')\n        images = []\n        for page in sorted(os.listdir(output_folder)):\n            if os.path.isfile(os.path.join(output_folder, page)) and 'converted_pdf_' in page:\n                images.append(Image.open(os.path.join(output_folder, page)))\n        min_shape = min([(np.sum(page_.size), page_.size) for page_ in images])[1]  # get the minimal width\n\n        if horizontal:\n            imgs_comb = np.hstack([np.asarray(i.resize(min_shape)) for i in images])\n        else:\n            imgs_comb = np.vstack([np.asarray(i.resize(min_shape)) for i in images])\n\n        imgs_comb = Image.fromarray(imgs_comb)\n        output = BytesIO()\n        imgs_comb.save(output, 'JPEG')  # type: ignore\n        demisto.debug('Combining all pages - COMPLETED')\n\n        return output.getvalue()\n\n\ndef rasterize_command():\n    url = demisto.getArg('url')\n    w = demisto.args().get('width', DEFAULT_W_WIDE).rstrip('px')\n    h = demisto.args().get('height', DEFAULT_H).rstrip('px')\n    r_type = demisto.args().get('type', 'png')\n    wait_time = int(demisto.args().get('wait_time', 0))\n    page_load = int(demisto.args().get('max_page_load_time', DEFAULT_PAGE_LOAD_TIME))\n    file_name = demisto.args().get('file_name', 'url')\n\n    if not (url.startswith('http')):\n        url = f'http://{url}'\n    file_name = f'{file_name}.{\"pdf\" if r_type == \"pdf\" else \"png\"}'  # type: ignore\n\n    output = rasterize(path=url, r_type=r_type, width=w, height=h, wait_time=wait_time, max_page_load_time=page_load)\n    if r_type == 'json':\n        return_results(CommandResults(raw_response=output, readable_output=\"Successfully load image for url: \" + url))\n        return\n\n    res = fileResult(filename=file_name, data=output)\n    if r_type == 'png':\n        res['Type'] = entryTypes['image']\n\n    demisto.results(res)\n\n\ndef rasterize_image_command():\n    args = demisto.args()\n    entry_id = args.get('EntryID')\n    w = args.get('width', DEFAULT_W).rstrip('px')\n    h = args.get('height', DEFAULT_H).rstrip('px')\n    file_name = args.get('file_name', entry_id)\n\n    file_path = demisto.getFilePath(entry_id).get('path')\n    file_name = f'{file_name}.pdf'\n\n    with open(file_path, 'rb') as f:\n        output = rasterize(path=f'file://{os.path.realpath(f.name)}', width=w, height=h, r_type='pdf')\n        res = fileResult(filename=file_name, data=output, file_type=entryTypes['entryInfoFile'])\n        demisto.results(res)\n\n\ndef rasterize_email_command():\n    html_body = demisto.args().get('htmlBody')\n    w = demisto.args().get('width', DEFAULT_W).rstrip('px')\n    h = demisto.args().get('height', DEFAULT_H).rstrip('px')\n    offline = demisto.args().get('offline', 'false') == 'true'\n    r_type = demisto.args().get('type', 'png')\n    file_name = demisto.args().get('file_name', 'email')\n\n    file_name = f'{file_name}.{\"pdf\" if r_type.lower() == \"pdf\" else \"png\"}'  # type: ignore\n    with open('htmlBody.html', 'w') as f:\n        f.write(f'\u003chtml style=\"background:white\";\u003e{html_body}\u003c/html\u003e')\n    path = f'file://{os.path.realpath(f.name)}'\n\n    output = rasterize(path=path, r_type=r_type, width=w, height=h, offline_mode=offline)\n    res = fileResult(filename=file_name, data=output)\n    if r_type == 'png':\n        res['Type'] = entryTypes['image']\n\n    demisto.results(res)\n\n\ndef rasterize_pdf_command():\n    entry_id = demisto.args().get('EntryID')\n    password = demisto.args().get('pdfPassword')\n    max_pages = int(demisto.args().get('maxPages', 30))\n    horizontal = demisto.args().get('horizontal', 'false') == 'true'\n    file_name = demisto.args().get('file_name', 'image')\n\n    file_path = demisto.getFilePath(entry_id).get('path')\n\n    file_name = f'{file_name}.jpeg'  # type: ignore\n\n    with open(file_path, 'rb') as f:\n        output = convert_pdf_to_jpeg(path=os.path.realpath(f.name), max_pages=max_pages, password=password,\n                                     horizontal=horizontal)\n        res = fileResult(filename=file_name, data=output)\n        res['Type'] = entryTypes['image']\n\n        demisto.results(res)\n\n\ndef module_test():\n    # setting up a mock email file\n    with tempfile.NamedTemporaryFile('w+') as test_file:\n        test_file.write('\u003chtml\u003e\u003chead\u003e\u003cmeta http-equiv=\\\"Content-Type\\\" content=\\\"text/html;charset=utf-8\\\"\u003e'\n                        '\u003c/head\u003e\u003cbody\u003e\u003cbr\u003e---------- TEST FILE ----------\u003cbr\u003e\u003c/body\u003e\u003c/html\u003e')\n        test_file.flush()\n        file_path = f'file://{os.path.realpath(test_file.name)}'\n\n        # rasterizing the file\n        rasterize(path=file_path, width=250, height=250)\n\n    demisto.results('ok')\n\n\ndef main():\n    try:\n        with open(DRIVER_LOG, 'w'):\n            pass  # truncate the log file\n        if demisto.command() == 'test-module':\n            module_test()\n\n        elif demisto.command() == 'rasterize-image':\n            rasterize_image_command()\n\n        elif demisto.command() == 'rasterize-email':\n            rasterize_email_command()\n\n        elif demisto.command() == 'rasterize-pdf':\n            rasterize_pdf_command()\n\n        elif demisto.command() == 'rasterize':\n            rasterize_command()\n\n        else:\n            return_error('Unrecognized command')\n\n    except Exception as ex:\n        return_err_or_warn(f'Unexpected exception: {ex}\\nTrace:{traceback.format_exc()}')\n    finally:\n        if is_debug_mode():\n            demisto.debug(f'os.environ: {os.environ}')\n            with open(DRIVER_LOG, 'r') as log:\n                demisto.debug('Driver log:' + log.read())\n\n\nif __name__ in [\"__builtin__\", \"builtins\", '__main__']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.11","modified":"2021-08-25T15:11:54.851972+03:00","name":"Rasterize","packID":"rasterize","packPropagationLabels":["all"],"prevName":"Rasterize","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":false,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"","display":"Default Hostname or IP Address","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"HostName","options":null,"required":false,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Ciphers","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Interactive terminal mode","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"terminal","options":null,"required":false,"type":8},{"defaultValue":"xterm","display":"Terminal Type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"terminalType","options":null,"required":false,"type":0}],"definitionId":"","description":"File transfer and execute commands via ssh, on remote machines","detailedDescription":"You can configure this module to run also from an engine.","display":"RemoteAccess","fromServerVersion":"","hidden":false,"icon":"remoteaccess.png","id":"remoteaccess","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.321827+03:00","name":"remoteaccess","packID":"","prevName":"remoteaccess","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Authentication","commitMessage":"","configuration":[{"defaultValue":"","display":"Service Provider Entity ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"EntityId","options":null,"required":true,"type":0},{"defaultValue":"","display":"IdP metadata URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"IDPSSODescriptorURL","options":null,"required":false,"type":0},{"defaultValue":"","display":"Or:\n\n IdP metadata file","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"MetadataFile","options":null,"required":false,"type":12},{"defaultValue":"","display":"IdP SSO URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"IDPSSOURL","options":null,"required":false,"type":0},{"defaultValue":"urn","display":"Attribute to get username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrUsername","options":null,"required":true,"type":0},{"defaultValue":"Email","display":"Attribute to get email","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrEmail","options":null,"required":false,"type":0},{"defaultValue":"FirstName","display":"Attribute to get first name","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrFirstName","options":null,"required":false,"type":0},{"defaultValue":"LastName","display":"Attribute to get last name","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrLastName","options":null,"required":false,"type":0},{"defaultValue":"Phone","display":"Attribute to get phone","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrPhone","options":null,"required":false,"type":0},{"defaultValue":"memberOf","display":"Attribute to get groups","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrGroups","options":null,"required":false,"type":0},{"defaultValue":",","display":"Groups delimiter","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AttrGroupsDelimiter","options":null,"required":false,"type":0},{"defaultValue":"","display":"Default role (for IdP users without groups)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"GroupsDefaultRole","options":null,"required":false,"type":0},{"defaultValue":"","display":"RelayState","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"RelayState","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Verify IdP response signature","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Verify","options":null,"required":false,"type":8},{"defaultValue":"","display":"IdP public certificate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"PubCert","options":null,"required":false,"type":12},{"defaultValue":"true","display":"Sign request","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"SignedV2","options":null,"required":false,"type":8},{"defaultValue":"","display":"Service Provider public certificate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"PubCertSP","options":null,"required":false,"type":12},{"defaultValue":"","display":"Service Provider Private key (pem format)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"PrivKey","options":null,"required":false,"type":14},{"defaultValue":"false","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"SamlInsecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"ADFS","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ADFS","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Compress encode URL (ADFS)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ConfSamlCompressEncode","options":null,"required":false,"type":8},{"defaultValue":"","display":"Service Identifier (ADFS)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ConfSamlADFSServiceIdentifier","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Don't map SAML groups to Demisto roles","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ConfSamlDotNotMapGroups","options":null,"required":false,"type":8},{"defaultValue":"/saml/metadata","display":"Get service provider metadata","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"samlGetMetadata","options":null,"required":false,"type":11},{"defaultValue":"","display":"IdP Single Logout URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"IDPSLOURL","options":null,"required":false,"type":0},{"defaultValue":"","display":"Single Logout Service Endpoint","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"SPLogoutURL","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Single logout - specify Name ID Format","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"UseSpecificNameIDFormat","options":null,"required":false,"type":8},{"defaultValue":"","display":"Name ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"NameIDFormat","options":["Unspecified","Email","X509SubjectName","WindowsDomainQualifiedName","Kerberos","Entity"],"required":false,"type":15},{"defaultValue":"false","display":"Use this instance for external authentication only","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"By checking this box you are limiting this instance to authenticate external (non-XSOAR) users when they enter to answer a survey sent via a communication task. For more details, see the documentation","name":"IsExternal","options":null,"required":false,"type":8}],"definitionId":"","description":"SAML 2.0 Single Sign-On","detailedDescription":"SAML 2.0 Single Sign-On (SSO).\nSecurity Assertion Markup Language (SAML) is an XML standard that allows secure web domains to exchange user authentication and authorization data.","display":"SAML 2.0","fromServerVersion":"","hidden":false,"icon":"saml.png","id":"saml","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:28.078761+03:00","name":"saml","packID":"","prevName":"saml","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Case Management","commitMessage":"","configuration":[{"defaultValue":"","display":"ServiceNow URL, in the format https://company.service-now.com/","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"incident","display":"Default ticket type for running ticket commands and fetching incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ticket_type","options":null,"required":false,"type":0},{"defaultValue":"","display":"ServiceNow API Version (e.g. 'v1')","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"api_version","options":null,"required":false,"type":0},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"stateNOT IN6,7","display":"The query to use when fetching incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"sysparm_query","options":null,"required":false,"type":0},{"defaultValue":"10","display":"How many incidents to fetch each time","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_limit","options":null,"required":false,"type":0},{"defaultValue":"10 minutes","display":"First fetch timestamp (\u003cnumber\u003e \u003ctime unit\u003e, e.g., 12 hours, 7 days, 3 months, 1 year)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_time","options":null,"required":false,"type":0},{"defaultValue":"opened_at","display":"Timestamp field to filter by (e.g., `opened_at`)\nThis is how the filter is applied to the query: “ORDERBYopened_at^opened_at\u003e[Last Run]. To prevent duplicate incidents, this field is mandatory for fetching incidents.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"timestamp_field","options":null,"required":false,"type":0},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"Get incident attachments","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"get_attachments","options":null,"required":false,"type":8},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the ServiceNow v2 integration instead.","detailedDescription":" \n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/service-now)","display":"ServiceNow (Deprecated)","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"ServiceNow","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"Ticket System ID","name":"id","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number to retrieve","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to retrieve ticket attachments, default false","name":"get_attachments","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Retrieve ticket information by specific ticket ID","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-ticket","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"ServiceNow ticket ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedBy","description":"ServiceNow ticket opener ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CreatedOn","description":"ServiceNow ticket creation date.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Assignee","description":"ServiceNow ticket assignee ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.State","description":"ServiceNow ticket state","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Summary","description":"ServiceNow ticket short summary","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Number","description":"ServiceNow ticket number","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Active","description":"ServiceNow ticket active","type":"boolean"},{"contentPath":"","contextPath":"ServiceNow.Ticket.AdditionalComments","description":"ServiceNow ticket comments","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Priority","description":"ServiceNow ticket priority","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedAt","description":"ServiceNow ticket opening time","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.ResolvedBy","description":"ServiceNow ticket resolver ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CloseCode","description":"ServiceNow ticket close code","type":"string"},{"contentPath":"","contextPath":"File.Info","description":"Attachment file info","type":"string"},{"contentPath":"","contextPath":"File.Name","description":"Attachment file name","type":"string"},{"contentPath":"","contextPath":"File.Size","description":"Attachment file size","type":"number"},{"contentPath":"","contextPath":"File.SHA1","description":"Attachment file SHA1","type":"string"},{"contentPath":"","contextPath":"File.SHA256","description":"Attachment file SHA256","type":"string"},{"contentPath":"","contextPath":"File.EntryID","description":"Attachment file entry ID","type":"string"},{"contentPath":"","contextPath":"File.Type","description":"Attachment file type","type":"string"},{"contentPath":"","contextPath":"File.MD5","description":"Attachment file MD5","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Ticket System ID to retrieve","name":"id","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number to retrieve","name":"number","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Whether to retrieve ticket attachments, default false","name":"get_attachments","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-get-ticket or servicenow-get-record instead","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"The unique ticket identifier(sys_id).","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"A string field that indicates the user who created the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.CreatedOn","description":"The date and time when the ticket was created.","type":"date"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"Specifies the user assigned to complete the ticket. By default, this field uses a reference qualifier to only display users with the itil role.","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"Status of the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"A human-readable title for the record.","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"The display value of the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.Active","description":"Specifies whether work is still being done on a task or whether the work for the task is complete.","type":"boolean"},{"contentPath":"","contextPath":"Ticket.AdditionalComments","description":"Comments about the task record.","type":"Unknown"},{"contentPath":"","contextPath":"Ticket.Priority","description":"Specifies how high a priority the ticket should be for the assignee.","type":"string"},{"contentPath":"","contextPath":"Ticket.OpenedAt","description":"The date and time when the ticket was opened for the first time.","type":"date"},{"contentPath":"","contextPath":"File.Info","description":"Attachment file info","type":"string"},{"contentPath":"","contextPath":"File.Name","description":"Attachment file name","type":"string"},{"contentPath":"","contextPath":"File.Size","description":"Attachment file size","type":"number"},{"contentPath":"","contextPath":"File.SHA1","description":"Attachment file SHA1","type":"string"},{"contentPath":"","contextPath":"File.SHA256","description":"Attachment file SHA256","type":"string"},{"contentPath":"","contextPath":"File.EntryID","description":"Attachment file entry ID","type":"string"},{"contentPath":"","contextPath":"File.Type","description":"Attachment file type","type":"string"},{"contentPath":"","contextPath":"File.MD5","description":"Attachment file MD5","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket urgency","name":"urgency","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket severity","name":"severity","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket impact","name":"impact","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Set ticket as Active","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ActivityDue - format \"2016-07-02 21:51:11\"","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of assigned users to the ticket","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ApprovalSet - format \"2016-07-02 21:51:11\"","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"To whom the ticket is assigned","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category of ticket","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket's close code","name":"close_code","predefined":["Solved (Work Around)","Solved (Permanently)","Solved Remotely (Work Around)","Solved Remotely (Permanently)","Not Solved (Not Reproducible)","Not Solved (Too Costly)","Closed/Resolved by Caller"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation id","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"delivery_plan","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If you want to display comments, work_notes...","name":"display","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Escalation","name":"escalation","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Is the ticket solved in the knowledge base","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Notify about this ticket","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many users included in this ticket before","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many time the ticket has been reopened","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Resolving time, Format: YYYY-MM-DD HH:MM:SS","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Subcategory","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List with UIDs","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date when started to work on the ticket","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set AssignmentGroup - sys_id of group","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"integer","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Priority of the ticket","name":"priority","predefined":["5 - Planning","4 - Low","3 - Moderate","2 - High","1 - Critical"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Template name to use as a base to create new tickets.","name":"template","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom(user defined) fields in the format: fieldname1=value;fieldname2=value; custom fields start with a \"u_\".","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"normal","deprecated":false,"description":"Type of Change Request ticket","name":"change_type","predefined":["normal","standard","emergency"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the ticket, e.g., \"Closed\" or \"7\" or \"7 - Closed\".","name":"state","required":false,"secret":false},{"default":false,"deprecated":false,"description":" Ticket opening time, Format: YYYY-MM-DD HH:MM:SS","name":"opened_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Caller system ID","name":"caller","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Create new ServiceNow ticket","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-create-ticket","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"ServiceNow ticket ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedBy","description":"ServiceNow ticket opener ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CreatedOn","description":"ServiceNow ticket creation date.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Assignee","description":"ServiceNow ticket assignee ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.State","description":"ServiceNow ticket state","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Summary","description":"ServiceNow ticket short summary","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Number","description":"ServiceNow ticket number","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Active","description":"ServiceNow ticket active","type":"boolean"},{"contentPath":"","contextPath":"ServiceNow.Ticket.AdditionalComments","description":"ServiceNow ticket comments","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Priority","description":"ServiceNow ticket priority","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedAt","description":"ServiceNow ticket opening time","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.ResolvedBy","description":"ServiceNow ticket resolver ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CloseCode","description":"ServiceNow ticket close code","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket urgency","name":"urgency","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket severity","name":"severity","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket impact","name":"impact","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Set ticket as Active","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ActivityDue - format \"2016-07-02 21:51:11\" glide_date_time","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of assigned users to the ticket","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ApprovalSet - format \"2016-07-02 21:51:11\" glide_date_time","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"To whom the ticket is assigned","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category of ticket","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket's close code","name":"close_code","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation id","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"delivery_plan","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If you want to display comments, work_notes...","name":"display","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Escalation","name":"escalation","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Is the ticket solved in the knowledge base","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Notify about this ticket","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many users included in this ticket before","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many time the ticket has been reopened","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Subcategory","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List with UIDs","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date when started to work on the ticket","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set AssignmentGroup - uuid of group like 46b87022a9fe198101a78787e40d7547","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"integer","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Priority of the ticket (number)","name":"priority","predefined":["5 - Planning","4 - Low","3 - Moderate","2 - High","1 - Critical"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Template name to use as a base to create new tickets.","name":"template","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom(user defined) fields in the format: fieldname1=value;fieldname2=value;...","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"normal","deprecated":false,"description":"Type of Change Request ticket","name":"type","predefined":["normal","standard","emergency"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the ticket","name":"state","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-create-ticket or servicenow-create-record instead","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-create","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"ServiceNow ticket System ID","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"ServiceNow ticket creator","type":"string"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"ServiceNow ticket assignee","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"ServiceNow ticket state","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"ServiceNow ticket short summary","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"ServiceNow ticket number","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket urgency","name":"urgency","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket severity","name":"severity","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket impact","name":"impact","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Set ticket as Active","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ActivityDue - format \"2016-07-02 21:51:11\" glide_date_time","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of assigned users to the ticket","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ApprovalSet - format \"2016-07-02 21:51:11\" glide_date_time","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"To whom the ticket is assigned","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category name","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket's close code","name":"close_code","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation id","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"delivery_plan","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If you want to display comments, work_notes...","name":"display","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Escalation","name":"escalation","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Is the ticket solved in the knowledge base","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Notify about this ticket","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many users included in this ticket before","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many time the ticket has been reopened","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Subcategory","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List with UIDs","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date when started to work on the ticket","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set AssignmentGroup - uuid of group like 46b87022a9fe198101a78787e40d7547","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"integer","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number","name":"number","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Priority of the ticket (number)","name":"priority","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Template name to use as a base to create new tickets.","name":"template","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Create a new ServiceNow ticket","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-incident-create","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"ServiceNow ticket System ID","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"ServiceNow ticket creator","type":"string"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"ServiceNow ticket assignee","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"ServiceNow ticket state","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"ServiceNow ticket short summary","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"ServiceNow ticket number","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket urgency","name":"urgency","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket severity","name":"severity","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket impact","name":"impact","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Does the ticket active(true/false)","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of assigned users to the ticket","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ApprovalSet - format \"2016-07-02 21:51:11\"","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"To whom the ticket is assigned","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category name","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket's close code","name":"close_code","predefined":["Solved (Work Around)","Solved (Permanently)","Solved Remotely (Work Around)","Solved Remotely (Permanently)","Not Solved (Not Reproducible)","Not Solved (Too Costly)","Closed/Resolved by Caller"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation id","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"delivery_plan","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If you want to display comments, work_notes...","name":"display","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Escalation","name":"escalation","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Is the ticket solved in the knowledge base","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Notify about this ticket","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many users included in this ticket before","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many time the ticket has been reopened","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Subcategory","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List with UIDs","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date when started to work on the ticket","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"integer","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Priority of the ticket","name":"priority","predefined":["5 - Planning","4 - Low","3 - Moderate","2 - High","1 - Critical"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"System ID of the ticket to update","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Custom(user defined) fields in the format: fieldname1=value;fieldname2=value; custom fields start with a \"u_\".","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"normal","deprecated":false,"description":"Type of Change Request ticket","name":"change_type","predefined":["normal","standard","emergency"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the ticket, e.g., \"Closed\" or \"7\" or \"7 - Closed\".","name":"state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Caller system ID","name":"caller","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Update specific ticket","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-update-ticket","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket urgency","name":"urgency","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket severity","name":"severity","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket impact","name":"impact","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Does the ticket active(true/false)","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of assigned users to the ticket","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ApprovalSet - format \"2016-07-02 21:51:11\" glide_date_time","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"To whom the ticket is assigned","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category name","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket's close code","name":"close_code","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation id","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"delivery_plan","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If you want to display comments, work_notes...","name":"display","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Escalation","name":"escalation","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Is the ticket solved in the knowledge base","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Notify about this ticket","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many users included in this ticket before","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many time the ticket has been reopened","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Subcategory","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List with UIDs","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date when started to work on the ticket","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"integer","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Priority of the ticket","name":"priority","predefined":["5 - Planning","4 - Low","3 - Moderate","2 - High","1 - Critical"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"System ID of the ticket to update","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Custom(user defined) fields in the format: fieldname1=value;fieldname2=value;...","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"normal","deprecated":false,"description":"Type of Change Request ticket","name":"type","predefined":["normal","standard","emergency"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the ticket","name":"state","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-update-ticket or servicenow-update-record instead","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-update","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket urgency","name":"urgency","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket severity","name":"severity","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket impact","name":"impact","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Does the ticket active(true/false)","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of assigned users to the ticket","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Set ticket ApprovalSet - format \"2016-07-02 21:51:11\" glide_date_time","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"To whom the ticket is assigned","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category name","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket's close code","name":"close_code","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation id","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"delivery_plan","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"If you want to display comments, work_notes...","name":"display","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Escalation","name":"escalation","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Is the ticket solved in the knowledge base","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Notify about this ticket","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many users included in this ticket before","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many time the ticket has been reopened","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Subcategory","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List with UIDs","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date when started to work on the ticket","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"integer","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number","name":"number","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Priority of the ticket (number)","name":"priority","required":false,"secret":false},{"default":false,"deprecated":false,"description":"System ID of the ticket to update","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-update-ticket or servicenow-update-record instead","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-incident-update","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Delete a ticket from ServiceNow","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-delete-ticket","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The actual link to publish in ServiceNow ticket, valid url format, like http://www.demisto.com","name":"link","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Publish the link as comment on the ticket, if false will publish the link as WorkNote, format bool","name":"post-as-comment","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The text to represent the link","name":"text","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Add a link to specific ticket","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-add-link","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The actual link to publish in ServiceNow ticket, valid url format, like http://www.demisto.com","name":"link","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Publish the link as comment on the ticket, by default true, if false will publish the link as WorkNote, format bool","name":"post-as-comment","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The text to represent the link","name":"text","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-add-link instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-incident-add-link","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Comment to add","name":"comment","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Specify to publish the note as comment on the ticket.","name":"post-as-comment","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Add comment to specific ticket by providing ticket id","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-add-comment","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Comment to add","name":"comment","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Publish the link as comment on the ticket, if false will publish the link as WorkNote, format bool","name":"post-as-comment","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-add-comment instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-incident-add-comment","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"Limit for how many tickets to retrieve","name":"limit","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to run. To learn about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Retrieve ticket info with a query","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-tickets","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"The unique ticket identifier.","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"A string field that indicates the user who created the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.CreatedOn","description":"The date and time when the ticket was created.","type":"date"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"Specifies the user assigned to complete the ticket. By default, this field uses a reference qualifier to only display users with the itil role.","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"Status of the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"A human-readable title for the record.","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"The display value of the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.Active","description":"Specifies whether work is still being done on a task or whether the work for the task is complete.","type":"boolean"},{"contentPath":"","contextPath":"Ticket.AdditionalComments","description":"Comments about the task record.","type":"Unknown"},{"contentPath":"","contextPath":"Ticket.Priority","description":"Specifies how high a priority the ticket should be for the assignee.","type":"string"},{"contentPath":"","contextPath":"Ticket.OpenedAt","description":"The date and time when the ticket was opened for the first time.","type":"date"},{"contentPath":"","contextPath":"Ticket.Escalation","description":"Indicates how long the ticket has been open.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"Limit for how many tickets to retrieve","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query","name":"sysparm_query","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to run. To learn about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-query-table or servicenow-query-tickets instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"ServiceNow ticket System ID","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"ServiceNow ticket creator","type":"string"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"ServiceNow ticket assignee","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"ServiceNow ticket state","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"ServiceNow ticket short summary","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"ServiceNow ticket number","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"Limit for how many tickets to retrieve","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query","name":"sysparm_query","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request"],"required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-query-table or servicenow-query-tickets instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-incidents-query","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"ServiceNow ticket System ID","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"ServiceNow ticket creator","type":"string"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"ServiceNow ticket assignee","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"ServiceNow ticket state","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"ServiceNow ticket short summary","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"ServiceNow ticket number","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"War-room entry ID that includes the file","name":"file_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Filename of uploaded file to override the existing file name in entry","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Upload a file to a specific ticket","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-upload-file","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.File.Filename","description":"Name of the file","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.File.Link","description":"Download link for the file","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.File.SystemID","description":"System ID of the file","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type","name":"ticket_type","predefined":["incident","problem","change_request"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"War-room entry ID that includes the file","name":"file_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Filename of uploaded file to override the existing file name in entry","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-upload-file instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-incident-upload-file","outputs":[{"contentPath":"","contextPath":"Ticket.File.Filename","description":"Name of the file","type":"string"},{"contentPath":"","contextPath":"Ticket.File.Link","description":"Download link for the file","type":"string"},{"contentPath":"","contextPath":"Ticket.File.SystemID","description":"System ID of the file","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Servicenow group name","name":"name","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-query-groups instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-groups","outputs":[{"contentPath":"","contextPath":"ServiceNowGroups.GroupId","description":"Group Id","type":"string"},{"contentPath":"","contextPath":"ServiceNowGroups.GroupName","description":"Group name","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"machine name","name":"computerName","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use servicenow-query-computers instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-computer","outputs":[{"contentPath":"","contextPath":"ServiceNowComputer.sys_id","description":"Id ","type":"string"},{"contentPath":"","contextPath":"ServiceNowComputer.u_code","description":"Code","type":"string"},{"contentPath":"","contextPath":"ServiceNowComputer.support_group","description":"Support group","type":"string"},{"contentPath":"","contextPath":"ServiceNowComputer.os","description":"Operating System","type":"string"},{"contentPath":"","contextPath":"ServiceNowComputer.comments","description":"Comments","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Record system ID","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Comma separated table fields to display and output to the context, e.g name,tag,company. ID field is added by default.","name":"fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the table to get the record from","name":"table_name","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Retrieve record information by specific record ID","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-record","outputs":[{"contentPath":"","contextPath":"ServiceNow.Record.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedOn","description":"time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the table to query","name":"table_name","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Limit for how many tickets to retrieve","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to run. For more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Comma separated table fields to display and output to the context, e.g name,tag,company. ID field is added by default.","isArray":true,"name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Query a specified table in ServiceNow","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-table","outputs":[{"contentPath":"","contextPath":"ServiceNow.Results.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Results.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Results.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Results.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Results.CreatedOn","description":"time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the table to create a record in.","name":"table_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Fields and their values to create the record with, in the format: fieldname1=value;fieldname2=value;...","name":"fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom(user defined) fields in the format: fieldname1=value;fieldname2=value;...","name":"custom_fields","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Create a new record in a specified ServiceNow table","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-create-record","outputs":[{"contentPath":"","contextPath":"ServiceNow.Record.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedOn","description":"time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the table to update the record in","name":"table_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The system ID of the ticket to update","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Fields and their values to update in the record, in the format: fieldname1=value;fieldname2=value;...","name":"fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom(User defined) fields and their values to update in the record, in the format: fieldname1=value;fieldname2=value;...","name":"custom_fields","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Update a record in a specified ServiceNow table","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-update-record","outputs":[{"contentPath":"","contextPath":"ServiceNow.Record.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedOn","description":"time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The table name","name":"table_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The system ID of the ticket to delete","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Delete a record in a specified ServiceNow table","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-delete-record","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Table name","name":"table_name","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"List API fields for a specified ServiceNow table","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-list-table-fields","outputs":[{"contentPath":"","contextPath":"ServiceNow.Field","description":"Table API field name","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by computer sys_id","name":"computer_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by computer name","name":"computer_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by specified query, for more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by asset tag","name":"asset_tag","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Query results limit","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Query the cmdb_ci_computer table in ServiceNow","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-computers","outputs":[{"contentPath":"","contextPath":"ServiceNow.Computer.ID","description":"Computer sys_id","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.AssetTag","description":"Computer Asset tag","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Name","description":"Computer name","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.DisplayName","description":"Computer display name","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.SupportGroup","description":"Computer support group","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.OperatingSystem","description":"Computer operating system","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Company","description":"Computer company sys_id","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.AssignedTo","description":"Computer assigned to user sys_id","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.State","description":"Computer state","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Cost","description":"Computer cost","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Comments","description":"Computer comments","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by group sys_id","name":"group_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by group name","name":"group_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by specified query, for more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Query results limit","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Query the sys_user_group table in ServiceNow","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-groups","outputs":[{"contentPath":"","contextPath":"ServiceNow.Group.ID","description":"Group sys_id","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Description","description":"Group description","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Name","description":"Group name","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Manager","description":"Group manager sys_id","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Updated","description":"Group update time","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by user sys_id","name":"user_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by username","name":"user_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by specified query, for more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Query results limit","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Query the sys_user table in ServiceNow","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-users","outputs":[{"contentPath":"","contextPath":"ServiceNow.User.ID","description":"User sys_id","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.Name","description":"User name (first + last)","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.UserName","description":"User username","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.Email","description":"User email","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.Created","description":"User creation time","type":"date"},{"contentPath":"","contextPath":"ServiceNow.User.Updated","description":"User update time","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The table label, e.g Asset, Incident, IP address etc.","name":"label","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Results limit","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Starting record index to begin retrieving records from","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Get table names by a label to use in commands","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-table-name","outputs":[{"contentPath":"","contextPath":"ServiceNow.Table.ID","description":"Table system ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Table.Name","description":"Table name to use in commands, e.g alm_asset","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Table.SystemName","description":"Table system name, e.g Asset","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Limit for the ticket notes","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Offset of the ticket notes","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Get notes from the specified ServiceNow ticket - Read permissions are required for the sys_journal_field table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-ticket-notes","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"Ticket ID","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.Value","description":"Ticket note value","type":"unknown"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.CreatedOn","description":"Ticket note created on","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.CreatedBy","description":"Ticket note created by","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.Type","description":"Ticket note type","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python:2.7.18.20958","feed":false,"isFetch":true,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\nimport re\nimport requests\nimport json\nfrom datetime import datetime\nimport shutil\n\n# disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\nif not demisto.params().get('proxy', False):\n    del os.environ['HTTP_PROXY']\n    del os.environ['HTTPS_PROXY']\n    del os.environ['http_proxy']\n    del os.environ['https_proxy']\n\n\ndef get_server_url():\n    url = demisto.params()['url']\n    url = re.sub('/[\\/]+$/', '', url)\n    url = re.sub('\\/$', '', url)\n    return url\n\n\n''' GLOBAL VARIABLES '''\n\nDEFAULTS = {\n    'limit': 10,\n    'offset': 0,\n    'fetch_limit': 10,\n    'fetch_time': '10 minutes',\n    'ticket_type': 'incident'\n}\n\nUSERNAME = demisto.params()['credentials']['identifier']\nPASSWORD = demisto.params()['credentials']['password']\nVERIFY_SSL = not demisto.params().get('insecure', False)\nAPI = '/api/now/'\nVERSION = demisto.params().get('api_version')\nPARAMS_TICKET_TYPE = demisto.params().get('ticket_type', DEFAULTS['ticket_type'])\nFETCH_TIME = demisto.params().get('fetch_time').strip()\nSYSPARM_QUERY = demisto.params().get('sysparm_query')\nSYSPARM_LIMIT = demisto.params().get('fetch_limit', DEFAULTS['fetch_limit'])\nTIMESTAMP_FIELD = demisto.params().get('timestamp_field', 'opened_at')\nTICKET_TYPE = demisto.params().get('ticket_type', DEFAULTS['ticket_type'])\nGET_ATTACHMENTS = demisto.params().get('get_attachments', False)\n\nif VERSION:\n    API += VERSION + '/'\n\nSERVER_URL = get_server_url() + API\n\nTICKET_STATES = {\n    'incident': {\n        '1': '1 - New',\n        '2': '2 - In Progress',\n        '3': '3 - On Hold',\n        '4': '4 - Awaiting Caller',\n        '5': '5 - Awaiting Evidence',\n        '6': '6 - Resolved',\n        '7': '7 - Closed',\n        '8': '8 - Canceled'\n    },\n    'problem': {\n        '1': '1 - Open',\n        '2': '2 - Known Error',\n        '3': '3 - Pending Change',\n        '4': '4 - Closed/Resolved'\n    },\n    'change_request': {\n        '-5': '-5 - New',\n        '-4': '-4 - Assess',\n        '-3': '-3 - Authorize',\n        '-2': '-2 - Scheduled',\n        '-1': '-1 - Implement',\n        '0': '0 - Review',\n        '3': '3 - Closed',\n        '4': '4 - Canceled'\n    },\n    'sc_task': {\n        '-5': '-5 - Pending',\n        '1': '1 - Open',\n        '2': '2 - Work In Progress',\n        '3': '3 - Closed Complete',\n        '4': '4 - Closed Incomplete',\n        '7': '7 - Closed Skipped'\n    },\n    'sc_request': {\n        '1': '1 - Approved',\n        '3': '3 - Closed',\n        '4': '4 - Rejected'\n    }\n}\n\nTICKET_SEVERITY = {\n    '1': '1 - High',\n    '2': '2 - Medium',\n    '3': '3 - Low'\n}\n\nTICKET_PRIORITY = {\n    '1': '1 - Critical',\n    '2': '2 - High',\n    '3': '3 - Moderate',\n    '4': '4 - Low',\n    '5': '5 - Planning'\n}\n\nCOMPUTER_STATUS = {\n    '1': 'In use',\n    '2': 'On order',\n    '3': 'On maintenance',\n    '6': 'In stock/In transit',\n    '7': 'Retired',\n    '100': 'Missing'\n}\n\n# Map SNOW severity to Demisto severity for incident creation\nSEVERITY_MAP = {\n    '1': 3,\n    '2': 2,\n    '3': 1\n}\n\nSNOW_ARGS = ['active', 'activity_due', 'opened_at', 'short_description', 'additional_assignee_list', 'approval_history',\n             'approval_set', 'assigned_to', 'assignment_group',\n             'business_duration', 'business_service', 'business_stc', 'calendar_duration', 'calendar_stc', 'caller_id',\n             'caused_by', 'close_code', 'close_notes',\n             'closed_at', 'closed_by', 'cmdb_ci', 'comments', 'comments_and_work_notes', 'company', 'contact_type',\n             'correlation_display', 'correlation_id',\n             'delivery_plan', 'delivery_task', 'description', 'due_date', 'expected_start', 'follow_up', 'group_list',\n             'hold_reason', 'impact', 'incident_state',\n             'knowledge', 'location', 'made_sla', 'notify', 'order', 'parent', 'parent_incident', 'priority',\n             'problem_id', 'resolved_at', 'resolved_by', 'rfc',\n             'severity', 'sla_due', 'state', 'subcategory', 'sys_tags', 'time_worked', 'urgency', 'user_input',\n             'watch_list', 'work_end', 'work_notes', 'work_notes_list',\n             'work_start', 'impact', 'incident_state', 'title', 'type', 'change_type', 'category', 'state', 'caller']\n\n# Every table in ServiceNow should have those fields\nDEFAULT_RECORD_FIELDS = {\n    'sys_id': 'ID',\n    'sys_updated_by': 'UpdatedBy',\n    'sys_updated_on': 'UpdatedAt',\n    'sys_created_by': 'CreatedBy',\n    'sys_created_on': 'CreatedAt'\n}\n\nDEPRECATED_COMMANDS = ['servicenow-get', 'servicenow-incident-get',\n                       'servicenow-create', 'servicenow-incident-create',\n                       'servicenow-update', 'servicenow-query',\n                       'servicenow-incidents-query', 'servicenow-incident-update']\n\n''' HELPER FUNCTIONS '''\n\n\ndef send_request(path, method='get', body=None, params=None, headers=None, file=None):\n    body = body if body is not None else {}\n    params = params if params is not None else {}\n\n    url = '{}{}'.format(SERVER_URL, path)\n    if not headers:\n        headers = {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n        }\n    if file:\n        # Not supported in v2\n        url = url.replace('v2', 'v1')\n        try:\n            file_entry = file['id']\n            file_name = file['name']\n            shutil.copy(demisto.getFilePath(file_entry)['path'], file_name)\n            with open(file_name, 'rb') as f:\n                files = {'file': f}\n                res = requests.request(method, url, headers=headers, params=params, data=body, files=files,\n                                       auth=(USERNAME, PASSWORD), verify=VERIFY_SSL)\n            shutil.rmtree(demisto.getFilePath(file_entry)['name'], ignore_errors=True)\n        except Exception as e:\n            raise Exception('Failed to upload file - ' + str(e))\n    else:\n        res = requests.request(method, url, headers=headers, data=json.dumps(body) if body else {}, params=params,\n                               auth=(USERNAME, PASSWORD), verify=VERIFY_SSL)\n\n    try:\n        obj = res.json()\n    except Exception as e:\n        if not res.content:\n            return ''\n        raise Exception('Error parsing reply - {} - {}'.format(res.content, str(e)))\n\n    if 'error' in obj:\n        message = obj.get('error', {}).get('message')\n        details = obj.get('error', {}).get('detail')\n        if message == 'No Record found':\n            return {\n                # Return an empty results array\n                'result': []\n            }\n        raise Exception('ServiceNow Error: {}, details: {}'.format(message, details))\n\n    if res.status_code \u003c 200 or res.status_code \u003e= 300:\n        raise Exception('Got status code {} with url {} with body {} with headers {}'\n                        .format(str(res.status_code), url, str(res.content), str(res.headers)))\n\n    return obj\n\n\ndef get_table_name(ticket_type=None):\n    if ticket_type:\n        return ticket_type\n    else:\n        if PARAMS_TICKET_TYPE:\n            return PARAMS_TICKET_TYPE\n        else:\n            return 'incident'\n\n\ndef create_ticket_context(data, ticket_type):\n    context = {\n        'ID': data.get('sys_id'),\n        'Summary': data.get('short_description'),\n        'Number': data.get('number'),\n        'CreatedOn': data.get('sys_created_on'),\n        'Active': data.get('active'),\n        'AdditionalComments': data.get('comments'),\n        'CloseCode': data.get('close_code'),\n        'OpenedAt': data.get('opened_at')\n    }\n\n    # These fields refer to records in the database, the value is their system ID.\n    if 'closed_by' in data:\n        context['ResolvedBy'] = data['closed_by']['value'] if 'value' in data['closed_by'] else ''\n    if 'opened_by' in data:\n        context['OpenedBy'] = data['opened_by']['value'] if 'value' in data['opened_by'] else ''\n        context['Creator'] = data['opened_by']['value'] if 'value' in data['opened_by'] else ''\n    if 'assigned_to' in data:\n        context['Assignee'] = data['assigned_to']['value'] if 'value' in data['assigned_to'] else ''\n\n    # Try to map fields\n    if 'priority' in data:\n        # Backward compatibility\n        if demisto.command() in DEPRECATED_COMMANDS:\n            context['Priority'] = data['priority']\n        else:\n            context['Priority'] = TICKET_PRIORITY.get(data['priority'], data['priority'])\n    if 'state' in data:\n        mapped_state = data['state']\n        # Backward compatibility\n        if demisto.command() not in DEPRECATED_COMMANDS:\n            if ticket_type in TICKET_STATES:\n                mapped_state = TICKET_STATES[ticket_type].get(data['state'], mapped_state)\n        context['State'] = mapped_state\n\n    return createContext(context, removeNull=True)\n\n\ndef get_ticket_context(data, ticket_type):\n    if not isinstance(data, list):\n        return create_ticket_context(data, ticket_type)\n\n    tickets = []\n    for d in data:\n        tickets.append(create_ticket_context(d, ticket_type))\n    return tickets\n\n\ndef get_ticket_human_readable(tickets, ticket_type):\n    if not isinstance(tickets, list):\n        tickets = [tickets]\n\n    result = []\n    for ticket in tickets:\n\n        hr = {\n            'Number': ticket.get('number'),\n            'System ID': ticket['sys_id'],\n            'Created On': ticket.get('sys_created_on'),\n            'Created By': ticket.get('sys_created_by'),\n            'Active': ticket.get('active'),\n            'Close Notes': ticket.get('close_notes'),\n            'Close Code': ticket.get('close_code'),\n            'Description': ticket.get('description'),\n            'Opened At': ticket.get('opened_at'),\n            'Due Date': ticket.get('due_date'),\n            # This field refers to a record in the database, the value is its system ID.\n            'Resolved By': ticket.get('closed_by', {}).get('value') if isinstance(ticket.get('closed_by'), dict)\n            else ticket.get('closed_by'),\n            'Resolved At': ticket.get('resolved_at'),\n            'SLA Due': ticket.get('sla_due'),\n            'Short Description': ticket.get('short_description'),\n            'Additional Comments': ticket.get('comments')\n        }\n\n        # Try to map the fields\n        if 'impact' in ticket:\n            hr['Impact'] = TICKET_SEVERITY.get(ticket['impact'], ticket['impact'])\n        if 'urgency' in ticket:\n            hr['Urgency'] = TICKET_SEVERITY.get(ticket['urgency'], ticket['urgency'])\n        if 'severity' in ticket:\n            hr['Severity'] = TICKET_SEVERITY.get(ticket['severity'], ticket['severity'])\n        if 'priority' in ticket:\n            hr['Priority'] = TICKET_PRIORITY.get(ticket['priority'], ticket['priority'])\n        if 'state' in ticket:\n            mapped_state = ticket['state']\n            if ticket_type in TICKET_STATES:\n                mapped_state = TICKET_STATES[ticket_type].get(ticket['state'], mapped_state)\n            hr['State'] = mapped_state\n        result.append(hr)\n    return result\n\n\ndef get_ticket_fields(template, ticket_type):\n    # Inverse the keys and values of those dictionaries to map the arguments to their corresponding values in ServiceNow\n    args = unicode_to_str_recur(demisto.args())\n    inv_severity = {v: k for k, v in TICKET_SEVERITY.iteritems()}\n    inv_priority = {v: k for k, v in TICKET_PRIORITY.iteritems()}\n    states = TICKET_STATES.get(ticket_type)\n    inv_states = {v: k for k, v in states.iteritems()} if states else {}\n\n    body = {}\n    for arg in SNOW_ARGS:\n        input_arg = args.get(arg)\n        if input_arg:\n            if arg in ['impact', 'urgency', 'severity']:\n                body[arg] = inv_severity.get(input_arg, input_arg)\n            elif arg == 'priority':\n                body[arg] = inv_priority.get(input_arg, input_arg)\n            elif arg == 'state':\n                body[arg] = inv_states.get(input_arg, input_arg)\n            else:\n                body[arg] = input_arg\n        elif template and arg in template:\n            body[arg] = template[arg]\n\n    return body\n\n\ndef get_body(fields, custom_fields):\n    body = {}\n\n    if fields:\n        for field in fields:\n            body[field] = fields[field]\n\n    if custom_fields:\n        for field in custom_fields:\n            # custom fields begin with \"u_\"\n            if field.startswith('u_'):\n                body[field] = custom_fields[field]\n            else:\n                body['u_' + field] = custom_fields[field]\n\n    return body\n\n\ndef split_fields(fields):\n    dic_fields = {}\n\n    if fields:\n        # As received by the command\n        arr_fields = fields.split(';')\n\n        for f in arr_fields:\n            field = f.split('=')\n            if len(field) \u003e 1:\n                dic_fields[field[0]] = field[1]\n\n    return dic_fields\n\n\n# Converts unicode elements of obj (incl. dictionary and list) to string recursively\ndef unicode_to_str_recur(obj):\n    if isinstance(obj, dict):\n        obj = {unicode_to_str_recur(k): unicode_to_str_recur(v) for k, v in obj.iteritems()}\n    elif isinstance(obj, list):\n        obj = map(unicode_to_str_recur, obj)\n    elif isinstance(obj, unicode):\n        obj = obj.encode('utf-8')\n    return obj\n\n\n# Converts to an str\ndef convert_to_str(obj):\n    if isinstance(obj, unicode):\n        return obj.encode('utf-8')\n    try:\n        return str(obj)\n    except ValueError:\n        return obj\n\n\n''' FUNCTIONS '''\n\n\ndef get_template(name):\n    query_params = {'sysparm_limit': 1, 'sysparm_query': 'name=' + name}\n\n    ticket_type = 'sys_template'\n    path = 'table/' + ticket_type\n    res = send_request('GET', path, params=query_params)\n\n    if len(res['result']) == 0:\n        raise ValueError(\"Incorrect template name\")\n\n    template = res['result'][0]['template'].split('^')\n    dic_template = {}\n\n    for i in range(len(template) - 1):\n        template_value = template[i].split('=')\n        if len(template_value) \u003e 1:\n            dic_template[template_value[0]] = template_value[1]\n\n    return dic_template\n\n\ndef get_ticket_command():\n    args = unicode_to_str_recur(demisto.args())\n    ticket_type = get_table_name(args.get('ticket_type'))\n    ticket_id = args.get('id')\n    number = args.get('number')\n    get_attachments = args.get('get_attachments', 'false')\n\n    res = get(ticket_type, ticket_id, number)\n    if not res or 'result' not in res:\n        return 'Cannot find ticket'\n\n    if isinstance(res['result'], list):\n        if len(res['result']) == 0:\n            return 'Cannot find ticket'\n        ticket = res['result'][0]\n    else:\n        ticket = res['result']\n\n    entries = []  # type: List[Dict]\n\n    if get_attachments.lower() != 'false':\n        entries = get_ticket_attachment_entries(ticket['sys_id'])\n\n    hr = get_ticket_human_readable(ticket, ticket_type)\n    context = get_ticket_context(ticket, ticket_type)\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code',\n               'Description', 'Opened At', 'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description',\n               'Additional Comments']\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow ticket', hr, headers=headers, removeNull=True),\n        'EntryContext': {\n            'Ticket(val.ID===obj.ID)': context,\n            'ServiceNow.Ticket(val.ID===obj.ID)': context\n        }\n    }\n\n    entries.append(entry)\n\n    return entries\n\n\ndef get_record_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = args['table_name']\n    record_id = args['id']\n    fields = args.get('fields')\n\n    res = get(table_name, record_id)\n\n    if not res or 'result' not in res:\n        return 'Cannot find record'\n\n    if isinstance(res['result'], list):\n        if len(res['result']) == 0:\n            return 'Cannot find record'\n        record = res['result'][0]\n    else:\n        record = res['result']\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json']\n    }\n\n    if fields:\n        fields = argToList(fields)\n        if 'sys_id' not in fields:\n            # ID is added by default\n            fields.append('sys_id')\n        # filter the record for the required fields\n        record = dict(filter(lambda kv_pair: kv_pair[0] in fields, record.items()))\n        for k, v in record.iteritems():\n            if isinstance(v, dict):\n                # For objects that refer to a record in the database, take their value(system ID).\n                record[k] = v.get('value', record[k])\n        record['ID'] = record.pop('sys_id')\n        entry['ReadableContentsFormat'] = formats['markdown']\n        entry['HumanReadable'] = tableToMarkdown('ServiceNow record', record, removeNull=True)\n        entry['EntryContext'] = {\n            'ServiceNow.Record(val.ID===obj.ID)': createContext(record)\n        }\n    else:\n        mapped_record = {DEFAULT_RECORD_FIELDS[k]: record[k] for k in DEFAULT_RECORD_FIELDS if k in record}\n        entry['ReadableContentsFormat'] = formats['markdown']\n        entry['HumanReadable'] = tableToMarkdown('ServiceNow record' + record_id, mapped_record, removeNull=True)\n        entry['EntryContext'] = {\n            'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_record)\n        }\n\n    return entry\n\n\ndef get(table_name, record_id, number=None):\n    path = None\n    query_params = {}  # type: Dict\n    if record_id:\n        path = 'table/' + table_name + '/' + record_id\n    elif number:\n        path = 'table/' + table_name\n        query_params = {\n            'number': number\n        }\n    else:\n        # Only in cases where the table is of type ticket\n        raise ValueError('servicenow-get-ticket requires either ticket ID (sys_id) or ticket number')\n\n    return send_request(path, 'get', params=query_params)\n\n\ndef get_ticket_attachments(ticket_id):\n    path = 'attachment'\n    query_params = {\n        'sysparm_query': 'table_sys_id=' + ticket_id\n    }\n\n    return send_request(path, 'get', params=query_params)\n\n\ndef get_ticket_attachment_entries(ticket_id):\n    entries = []\n    links = []  # type: List[Tuple[str, str]]\n    attachments_res = get_ticket_attachments(ticket_id)\n    if 'result' in attachments_res and len(attachments_res['result']) \u003e 0:\n        attachments = attachments_res['result']\n        links = [(attachment['download_link'], attachment['file_name']) for attachment in attachments]\n\n    for link in links:\n        file_res = requests.get(link[0], auth=(USERNAME, PASSWORD), verify=VERIFY_SSL)\n        if file_res is not None:\n            entries.append(fileResult(link[1], file_res.content))\n\n    return entries\n\n\ndef update_ticket_command():\n    args = unicode_to_str_recur(demisto.args())\n    custom_fields = split_fields(args.get('custom_fields'))\n    template = args.get('template')\n    ticket_type = get_table_name(args.get('ticket_type'))\n    ticket_id = args['id']\n\n    if template:\n        template = get_template(template)\n    fields = get_ticket_fields(template, ticket_type)\n\n    res = update(ticket_type, ticket_id, fields, custom_fields)\n\n    if not res or 'result' not in res:\n        return_error('Unable to retrieve response')\n\n    hr = get_ticket_human_readable(res['result'], ticket_type)\n    context = get_ticket_context(res['result'], ticket_type)\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow ticket updated successfully\\nTicket type: ' + ticket_type,\n                                         hr, removeNull=True),\n        'EntryContext': {\n            'ServiceNow.Ticket(val.ID===obj.ID)': context\n        }\n    }\n\n    return entry\n\n\ndef update_record_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = args['table_name']\n    record_id = args['id']\n    fields = args.get('fields', {})\n    custom_fields = args.get('custom_fields')\n\n    if fields:\n        fields = split_fields(fields)\n    if custom_fields:\n        custom_fields = split_fields(custom_fields)\n\n    res = update(table_name, record_id, fields, custom_fields)\n\n    if not res or 'result' not in res:\n        return 'Could not retrieve record'\n\n    result = res['result']\n\n    mapped_record = {DEFAULT_RECORD_FIELDS[k]: result[k] for k in DEFAULT_RECORD_FIELDS if k in result}\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow record updated successfully', mapped_record, removeNull=True),\n        'EntryContext': {\n            'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_record)\n        }\n    }\n\n    return entry\n\n\ndef update(table_name, record_id, fields, custom_fields):\n    body = get_body(fields, custom_fields)\n    path = 'table/' + table_name + '/' + record_id\n\n    return send_request(path, 'patch', body=body)\n\n\ndef create_ticket_command():\n    args = unicode_to_str_recur(demisto.args())\n    custom_fields = split_fields(args.get('custom_fields'))\n    template = args.get('template')\n    ticket_type = get_table_name(args.get('ticket_type'))\n\n    if template:\n        template = get_template(template)\n    fields = get_ticket_fields(template, ticket_type)\n\n    res = create(ticket_type, fields, custom_fields)\n\n    if not res or 'result' not in res:\n        return_error('Unable to retrieve response')\n\n    hr = get_ticket_human_readable(res['result'], ticket_type)\n    context = get_ticket_context(res['result'], ticket_type)\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code',\n               'Description', 'Opened At', 'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description',\n               'Additional Comments']\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow ticket created successfully', hr,\n                                         headers=headers, removeNull=True),\n        'EntryContext': {\n            'Ticket(val.ID===obj.ID)': context,\n            'ServiceNow.Ticket(val.ID===obj.ID)': context\n        }\n    }\n\n    return entry\n\n\ndef create_record_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = args['table_name']\n    fields = args.get('fields')\n    custom_fields = args.get('custom_fields')\n\n    if fields:\n        fields = split_fields(fields)\n    if custom_fields:\n        custom_fields = split_fields(custom_fields)\n\n    res = create(table_name, fields, custom_fields)\n\n    if not res or 'result' not in res:\n        return 'Could not retrieve record'\n\n    result = res['result']\n\n    mapped_record = {DEFAULT_RECORD_FIELDS[k]: result[k] for k in DEFAULT_RECORD_FIELDS if k in result}\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow record created successfully', mapped_record, removeNull=True),\n        'EntryContext': {\n            'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_record)\n        }\n    }\n\n    return entry\n\n\ndef create(table_name, fields, custom_fields):\n    body = get_body(fields, custom_fields)\n    path = 'table/' + table_name\n\n    return send_request(path, 'post', body=body)\n\n\ndef delete_ticket_command():\n    args = unicode_to_str_recur(demisto.args())\n    ticket_id = args['id']\n    ticket_type = get_table_name(args.get('ticket_type'))\n\n    res = delete(ticket_type, ticket_id)\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['text'],\n        'HumanReadable': 'Ticket with ID ' + ticket_id + ' was successfully deleted.'\n    }\n\n    return entry\n\n\ndef delete_record_command():\n    args = unicode_to_str_recur(demisto.args())\n    record_id = args['id']\n    table_name = args.get('table_name')\n\n    res = delete(table_name, record_id)\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['text'],\n        'HumanReadable': 'Record with ID ' + record_id + ' was successfully deleted.'\n    }\n\n    return entry\n\n\ndef delete(table_name, record_id):\n    path = 'table/' + table_name + '/' + record_id\n\n    return send_request(path, 'delete')\n\n\ndef add_link_command():\n    args = unicode_to_str_recur(demisto.args())\n    ticket_id = args['id']\n    key = 'comments' if args.get('post-as-comment', 'false').lower() == 'true' else 'work_notes'\n    text = args.get('text', args['link'])\n    link = '[code]\u003ca class=\"web\" target=\"_blank\" href=\"' + args['link'] + '\" \u003e' + text + '\u003c/a\u003e[/code]'\n    ticket_type = get_table_name(args.get('ticket_type'))\n\n    res = add_link(ticket_id, ticket_type, key, link)\n\n    if not res or 'result' not in res:\n        return_error('Unable to retrieve response')\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code',\n               'Description', 'Opened At', 'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description',\n               'Additional Comments']\n\n    hr = get_ticket_human_readable(res['result'], ticket_type)\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('Link successfully added to ServiceNow ticket', hr,\n                                         headers=headers, removeNull=True)\n    }\n\n    return entry\n\n\ndef add_link(ticket_id, ticket_type, key, link):\n    body = {}\n    body[key] = link\n    path = 'table/' + ticket_type + '/' + ticket_id\n\n    return send_request(path, 'patch', body=body)\n\n\ndef add_comment_command():\n    args = unicode_to_str_recur(demisto.args())\n    ticket_id = args['id']\n    key = 'comments' if args.get('post-as-comment', 'false').lower() == 'true' else 'work_notes'\n    text = args['comment']\n    ticket_type = get_table_name(args.get('ticket_type'))\n\n    res = add_comment(ticket_id, ticket_type, key, text)\n\n    if not res or 'result' not in res:\n        return_error('Unable to retrieve response')\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code',\n               'Description', 'Opened At', 'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description',\n               'Additional Comments']\n\n    hr = get_ticket_human_readable(res['result'], ticket_type)\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('Comment successfully added to ServiceNow ticket', hr,\n                                         headers=headers, removeNull=True)\n    }\n\n    return entry\n\n\ndef add_comment(ticket_id, ticket_type, key, text):\n    body = {}\n    body[key] = text\n    path = 'table/' + ticket_type + '/' + ticket_id\n\n    return send_request(path, 'patch', body=body)\n\n\ndef get_ticket_notes_command():\n    args = unicode_to_str_recur(demisto.args())\n    ticket_id = args['id']\n    limit = args.get('limit')\n    offset = args.get('offset')\n\n    comments_query = 'element_id=' + ticket_id + '^element=comments^ORelement=work_notes'\n\n    res = query('sys_journal_field', limit, offset, comments_query)\n\n    if not res or 'result' not in res:\n        return 'No results found'\n\n    headers = ['Value', 'CreatedOn', 'CreatedBy', 'Type']\n\n    mapped_notes = [{\n        'Value': n.get('value'),\n        'CreatedOn': n.get('sys_created_on'),\n        'CreatedBy': n.get('sys_created_by'),\n        'Type': 'Work Note' if n.get('element', '') == 'work_notes' else 'Comment'\n    } for n in res['result']]\n\n    if not mapped_notes:\n        return 'No results found'\n\n    ticket = {\n        'ID': ticket_id,\n        'Note': mapped_notes\n    }\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow notes for ticket ' + ticket_id, mapped_notes, headers=headers,\n                                         headerTransform=pascalToSpace, removeNull=True),\n        'EntryContext': {\n            'ServiceNow.Ticket(val.ID===obj.ID)': createContext(ticket, removeNull=True)\n        }\n    }\n\n    return entry\n\n\ndef query_tickets_command():\n    args = unicode_to_str_recur(demisto.args())\n    sysparm_limit = args.get('limit', DEFAULTS['limit'])\n    sysparm_query = args.get('query')\n    sysparm_offset = args.get('offset', DEFAULTS['offset'])\n\n    if not sysparm_query:\n        # backward compatibility\n        sysparm_query = args.get('sysparm_query')\n    ticket_type = get_table_name(args.get('ticket_type'))\n\n    res = query(ticket_type, sysparm_limit, sysparm_offset, sysparm_query)\n\n    if not res or 'result' not in res or len(res['result']) == 0:\n        return 'No results found'\n\n    hr = get_ticket_human_readable(res['result'], ticket_type)\n    context = get_ticket_context(res['result'], ticket_type)\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code',\n               'Description', 'Opened At', 'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description',\n               'Additional Comments']\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow tickets', hr, headers=headers, removeNull=True),\n        'EntryContext': {\n            'Ticket(val.ID===obj.ID)': context,\n            'ServiceNow.Ticket(val.ID===obj.ID)': context\n        }\n    }\n\n    return entry\n\n\ndef query_table_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = args['table_name']\n    sysparm_limit = args.get('limit', DEFAULTS['limit'])\n    sysparm_query = args.get('query')\n    sysparm_offset = args.get('offset', DEFAULTS['offset'])\n    fields = args.get('fields')\n\n    res = query(table_name, sysparm_limit, sysparm_offset, sysparm_query)\n\n    if not res or 'result' not in res or len(res['result']) == 0:\n        return 'No results found'\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json']\n    }\n\n    result = res['result']\n\n    if fields:\n        fields = argToList(fields)\n        if 'sys_id' not in fields:\n            # ID is added by default\n            fields.append('sys_id')\n        # Filter the records according to the given fields\n        records = [dict(filter(lambda kv_pair: kv_pair[0] in fields, r.iteritems())) for r in res['result']]\n        for r in records:\n            r['ID'] = r.pop('sys_id')\n            for k, v in r.iteritems():\n                if isinstance(v, dict):\n                    # For objects that refer to a record in the database, take their value (system ID).\n                    r[k] = v.get('value', v)\n        entry['ReadableContentsFormat'] = formats['markdown']\n        entry['HumanReadable'] = tableToMarkdown('ServiceNow records', records, removeNull=True)\n        entry['EntryContext'] = {\n            'ServiceNow.Record(val.ID===obj.ID)': createContext(records)\n        }\n    else:\n        mapped_records = [{DEFAULT_RECORD_FIELDS[k]: r[k] for k in DEFAULT_RECORD_FIELDS if k in r} for r in result]\n        entry['ReadableContentsFormat'] = formats['markdown']\n        entry['HumanReadable'] = tableToMarkdown('ServiceNow records', mapped_records, removeNull=True)\n        entry['EntryContext'] = {\n            'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_records)\n        }\n\n    return entry\n\n\ndef query(table_name, sysparm_limit, sysparm_offset, sysparm_query):\n    query_params = {}\n    query_params['sysparm_limit'] = sysparm_limit\n    query_params['sysparm_offset'] = sysparm_offset\n    if sysparm_query:\n        query_params['sysparm_query'] = sysparm_query\n\n    path = 'table/' + table_name\n\n    return send_request(path, 'get', params=query_params)\n\n\ndef upload_file_command():\n    args = unicode_to_str_recur(demisto.args())\n    ticket_type = get_table_name(args.get('ticket_type'))\n    ticket_id = args['id']\n    file_id = args['file_id']\n    file_name = args.get('file_name', demisto.dt(demisto.context(), \"File(val.EntryID=='\" + file_id + \"').Name\"))\n\n    # in case of info file\n    if not file_name:\n        file_name = demisto.dt(demisto.context(), \"InfoFile(val.EntryID=='\" + file_id + \"').Name\")\n\n    if not file_name:\n        return_error('Could not find the file')\n\n    file_name = file_name[0] if isinstance(file_name, list) else file_name\n\n    res = upload_file(ticket_id, file_id, file_name, ticket_type)\n\n    if not res or 'result' not in res or not res['result']:\n        return_error('Unable to retrieve response')\n\n    hr = {\n        'Filename': res['result'].get('file_name'),\n        'Download link': res['result'].get('download_link'),\n        'System ID': res['result'].get('sys_id')\n    }\n\n    context = {\n        'ID': ticket_id,\n        'File': {}\n    }\n    context['File']['Filename'] = res['result'].get('file_name')\n    context['File']['Link'] = res['result'].get('download_link')\n    context['File']['SystemID'] = res['result'].get('sys_id')\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('File uploaded successfully', hr),\n        'EntryContext': {\n            'ServiceNow.Ticket(val.ID===obj.ID)': context,\n            'Ticket(val.ID===obj.ID)': context\n        }\n    }\n\n    return entry\n\n\ndef upload_file(ticket_id, file_id, file_name, ticket_type):\n    headers = {\n        'Accept': 'application/json'\n    }\n\n    body = {\n        'table_name': ticket_type,\n        'table_sys_id': ticket_id,\n        'file_name': file_name\n    }\n\n    path = 'attachment/upload'\n\n    return send_request(path, 'post', headers=headers, body=body, file={'id': file_id, 'name': file_name})\n\n\n# Deprecated\ndef get_computer_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = 'cmdb_ci_computer'\n    computer_name = args['computerName']\n\n    res = query(table_name, None, 0, 'u_code=' + computer_name)\n\n    if not res or 'result' not in res:\n        return 'Cannot find computer'\n    elif isinstance(res['result'], list):\n        if len(res['result']) == 0:\n            return 'Cannot find computer'\n        computer = res['result'][0]\n    else:\n        computer = res['result']\n\n    if computer['u_code'] != computer_name:\n        return 'Computer not found'\n\n    hr = {\n        'ID': computer['sys_id'],\n        'u_code (computer name)': computer['u_code'],\n        'Support group': computer['support_group'],\n        'Operating System': computer['os'],\n        'Comments': computer['comments']\n    }\n\n    ec = createContext(computer, removeNull=True)\n    if 'support_group' in computer:\n        ec['support_group'] = computer['support_group']['value'] if 'value' in computer['support_group'] else ''\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': computer,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Computer', hr),\n        'EntryContext': {\n            'ServiceNowComputer(val.sys_id==obj.sys_id)': ec,\n        }\n    }\n\n    return entry\n\n\ndef query_computers_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = 'cmdb_ci_computer'\n    computer_id = args.get('computer_id')\n    computer_name = args.get('computer_name')\n    asset_tag = args.get('asset_tag')\n    computer_query = args.get('query', {})\n    offset = args.get('offset', DEFAULTS['offset'])\n    limit = args.get('limit', DEFAULTS['limit'])\n\n    if computer_id:\n        res = get(table_name, computer_id)\n    else:\n        if computer_name:\n            computer_query = 'name=' + computer_name\n        elif asset_tag:\n            computer_query = 'asset_tag=' + asset_tag\n\n        res = query(table_name, limit, offset, computer_query)\n\n    if not res or 'result' not in res:\n        return 'No computers found'\n\n    computers = res['result']\n    if not isinstance(computers, list):\n        computers = [computers]\n\n    if len(computers) == 0:\n        return 'No computers found'\n\n    headers = ['ID', 'AssetTag', 'Name', 'DisplayName', 'SupportGroup', 'OperatingSystem', 'Company', 'AssignedTo',\n               'State', 'Cost', 'Comments']\n\n    mapped_computers = [{\n        'ID': computer.get('sys_id'),\n        'AssetTag': computer.get('asset_tag'),\n        'Name': computer.get('name'),\n        'DisplayName': '{} - {}'.format(computer.get('asset_tag', ''), computer.get('name', '')),\n        'SupportGroup': computer.get('support_group'),\n        'OperatingSystem': computer.get('os'),\n        'Company': computer.get('company', {}).get('value')\n        if isinstance(computer.get('company'), dict) else computer.get('company'),\n        'AssignedTo': computer.get('assigned_to', {}).get('value')\n        if isinstance(computer.get('assigned_to'), dict) else computer.get('assigned_to'),\n        'State': COMPUTER_STATUS.get(computer.get('install_status', ''), computer.get('install_status')),\n        'Cost': '{} {}'.format(computer.get('cost', ''), computer.get('cost_cc', '')).rstrip(),\n        'Comments': computer.get('comments')\n    } for computer in computers]\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Computers', mapped_computers, headers=headers,\n                                         removeNull=True, headerTransform=pascalToSpace),\n        'EntryContext': {\n            'ServiceNow.Computer(val.ID===obj.ID)': createContext(mapped_computers, removeNull=True),\n        }\n    }\n\n    return entry\n\n\ndef query_groups_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = 'sys_user_group'\n    group_id = args.get('group_id')\n    group_name = args.get('group_name')\n    group_query = args.get('query', {})\n    offset = args.get('offset', DEFAULTS['offset'])\n    limit = args.get('limit', DEFAULTS['limit'])\n\n    if group_id:\n        res = get(table_name, group_id)\n    else:\n        if group_name:\n            group_query = 'name=' + group_name\n        res = query(table_name, limit, offset, group_query)\n\n    if not res or 'result' not in res:\n        return 'No groups found'\n\n    groups = res['result']\n    if not isinstance(groups, list):\n        groups = [groups]\n\n    if len(groups) == 0:\n        return 'No groups found'\n\n    headers = ['ID', 'Description', 'Name', 'Active', 'Manager', 'Updated']\n\n    mapped_groups = [{\n        'ID': group.get('sys_id'),\n        'Description': group.get('description'),\n        'Name': group.get('name'),\n        'Active': group.get('active'),\n        'Manager': group.get('manager', {}).get('value')\n        if isinstance(group.get('manager'), dict) else group.get('manager'),\n        'Updated': group.get('sys_updated_on'),\n    } for group in groups]\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Groups', mapped_groups, headers=headers,\n                                         removeNull=True, headerTransform=pascalToSpace),\n        'EntryContext': {\n            'ServiceNow.Group(val.ID===obj.ID)': createContext(mapped_groups, removeNull=True),\n        }\n    }\n\n    return entry\n\n\ndef query_users_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = 'sys_user'\n    user_id = args.get('user_id')\n    user_name = args.get('user_name')\n    user_query = args.get('query', {})\n    offset = args.get('offset', DEFAULTS['offset'])\n    limit = args.get('limit', DEFAULTS['limit'])\n\n    if user_id:\n        res = get(table_name, user_id)\n    else:\n        if user_name:\n            user_query = 'user_name=' + user_name\n        res = query(table_name, limit, offset, user_query)\n\n    if not res or 'result' not in res:\n        return 'No users found'\n    res = unicode_to_str_recur(res)\n\n    users = res['result']\n    if not isinstance(users, list):\n        users = [users]\n\n    if len(users) == 0:\n        return 'No users found'\n\n    headers = ['ID', 'Name', 'UserName', 'Email', 'Created', 'Updated']\n\n    mapped_users = [{\n        'ID': user.get('sys_id'),\n        'Name': '{} {}'.format(user.get('first_name', ''), user.get('last_name', '')).rstrip(),\n        'UserName': user.get('user_name'),\n        'Email': user.get('email'),\n        'Created': user.get('sys_created_on'),\n        'Updated': user.get('sys_updated_on'),\n    } for user in users]\n    mapped_users = unicode_to_str_recur(mapped_users)\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Users', mapped_users, headers=headers, removeNull=True,\n                                         headerTransform=pascalToSpace),\n        'EntryContext': {\n            'ServiceNow.User(val.ID===obj.ID)': createContext(mapped_users, removeNull=True),\n        }\n    }\n\n    return entry\n\n\n# Deprecated\ndef get_groups_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = 'sys_user_group'\n    group_name = args['name']\n    res = query(table_name, None, 0, 'name=' + group_name)\n\n    if not res or 'result' not in res:\n        return 'No groups found'\n\n    hr_groups = []\n    context_groups = []\n\n    for group in res['result']:\n        if group['name'] == group_name:\n            hr_groups.append({\n                'ID': group['sys_id'],\n                'Name': group['name'],\n                'Description': group['description'],\n                'Email': group['email'],\n                'Active': group['active'],\n                'Manager': ['manager']\n            })\n            context_groups.append({\n                'GroupId': group['sys_id'],\n                'GroupName': group['name']\n            })\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Group', hr_groups),\n        'EntryContext': {\n            'ServiceNowGroups(val.GroupId==obj.GroupId)': context_groups,\n        }\n    }\n\n    return entry\n\n\ndef list_table_fields_command():\n    args = unicode_to_str_recur(demisto.args())\n    table_name = args['table_name']\n\n    res = get_table_fields(table_name)\n\n    if not res or 'result' not in res:\n        return 'Cannot find table'\n\n    if len(res['result']) == 0:\n        return 'Table contains no records'\n\n    fields = [{'Name': k} for k, v in res['result'][0].iteritems()]\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Table fields - ' + table_name, fields),\n        'EntryContext': {\n            'ServiceNow.Field': createContext(fields),\n        }\n    }\n\n    return entry\n\n\ndef get_table_fields(table_name):\n    # Get one record\n    path = 'table/' + table_name + '?sysparm_limit=1'\n    res = send_request(path, 'GET')\n\n    return res\n\n\ndef get_table_name_command():\n    args = unicode_to_str_recur(demisto.args())\n    label = args['label']\n    offset = args.get('offset', DEFAULTS['offset'])\n    limit = args.get('limit', DEFAULTS['limit'])\n\n    table_query = 'label=' + label\n\n    res = query('sys_db_object', limit, offset, table_query)\n\n    if not res or 'result' not in res:\n        return 'Cannot find table'\n\n    tables = res['result']\n\n    if len(tables) == 0:\n        return 'Cannot find table'\n\n    headers = ['ID', 'Name', 'SystemName']\n\n    mapped_tables = [{\n        'ID': table.get('sys_id'),\n        'Name': table.get('name'),\n        'SystemName': table.get('sys_name')\n    } for table in tables]\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': res,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow Tables for label - ' + label, mapped_tables,\n                                         headers=headers, headerTransform=pascalToSpace),\n        'EntryContext': {\n            'ServiceNow.Table(val.ID===obj.ID)': createContext(mapped_tables),\n        }\n    }\n\n    return entry\n\n\ndef fetch_incidents():\n    query_params = {}\n    incidents = []\n    if FETCH_TIME:\n        fetch_time = FETCH_TIME\n    else:\n        fetch_time = DEFAULTS['fetch_time']\n\n    last_run = demisto.getLastRun()\n    if 'time' not in last_run:\n        snow_time, _ = parse_date_range(fetch_time, '%Y-%m-%d %H:%M:%S')\n    else:\n        snow_time = last_run['time']\n\n    query = ''\n    if SYSPARM_QUERY:\n        query += SYSPARM_QUERY + '^'\n    query += 'ORDERBY{0}^{0}\u003e{1}'.format(TIMESTAMP_FIELD, snow_time)\n\n    if query:\n        query_params['sysparm_query'] = query\n\n    query_params['sysparm_limit'] = SYSPARM_LIMIT\n\n    path = 'table/' + TICKET_TYPE\n    res = send_request(path, 'get', params=query_params)\n\n    count = 0\n    parsed_snow_time = datetime.strptime(snow_time, '%Y-%m-%d %H:%M:%S')\n\n    for result in res.get('result', []):\n        labels = []\n\n        if TIMESTAMP_FIELD not in result:\n            raise ValueError(\"The timestamp field [{}]\"\n                             \" does not exist in the ticket\".format(TIMESTAMP_FIELD))\n\n        if count \u003e SYSPARM_LIMIT:\n            break\n\n        try:\n            if datetime.strptime(result[TIMESTAMP_FIELD], '%Y-%m-%d %H:%M:%S') \u003c parsed_snow_time:\n                continue\n        except Exception:\n            pass\n\n        for k, v in result.iteritems():\n            if isinstance(v, basestring):\n                labels.append({\n                    'type': k,\n                    'value': v\n                })\n            else:\n                labels.append({\n                    'type': k,\n                    'value': json.dumps(v)\n                })\n\n        severity = SEVERITY_MAP.get(result.get('severity', ''), 0)\n\n        file_names = []\n        if GET_ATTACHMENTS:\n            file_entries = get_ticket_attachment_entries(result['sys_id'])\n            for file_result in file_entries:\n                if file_result['Type'] == entryTypes['error']:\n                    raise Exception('Error getting attachment: ' + str(file_result['Contents']))\n                file_names.append({\n                    'path': file_result['FileID'],\n                    'name': file_result['File']\n                })\n\n        incidents.append({\n            'name': 'ServiceNow Incident ' + result.get('number'),\n            'labels': labels,\n            'details': json.dumps(result),\n            'severity': severity,\n            'attachment': file_names,\n            'rawJSON': json.dumps(result)\n        })\n\n        count += 1\n        snow_time = result[TIMESTAMP_FIELD]\n\n    demisto.incidents(incidents)\n    demisto.setLastRun({'time': snow_time})\n\n\ndef test_module():\n    # Validate fetch_time parameter is valid (if not, parse_date_range will raise the error message)\n    parse_date_range(FETCH_TIME, '%Y-%m-%d %H:%M:%S')\n\n    path = 'table/' + TICKET_TYPE + '?sysparm_limit=1'\n    res = send_request(path, 'GET')\n    if 'result' not in res:\n        return_error('ServiceNow error: ' + str(res))\n    ticket = res['result']\n    if ticket and demisto.params().get('isFetch'):\n        if isinstance(ticket, list):\n            ticket = ticket[0]\n        if TIMESTAMP_FIELD not in ticket:\n            raise ValueError(\"The timestamp field [{}]\"\n                             \" does not exist in the ticket\".format(TIMESTAMP_FIELD))\n\n\nLOG('Executing command ' + demisto.command())\nraise_exception = False\ntry:\n    if demisto.command() == 'test-module':\n        test_module()\n        demisto.results('ok')\n    elif demisto.command() == 'fetch-incidents':\n        raise_exception = True\n        fetch_incidents()\n    elif demisto.command() == 'servicenow-get' or \\\n            demisto.command() == 'servicenow-incident-update' or demisto.command() == 'servicenow-get-ticket':\n        demisto.results(get_ticket_command())\n    elif demisto.command() == 'servicenow-update' or \\\n            demisto.command() == 'servicenow-incident-update' or demisto.command() == 'servicenow-update-ticket':\n        demisto.results(update_ticket_command())\n    elif demisto.command() == 'servicenow-create' or \\\n            demisto.command() == 'servicenow-incident-create' or demisto.command() == 'servicenow-create-ticket':\n        demisto.results(create_ticket_command())\n    elif demisto.command() == 'servicenow-delete-ticket':\n        demisto.results(delete_ticket_command())\n    elif demisto.command() == 'servicenow-add-link' or demisto.command() == 'servicenow-incident-add-link':\n        demisto.results(add_link_command())\n    elif demisto.command() == 'servicenow-add-comment' or demisto.command() == 'servicenow-incident-add-comment':\n        demisto.results(add_comment_command())\n    elif demisto.command() == 'servicenow-query' or \\\n            demisto.command() == 'servicenow-incidents-query' or demisto.command() == 'servicenow-query-tickets':\n        demisto.results(query_tickets_command())\n    elif demisto.command() == 'servicenow-upload-file' or demisto.command() == 'servicenow-incident-upload-file':\n        demisto.results(upload_file_command())\n    elif demisto.command() == 'servicenow-query-table':\n        demisto.results(query_table_command())\n    elif demisto.command() == 'servicenow-get-computer':\n        demisto.results(get_computer_command())\n    elif demisto.command() == 'servicenow-query-computers':\n        demisto.results(query_computers_command())\n    elif demisto.command() == 'servicenow-query-groups':\n        demisto.results(query_groups_command())\n    elif demisto.command() == 'servicenow-query-users':\n        demisto.results(query_users_command())\n    elif demisto.command() == 'servicenow-get-groups':\n        demisto.results(get_groups_command())\n    elif demisto.command() == 'servicenow-get-record':\n        demisto.results(get_record_command())\n    elif demisto.command() == 'servicenow-update-record':\n        demisto.results(update_record_command())\n    elif demisto.command() == 'servicenow-create-record':\n        demisto.results(create_record_command())\n    elif demisto.command() == 'servicenow-delete-record':\n        demisto.results(delete_record_command())\n    if demisto.command() == 'servicenow-list-table-fields':\n        demisto.results(list_table_fields_command())\n    if demisto.command() == 'servicenow-get-table-name':\n        demisto.results(get_table_name_command())\n    if demisto.command() == 'servicenow-get-ticket-notes':\n        demisto.results(get_ticket_notes_command())\nexcept Exception as e:\n    LOG(e)\n    LOG.print_log()\n    if not raise_exception:\n        return_error(str(e))\n    else:\n        raise\n","subtype":"python2","type":"python"},"itemVersion":"2.2.2","modified":"2021-08-24T19:36:38.155514+03:00","name":"ServiceNow","packID":"ServiceNow","packPropagationLabels":["all"],"prevName":"ServiceNow","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"IT Services","commitMessage":"","configuration":[{"defaultValue":"","display":"ServiceNow URL, in the format https://company.service-now.com/","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username/Client ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"Use OAuth Login","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Check this box to use OAuth 2.0 authentication. See (?) for more information.","name":"use_oauth","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"ServiceNow CMDB is a service‑centric foundation that proactively analyzes service‑impacting changes, identifies issues, and eliminates outages.","detailedDescription":"### Instance Configuration\nThe integration supports two types of authorization:\n1. Basic authorization using username and password.\n2. OAuth 2.0 authorization.\n\n#### OAuth 2.0 Authorization\nTo use OAuth 2.0 authorization perform the following steps:\n1. Login to your ServiceNow instance and create an endpoint for XSOAR to access your instance. (See [Snow OAuth](https://docs.servicenow.com/bundle/orlando-platform-administration/page/administer/security/task/t_CreateEndpointforExternalClients.html) for more information). \n2. Copy the **Client Id** and **Client Secret** (press the lock next to the client secret to reveal it) that were automatically generated when creating the endpoint into the **Username** and **Password** fields of the instance configuration.\n3. Select the **Use OAuth Login** checkbox and click **Done**.\n4. Run the command ***!servicenow-cmdb-oauth-login*** from the XSOAR CLI and fill in the username and password of the ServiceNow instance. This step generates and saves in the integration context a refresh token to the ServiceNow instance and is required only the first time you configure a new instance in the XSOAR platform.\n5. (Optional) Test the created instance by running the ***!servicenow-cmdb-oauth-test*** command.\n\n**Notes:**\n1. When running the ***!servicenow-cmdb-oauth-login*** command, a refresh token is generated and will be used to produce new access tokens after the current access token has expired.\n2. Every time the refresh token expires you will have to run the ***servicenow-cmdb-oauth-login*** command again. Therefore, we recommend to set the **Refresh Token Lifespan** field in the endpoint created in step 1 to a long period (can be set to several years). \n\n\n### Using Multi Factor Authentication (MFA)\nMFA can be used both when using basic authorization and when using OAuth 2.0 authorization, however we strongly recommend using OAuth 2.0 when using MFA.\nIf MFA is enabled for your user, perform the following steps:\n1. Open the Google Authenticator application on your mobile device and make note of the number. The number refreshes every 30 seconds.\n2. Enter your username and password, and append the One Time Password (OTP) that you currently see on your mobile device to your password without any extra spaces. For example, if your password is **12345** and the current OTP code is **424 058**, enter `12345424058`.\n\n**Notes:**\n1. When using basic authorization, you will have to update your password with the current OTP every time the current code expires (30 seconds), therefore we recommend using OAuth 2.0 authorization.\n2. For using OAuth 2.0 see the instructions above. The OTP code should be appended to the password parameter in the ***!servicenow-cmdb-oauth-login*** command.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/service-now-cmdb)","display":"ServiceNow CMDB","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"ServiceNow CMDB","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The name of the class to query.","name":"class","required":true,"secret":false},{"default":false,"deprecated":false,"description":"An encoded query string used to filter the results. For more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/paris-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html.","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of results returned per page (default: 50).","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The number of records to exclude from the query (default: 0).","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Query records for a CMDB class.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-records-list","outputs":[{"contentPath":"","contextPath":"ServiceNowCMDB.Class","description":"The name of CMDB table that was queried.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Records","description":"A list of all the records that were found in the CMDB table.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the class to query.","name":"class","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the record that should be queried.","name":"sys_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of the fields to return for the queried record.","name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of relations returned (default: 50).","name":"relation_limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The number of records to exclude from the relations query (default: 0).","name":"relation_offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Query attributes and relationship information for a specific record.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-record-get-by-id","outputs":[{"contentPath":"","contextPath":"ServiceNowCMDB.Record.SysID","description":"The sys_id of the record that was queried.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Class","description":"The name of the class from which the record was queried.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Attributes","description":"The attributes that were returned in the response for the queried record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.OutboundRelations","description":"A list of all the outbound relations of the queried record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.InboundRelations","description":"A list of all the inbound relations of the queried record.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the class to add the record to.","name":"class","required":true,"secret":false},{"default":false,"defaultValue":"ServiceNow","deprecated":false,"description":"The discovery source value. You can see all available values from the sys_choice table with query GOTOelementLIKEdiscovery_source^name=cmdb_ci. (default: \"ServiceNow\").","name":"source","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of attributes that should be added to the created record. Input format: attribute=value pairs, e.g., \"name=test, ram=1024\".","name":"attributes","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of dictionaries. Each dictionary represents an inbound relation that should be added to the created record.","isArray":true,"name":"inbound_relations","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of dictionaries. Each dictionary represents an outbound relation that should be added to the created record.","isArray":true,"name":"outbound_relations","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of fields to return for the created record.","name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of relations returned (default: 50).","name":"relation_limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The number of records to exclude from the relations query (default: 0).","name":"relation_offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a record with associated relations and attributes.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-record-create","outputs":[{"contentPath":"","contextPath":"ServiceNowCMDB.Record.SysID","description":"The sys_id of the record that was created.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Class","description":"The name of the class from which the record was created.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Attributes","description":"The attributes that were returned in the response for the created record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.OutboundRelations","description":"A list of all the outbound relations of the created record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.InboundRelations","description":"A list of all the inbound relations of the created record.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The class name of the record that should be updated.","name":"class","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the record that should be updated.","name":"sys_id","required":true,"secret":false},{"default":false,"defaultValue":"ServiceNow","deprecated":false,"description":"The discovery source value. You can see all available values from sys_choice table with query GOTOelementLIKEdiscovery_source^name=cmdb_ci. (default: \"ServiceNow\").","name":"source","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of the attributes that should be updated in the record. Input format: attribute=value pairs, e.g., \"name=test,ram=1024\".","name":"attributes","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of the fields to return for the updated record.","name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of relations returned (default: 50).","name":"relation_limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The number of records to exclude from the relations query (default: 0).","name":"relation_offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Update a record with the given attributes.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-record-update","outputs":[{"contentPath":"","contextPath":"ServiceNowCMDB.Record.SysID","description":"The sys_id of the record that was updated.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Class","description":"The class name of the updated record.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Attributes","description":"The attributes that were returned in the response for the updated record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.OutboundRelations","description":"A list of all the outbound relations of the updated record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.InboundRelations","description":"A list of all the inbound relations of the updated record.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The class name of the record.","name":"class","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the record to which the relations should be added.","name":"sys_id","required":true,"secret":false},{"default":false,"defaultValue":"ServiceNow","deprecated":false,"description":"The discovery source value. You can see all available values from sys_choice table with query GOTOelementLIKEdiscovery_source^name=cmdb_ci. (default: \"ServiceNow\").","name":"source","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of dictionaries. Each dictionary represents an inbound relation that should be added to the created record.","isArray":true,"name":"inbound_relations","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of dictionaries. Each dictionary represents an outbound relation that should be added to the created record.","isArray":true,"name":"outbound_relations","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of the fields to return for the record.","name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of relations returned (default: 50).","name":"relation_limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The number of records to exclude from the relations query (default: 0).","name":"relation_offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Add a new relation to an existing record.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-record-add-relations","outputs":[{"contentPath":"","contextPath":"ServiceNowCMDB.Record.SysID","description":"The sys_id of the record that was updated.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Class","description":"The class name of the record.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Attributes","description":"The attributes that were returned in the response for the updated record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.OutboundRelations","description":"A list of all the outbound relations of the record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.InboundRelations","description":"A list of all the inbound relations of the record.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The class name of the record.","name":"class","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the record from which a relation should be deleted.","name":"sys_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the relation that should be deleted.","name":"relation_sys_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of the fields to return for the record.","name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of relations returned (default: 50).","name":"relation_limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"The number of records to exclude from the relations query (default: 0).","name":"relation_offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete a relation of an existing record.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-record-delete-relations","outputs":[{"contentPath":"","contextPath":"ServiceNowCMDB.Record.SysID","description":"The sys_id of the record that was updated.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Class","description":"The class name of the record.","type":"String"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.Attributes","description":"The attributes that were returned in the response for the updated record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.OutboundRelations","description":"A list of all the outbound relations of the record.","type":"Unknown"},{"contentPath":"","contextPath":"ServiceNowCMDB.Record.InboundRelations","description":"A list of all the inbound relations of the record.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username that should be used for login.","name":"username","required":true,"secret":true},{"default":false,"deprecated":false,"description":"The password that should be used for login.","name":"password","required":true,"secret":true}],"cartesian":false,"deprecated":false,"description":"This function should be used once before running any command when using OAuth authorization.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-oauth-login","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Test the instance configuration when using OAuth authorization.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-cmdb-oauth-test","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\n\n'''IMPORTS'''\nimport urllib3\nimport traceback\nfrom typing import Any, Dict, Tuple, List\nfrom _collections import defaultdict\nimport ast\nfrom operator import itemgetter\n\n# Disable insecure warnings\nurllib3.disable_warnings()\n\n''' CONSTANTS '''\nAPI_VERSION = '/api/now/cmdb/instance/'\nCREAT_RECORD_DATA_FIELDS = ['attributes', 'inbound_relations', 'outbound_relations', 'source']\nUPDATE_RECORD_DATA_FIELDS = ['attributes', 'source']\nADD_RELATION_DATA_FIELDS = ['inbound_relations', 'outbound_relations', 'source']\nFIELD_TO_OUTPUT = {\n    'inbound_relations': 'Inbound Relations',\n    'outbound_relations': 'Outbound Relations'\n}\n\n\nclass Client:\n    \"\"\"Client class to interact with the service API\n\n    This Client implements API calls, and does not contain any Demisto logic.\n    Should only do requests and return data.\n    It inherits from BaseClient defined in CommonServer Python.\n    Most calls use _http_request() that handles proxy, SSL verification, etc.\n    \"\"\"\n    def __init__(self, credentials: dict, use_oauth: bool = False, client_id: str = '', client_secret: str = '',\n                 url: str = '', verify: bool = False, proxy: bool = False):\n        \"\"\"\n        Args:\n            - credentials: the username and password given by the user.\n            - client_id: the client id of the application of the user.\n            - client_secret - the client secret of the application of the user.\n            - url: the instance url of the user, i.e: https://\u003cinstance\u003e.service-now.com.\n                   NOTE - url should be given without an API specific suffix as it is also used for the OAuth process.\n            - insecure: Whether the request should verify the SSL certificate.\n            - proxy: Whether to run the integration using the system proxy.\n            - headers: The request headers, for example: {'Accept`: `application/json`}. Can be None.\n            - use_oauth: a flag indicating whether the user wants to use OAuth 2.0 or basic authorization.\n        \"\"\"\n        headers = {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json'\n        }\n        self.use_oauth = use_oauth\n        self.snow_client: ServiceNowClient = ServiceNowClient(credentials=credentials, use_oauth=use_oauth,\n                                                              client_id=client_id, client_secret=client_secret,\n                                                              url=url, verify=verify, proxy=proxy, headers=headers)\n\n    def records_list(self, class_name, params=None):\n        return self.snow_client.http_request(method='GET', url_suffix=f'{API_VERSION}{class_name}', params=params)\n\n    def get_record(self, class_name, sys_id, params=None):\n        url_suffix = f'{API_VERSION}{class_name}/{sys_id}'\n        return self.snow_client.http_request(method='GET', url_suffix=url_suffix, params=params)\n\n    def create_record(self, class_name, data, params=None):\n        return self.snow_client.http_request(method='POST', url_suffix=f'{API_VERSION}{class_name}', params=params, data=data)\n\n    def update_record(self, class_name, sys_id, data, params=None):\n        url_suffix = f'{API_VERSION}{class_name}/{sys_id}'\n        return self.snow_client.http_request(method='PATCH', url_suffix=url_suffix, params=params, data=data)\n\n    def add_relation(self, class_name, sys_id, data, params=None):\n        url_suffix = f'{API_VERSION}{class_name}/{sys_id}/relation'\n        return self.snow_client.http_request(method='POST', url_suffix=url_suffix, params=params, data=data)\n\n    def delete_relation(self, class_name, sys_id, rel_sys_id, params=None):\n        url_suffix = f'{API_VERSION}{class_name}/{sys_id}/relation/{rel_sys_id}'\n        return self.snow_client.http_request(method='DELETE', url_suffix=url_suffix, params=params)\n\n\n''' HELPER FUNCTIONS '''\n\n\ndef create_request_data(data_fields: List, args: dict) -\u003e dict:\n    \"\"\"\n    This function converts the input given by the user when creating a new record to a data dict that should be passed\n    in the http request.\n\n    Args:\n        data_fields: A list with the fields that should be added to the data.\n        args: The arguments that were filled by the user.\n\n    Returns:\n        A dictionary representing the data parameter that should be sent in the http request.\n    \"\"\"\n    data = {}\n    for field in data_fields:\n        if field == 'source':\n            data[field] = args.get(field)\n        elif field == 'attributes':  # 'attributes' input should be of the form key1=value1,key2=value2...\n            val = args.get(field)\n            if val:\n                try:\n                    attributes_dict = {}\n                    attributes_input = val.split(',')\n                    for attribute in attributes_input:\n                        pair = attribute.split('=')\n                        attributes_dict[pair[0]] = pair[1]\n                    data[field] = attributes_dict\n                except Exception:\n                    raise Exception('Illegal input. Input format should be \"key=value\". Multiple values can be filled, '\n                                    'separated by a comma.')\n        else:  # other fields should be converted to dict/list\n            val = args.get(field)\n            if val:\n                try:\n                    data[field] = ast.literal_eval(val)\n                except Exception:\n                    raise Exception('Illegal input. Please see the argument description for the correct input format.')\n    return data\n\n\ndef create_record_context(class_name: str, sys_id: str, result: dict) -\u003e dict:\n    \"\"\"\n    Create the context output for commands that operate on a single record.\n\n    Args:\n        class_name: The class name of the record used.\n        sys_id: The id of the record.\n        result: The raw response from the http request.\n\n    Return:\n        A dictionary representing the context output for the record.\n    \"\"\"\n    context = {\n        'ServiceNowCMDB.Record(val.ID===obj.ID)': {\n            'Class': class_name,\n            'SysID': sys_id,\n            'Attributes': result.get('attributes', {}),\n            'InboundRelations': result.get('inbound_relations', []),\n            'OutboundRelations': result.get('outbound_relations', []),\n        }\n    }\n    return context\n\n\ndef create_human_readable(title: str, result: dict, fields: str) -\u003e str:\n    \"\"\"\n    Create the human readable output for commands.\n\n    Args:\n        title: The title of the human readable output.\n        result: The raw response from the http request consisting of the attributes, inbound_relations and\n                outbound_relations fields.\n        fields: A string representing all the fields of the record the client specified that should be returned. If no\n        fields were specified, only the record name and sys_id will be displayed in the war room.\n\n    Return:\n        A string representing the markdown output that should be displayed in the war room.\n    \"\"\"\n    md = f'{title}\\n'\n    attributes_outputs = {}\n    if fields:\n        for field in fields.split(','):\n            if result.get('attributes', {}).get(field):\n                attributes_outputs[string_to_context_key(field)] = result.get('attributes', {}).get(field)\n    else:\n        attributes_outputs = {\n            'SysID': result.get('attributes', {}).get('sys_id'),\n            'Name': result.get('attributes', {}).get('name')\n        }\n\n    md += tableToMarkdown('Attributes', t=attributes_outputs, removeNull=True)\n\n    for relation_type in ['inbound_relations', 'outbound_relations']:\n        relations = result.get(relation_type)\n        if relations:\n            relation_output = {\n                'SysID': list(map(itemgetter('sys_id'), relations)),\n                'Target Display Value': list(\n                    map(itemgetter('display_value'), list(map(itemgetter('target'), result.get(relation_type))))),  # type: ignore\n                'Type Display Value': list(\n                    map(itemgetter('display_value'), list(map(itemgetter('type'), result.get(relation_type))))),  # type: ignore\n            }\n            md += f' {tableToMarkdown(FIELD_TO_OUTPUT.get(relation_type), t=relation_output)}'\n    return md\n\n\n''' COMMAND FUNCTIONS '''\n\n\ndef records_list_command(client: Client, args: dict) -\u003e Tuple[str, dict, Any]:\n    \"\"\"\n    Query a CMDB table using the class name to receive all records in the class.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    context: dict = defaultdict(list)\n    class_name = args.get('class')\n    params = {}\n    if args.get('query'):\n        params['sysparm_query'] = args.get('query')\n    if args.get('limit'):\n        params['sysparm_limit'] = args.get('limit')\n    if args.get('offset'):\n        params['sysparm_offset'] = args.get('offset')\n\n    outputs = {\n        'Class': class_name\n    }\n\n    response = client.records_list(class_name=class_name, params=params)\n    result = response.get('result', {})\n    if result:\n        outputs['Records'] = result\n        human_readable = tableToMarkdown(f'Found {len(result)} records for class {class_name}:', t=result)\n    else:\n        human_readable = f'Found no records for class {class_name}.'\n    context['ServiceNowCMDB(val.ID===obj.ID)'] = outputs\n\n    return human_readable, context, response\n\n\ndef get_record_command(client: Client, args: dict) -\u003e Tuple[str, dict, Any]:\n    \"\"\"\n    Query attributes and relationship information for a specific record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    context: dict = defaultdict(list)\n    class_name = args.get('class')\n    sys_id = args.get('sys_id')\n    params: dict = {}\n    if args.get('fields'):\n        params['sysparm_fields'] = args.get('fields')\n        # Verify that sys_id and name were added so they can be used in the output of the command:\n        if 'sys_id' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',sys_id'\n        if 'name' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',name'\n    if args.get('relation_limit'):\n        params['sysparm_relation_limit'] = args.get('relation_limit')\n    if args.get('relation_offset'):\n        params['sysparm_relation_offset'] = args.get('relation_offset')\n\n    response = client.get_record(class_name=class_name, sys_id=sys_id, params=params)\n    result = response.get('result')\n    if result:\n        context['ServiceNowCMDB.Record(val.ID===obj.ID)'] = {\n            'Class': class_name,\n            'SysID': sys_id,\n            'Attributes': result.get('attributes', {}),\n            'InboundRelations': result.get('inbound_relations', []),\n            'OutboundRelations': result.get('outbound_relations', []),\n        }\n        hr_title = f'### Found the following attributes and relations for record {sys_id}:'\n        human_readable = create_human_readable(hr_title, result, params.get('sysparm_fields', ''))\n    else:\n        context['ServiceNowCMDB.Record(val.ID===obj.ID)'] = {\n            'Class': class_name,\n            'SysID': sys_id\n        }\n        human_readable = f'Found no attributes and relations for record {sys_id}.'\n\n    return human_readable, context, response\n\n\ndef create_record_command(client: Client, args: dict) -\u003e Tuple[str, dict, Any]:\n    \"\"\"\n    Create a record with associated relations.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    context: dict = defaultdict(list)\n    class_name = args.get('class', '')\n    params: dict = {}\n    if args.get('fields'):\n        params['sysparm_fields'] = args.get('fields')\n        # Verify that sys_id and name were added so they can be used in the output of the command:\n        if 'sys_id' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',sys_id'\n        if 'name' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',name'\n    if args.get('relation_limit'):\n        params['sysparm_relation_limit'] = args.get('relation_limit')\n    if args.get('relation_offset'):\n        params['sysparm_relation_offset'] = args.get('relation_offset')\n\n    data = create_request_data(CREAT_RECORD_DATA_FIELDS, args)\n\n    response = client.create_record(class_name=class_name, params=params, data=str(data))\n    result = response.get('result')\n    if result:\n        sys_id = result.get('attributes', {}).get('sys_id')\n        context = create_record_context(class_name, sys_id, result)\n        hr_title = f'### Record {sys_id} was created successfully.'\n        human_readable = create_human_readable(hr_title, result, params.get('sysparm_fields', ''))\n    else:\n        human_readable = 'Failed to create a new record.'\n\n    return human_readable, context, response\n\n\ndef update_record_command(client: Client, args: dict) -\u003e Tuple[str, dict, Any]:\n    \"\"\"\n    Update a record with attributes given by the user.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    context: dict = defaultdict(list)\n    class_name = args.get('class', '')\n    sys_id = args.get('sys_id', '')\n    params: dict = {}\n    if args.get('fields'):\n        params['sysparm_fields'] = args.get('fields')\n        # Verify that sys_id and name were added so they can be used in the output of the command:\n        if 'sys_id' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',sys_id'\n        if 'name' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',name'\n    if args.get('relation_limit'):\n        params['sysparm_relation_limit'] = args.get('relation_limit')\n    if args.get('relation_offset'):\n        params['sysparm_relation_offset'] = args.get('relation_offset')\n\n    data = create_request_data(UPDATE_RECORD_DATA_FIELDS, args)\n\n    response = client.update_record(class_name=class_name, sys_id=sys_id, data=str(data), params=params)\n    result = response.get('result')\n    if result:\n        context = create_record_context(class_name, sys_id, result)\n        hr_title = f'### Updated record {sys_id} successfully.'\n        human_readable = create_human_readable(hr_title, result, params.get('sysparm_fields', ''))\n    else:\n        human_readable = f'Failed to update record {sys_id}.'\n\n    return human_readable, context, response\n\n\ndef add_relation_command(client: Client, args: dict) -\u003e Tuple[str, dict, Any]:\n    \"\"\"\n    Add new relations to an existing record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    context: dict = defaultdict(list)\n    class_name = args.get('class', '')\n    sys_id = args.get('sys_id', '')\n    params: dict = {}\n    if args.get('fields'):\n        params['sysparm_fields'] = args.get('fields')\n        # Verify that sys_id and name were added so they can be used in the output of the command:\n        if 'sys_id' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',sys_id'\n        if 'name' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',name'\n    if args.get('relation_limit'):\n        params['sysparm_relation_limit'] = args.get('relation_limit')\n    if args.get('relation_offset'):\n        params['sysparm_relation_offset'] = args.get('relation_offset')\n\n    data = create_request_data(ADD_RELATION_DATA_FIELDS, args)\n\n    response = client.add_relation(class_name=class_name, sys_id=sys_id, data=str(data), params=params)\n    result = response.get('result')\n    if result:\n        context = create_record_context(class_name, sys_id, result)\n        hr_title = f'### New relations were added to {sys_id} record successfully.'\n        human_readable = create_human_readable(hr_title, result, params.get('sysparm_fields', ''))\n    else:\n        human_readable = f'Failed to add new relations to record {sys_id}.'\n\n    return human_readable, context, response\n\n\ndef delete_relation_command(client: Client, args: dict) -\u003e Tuple[str, dict, Any]:\n    \"\"\"\n    Delete relations for an existing record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    context: dict = defaultdict(list)\n    class_name = args.get('class', '')\n    sys_id = args.get('sys_id', '')\n    rel_sys_id = args.get('relation_sys_id', '')\n    params: dict = {}\n    if args.get('fields'):\n        params['sysparm_fields'] = args.get('fields')\n        # Verify that sys_id and name were added so they can be used in the output of the command:\n        if 'sys_id' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',sys_id'\n        if 'name' not in params.get('sysparm_fields', ''):\n            params['sysparm_fields'] += ',name'\n    if args.get('relation_limit'):\n        params['sysparm_relation_limit'] = args.get('relation_limit')\n    if args.get('relation_offset'):\n        params['sysparm_relation_offset'] = args.get('relation_offset')\n\n    response = client.delete_relation(class_name=class_name, sys_id=sys_id, rel_sys_id=rel_sys_id, params=params)\n    result = response.get('result')\n    if result:\n        context = create_record_context(class_name, sys_id, result)\n        hr_title = f'### Deleted relation {rel_sys_id} successfully from {sys_id} record.'\n        human_readable = create_human_readable(hr_title, result, params.get('sysparm_fields', ''))\n    else:\n        human_readable = f'Failed to delete relation {rel_sys_id} from record {sys_id}.'\n\n    return human_readable, context, response\n\n\ndef test_module(client: Client) -\u003e str:\n    \"\"\"Tests API connectivity and authentication'\n\n    Returning 'ok' indicates that the integration works like it is supposed to.\n    Connection to the service is successful.\n    Raises exceptions if something goes wrong.\n\n    :type client: ``Client``\n    :param Client: ServiceNow CMDB client to use\n\n    :return: 'ok' if test passed, anything else will fail the test.\n    :rtype: ``str``\n    \"\"\"\n    # Notify the user that test button can't be used when using OAuth 2.0:\n    if client.use_oauth:\n        return_error('Test button cannot be used when using OAuth 2.0. Please use the !servicenow-cmdb-oauth-login '\n                     'command followed by the !servicenow-cmdb-oauth-test command to test the instance.')\n\n    try:\n        client.records_list(class_name='cmdb_ci_linux_server')\n    except Exception as e:\n        raise e\n    return 'ok'\n\n\ndef oauth_test_module(client: Client, *_) -\u003e Tuple[str, Dict[Any, Any], Dict[Any, Any]]:\n    \"\"\"\n    Test the instance configurations when using OAuth authorization.\n    \"\"\"\n    if not client.use_oauth:\n        return_error('!servicenow-cmdb-oauth-test command should be used only when using OAuth 2.0 authorization.\\n '\n                     'Please select the `Use OAuth Login` checkbox in the instance configuration before running this '\n                     'command.')\n    try:\n        client.records_list(class_name='cmdb_ci_linux_server')\n    except Exception as e:\n        raise e\n    hr = '### Instance Configured Successfully.\\n'\n    return hr, {}, {}\n\n\ndef login_command(client: Client, args: Dict[str, Any]) -\u003e Tuple[str, Dict[Any, Any], Dict[Any, Any]]:\n    \"\"\"\n    Login the user using OAuth authorization\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    # Verify that the user selected the `Use OAuth Login` checkbox:\n    if not client.use_oauth:\n        return_error('!servicenow-cmdb-oauth-login command can be used only when using OAuth 2.0 authorization.\\n '\n                     'Please select the `Use OAuth Login` checkbox in the instance configuration before running this '\n                     'command.')\n\n    username = args.get('username', '')\n    password = args.get('password', '')\n    try:\n        client.snow_client.login(username, password)\n        hr = '### Logged in successfully.\\n A refresh token was saved to the integration context and will be ' \\\n             'used to generate a new access token once the current one expires.'\n    except Exception as e:\n        return_error(f'Failed to login. Please verify that the provided username and password are correct, and that you'\n                     f' entered the correct client id and client secret in the instance configuration (see ? for'\n                     f'correct usage when using OAuth).\\n\\n{e}')\n    return hr, {}, {}\n\n\n''' MAIN FUNCTION '''\n\n\ndef main() -\u003e None:\n    \"\"\"main function, parses params and runs command functions\n    \"\"\"\n    params = demisto.params()\n\n    url = params.get('url', '')\n    verify = not params.get('insecure', False)\n    proxy = params.get('proxy', False)\n    client_id = client_secret = ''\n    credentials = params.get('credentials', {})\n    use_oauth = params.get('use_oauth', False)\n\n    if use_oauth:\n        client_id = credentials.get('identifier')\n        client_secret = credentials.get('password')\n\n    client = Client(credentials=credentials, use_oauth=use_oauth, client_id=client_id,\n                    client_secret=client_secret, url=url, verify=verify, proxy=proxy)\n\n    commands = {\n        'servicenow-cmdb-oauth-login': login_command,\n        'servicenow-cmdb-oauth-test': oauth_test_module,\n        'servicenow-cmdb-records-list': records_list_command,\n        'servicenow-cmdb-record-get-by-id': get_record_command,\n        'servicenow-cmdb-record-create': create_record_command,\n        'servicenow-cmdb-record-update': update_record_command,\n        'servicenow-cmdb-record-add-relations': add_relation_command,\n        'servicenow-cmdb-record-delete-relations': delete_relation_command\n    }\n\n    command = demisto.command()\n\n    demisto.debug(f'Command being called is {command}')\n    try:\n        if demisto.command() == 'test-module':\n            # This is the call made when pressing the integration Test button.\n            result = test_module(client)\n            return_results(result)\n        elif command in commands:\n            return_outputs(*commands[command](client, demisto.args()))  # type: ignore\n        else:\n            return_error('Command not found.')\n\n    # Log exceptions and return errors\n    except Exception as e:\n        demisto.error(traceback.format_exc())  # print the traceback\n        return_error(f'Failed to execute {command} command.\\nError:\\n{str(e)}')\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\nOAUTH_URL = '/oauth_token.do'\n\n\nclass ServiceNowClient(BaseClient):\n\n    def __init__(self, credentials: dict, use_oauth: bool = False, client_id: str = '', client_secret: str = '',\n                 url: str = '', verify: bool = False, proxy: bool = False, headers: dict = None):\n        \"\"\"\n        ServiceNow Client class. The class can use either basic authorization with username and password, or OAuth2.\n        Args:\n            - credentials: the username and password given by the user.\n            - client_id: the client id of the application of the user.\n            - client_secret - the client secret of the application of the user.\n            - url: the instance url of the user, i.e: https://\u003cinstance\u003e.service-now.com.\n                   NOTE - url should be given without an API specific suffix as it is also used for the OAuth process.\n            - verify: Whether the request should verify the SSL certificate.\n            - proxy: Whether to run the integration using the system proxy.\n            - headers: The request headers, for example: {'Accept`: `application/json`}. Can be None.\n            - use_oauth: a flag indicating whether the user wants to use OAuth 2.0 or basic authorization.\n        \"\"\"\n        self.auth = None\n        self.use_oauth = use_oauth\n        if self.use_oauth:  # if user selected the `Use OAuth` box use OAuth authorization, else use basic authorization\n            self.client_id = client_id\n            self.client_secret = client_secret\n        else:\n            self.username = credentials.get('identifier')\n            self.password = credentials.get('password')\n            self.auth = (self.username, self.password)\n\n        self.base_url = url\n        super().__init__(base_url=self.base_url, verify=verify, proxy=proxy, headers=headers, auth=self.auth)  # type\n        # : ignore[misc]\n\n    def http_request(self, method, url_suffix, full_url=None, headers=None, json_data=None, params=None, data=None,\n                     files=None, return_empty_response=False, auth=None):\n        ok_codes = (200, 201, 401)  # includes responses that are ok (200) and error responses that should be\n        # handled by the client and not in the BaseClient\n        try:\n            if self.use_oauth:  # add a valid access token to the headers when using OAuth\n                access_token = self.get_access_token()\n                self._headers.update({\n                    'Authorization': 'Bearer ' + access_token\n                })\n            res = super()._http_request(method=method, url_suffix=url_suffix, full_url=full_url, resp_type='response',\n                                        headers=headers, json_data=json_data, params=params, data=data, files=files,\n                                        ok_codes=ok_codes, return_empty_response=return_empty_response, auth=auth)\n            if res.status_code in [200, 201]:\n                try:\n                    return res.json()\n                except ValueError as exception:\n                    raise DemistoException('Failed to parse json object from response: {}'\n                                           .format(res.content), exception)\n\n            if res.status_code in [401]:\n                if self.use_oauth:\n                    if demisto.getIntegrationContext().get('expiry_time', 0) \u003c= date_to_timestamp(datetime.now()):\n                        access_token = self.get_access_token()\n                        self._headers.update({\n                            'Authorization': 'Bearer ' + access_token\n                        })\n                        return self.http_request(method, url_suffix, full_url=full_url, params=params)\n                    try:\n                        err_msg = f'Unauthorized request: \\n{str(res.json())}'\n                    except ValueError:\n                        err_msg = f'Unauthorized request: \\n{str(res)}'\n                    raise DemistoException(err_msg)\n                else:\n                    raise Exception(f'Authorization failed. Please verify that the username and password are correct.'\n                                    f'\\n{res}')\n\n        except Exception as e:\n            if self._verify and 'SSL Certificate Verification Failed' in e.args[0]:\n                return_error('SSL Certificate Verification Failed - try selecting \\'Trust any certificate\\' '\n                             'checkbox in the integration configuration.')\n            raise DemistoException(e.args[0])\n\n    def login(self, username: str, password: str):\n        \"\"\"\n        Generate a refresh token using the given client credentials and save it in the integration context.\n        \"\"\"\n        data = {\n            'client_id': self.client_id,\n            'client_secret': self.client_secret,\n            'username': username,\n            'password': password,\n            'grant_type': 'password'\n        }\n        try:\n            headers = {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n            res = super()._http_request(method='POST', url_suffix=OAUTH_URL, resp_type='response', headers=headers,\n                                        data=data)\n            try:\n                res = res.json()\n            except ValueError as exception:\n                raise DemistoException('Failed to parse json object from response: {}'.format(res.content), exception)\n            if 'error' in res:\n                return_error(\n                    f'Error occurred while creating an access token. Please check the Client ID, Client Secret '\n                    f'and that the given username and password are correct.\\n{res}')\n            if res.get('refresh_token'):\n                refresh_token = {\n                    'refresh_token': res.get('refresh_token')\n                }\n                set_integration_context(refresh_token)\n        except Exception as e:\n            return_error(f'Login failed. Please check the instance configuration and the given username and password.\\n'\n                         f'{e.args[0]}')\n\n    def get_access_token(self):\n        \"\"\"\n        Get an access token that was previously created if it is still valid, else, generate a new access token from\n        the client id, client secret and refresh token.\n        \"\"\"\n        ok_codes = (200, 201, 401)\n        previous_token = get_integration_context()\n\n        # Check if there is an existing valid access token\n        if previous_token.get('access_token') and previous_token.get('expiry_time') \u003e date_to_timestamp(datetime.now()):\n            return previous_token.get('access_token')\n        else:\n            data = {'client_id': self.client_id,\n                    'client_secret': self.client_secret}\n\n            # Check if a refresh token exists. If not, raise an exception indicating to call the login function first.\n            if previous_token.get('refresh_token'):\n                data['refresh_token'] = previous_token.get('refresh_token')\n                data['grant_type'] = 'refresh_token'\n            else:\n                raise Exception('Could not create an access token. User might be not logged in. Try running the'\n                                ' oauth-login command first.')\n\n            try:\n                headers = {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n                res = super()._http_request(method='POST', url_suffix=OAUTH_URL, resp_type='response', headers=headers,\n                                            data=data, ok_codes=ok_codes)\n                try:\n                    res = res.json()\n                except ValueError as exception:\n                    raise DemistoException('Failed to parse json object from response: {}'.format(res.content),\n                                           exception)\n                if 'error' in res:\n                    return_error(\n                        f'Error occurred while creating an access token. Please check the Client ID, Client Secret '\n                        f'and try to run again the login command to generate a new refresh token as it '\n                        f'might have expired.\\n{res}')\n                if res.get('access_token'):\n                    expiry_time = date_to_timestamp(datetime.now(), date_format='%Y-%m-%dT%H:%M:%S')\n                    expiry_time += res.get('expires_in', 0) * 1000 - 10\n                    new_token = {\n                        'access_token': res.get('access_token'),\n                        'refresh_token': res.get('refresh_token'),\n                        'expiry_time': expiry_time\n                    }\n                    set_integration_context(new_token)\n                    return res.get('access_token')\n            except Exception as e:\n                return_error(f'Error occurred while creating an access token. Please check the instance configuration.'\n                             f'\\n\\n{e.args[0]}')\n\n\n\n\n''' ENTRY POINT '''\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.2.2","modified":"2021-08-24T19:36:38.156022+03:00","name":"ServiceNow CMDB","packID":"ServiceNow","packPropagationLabels":["all"],"prevName":"ServiceNow CMDB","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Identity and Access Management","commitMessage":"","configuration":[{"defaultValue":"","display":"ServiceNow URL (https://\u003cdomain\u003e.service-now.com)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"ServiceNow API Version (e.g. 'v1'). Specify this value to use an endpoint version other than the latest.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"api_version","options":null,"required":false,"type":0},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow creating users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"create_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow updating users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"update_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow enabling users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"enable_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow disabling users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"disable_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Automatically create user if not found in update command","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"create_if_not_exists","options":null,"required":false,"type":8},{"defaultValue":"User Profile - ServiceNow (Incoming)","display":"Incoming Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mapper_in","options":null,"required":true,"type":0},{"defaultValue":"User Profile - ServiceNow (Outgoing)","display":"Outgoing Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mapper_out","options":null,"required":true,"type":0}],"definitionId":"","description":"Integrate with ServiceNow's services to execute CRUD operations for employee lifecycle processes.","detailedDescription":"## Prerequisites\nTo use ServiceNow in XSOAR, ensure your user account has the `rest_api_explorer`, `web_service_admin` roles or any other role required to permit working with the `sys_user` table. These roles are required in order to make API calls. However, they may not suffice for viewing records in some tables.\n\n## Enable/Disable CRUD Commands\nYou can select which CRUD commands are enabled in the integration instance configuration settings. By default, all commands are enabled.\n\n## Add Custom Indicator Fields\nFollow these steps to add custom fields to the User Profile indicator.\n\n1. In XSOAR, create the custom indicator and incident field, for example, **Middle Name**.\n2. Duplicate the **User Profile - ServiceNow (Incoming)** mapper and/or the **User Profile - ServiceNow (Outging)** mapper.\n3. Add and map the custom field to the necessary mapper(s).\n4. Go to the ServiceNow IAM integration instance and in the mapper textbox, replace the name of the default mapper with the custom mapper you created.\n\n## Automatically create user if not found in update command\nThe *create-if-not-exists* parameter specifies if a new user should be created when the User Profile passed was not found in the 3rd-party integration.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/service-now-iam)","display":"ServiceNow IAM","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"ServiceNow IAM","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"User Profile indicator details.","name":"user-profile","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"When set to true, after the command execution the status of the user in the 3rd-party integration will be active.","name":"allow-enable","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a user in ServiceNow.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-create-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"When set to true, after the command execution the status of the user in the 3rd-party integration will be active.","name":"allow-enable","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates an existing user with the data passed in the user-profile argument.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-update-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves a single user resource.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-get-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Disable an active user.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-disable-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Retrieves a User Profile schema, which holds all of the user fields within the application. Used for outgoing-mapping through the Get Schema option.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-mapping-fields","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":true,"isRemoteSyncIn":false,"isRemoteSyncOut":true,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n# noqa: F401\n# noqa: F401\n# noqa: F401\n# noqa: F401\n\n\nimport traceback\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n'''CLIENT CLASS'''\n\n\nclass Client(BaseClient):\n    \"\"\"\n    ServiceNow IAM Client class that implements logic to authenticate with ServiceNow.\n    \"\"\"\n\n    def test(self):\n        uri = '/table/sys_user?sysparm_limit=1'\n        self._http_request(method='GET', url_suffix=uri)\n\n    def get_user(self, email):\n        uri = 'table/sys_user'\n        query_params = {\n            'email': email\n        }\n\n        res = self._http_request(\n            method='GET',\n            url_suffix=uri,\n            params=query_params\n        )\n\n        if res and len(res.get('result', [])) == 1:\n            return res.get('result')[0]\n        return None\n\n    def create_user(self, user_data):\n        uri = 'table/sys_user'\n        res = self._http_request(\n            method='POST',\n            url_suffix=uri,\n            json_data=user_data\n        )\n        return res.get('result')\n\n    def update_user(self, user_id, user_data):\n        uri = f'/table/sys_user/{user_id}'\n        res = self._http_request(\n            method='PATCH',\n            url_suffix=uri,\n            json_data=user_data\n        )\n        return res.get('result')\n\n    def get_service_now_fields(self):\n        service_now_fields = {}\n        uri = 'table/sys_dictionary?sysparm_query=name=sys_user'\n        res = self._http_request(\n            method='GET',\n            url_suffix=uri\n        )\n\n        elements = res.get('result', [])\n        for elem in elements:\n            if elem.get('element'):\n                field_name = elem.get('element')\n                description = elem.get('sys_name')\n                service_now_fields[field_name] = description\n\n        return service_now_fields\n\n\n'''HELPER FUNCTIONS'''\n\n\ndef handle_exception(user_profile, e, action):\n    \"\"\" Handles failed responses from ServiceNow API by setting the User Profile object with the results.\n\n    Args:\n        user_profile (IAMUserProfile): The User Profile object.\n        e (Exception): The exception error. If DemistoException, holds the response json.\n        action (IAMActions): An enum represents the current action (get, update, create, etc).\n    \"\"\"\n    if e.__class__ is DemistoException and hasattr(e, 'res') and e.res is not None:\n        error_code = e.res.status_code\n        try:\n            resp = e.res.json()\n            error_message = get_error_details(resp)\n        except ValueError:\n            error_message = str(e)\n    else:\n        error_code = ''\n        error_message = str(e)\n\n    user_profile.set_result(action=action,\n                            success=False,\n                            error_code=error_code,\n                            error_message=error_message)\n\n    demisto.error(traceback.format_exc())\n\n\ndef get_error_details(res):\n    \"\"\" Parses the error details retrieved from ServiceNow and outputs the resulted string.\n\n    Args:\n        res (dict): The data retrieved from ServiceNow.\n\n    Returns:\n        (str) The parsed error details.\n    \"\"\"\n    message = res.get('error', {}).get('message')\n    details = res.get('error', {}).get('detail')\n    return f'{message}: {details}'\n\n\n'''COMMAND FUNCTIONS'''\n\n\ndef test_module(client):\n    client.test()\n    return_results('ok')\n\n\ndef get_mapping_fields_command(client):\n    service_now_fields = client.get_service_now_fields()\n    incident_type_scheme = SchemeTypeMapping(type_name=IAMUserProfile.DEFAULT_INCIDENT_TYPE)\n\n    for field, description in service_now_fields.items():\n        incident_type_scheme.add_field(field, description)\n\n    return GetMappingFieldsResponse([incident_type_scheme])\n\n\ndef get_user_command(client, args, mapper_in):\n    user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n    try:\n        service_now_user = client.get_user(user_profile.get_attribute('email'))\n        if not service_now_user:\n            error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n            user_profile.set_result(action=IAMActions.GET_USER,\n                                    success=False,\n                                    error_code=error_code,\n                                    error_message=error_message)\n        else:\n            user_profile.update_with_app_data(service_now_user, mapper_in)\n            user_profile.set_result(\n                action=IAMActions.GET_USER,\n                success=True,\n                active=True if service_now_user.get('active') == 'true' else False,\n                iden=service_now_user.get('sys_id'),\n                email=service_now_user.get('email'),\n                username=service_now_user.get('user_name'),\n                details=service_now_user\n            )\n\n    except Exception as e:\n        handle_exception(user_profile, e, IAMActions.GET_USER)\n\n    return user_profile\n\n\ndef disable_user_command(client, args, is_command_enabled):\n    user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n    if not is_command_enabled:\n        user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                skip=True,\n                                skip_reason='Command is disabled.')\n    else:\n        try:\n            service_now_user = client.get_user(user_profile.get_attribute('email'))\n            if not service_now_user:\n                _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                        skip=True,\n                                        skip_reason=error_message)\n            else:\n                user_id = service_now_user.get('sys_id')\n                user_data = {'active': False}\n                updated_user = client.update_user(user_id, user_data)\n                user_profile.set_result(\n                    action=IAMActions.DISABLE_USER,\n                    success=True,\n                    active=False,\n                    iden=updated_user.get('sys_id'),\n                    email=updated_user.get('email'),\n                    username=updated_user.get('user_name'),\n                    details=updated_user\n                )\n\n        except Exception as e:\n            handle_exception(user_profile, e, IAMActions.DISABLE_USER)\n\n    return user_profile\n\n\ndef create_user_command(client, args, mapper_out, is_command_enabled, is_update_enabled, is_enable_enabled):\n    user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n\n    if not is_command_enabled:\n        user_profile.set_result(action=IAMActions.CREATE_USER,\n                                skip=True,\n                                skip_reason='Command is disabled.')\n    else:\n        try:\n            service_now_user = client.get_user(user_profile.get_attribute('email'))\n            if service_now_user:\n                # if user exists, update it\n                user_profile = update_user_command(client, args, mapper_out, is_update_enabled,\n                                                   is_enable_enabled, False, False)\n\n            else:\n                service_now_profile = user_profile.map_object(mapper_out,\n                                                              incident_type=IAMUserProfile.CREATE_INCIDENT_TYPE)\n                created_user = client.create_user(service_now_profile)\n                user_profile.set_result(\n                    action=IAMActions.CREATE_USER,\n                    success=True,\n                    active=True if created_user.get('active') == 'true' else False,\n                    iden=created_user.get('sys_id'),\n                    email=created_user.get('email'),\n                    username=created_user.get('user_name'),\n                    details=created_user\n                )\n\n        except Exception as e:\n            handle_exception(user_profile, e, IAMActions.CREATE_USER)\n\n    return user_profile\n\n\ndef update_user_command(client, args, mapper_out, is_command_enabled, is_enable_enabled,\n                        is_create_user_enabled, create_if_not_exists):\n    user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n    allow_enable = args.get('allow-enable') == 'true'\n    if not is_command_enabled:\n        user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                skip=True,\n                                skip_reason='Command is disabled.')\n    else:\n        try:\n            service_now_user = client.get_user(user_profile.get_attribute('email'))\n            if service_now_user:\n                user_id = service_now_user.get('sys_id')\n                service_now_profile = user_profile.map_object(mapper_out,\n                                                              incident_type=IAMUserProfile.UPDATE_INCIDENT_TYPE)\n\n                if allow_enable and is_enable_enabled:\n                    service_now_profile['active'] = True\n                    service_now_profile['locked_out'] = False\n\n                updated_user = client.update_user(user_id, service_now_profile)\n                user_profile.set_result(\n                    action=IAMActions.UPDATE_USER,\n                    success=True,\n                    active=True if updated_user.get('active') == 'true' else False,\n                    iden=updated_user.get('sys_id'),\n                    email=updated_user.get('email'),\n                    username=updated_user.get('user_name'),\n                    details=updated_user\n                )\n            else:\n                if create_if_not_exists:\n                    user_profile = create_user_command(client, args, mapper_out, is_create_user_enabled,\n                                                       False, False)\n                else:\n                    _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                    user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                            skip=True,\n                                            skip_reason=error_message)\n\n        except Exception as e:\n            handle_exception(user_profile, e, IAMActions.UPDATE_USER)\n\n    return user_profile\n\n\ndef main():\n    user_profile = None\n    params = demisto.params()\n    api_version = params.get('api_version', '')\n    base_url = urljoin(params['url'].strip('/'), '/api/now/')\n    if api_version:\n        base_url += api_version\n    username = params.get('credentials', {}).get('identifier')\n    password = params.get('credentials', {}).get('password')\n    mapper_in = params.get('mapper_in')\n    mapper_out = params.get('mapper_out')\n    verify_certificate = not params.get('insecure', False)\n    proxy = params.get('proxy', False)\n    command = demisto.command()\n    args = demisto.args()\n\n    is_create_enabled = params.get(\"create_user_enabled\")\n    is_disable_enabled = params.get(\"disable_user_enabled\")\n    is_enable_enabled = params.get(\"enable_user_enabled\")\n    is_update_enabled = demisto.params().get(\"update_user_enabled\")\n    create_if_not_exists = demisto.params().get(\"create_if_not_exists\")\n\n    headers = {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n    }\n\n    client = Client(\n        base_url=base_url,\n        verify=verify_certificate,\n        proxy=proxy,\n        headers=headers,\n        ok_codes=(200, 201),\n        auth=(username, password)\n    )\n\n    demisto.debug(f'Command being called is {command}')\n\n    if command == 'iam-get-user':\n        user_profile = get_user_command(client, args, mapper_in)\n\n    elif command == 'iam-create-user':\n        user_profile = create_user_command(client, args, mapper_out, is_create_enabled, is_update_enabled,\n                                           is_enable_enabled)\n\n    elif command == 'iam-update-user':\n        user_profile = update_user_command(client, args, mapper_out, is_update_enabled, is_enable_enabled,\n                                           is_create_enabled, create_if_not_exists)\n\n    elif command == 'iam-disable-user':\n        user_profile = disable_user_command(client, args, is_disable_enabled)\n\n    if user_profile:\n        return_results(user_profile)\n\n    try:\n        if command == 'test-module':\n            test_module(client)\n\n        elif command == 'get-mapping-fields':\n            return_results(get_mapping_fields_command(client))\n\n    except Exception:\n        # For any other integration command exception, return an error\n        return_error(f'Failed to execute {command} command. Traceback: {traceback.format_exc()}')\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\n\nclass IAMErrors(object):\n    \"\"\"\n    An enum class to manually handle errors in IAM integrations\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    BAD_REQUEST = 400, 'Bad request - failed to perform operation'\n    USER_DOES_NOT_EXIST = 404, 'User does not exist'\n    USER_ALREADY_EXISTS = 409, 'User already exists'\n\n\nclass IAMActions(object):\n    \"\"\"\n    Enum: contains all the IAM actions (e.g. get, update, create, etc.)\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    GET_USER = 'get'\n    UPDATE_USER = 'update'\n    CREATE_USER = 'create'\n    DISABLE_USER = 'disable'\n    ENABLE_USER = 'enable'\n\n\nclass IAMVendorActionResult:\n    \"\"\" This class is used in IAMUserProfile class to represent actions data.\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    def __init__(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                 error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        self._brand = demisto.callingContext.get('context', {}).get('IntegrationBrand')\n        self._instance_name = demisto.callingContext.get('context', {}).get('IntegrationInstance')\n        self._success = success\n        self._active = active\n        self._iden = iden\n        self._username = username\n        self._email = email\n        self._error_code = error_code\n        self._error_message = error_message\n        self._details = details\n        self._skip = skip\n        self._skip_reason = skip_reason\n        self._action = action\n        self._return_error = return_error\n\n    def should_return_error(self):\n        return self._return_error\n\n    def create_outputs(self):\n        \"\"\" Sets the outputs in `_outputs` attribute.\n        \"\"\"\n        outputs = {\n            'brand': self._brand,\n            'instanceName': self._instance_name,\n            'action': self._action,\n            'success': self._success,\n            'active': self._active,\n            'id': self._iden,\n            'username': self._username,\n            'email': self._email,\n            'errorCode': self._error_code,\n            'errorMessage': self._error_message,\n            'details': self._details,\n            'skipped': self._skip,\n            'reason': self._skip_reason\n        }\n        return outputs\n\n    def create_readable_outputs(self, outputs):\n        \"\"\" Sets the human readable output in `_readable_output` attribute.\n\n        :param outputs: (dict) the command outputs.\n        \"\"\"\n        title = self._action.title() + ' User Results ({})'.format(self._brand)\n\n        if not self._skip:\n            headers = [\"brand\", \"instanceName\", \"success\", \"active\", \"id\", \"username\",\n                       \"email\", \"errorCode\", \"errorMessage\", \"details\"]\n        else:\n            headers = [\"brand\", \"instanceName\", \"skipped\", \"reason\"]\n\n        readable_output = tableToMarkdown(\n            name=title,\n            t=outputs,\n            headers=headers,\n            removeNull=True\n        )\n\n        return readable_output\n\n\nclass IAMUserProfile:\n    \"\"\" A User Profile object class for IAM integrations.\n\n    :type _user_profile: ``str``\n    :param _user_profile: The user profile information.\n\n    :type _user_profile_delta: ``str``\n    :param _user_profile_delta: The user profile delta.\n\n    :type _vendor_action_results: ``list``\n    :param _vendor_action_results: A List of data returned from the vendor.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    DEFAULT_INCIDENT_TYPE = 'User Profile'\n    CREATE_INCIDENT_TYPE = 'User Profile - Create'\n    UPDATE_INCIDENT_TYPE = 'User Profile - Update'\n\n    def __init__(self, user_profile, user_profile_delta=None):\n        self._user_profile = safe_load_json(user_profile)\n        self._user_profile_delta = safe_load_json(user_profile_delta) if user_profile_delta else {}\n        self._vendor_action_results = []\n\n    def get_attribute(self, item, use_old_user_data=False):\n        if use_old_user_data and self._user_profile.get('olduserdata', {}).get(item):\n            return self._user_profile.get('olduserdata', {}).get(item)\n        return self._user_profile.get(item)\n\n    def to_entry(self):\n        \"\"\" Generates a XSOAR IAM entry from the data in _vendor_action_results.\n        Note: Currently we are using only the first element of the list, in the future we will support multiple results.\n\n        :return: A XSOAR entry.\n        :rtype: ``dict``\n        \"\"\"\n\n        outputs = self._vendor_action_results[0].create_outputs()\n        readable_output = self._vendor_action_results[0].create_readable_outputs(outputs)\n\n        entry_context = {\n            'IAM.UserProfile(val.email \u0026\u0026 val.email == obj.email)': self._user_profile,\n            'IAM.Vendor(val.instanceName \u0026\u0026 val.instanceName == obj.instanceName \u0026\u0026 '\n            'val.email \u0026\u0026 val.email == obj.email)': outputs\n        }\n\n        return_entry = {\n            'ContentsFormat': EntryFormat.JSON,\n            'Contents': outputs,\n            'EntryContext': entry_context\n        }\n\n        if self._vendor_action_results[0].should_return_error():\n            return_entry['Type'] = EntryType.ERROR\n        else:\n            return_entry['Type'] = EntryType.NOTE\n            return_entry['HumanReadable'] = readable_output\n\n        return return_entry\n\n    def return_outputs(self):\n        return_results(self.to_entry())\n\n    def set_result(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                   error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        if not email:\n            email = self.get_attribute('email')\n\n        vendor_action_result = IAMVendorActionResult(\n            success=success,\n            active=active,\n            iden=iden,\n            username=username,\n            email=email,\n            error_code=error_code,\n            error_message=error_message if error_message else '',\n            details=details,\n            skip=skip,\n            skip_reason=skip_reason if skip_reason else '',\n            action=action,\n            return_error=return_error\n        )\n\n        self._vendor_action_results.append(vendor_action_result)\n\n    def map_object(self, mapper_name, incident_type):\n        \"\"\" Returns the user data, in an application data format.\n\n        :type mapper_name: ``str``\n        :param mapper_name: The outgoing mapper from XSOAR to the application.\n\n        :type incident_type: ``str``\n        :param incident_type: The incident type used.\n\n        :return: the user data, in the app data format.\n        :rtype: ``dict``\n        \"\"\"\n        if incident_type not in [IAMUserProfile.CREATE_INCIDENT_TYPE, IAMUserProfile.UPDATE_INCIDENT_TYPE]:\n            raise DemistoException('You must provide a valid incident type to the map_object function.')\n        if not self._user_profile:\n            raise DemistoException('You must provide the user profile data.')\n        app_data = demisto.mapObject(self._user_profile, mapper_name, incident_type)\n        return app_data\n\n    def update_with_app_data(self, app_data, mapper_name, incident_type=None):\n        \"\"\" updates the user_profile attribute according to the given app_data\n\n        :type app_data: ``dict``\n        :param app_data: The user data in app\n\n        :type mapper_name: ``str``\n        :param mapper_name: Incoming mapper name\n\n        :type incident_type: ``str``\n        :param incident_type: Optional - incident type\n        \"\"\"\n        if not incident_type:\n            incident_type = IAMUserProfile.DEFAULT_INCIDENT_TYPE\n        if not isinstance(app_data, dict):\n            app_data = safe_load_json(app_data)\n        self._user_profile = demisto.mapObject(app_data, mapper_name, incident_type)\n\n\nclass IAMUserAppData:\n    \"\"\" Holds user attributes retrieved from an application.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, user_id, username, is_active, app_data):\n        self.id = user_id\n        self.username = username\n        self.is_active = is_active\n        self.full_data = app_data\n\n\nclass IAMCommand:\n    \"\"\" A class that implements the IAM CRUD commands - should be used.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, is_create_enabled=True, is_enable_enabled=True, is_disable_enabled=True, is_update_enabled=True,\n                 create_if_not_exists=True, mapper_in=None, mapper_out=None, attr='email'):\n        \"\"\" The IAMCommand c'tor\n\n        :param is_create_enabled: (bool) Whether or not to allow creating users in the application.\n        :param is_enable_enabled: (bool) Whether or not to allow enabling users in the application.\n        :param is_disable_enabled: (bool) Whether or not to allow disabling users in the application.\n        :param is_update_enabled: (bool) Whether or not to allow updating users in the application.\n        :param create_if_not_exists: (bool) Whether or not to create a user if does not exist in the application.\n        :param mapper_in: (str) Incoming mapper from the application to Cortex XSOAR\n        :param mapper_out: (str) Outgoing mapper from the Cortex XSOAR to the application\n        \"\"\"\n        self.is_create_enabled = is_create_enabled\n        self.is_enable_enabled = is_enable_enabled\n        self.is_disable_enabled = is_disable_enabled\n        self.is_update_enabled = is_update_enabled\n        self.create_if_not_exists = create_if_not_exists\n        self.mapper_in = mapper_in\n        self.mapper_out = mapper_out\n        self.attr = attr\n\n    def get_user(self, client, args):\n        \"\"\" Searches a user in the application and updates the user profile object with the data.\n            If not found, the error details will be resulted instead.\n        :param client: (Client) The integration Client object that implements a get_user() method\n        :param args: (dict) The `iam-get-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        try:\n            identifier = user_profile.get_attribute(self.attr)\n            user_app_data = client.get_user(identifier)\n            if not user_app_data:\n                error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                user_profile.set_result(action=IAMActions.GET_USER,\n                                        success=False,\n                                        error_code=error_code,\n                                        error_message=error_message)\n            else:\n                user_profile.update_with_app_data(user_app_data.full_data, self.mapper_in)\n                user_profile.set_result(\n                    action=IAMActions.GET_USER,\n                    active=user_app_data.is_active,\n                    iden=user_app_data.id,\n                    email=user_profile.get_attribute('email'),\n                    username=user_app_data.username,\n                    details=user_app_data.full_data\n                )\n\n        except Exception as e:\n            client.handle_exception(user_profile, e, IAMActions.GET_USER)\n\n        return user_profile\n\n    def disable_user(self, client, args):\n        \"\"\" Disables a user in the application and updates the user profile object with the updated data.\n            If not found, the command will be skipped.\n\n        :param client: (Client) The integration Client object that implements get_user() and disable_user() methods\n        :param args: (dict) The `iam-disable-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        if not self.is_disable_enabled:\n            user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if not user_app_data:\n                    _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                    user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                            skip=True,\n                                            skip_reason=error_message)\n                else:\n                    if user_app_data.is_active:\n                        user_app_data = client.disable_user(user_app_data.id)\n                    user_profile.set_result(\n                        action=IAMActions.DISABLE_USER,\n                        active=False,\n                        iden=user_app_data.id,\n                        email=user_profile.get_attribute('email'),\n                        username=user_app_data.username,\n                        details=user_app_data.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.DISABLE_USER)\n\n        return user_profile\n\n    def create_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If a user in the app already holds the email in the given user profile, updates\n            its data with the given data.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-create-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n\n        if not self.is_create_enabled:\n            user_profile.set_result(action=IAMActions.CREATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    # if user exists, update it\n                    user_profile = self.update_user(client, args)\n\n                else:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.CREATE_INCIDENT_TYPE)\n                    created_user = client.create_user(app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.CREATE_USER,\n                        active=created_user.is_active,\n                        iden=created_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=created_user.username,\n                        details=created_user.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.CREATE_USER)\n\n        return user_profile\n\n    def update_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If the user is disabled and `allow-enable` argument is `true`, also enables the user.\n            If the user does not exist in the app and the `create-if-not-exist` parameter is checked, creates the user.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-update-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        allow_enable = args.get('allow-enable') == 'true'\n        if not self.is_update_enabled:\n            user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr, use_old_user_data=True)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.UPDATE_INCIDENT_TYPE)\n\n                    if allow_enable and self.is_enable_enabled and not user_app_data.is_active:\n                        client.enable_user(user_app_data.id)\n\n                    updated_user = client.update_user(user_app_data.id, app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.UPDATE_USER,\n                        active=updated_user.is_active,\n                        iden=updated_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=updated_user.username,\n                        details=updated_user.full_data\n                    )\n                else:\n                    if self.create_if_not_exists:\n                        user_profile = self.create_user(client, args)\n                    else:\n                        _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                        user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                                skip=True,\n                                                skip_reason=error_message)\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.UPDATE_USER)\n\n        return user_profile\n\n\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.2.2","modified":"2021-08-24T19:36:38.156107+03:00","name":"ServiceNow IAM","packID":"ServiceNow","packPropagationLabels":["all"],"prevName":"ServiceNow IAM","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Case Management","commitMessage":"","configuration":[{"defaultValue":"","display":"ServiceNow URL, in the format https://company.service-now.com/","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username/Client ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Use OAuth Login","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Select this checkbox if to use OAuth 2.0 authentication. See (?) for more information.","name":"use_oauth","options":null,"required":false,"type":8},{"defaultValue":"incident","display":"Default ticket type for running ticket commands and fetching incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The ticket type can be: incident, problem, change_request, sc_request, sc_task or sc_req_item.","name":"ticket_type","options":null,"required":false,"type":0},{"defaultValue":"","display":"ServiceNow API Version (e.g. 'v1')","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"api_version","options":null,"required":false,"type":0},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"stateNOT IN6,7","display":"The query to use when fetching incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"sysparm_query","options":null,"required":false,"type":0},{"defaultValue":"10","display":"How many incidents to fetch each time","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_limit","options":null,"required":false,"type":0},{"defaultValue":"10 minutes","display":"First fetch timestamp (\u003cnumber\u003e \u003ctime unit\u003e, e.g., 12 hours, 7 days, 3 months, 1 year)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_time","options":null,"required":false,"type":0},{"defaultValue":"opened_at","display":"Timestamp field to filter by (e.g., `opened_at`) This is how the filter is applied to the query: \"ORDERBYopened_at^opened_at\u003e[Last Run]\".\nTo prevent duplicate incidents, this field is mandatory for fetching incidents.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"timestamp_field","options":null,"required":false,"type":0},{"defaultValue":"number","display":"ServiceNow ticket column to be set as the incident name. Default is the incident number","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incident_name","options":null,"required":false,"type":0},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"Get incident attachments","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"get_attachments","options":null,"required":false,"type":8},{"defaultValue":"None","display":"Incident Mirroring Direction","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Choose the direction to mirror the incident: Incoming (from ServiceNow to XSOAR), Outgoing (from XSOAR to ServiceNow), or Incoming and Outgoing (from/to XSOAR and ServiceNow).","name":"mirror_direction","options":["None","Incoming","Outgoing","Incoming And Outgoing"],"required":false,"type":15},{"defaultValue":"comments","display":"Comment Entry Tag","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Choose the tag to add to an entry to mirror it as a comment in ServiceNow.","name":"comment_tag","options":null,"required":false,"type":0},{"defaultValue":"work_notes","display":"Work Note Entry Tag","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Choose the tag to add to an entry to mirror it as a work note in ServiceNow.","name":"work_notes_tag","options":null,"required":false,"type":0},{"defaultValue":"ForServiceNow","display":"File Entry Tag","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Choose the tag to add to an entry to mirror it as a file in ServiceNow.","name":"file_tag","options":null,"required":false,"type":0},{"defaultValue":"sys_updated_on","display":"Timestamp field to query for updates as part of the mirroring flow","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"According to the timestamp in this field, records will be queried to check for updates.","name":"update_timestamp_field","options":null,"required":false,"type":0},{"defaultValue":"100","display":"How many incidents to mirror incoming each time","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"If a greater number of incidents than the limit were modified, then they won't be mirrored in.","name":"mirror_limit","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Close Mirrored XSOAR Incident","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, closing the ServiceNow ticket is mirrored in Cortex XSOAR.","name":"close_incident","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Close Mirrored ServiceNow Ticket","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, closing the XSOAR incident is mirrored in ServiceNow.","name":"close_ticket","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19}],"definitionId":"","description":"Use The ServiceNow IT Service Management (ITSM) solution to modernize the way you manage and deliver services to your users.","detailedDescription":" To use ServiceNow on Cortex XSOAR, ensure your user account has the rest_api_explorer and web_service_admin roles.\n These roles are required to make API calls.\n However, they may not suffice for viewing records in some tables.\n Please make sure you have the correct role so you have permissions to work with the relevant table.\n  \n### Instance Configuration\nThe integration supports two types of authorization:\n1. Basic authorization using username and password.\n2. OAuth 2.0 authorization.\n\n#### OAuth 2.0 Authorization\nTo use OAuth 2.0 authorization follow the next steps:\n1. Login to your ServiceNow instance and create an endpoint for XSOAR to access your instance (please see [Snow OAuth](https://docs.servicenow.com/bundle/orlando-platform-administration/page/administer/security/task/t_CreateEndpointforExternalClients.html) for more information). \n2. Copy the `Client Id` and `Client Secret` (press the lock next to the client secret to reveal it) that were automatically generated when creating the endpoint into the `Username` and `Password` fields of the instance configuration.\n3. Select the `Use OAuth Login` checkbox and click the `Done` button.\n4. Run the command `!servicenow-oauth-login` from the XSOAR CLI and fill in the username and password of the ServiceNow instance. This step generates an access token to the ServiceNow instance and is required only in the first time after configuring a new instance in the XSOAR platform.\n5. (Optional) Test the created instance by running the `!servicenow-oauth-test` command.\n\n**Notes:**\n1. When running the `!servicenow-oauth-login` command, a refresh token is generated and will be used to produce new access tokens after the current access token has expired.\n2. Every time the refresh token expires you will have to run the `servicenow-oauth-login` command again. Hence, we recommend to set the `Refresh Token Lifespan` field in the endpoint created in step 1 to a long period (can be set to several years). \n\n\n### Using Multi Factor Authentication (MFA)\nMFA can be used both when using basic authorization and when using OAuth 2.0 authorization, however we strongly recommend using OAuth 2.0 when using MFA.\nIf MFA is enabled for your user, follow the next steps:\n1. Open the Google Authenticator application on your mobile device and make note of the number. The number refreshes every 30 seconds.\n2. Enter your username and password, and append the One Time Password (OTP) that you currently see on your mobile device to your password without any extra spaces. For example, if your password is `12345` and the current OTP code is `424 058`, enter `12345424058`.\n\n**Notes:**\n1. When using basic authorization, you will have to update your password with the current OTP every time the current code expires (30 seconds), hence we recommend using OAuth 2.0 authorization.\n2. For using OAuth 2.0 see the above instructions. The OTP code should be appended to the password parameter in the `!servicenow-oauth-login` command.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/service-now-v2)","display":"ServiceNow v2","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"ServiceNow v2","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"Ticket system ID for which to retrieve information.","name":"id","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task","sc_req_item"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number to retrieve.","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"If \"true\" will retrieve ticket attachments. Default is \"false\".","name":"get_attachments","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom fields on which to query. For example: state_code=AR;time_zone=PST.","name":"custom_fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Additional fields to display in the War Room entry and incident context.","isArray":true,"name":"additional_fields","required":false,"secret":false},{"default":false,"defaultValue":";","deprecated":false,"description":"The delimiter character to use as a separator for a list of fields in an argument for this command. Default is ';'.","name":"fields_delimiter","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves ticket information by ticket ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-ticket","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"Ticket ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedBy","description":"Ticket opener ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CreatedOn","description":"Ticket creation date.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Assignee","description":"Ticket assignee ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.State","description":"Ticket state.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Summary","description":"Ticket short summary.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Number","description":"Ticket number.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Active","description":"Ticket active.","type":"boolean"},{"contentPath":"","contextPath":"ServiceNow.Ticket.AdditionalComments","description":"Ticket comments.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Priority","description":"Ticket priority.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedAt","description":"Ticket opening time.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.ResolvedBy","description":"Ticket resolver ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CloseCode","description":"Ticket close code.","type":"string"},{"contentPath":"","contextPath":"File.Info","description":"Attachment file info.","type":"string"},{"contentPath":"","contextPath":"File.Name","description":"Attachment file name.","type":"string"},{"contentPath":"","contextPath":"File.Size","description":"Attachment file size.","type":"number"},{"contentPath":"","contextPath":"File.SHA1","description":"Attachment SHA1 hash.","type":"string"},{"contentPath":"","contextPath":"File.SHA256","description":"Attachment SHA256 hash.","type":"string"},{"contentPath":"","contextPath":"File.EntryID","description":"Attachment file entry ID.","type":"string"},{"contentPath":"","contextPath":"File.Type","description":"Attachment file type.","type":"string"},{"contentPath":"","contextPath":"File.MD5","description":"Attachment MD5 hash.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket.","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task","sc_req_item"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket urgency. You can either select from the predefined options or enter another value. For example, \"Urgent\" or \"5\".","name":"urgency","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket severity. You can either select from the predefined options or enter another value. For example, \"Urgent\" or \"5\".","name":"severity","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket impact.","name":"impact","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether to set the ticket as Active. Can be \"true\" or \"false\".","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ticket activity due date, in the format \"2016-07-02 21:51:11\".","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of users assigned to the ticket.","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval.","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ticket approval set date, in the format \"2016-07-02 21:51:11\".","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User assigned to the ticket.","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business duration, in the format: YYYY-MM-DD HH:MM:SS.","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service.","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source.","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Calendar duration, in the format: YYYY-MM-DD HH:MM:SS.","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Caller ID (UID format).","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category of the ticket.","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"caused_by","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket's close code. Can be \"Solved (Work Around)\", \"Solved (Permanently)\", \"Solved Remotely (Work Around)\", \"Solved Remotely (Permanently)\", \"Not Solved (Not Reproducible)\", \"Not Solved (Too Costly)\", or \"Closed/Resolved by Caller\".","name":"close_code","predefined":["Solved (Work Around)","Solved (Permanently)","Solved Remotely (Work Around)","Solved Remotely (Permanently)","Not Solved (Not Reproducible)","Not Solved (Too Costly)","Closed/Resolved by Caller"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket.","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"When the ticket was closed, in the format: YYYY-MM-DD HH:MM:SS.","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket.","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format.","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input.","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input.","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Company (UID format).","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type.","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display.","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation ID.","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Delivery plan (UID format).","name":"delivery_plan","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description.","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket due date, in the format: YYYY-MM-DD HH:MM:SS.","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Expected start date/time, in the format: YYYY-MM-DD HH:MM:SS.","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Follow up date/time, in the format: YYYY-MM-DD HH:MM:SS.","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list (group).","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether the ticket is solved in the knowledge base. Can be \"true\" or \"false\".","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket.","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket.","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether to be notified about this ticket. Can be \"1\" or \"0\".","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number.","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The number of users included in this ticket.","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"How many times the ticket has been reopened.","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The date/time that the ticket was resolved, in the format: YYYY-MM-DD HH:MM:SS.","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"ID of the user that resolved the ticket.","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA due date/time, in the format: YYYY-MM-DD HH:MM:SS.","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket subcategory.","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by.","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last date/time that the system was updated, in the format: YYYY-MM-DD HH:MM:SS.","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user.","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets.","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List work notes UIDs.","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date/time when work started on the ticket.","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The sys_id of the group to assign.","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The number that represents the incident state.","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number.","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Priority of the ticket.","name":"priority","predefined":["5 - Planning","4 - Low","3 - Moderate","2 - High","1 - Critical"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Template name to use as the basis to create new tickets.","name":"template","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom (user defined) fields in the format: fieldname1=value;fieldname2=value; custom fields start with a \"u_\".","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"normal","deprecated":false,"description":"Type of Change Request ticket. Can be \"normal\", \"standard\", or \"emergency\". Default is \"normal\".","name":"change_type","predefined":["normal","standard","emergency"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the ticket, for example: \"Closed\" or \"7\" or \"7 - Closed\".","name":"state","required":false,"secret":false},{"default":false,"deprecated":false,"description":" Date/time the ticket was opened, in the format: YYYY-MM-DD HH:MM:SS.","name":"opened_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Caller system ID.","name":"caller","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket approval.","name":"approval","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Additional fields in the format: fieldname1=value;fieldname2=value;","name":"additional_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Flag that indicates whether to set field values using the display value or the actual value. 'true' treats input values as the display value. 'false' treats input values as actual values. Default is false.","name":"input_display_value","predefined":["false","true"],"required":false,"secret":false},{"default":false,"defaultValue":";","deprecated":false,"description":"The delimiter character to use as a separator for a list of fields in an argument for this command. Default is ';'.","name":"fields_delimiter","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates new ServiceNow ticket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-create-ticket","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"Ticket ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedBy","description":"Ticket opener ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CreatedOn","description":"Ticket creation date.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Assignee","description":"Ticket assignee ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.State","description":"Ticket state.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Summary","description":"Ticket short summary.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Number","description":"Ticket number.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Active","description":"Ticket active.","type":"boolean"},{"contentPath":"","contextPath":"ServiceNow.Ticket.AdditionalComments","description":"Ticket comments.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Priority","description":"Ticket priority.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.OpenedAt","description":"Ticket opening time.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.ResolvedBy","description":"Ticket resolver ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.CloseCode","description":"Ticket close code.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Short description of the ticket.","name":"short_description","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task","sc_req_item"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket urgency. You can either select from the predefined options or enter another value. For example, \"Urgent\" or \"5\".","name":"urgency","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket severity. You can either select from the predefined options or enter another value. For example, \"Urgent\" or \"5\".","name":"severity","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket impact.","name":"impact","predefined":["3 - Low","2 - Medium","1 - High"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether the ticket is Active. Can be \"true\" or \"false\".","name":"active","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ticket activity due date, in the format: \"2016-07-02 21:51:11\".","name":"activity_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of users assigned to the ticket.","name":"additional_assignee_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket history approval.","name":"approval_history","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ticket approval set date/time, in the format: \"2016-07-02 21:51:11\".","name":"approval_set","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User assigned to the ticket.","name":"assigned_to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business duration, in the format: YYYY-MM-DD HH:MM:SS.","name":"business_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business service.","name":"business_service","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Business source.","name":"business_stc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Calendar duration, in the format: YYYY-MM-DD HH:MM:SS.","name":"calendar_duration","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Caller ID (UID format).","name":"caller_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Category name.","name":"category","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format.","name":"caused_by","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket's close code. Can be \"Solved (Work Around)\", \"Solved (Permanently)\", \"Solved Remotely (Work Around)\", \"Solved Remotely (Permanently)\", \"Not Solved (Not Reproducible)\", \"Not Solved (Too Costly)\", or \"Closed/Resolved by Caller\".","name":"close_code","predefined":["Solved (Work Around)","Solved (Permanently)","Solved Remotely (Work Around)","Solved Remotely (Permanently)","Not Solved (Not Reproducible)","Not Solved (Too Costly)","Closed/Resolved by Caller"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Close notes of the ticket.","name":"close_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date/time the ticket was closed, in the format: YYYY-MM-DD HH:MM:SS.","name":"closed_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"User who closed the ticket.","name":"closed_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format.","name":"cmdb_ci","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input.","name":"comments","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format type journal input.","name":"comments_and_work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format.","name":"company","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Contact type.","name":"contact_type","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation display.","name":"correlation_display","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Correlation ID.","name":"correlation_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID Format.","name":"delivery_plan","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket description.","name":"description","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket due date, in the format: YYYY-MM-DD HH:MM:SS.","name":"due_date","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Expected start date/time, in the format: YYYY-MM-DD HH:MM:SS.","name":"expected_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Follow up date/time, in the format: YYYY-MM-DD HH:MM:SS.","name":"follow_up","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID format list.","name":"group_list","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether the ticket is solved in the knowledge base. Can be \"true\" or \"false\".","name":"knowledge","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Location of the ticket.","name":"location","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA of the ticket.","name":"made_sla","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Whether to be notified about this ticket. Can be \"1\" or \"0\".","name":"notify","predefined":["1","0"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Order number.","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Parent (UID format).","name":"parent","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Parent incident (UID format).","name":"parent_incident","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Problem ID (UID format).","name":"problem_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The number of users included in this ticket.","name":"reassignment_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The number of times the ticket has been reopened.","name":"reopen_count","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date/time the ticket was resolved, in the format: YYYY-MM-DD HH:MM:SS.","name":"resolved_at","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Resolved by (UID format).","name":"resolved_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"UID","name":"rfc","required":false,"secret":false},{"default":false,"deprecated":false,"description":"SLA due date/time, in the format: YYYY-MM-DD HH:MM:SS.","name":"sla_due","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket subcategory.","name":"subcategory","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Last updated by","name":"sys_updated_by","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date/time the system was last updated.","name":"sys_updated_on","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Input from the end user.","name":"user_input","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A list of watched tickets.","name":"watch_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format: YYYY-MM-DD HH:MM:SS","name":"work_end","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Format journal list.","name":"work_notes","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Comma-separated list of work notes UIDs.","name":"work_notes_list","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Date/time when work started on the ticket.","name":"work_start","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Assignment group UID.","name":"assignment_group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Number representing the incident state.","name":"incident_state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket number.","name":"number","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Priority of the ticket.","name":"priority","predefined":["5 - Planning","4 - Low","3 - Moderate","2 - High","1 - Critical"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"System ID of the ticket to update.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Custom (user defined) fields in the format: fieldname1=value;fieldname2=value; custom fields start with a \"u_\".","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"normal","deprecated":false,"description":"Type of Change Request ticket. Can be \"normal\", \"standard\", or \"emergency\". Default is \"normal\".","name":"change_type","predefined":["normal","standard","emergency"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"State of the ticket, for example: \"Closed\" or \"7\" or \"7 - Closed\".","name":"state","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Caller system ID.","name":"caller","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Ticket approval.","name":"approval","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Additional fields in the format: fieldname1=value;fieldname2=value;","name":"additional_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Flag that indicates whether to set field values using the display value or the actual value. 'true' treats input values as the display value. 'false' treats input values as actual values. Default is false.","name":"input_display_value","predefined":["false","true"],"required":false,"secret":false},{"default":false,"defaultValue":";","deprecated":false,"description":"The delimiter character to use as a separator for a list of fields in an argument for this command. Default is ';'.","name":"fields_delimiter","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates the specified ticket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-update-ticket","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task","sc_req_item"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Deletes a ticket from ServiceNow.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-delete-ticket","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"The maximum number of tickets to retrieve.","name":"limit","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task","sc_req_item"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to run. To learn about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index from which to begin retrieving records.","name":"offset","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Additional fields to present in the War Room entry and incident context.","isArray":true,"name":"additional_fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"System parameters in the format: fieldname1=value;fieldname2=value. For example: \"sysparm_display_value=true;sysparm_exclude_reference_link=True\"","name":"system_params","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves ticket information according to the supplied query.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-tickets","outputs":[{"contentPath":"","contextPath":"Ticket.ID","description":"The unique ticket identifier.","type":"string"},{"contentPath":"","contextPath":"Ticket.Creator","description":"A string field that indicates the user who created the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.CreatedOn","description":"The date/time when the ticket was created.","type":"date"},{"contentPath":"","contextPath":"Ticket.Assignee","description":"Specifies the user assigned to complete the ticket. By default, this field uses a reference qualifier to only display users with the ITIL role.","type":"string"},{"contentPath":"","contextPath":"Ticket.State","description":"Status of the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.Summary","description":"A human-readable title for the record.","type":"string"},{"contentPath":"","contextPath":"Ticket.Number","description":"The display value of the ticket.","type":"string"},{"contentPath":"","contextPath":"Ticket.Active","description":"Specifies whether work is still being done on a task or whether the work for the task is complete.","type":"boolean"},{"contentPath":"","contextPath":"Ticket.AdditionalComments","description":"Comments about the task record.","type":"Unknown"},{"contentPath":"","contextPath":"Ticket.Priority","description":"Specifies the ticket priority for the assignee.","type":"string"},{"contentPath":"","contextPath":"Ticket.OpenedAt","description":"The date/time when the ticket was first opened.","type":"date"},{"contentPath":"","contextPath":"Ticket.Escalation","description":"Indicates how long the ticket has been open.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID.","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The actual link to publish in ServiceNow ticket, in a valid URL format, for example, http://www.demisto.com.","name":"link","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Whether to publish the link as comment on the ticket. Can be \"true\" or \"false\". If false will publish the link as WorkNote.","name":"post-as-comment","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The text to represent the link.","name":"text","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Adds a link to the specified ticket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-add-link","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID.","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Comment to add.","name":"comment","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to publish the note as comment on the ticket. Can be \"true\" or \"false\". Default is \"false\".","name":"post-as-comment","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Adds a comment to the specified ticket, by ticket ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-add-comment","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID.","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"War Room entry ID that includes the file.","name":"file_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Filename of the uploaded file to override the existing file name in the entry.","name":"file_name","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Uploads a file to the specified ticket.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-upload-file","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.File.Filename","description":"Name of the file.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.File.Link","description":"Download link for the file.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.File.SystemID","description":"System ID of the file.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Record System ID.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Comma-separated list of table fields to display and output to the context. For example, name,tag,company. ID field is added by default.","name":"fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the table from which to get the record.","name":"table_name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves record information, by record ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-record","outputs":[{"contentPath":"","contextPath":"ServiceNow.Record.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedOn","description":"A time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the table to query","name":"table_name","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"The maximum number of tickets to retrieve.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The query to run. For more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Comma-separated list of table fields to display and output to the context. For example, name,tag,company. ID field is added by default.","isArray":true,"name":"fields","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index from which to begin retrieving records.","name":"offset","required":false,"secret":false},{"default":false,"deprecated":false,"description":"System parameters in the format: fieldname1=value;fieldname2=value. For example: \"sysparm_display_value=true\u0026sysparm_exclude_reference_link=True\"","name":"system_params","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Queries the specified table in ServiceNow.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-table","outputs":[{"contentPath":"","contextPath":"ServiceNow.Results.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Results.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Results.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Results.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Results.CreatedOn","description":"A time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the table in which to create a record.","name":"table_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Fields and their values to create the record with, in the format: fieldname1=value;fieldname2=value;...","name":"fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom (user defined) fields in the format: fieldname1=value;fieldname2=value;...","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Flag that indicates whether to set field values using the display value or the actual value. 'true' treats input value as the display value. 'false' treats input values as actual values. Default is false.","name":"input_display_value","predefined":["false","true"],"required":false,"secret":false},{"default":false,"defaultValue":";","deprecated":false,"description":"The delimiter character to use as a separator for a list of fields in an argument for this command. Default is ';'.","name":"fields_delimiter","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a new record in the specified ServiceNow table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-create-record","outputs":[{"contentPath":"","contextPath":"ServiceNow.Record.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedOn","description":"A time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the table to update the record in.","name":"table_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The system ID of the ticket to update.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Fields and their values to update in the record, in the format: fieldname1=value;fieldname2=value;...","name":"fields","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Custom (user defined) fields and their values to update in the record, in the format: fieldname1=value;fieldname2=value;...","name":"custom_fields","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Flag that indicates whether to set field values using the display value or the actual value. 'true' treats input value as the display value. 'false' treats input values as actual values. Default is false.","name":"input_display_value","predefined":["false","true"],"required":false,"secret":false},{"default":false,"defaultValue":";","deprecated":false,"description":"The delimiter character to use as a separator for a list of fields in an argument for this command. Default is ';'.","name":"fields_delimiter","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates a record in the specified ServiceNow table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-update-record","outputs":[{"contentPath":"","contextPath":"ServiceNow.Record.ID","description":"The unique record identifier for the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedBy","description":"A string field that indicates the user who most recently updated the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.UpdatedAt","description":"A time-stamp field that indicates the date and time of the most recent update.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedBy","description":"A string field that indicates the user who created the record.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Record.CreatedOn","description":"A time-stamp field that indicates when a record was created.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The table name.","name":"table_name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The system ID of the ticket to delete.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Deletes a record in the specified ServiceNow table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-delete-record","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Table name","name":"table_name","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Lists API fields for the specified ServiceNow table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-list-table-fields","outputs":[{"contentPath":"","contextPath":"ServiceNow.Field","description":"Table API field name.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by computer sys_id.","name":"computer_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by computer name.","name":"computer_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by specified query, for more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by asset tag.","name":"asset_tag","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of query results. Default is 10.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Queries the cmdb_ci_computer table in ServiceNow.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-computers","outputs":[{"contentPath":"","contextPath":"ServiceNow.Computer.ID","description":"Computer system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.AssetTag","description":"Computer Asset tag.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Name","description":"Computer name.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.DisplayName","description":"Computer display name.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.SupportGroup","description":"Computer support group.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.OperatingSystem","description":"Computer operating system.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Company","description":"Computer company system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.AssignedTo","description":"Computer assigned to user system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.State","description":"Computer state.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Cost","description":"Computer cost.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Computer.Comments","description":"Computer comments.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by group system ID.","name":"group_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by group name.","name":"group_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by specified query, for more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of query results. Default is 10.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Queries the sys_user_group table in ServiceNow.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-groups","outputs":[{"contentPath":"","contextPath":"ServiceNow.Group.ID","description":"Group system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Description","description":"Group description.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Name","description":"Group name.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Manager","description":"Group manager system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Group.Updated","description":"Date/time the group was last updated.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by user system ID.","name":"user_id","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by username.","name":"user_name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Query by specified query, for more information about querying in ServiceNow, see https://docs.servicenow.com/bundle/istanbul-servicenow-platform/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html","name":"query","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of query results. Default is 10.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Queries the sys_user table in ServiceNow.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-users","outputs":[{"contentPath":"","contextPath":"ServiceNow.User.ID","description":"User system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.Name","description":"User name (first and last).","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.UserName","description":"User username.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.Email","description":"User email address.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.User.Created","description":"Date/time the user was created.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.User.Updated","description":"Date/time the user was last updated.","type":"date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The table label, for example: Asset, Incident, IP address, and so on.","name":"label","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of query results. Default is 10.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Starting record index to begin retrieving records from.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets table names by a label to use in commands.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-table-name","outputs":[{"contentPath":"","contextPath":"ServiceNow.Table.ID","description":"Table system ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Table.Name","description":"Table name to use in commands, for example: alm_asset.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Table.SystemName","description":"Table system name, for example: Asset.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Ticket System ID.","name":"id","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of ticket notes. Default is 10.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Offset of the ticket notes.","name":"offset","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets notes from the specified ServiceNow ticket. \"Read permissions\" are required for the sys_journal_field table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-ticket-notes","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"Ticket ID.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.Value","description":"Ticket note value.","type":"unknown"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.CreatedOn","description":"Date/time the ticket note was created.","type":"date"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.CreatedBy","description":"User that created the ticket note.","type":"string"},{"contentPath":"","contextPath":"ServiceNow.Ticket.Note.Type","description":"Ticket note type.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Ticket System ID.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Tag system ID. Can be retrieved using the \"!servicenow-query-table table_name=label fields=name,active,sys_id\" command.","name":"tag_id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Tag title. For example: \"Incident - INC000001\".","name":"title","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"incident","deprecated":false,"description":"Ticket type. Can be \"incident\", \"problem\", \"change_request\", \"sc_request\", \"sc_task\", or \"sc_req_item\". Default is \"incident\".","name":"ticket_type","predefined":["incident","problem","change_request","sc_request","sc_task","sc_req_item"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Adds a tag to a ticket. The added tag entry will be visible in the label_entry table and can be retrieved using the \"!servicenow-query-table table_name=label_entry fields=title,table,sys_id,id_display,id_type\" command.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-add-tag","outputs":[{"contentPath":"","contextPath":"ServiceNow.Ticket.ID","description":"The unique ticket identifier.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.Ticket.TagTitle","description":"Ticket tag title.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.Ticket.TagID","description":"Ticket tag ID.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Query by name. Does not require an exact match.","name":"name","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Starting record index to begin retrieving records from.","name":"offset","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of query results. Default is 10.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Queries the sc_cat_item table in ServiceNow.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-query-items","outputs":[{"contentPath":"","contextPath":"ServiceNow.CatalogItem.ID","description":"Catalog item system ID.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Name","description":"Catalog item name.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Description","description":"Catalog item description.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Price","description":"Catalog item price.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Catalog item system ID.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves item details by system ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-get-item-details","outputs":[{"contentPath":"","contextPath":"ServiceNow.CatalogItem.ID","description":"Catalog item system ID.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Name","description":"Catalog item name.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Description","description":"Catalog item description.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Price","description":"Catalog item price.","type":"Number"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Variables.Mandatory","description":"Is the variable mandatory as part of the ordering process.","type":"Boolean"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Variables.Name","description":"A name to identify the question.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Variables.Question","description":"Question to ask users ordering the catalog item.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.CatalogItem.Variables.Type","description":"The variable type.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Catalog item system ID.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Quantity of the item to order.","name":"quantity","required":true,"secret":false},{"default":false,"deprecated":false,"description":"If there are mandatory variables defined for the item, they must be passed to the endpoint. Can be retrieved using the !servicenow-get-item-details command. For example, var1=value1;var2=value2.","name":"variables","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Orders the specified catalog item.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-create-item-order","outputs":[{"contentPath":"","contextPath":"ServiceNow.OrderRequest.ID","description":"Generated request system ID.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.OrderRequest.RequestNumber","description":"Number of the generated request.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Queue ID. Can be retrieved using the \"!servicenow-query-table table_name=awa_queue fields=name,number,order\" command.","name":"queue_id","required":true,"secret":false},{"default":false,"defaultValue":"incident","deprecated":false,"description":"Document table.","name":"document_table","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Document ID.","name":"document_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Documents a route to a queue. Requires an installation of the Advanced Work Assignments plugin. An active queue and service channel to the designated table.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-document-route-to-queue","outputs":[{"contentPath":"","contextPath":"ServiceNow.WorkItem.WorkItemID","description":"Unique ID of the work item assigned to the queue.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.WorkItem.DocumentTable","description":"Name of the table associated with the document","type":"String"},{"contentPath":"","contextPath":"ServiceNow.WorkItem.DocumentID","description":"Unique ID of the document to be routed to the queue.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.WorkItem.QueueID","description":"Unique ID of the queue on which to route a document.","type":"String"},{"contentPath":"","contextPath":"ServiceNow.WorkItem.DisplayName","description":"Name of the document to be routed by this work item, for example: case record.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Returns the list of fields for an incident type.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-mapping-fields","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The ticket ID.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Retrieve entries that were created after lastUpdate.","name":"lastUpdate","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get remote data from a remote incident. This method does not update the current incident, and should be used for debugging purposes.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-remote-data","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The username to use for login.","name":"username","required":true,"secret":true},{"default":false,"deprecated":false,"description":"The password to use for login.","name":"password","required":true,"secret":true}],"cartesian":false,"deprecated":false,"description":"This function should be used once before running any command when using OAuth2 authentication.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-oauth-login","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Test the instance configuration when using OAuth2 authentication.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"servicenow-oauth-test","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Date string in local time representing the last time the incident was updated. The incident is only returned if it was modified after the last update time.","name":"lastUpdate","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets the list of incidents that were modified since the last update time. Note that this method is here for debugging purposes. The get-modified-remote-data command is used as part of a Mirroring feature, which is available from version 6.1.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-modified-remote-data","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":true,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":true,"isRemoteSyncIn":true,"isRemoteSyncOut":true,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"import os\nimport shutil\nimport dateparser\nfrom urllib import parse\nfrom typing import List, Tuple, Dict, Callable, Any, Union, Optional\n\n\n\n# disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\nCOMMAND_NOT_IMPLEMENTED_MSG = 'Command not implemented'\n\nTICKET_STATES = {\n    'incident': {\n        '1': '1 - New',\n        '2': '2 - In Progress',\n        '3': '3 - On Hold',\n        '4': '4 - Awaiting Caller',\n        '5': '5 - Awaiting Evidence',\n        '6': '6 - Resolved',\n        '7': '7 - Closed',\n        '8': '8 - Canceled'\n    },\n    'problem': {\n        '1': '1 - Open',\n        '2': '2 - Known Error',\n        '3': '3 - Pending Change',\n        '4': '4 - Closed/Resolved'\n    },\n    'change_request': {\n        '-5': '-5 - New',\n        '-4': '-4 - Assess',\n        '-3': '-3 - Authorize',\n        '-2': '-2 - Scheduled',\n        '-1': '-1 - Implement',\n        '0': '0 - Review',\n        '3': '3 - Closed',\n        '4': '4 - Canceled'\n    },\n    'sc_task': {\n        '-5': '-5 - Pending',\n        '1': '1 - Open',\n        '2': '2 - Work In Progress',\n        '3': '3 - Closed Complete',\n        '4': '4 - Closed Incomplete',\n        '7': '7 - Closed Skipped'\n    },\n    'sc_request': {\n        '1': '1 - Approved',\n        '3': '3 - Closed',\n        '4': '4 - Rejected'\n    },\n}\n\nTICKET_APPROVAL = {\n    'sc_req_item': {\n        'waiting_for_approval': 'Waiting for approval',\n        'approved': 'Approved',\n        'requested': 'Requested',\n        'rejected': 'Rejected',\n        'not requested': 'Not Yet Requested'\n    }\n}\n\nTICKET_PRIORITY = {\n    '1': '1 - Critical',\n    '2': '2 - High',\n    '3': '3 - Moderate',\n    '4': '4 - Low',\n    '5': '5 - Planning'\n}\n\nSNOW_ARGS = ['active', 'activity_due', 'opened_at', 'short_description', 'additional_assignee_list', 'approval_history',\n             'approval', 'approval_set', 'assigned_to', 'assignment_group',\n             'business_duration', 'business_service', 'business_stc', 'change_type', 'category', 'caller',\n             'calendar_duration', 'calendar_stc', 'caller_id', 'caused_by', 'close_code', 'close_notes',\n             'closed_at', 'closed_by', 'cmdb_ci', 'comments', 'comments_and_work_notes', 'company', 'contact_type',\n             'correlation_display', 'correlation_id', 'delivery_plan', 'delivery_task', 'description', 'due_date',\n             'expected_start', 'follow_up', 'group_list', 'hold_reason', 'impact', 'incident_state',\n             'knowledge', 'location', 'made_sla', 'notify', 'order', 'parent', 'parent_incident', 'priority',\n             'problem_id', 'reassignment_count', 'reopen_count', 'resolved_at', 'resolved_by', 'rfc',\n             'severity', 'sla_due', 'state', 'subcategory', 'sys_tags', 'sys_updated_by', 'sys_updated_on',\n             'time_worked', 'title', 'type', 'urgency', 'user_input', 'watch_list', 'work_end', 'work_notes',\n             'work_notes_list', 'work_start']\n\n# Every table in ServiceNow should have those fields\nDEFAULT_RECORD_FIELDS = {\n    'sys_id': 'ID',\n    'sys_updated_by': 'UpdatedBy',\n    'sys_updated_on': 'UpdatedAt',\n    'sys_created_by': 'CreatedBy',\n    'sys_created_on': 'CreatedAt'\n}\n\n\nMIRROR_DIRECTION = {\n    'None': None,\n    'Incoming': 'In',\n    'Outgoing': 'Out',\n    'Incoming And Outgoing': 'Both'\n}\n\n\ndef arg_to_timestamp(arg: Any, arg_name: str, required: bool = False) -\u003e int:\n    \"\"\"\n    Converts an XSOAR argument to a timestamp (seconds from epoch).\n    This function is used to quickly validate an argument provided to XSOAR\n    via ``demisto.args()`` into an ``int`` containing a timestamp (seconds\n    since epoch). It will throw a ValueError if the input is invalid.\n    If the input is None, it will throw a ValueError if required is ``True``,\n    or ``None`` if required is ``False``.\n\n    Args:\n        arg: argument to convert\n        arg_name: argument name.\n        required: throws exception if ``True`` and argument provided is None\n\n    Returns:\n        returns an ``int`` containing a timestamp (seconds from epoch) if conversion works\n        returns ``None`` if arg is ``None`` and required is set to ``False``\n        otherwise throws an Exception\n    \"\"\"\n    if arg is None:\n        if required is True:\n            raise ValueError(f'Missing \"{arg_name}\"')\n\n    if isinstance(arg, str) and arg.isdigit():\n        # timestamp is a str containing digits - we just convert it to int\n        return int(arg)\n    if isinstance(arg, str):\n        # we use dateparser to handle strings either in ISO8601 format, or\n        # relative time stamps.\n        # For example: format 2019-10-23T00:00:00 or \"3 days\", etc\n        date = dateparser.parse(arg, settings={'TIMEZONE': 'UTC'})\n        if date is None:\n            # if d is None it means dateparser failed to parse it\n            raise ValueError(f'Invalid date: {arg_name}')\n\n        return int(date.timestamp())\n    if isinstance(arg, (int, float)):\n        # Convert to int if the input is a float\n        return int(arg)\n    raise ValueError(f'Invalid date: \"{arg_name}\"')\n\n\ndef get_server_url(server_url: str) -\u003e str:\n    url = server_url\n    url = re.sub('/[/]+$/', '', url)\n    url = re.sub('/$', '', url)\n    return url\n\n\ndef get_item_human_readable(data: dict) -\u003e dict:\n    \"\"\"Get item human readable.\n\n    Args:\n        data: item data.\n\n    Returns:\n        item human readable.\n    \"\"\"\n    item = {\n        'ID': data.get('sys_id', ''),\n        'Name': data.get('name', ''),\n        'Description': data.get('short_description', ''),\n        'Price': data.get('price', ''),\n        'Variables': []\n    }\n    variables = data.get('variables')\n    if variables and isinstance(variables, list):\n        for var in variables:\n            if var:\n                pretty_variables = {\n                    'Question': var.get('label', ''),\n                    'Type': var.get('display_type', ''),\n                    'Name': var.get('name', ''),\n                    'Mandatory': var.get('mandatory', '')\n                }\n                item['Variables'].append(pretty_variables)\n    return item\n\n\ndef create_ticket_context(data: dict, additional_fields: list = None) -\u003e Any:\n    \"\"\"Create ticket context.\n\n    Args:\n        data: ticket data.\n        additional_fields: additional fields to extract from the ticket\n\n    Returns:\n        ticket context.\n    \"\"\"\n    context = {\n        'ID': data.get('sys_id'),\n        'Summary': data.get('short_description'),\n        'Number': data.get('number'),\n        'CreatedOn': data.get('sys_created_on'),\n        'Active': data.get('active'),\n        'AdditionalComments': data.get('comments'),\n        'CloseCode': data.get('close_code'),\n        'OpenedAt': data.get('opened_at')\n    }\n    if additional_fields:\n        for additional_field in additional_fields:\n            if additional_field in data.keys() and camelize_string(additional_field) not in context.keys():\n                context[additional_field] = data.get(additional_field)\n\n    # These fields refer to records in the database, the value is their system ID.\n    closed_by = data.get('closed_by')\n    if closed_by:\n        if isinstance(closed_by, dict):\n            context['ResolvedBy'] = closed_by.get('value', '')\n        else:\n            context['ResolvedBy'] = closed_by\n    opened_by = data.get('opened_by')\n    if opened_by:\n        if isinstance(opened_by, dict):\n            context['OpenedBy'] = opened_by.get('value', '')\n            context['Creator'] = opened_by.get('value', '')\n        else:\n            context['OpenedBy'] = opened_by\n            context['Creator'] = opened_by\n    assigned_to = data.get('assigned_to')\n    if assigned_to:\n        if isinstance(assigned_to, dict):\n            context['Assignee'] = assigned_to.get('value', '')\n        else:\n            context['Assignee'] = assigned_to\n\n    # Try to map fields\n    priority = data.get('priority')\n    if priority:\n        context['Priority'] = TICKET_PRIORITY.get(priority, priority)\n    state = data.get('state')\n    if state:\n        context['State'] = state\n\n    return createContext(context, removeNull=True)\n\n\ndef get_ticket_context(data: Any, additional_fields: list = None) -\u003e Any:\n    \"\"\"Manager of ticket context creation.\n\n    Args:\n        data: ticket data. in the form of a dict or a list of dict.\n        additional_fields: additional fields to extract from the ticket\n\n    Returns:\n        ticket context. in the form of a dict or a list of dict.\n    \"\"\"\n    if not isinstance(data, list):\n        return create_ticket_context(data, additional_fields)\n\n    tickets = []\n    for d in data:\n        tickets.append(create_ticket_context(d, additional_fields))\n    return tickets\n\n\ndef get_ticket_human_readable(tickets, ticket_type: str, additional_fields: list = None) -\u003e list:\n    \"\"\"Get ticket human readable.\n\n    Args:\n        tickets: tickets data. in the form of a dict or a list of dict.\n        ticket_type: ticket type.\n        additional_fields: additional fields to extract from the ticket\n\n    Returns:\n        ticket human readable.\n    \"\"\"\n    if not isinstance(tickets, list):\n        tickets = [tickets]\n\n    ticket_severity = {\n        '1': '1 - High',\n        '2': '2 - Medium',\n        '3': '3 - Low'\n    }\n\n    result = []\n    for ticket in tickets:\n\n        hr = {\n            'Number': ticket.get('number'),\n            'System ID': ticket.get('sys_id'),\n            'Created On': ticket.get('sys_created_on'),\n            'Created By': ticket.get('sys_created_by'),\n            'Active': ticket.get('active'),\n            'Close Notes': ticket.get('close_notes'),\n            'Close Code': ticket.get('close_code'),\n            'Description': ticket.get('description'),\n            'Opened At': ticket.get('opened_at'),\n            'Due Date': ticket.get('due_date'),\n            # This field refers to a record in the database, the value is its system ID.\n            'Resolved By': ticket.get('closed_by', {}).get('value') if isinstance(ticket.get('closed_by'), dict)\n            else ticket.get('closed_by'),\n            'Resolved At': ticket.get('resolved_at'),\n            'SLA Due': ticket.get('sla_due'),\n            'Short Description': ticket.get('short_description'),\n            'Additional Comments': ticket.get('comments')\n        }\n        # Try to map the fields\n        impact = ticket.get('impact', '')\n        if impact:\n            hr['Impact'] = ticket_severity.get(impact, impact)\n        urgency = ticket.get('urgency', '')\n        if urgency:\n            hr['Urgency'] = ticket_severity.get(urgency, urgency)\n        severity = ticket.get('severity', '')\n        if severity:\n            hr['Severity'] = ticket_severity.get(severity, severity)\n        priority = ticket.get('priority', '')\n        if priority:\n            hr['Priority'] = TICKET_PRIORITY.get(priority, priority)\n\n        state = ticket.get('state', '')\n        if state:\n            mapped_state = state\n            if ticket_type in TICKET_STATES:\n                mapped_state = TICKET_STATES[ticket_type].get(state, mapped_state)\n            hr['State'] = mapped_state\n        approval = ticket.get('approval', '')\n        if approval:\n            mapped_approval = approval\n            if ticket_type in TICKET_APPROVAL:\n                mapped_approval = TICKET_APPROVAL[ticket_type].get(ticket.get('approval'), mapped_approval)\n                # Approval will be added to the markdown only in the necessary ticket types\n                hr['Approval'] = mapped_approval\n\n        if additional_fields:\n            for additional_field in additional_fields:\n                hr[additional_field] = ticket.get(additional_field)\n        result.append(hr)\n\n    return result\n\n\ndef get_ticket_fields(args: dict, template_name: dict = {}, ticket_type: str = '') -\u003e dict:\n    \"\"\"Inverse the keys and values of those dictionaries\n    to map the arguments to their corresponding values in ServiceNow.\n\n    Args:\n        args: Demisto args\n        template_name: ticket template name\n        ticket_type: ticket type\n\n    Returns:\n        ticket fields.\n    \"\"\"\n    ticket_severity = {\n        '1': '1 - High',\n        '2': '2 - Medium',\n        '3': '3 - Low'\n    }\n\n    inv_severity = {v: k for k, v in ticket_severity.items()}\n    inv_priority = {v: k for k, v in TICKET_PRIORITY.items()}\n    states = TICKET_STATES.get(ticket_type)\n    inv_states = {v: k for k, v in states.items()} if states else {}\n    approval = TICKET_APPROVAL.get(ticket_type)\n    inv_approval = {v: k for k, v in approval.items()} if approval else {}\n\n    ticket_fields = {}\n    for arg in SNOW_ARGS:\n        input_arg = args.get(arg)\n        if input_arg:\n            if arg in ['impact', 'urgency', 'severity']:\n                ticket_fields[arg] = inv_severity.get(input_arg, input_arg)\n            elif arg == 'priority':\n                ticket_fields[arg] = inv_priority.get(input_arg, input_arg)\n            elif arg == 'state':\n                ticket_fields[arg] = inv_states.get(input_arg, input_arg)\n            elif arg == 'approval':\n                ticket_fields[arg] = inv_approval.get(input_arg, input_arg)\n            elif arg == 'change_type':\n                # this change is required in order to use type 'Standard' as well.\n                ticket_fields['type'] = input_arg\n            else:\n                ticket_fields[arg] = input_arg\n        elif template_name and arg in template_name:\n            ticket_fields[arg] = template_name[arg]\n\n    return ticket_fields\n\n\ndef generate_body(fields: dict = {}, custom_fields: dict = {}) -\u003e dict:\n    \"\"\"Generates a body from fields and custom fields.\n\n    Args:\n        fields: fields data.\n        custom_fields: custom fields data.\n\n    Returns:\n        body object for SNOW requests.\n    \"\"\"\n    body = {}\n\n    if fields:\n        for field in fields:\n            body[field] = fields[field]\n\n    if custom_fields:\n        for field in custom_fields:\n            # custom fields begin with \"u_\"\n            if field.startswith('u_'):\n                body[field] = custom_fields[field]\n            else:\n                body['u_' + field] = custom_fields[field]\n\n    return body\n\n\ndef split_fields(fields: str = '', delimiter: str = ';') -\u003e dict:\n    \"\"\"Split str fields of Demisto arguments to SNOW request fields by the char ';'.\n\n    Args:\n        fields: fields in a string representation.\n        delimiter: the delimiter to use to separate the fields.\n    Returns:\n        dic_fields object for SNOW requests.\n    \"\"\"\n    dic_fields = {}\n\n    if fields:\n        if '=' not in fields:\n            raise Exception(\n                f\"The argument: {fields}.\\nmust contain a '=' to specify the keys and values. e.g: key=val.\")\n        arr_fields = fields.split(delimiter)\n        for f in arr_fields:\n            field = f.split('=', 1)  # a field might include a '=' sign in the value. thus, splitting only once.\n            if len(field) \u003e 1:\n                dic_fields[field[0]] = field[1]\n\n    return dic_fields\n\n\ndef build_query_for_request_params(query):\n    \"\"\"Split query that contains '\u0026' to a list of queries.\n\n    Args:\n        query: query (Example: \"id=5\u0026status=1\")\n\n    Returns:\n        List of sub queries. (Example: [\"id=5\", \"status=1\"])\n    \"\"\"\n\n    if '\u0026' in query:\n        query_params = []  # type: ignore\n        query_args = parse.parse_qsl(query)\n        for arg in query_args:\n            query_params.append(parse.urlencode([arg]))  # type: ignore\n        return query_params\n    else:\n        return query\n\n\nclass Client(BaseClient):\n    \"\"\"\n    Client to use in the ServiceNow integration. Overrides BaseClient.\n    \"\"\"\n\n    def __init__(self, server_url: str, sc_server_url: str, username: str, password: str, verify: bool, fetch_time: str,\n                 sysparm_query: str, sysparm_limit: int, timestamp_field: str, ticket_type: str, get_attachments: bool,\n                 incident_name: str, oauth_params: dict = None, version: str = None):\n        \"\"\"\n\n        Args:\n            server_url: SNOW server url\n            sc_server_url: SNOW Service Catalog url\n            username: SNOW username\n            password: SNOW password\n            oauth_params: (optional) the parameters for the ServiceNowClient that should be used to create an\n                          access token when using OAuth2 authentication.\n            verify: whether to verify the request\n            fetch_time: first time fetch for fetch_incidents\n            sysparm_query: system query\n            sysparm_limit: system limit\n            timestamp_field: timestamp field for fetch_incidents\n            ticket_type: default ticket type\n            get_attachments: whether to get ticket attachments by default\n            incident_name: the ServiceNow ticket field to be set as the incident name\n        \"\"\"\n        oauth_params = oauth_params if oauth_params else {}\n        self._base_url = server_url\n        self._sc_server_url = sc_server_url\n        self._version = version\n        self._verify = verify\n        self._username = username\n        self._password = password\n        self._proxies = handle_proxy(proxy_param_name='proxy', checkbox_default_value=False)\n        self.use_oauth = True if oauth_params else False\n        self.fetch_time = fetch_time\n        self.timestamp_field = timestamp_field\n        self.ticket_type = ticket_type\n        self.get_attachments = get_attachments\n        self.incident_name = incident_name\n        self.sys_param_query = sysparm_query\n        self.sys_param_limit = sysparm_limit\n        self.sys_param_offset = 0\n\n        if self.use_oauth:  # if user selected the `Use OAuth` checkbox, OAuth2 authentication should be used\n            self.snow_client: ServiceNowClient = ServiceNowClient(credentials=oauth_params.get('credentials', {}),\n                                                                  use_oauth=self.use_oauth,\n                                                                  client_id=oauth_params.get('client_id', ''),\n                                                                  client_secret=oauth_params.get('client_secret', ''),\n                                                                  url=oauth_params.get('url', ''),\n                                                                  verify=oauth_params.get('verify', False),\n                                                                  proxy=oauth_params.get('proxy', False),\n                                                                  headers=oauth_params.get('headers', ''))\n        else:\n            self._auth = (self._username, self._password)\n\n    def send_request(self, path: str, method: str = 'GET', body: dict = None, params: dict = None,\n                     headers: dict = None, file=None, sc_api: bool = False):\n        \"\"\"Generic request to ServiceNow.\n\n        Args:\n            path: API path\n            method: request method\n            body: request body\n            params: request params\n            headers: request headers\n            file: request  file\n            sc_api: Whether to send the request to the SC API\n\n        Returns:\n            response from API\n        \"\"\"\n        body = body if body is not None else {}\n        params = params if params is not None else {}\n        # if sc_api is set to true, then sending the request to the 'Service Catalog' instead of the 'now' API.\n        url = f'{self._base_url}{path}' if not sc_api else f'{self._sc_server_url}{path}'\n\n        if not headers:\n            headers = {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n            }\n        max_retries = 3\n        num_of_tries = 0\n        while num_of_tries \u003c max_retries:\n            if file:\n                # Not supported in v2\n                url = url.replace('v2', 'v1')\n                try:\n                    file_entry = file['id']\n                    file_name = file['name']\n                    shutil.copy(demisto.getFilePath(file_entry)['path'], file_name)\n                    with open(file_name, 'rb') as f:\n                        if self.use_oauth:\n                            access_token = self.snow_client.get_access_token()\n                            headers.update({\n                                'Authorization': f'Bearer {access_token}'\n                            })\n                            res = requests.request(method, url, headers=headers, data=body, params=params,\n                                                   files={'file': f}, verify=self._verify, proxies=self._proxies)\n                        else:\n                            res = requests.request(method, url, headers=headers, data=body, params=params,\n                                                   files={'file': f}, auth=self._auth,\n                                                   verify=self._verify, proxies=self._proxies)\n                    shutil.rmtree(demisto.getFilePath(file_entry)['name'], ignore_errors=True)\n                except Exception as err:\n                    raise Exception('Failed to upload file - ' + str(err))\n            else:\n                if self.use_oauth:\n                    access_token = self.snow_client.get_access_token()\n                    headers.update({\n                        'Authorization': f'Bearer {access_token}'\n                    })\n                    res = requests.request(method, url, headers=headers, data=json.dumps(body) if body else {},\n                                           params=params, verify=self._verify, proxies=self._proxies)\n                else:\n                    res = requests.request(method, url, headers=headers, data=json.dumps(body) if body else {},\n                                           params=params, auth=self._auth, verify=self._verify, proxies=self._proxies)\n\n            if \"Instance Hibernating page\" in res.text:\n                raise DemistoException(\n                    \"A connection was established but the instance is in hibernate mode.\\n\"\n                    \"Please wake your instance and try again.\")\n            try:\n                json_res = res.json()\n            except Exception as err:\n                if res.status_code == 201:\n                    return \"The ticket was successfully created.\"\n                if not res.content:\n                    return ''\n                raise Exception(f'Error parsing reply - {str(res.content)} - {str(err)}')\n\n            if 'error' in json_res:\n                message = json_res.get('error', {}).get('message')\n                details = json_res.get('error', {}).get('detail')\n                if message == 'No Record found':\n                    return {'result': []}  # Return an empty results array\n                if res.status_code == 401:\n                    demisto.debug(f'Got status code 401 - {json_res}. Retrying ...')\n                else:\n                    raise Exception(f'ServiceNow Error: {message}, details: {details}')\n\n            if res.status_code \u003c 200 or res.status_code \u003e= 300:\n                if res.status_code != 401 or num_of_tries == (max_retries - 1):\n                    raise Exception(\n                        f'Got status code {str(res.status_code)} with url {url} with body {str(res.content)}'\n                        f' with headers {str(res.headers)}')\n            else:\n                break\n            num_of_tries += 1\n\n        return json_res\n\n    def get_table_name(self, ticket_type: str = '') -\u003e str:\n        \"\"\"Get the relevant table name from th client.\n\n        Args:\n            ticket_type: ticket type\n\n        Returns:\n            the ticket_type if given or the client ticket type\n        \"\"\"\n        if ticket_type:\n            return ticket_type\n        return self.ticket_type\n\n    def get_template(self, template_name: str) -\u003e dict:\n        \"\"\"Get a ticket by sending a GET request.\n        Args:\n            template_name: ticket template name\n\n        Returns:\n            the ticket template\n        \"\"\"\n        query_params = {'sysparm_limit': 1, 'sysparm_query': f'name={template_name}'}\n\n        result = self.send_request('table/sys_template', 'GET', params=query_params)\n\n        if len(result['result']) == 0:\n            raise ValueError(\"Incorrect template name.\")\n\n        template = result['result'][0].get('template', '').split('^')\n        dic_template = {}\n\n        for i in range(len(template) - 1):\n            template_value = template[i].split('=')\n            if len(template_value) \u003e 1:\n                dic_template[template_value[0]] = template_value[1]\n\n        return dic_template\n\n    def get_ticket_attachments(self, ticket_id: str, sys_created_on: Optional[str] = None) -\u003e dict:\n        \"\"\"Get ticket attachments by sending a GET request.\n\n        Args:\n            ticket_id: ticket id\n            sys_created_on: string, when the attachment was created\n\n        Returns:\n            Response from API.\n        \"\"\"\n        query = f'table_sys_id={ticket_id}'\n        if sys_created_on:\n            query += f'^sys_created_on\u003e{sys_created_on}'\n        return self.send_request('attachment', 'GET', params={'sysparm_query': query})\n\n    def get_ticket_attachment_entries(self, ticket_id: str, sys_created_on: Optional[str] = None) -\u003e list:\n        \"\"\"Get ticket attachments, including file attachments\n        by sending a GET request and using the get_ticket_attachments class function.\n\n        Args:\n            ticket_id: ticket id\n            sys_created_on: string, when the attachment was created\n\n        Returns:\n            Array of attachments entries.\n        \"\"\"\n        entries = []\n        links = []  # type: List[Tuple[str, str]]\n        attachments_res = self.get_ticket_attachments(ticket_id, sys_created_on)\n        if 'result' in attachments_res and len(attachments_res['result']) \u003e 0:\n            attachments = attachments_res['result']\n            links = [(attachment.get('download_link', ''), attachment.get('file_name', ''))\n                     for attachment in attachments]\n\n        for link in links:\n            file_res = requests.get(link[0], auth=(self._username, self._password), verify=self._verify,\n                                    proxies=self._proxies)\n            if file_res is not None:\n                entries.append(fileResult(link[1], file_res.content))\n\n        return entries\n\n    def get(self, table_name: str, record_id: str, custom_fields: dict = {}, number: str = None) -\u003e dict:\n        \"\"\"Get a ticket by sending a GET request.\n\n        Args:\n            table_name: the table name\n            record_id: the record ID\n            custom_fields: custom fields of the record to query\n            number: record number\n\n        Returns:\n            Response from API.\n        \"\"\"\n        query_params = {}  # type: Dict\n        if record_id:\n            path = f'table/{table_name}/{record_id}'\n        elif number:\n            path = f'table/{table_name}'\n            query_params = {\n                'number': number\n            }\n        elif custom_fields:\n            path = f'table/{table_name}'\n            query_params = custom_fields\n        else:\n            # Only in cases where the table is of type ticket\n            raise ValueError('servicenow-get-ticket requires either ticket ID (sys_id) or ticket number.')\n\n        return self.send_request(path, 'GET', params=query_params)\n\n    def update(self, table_name: str, record_id: str, fields: dict = {}, custom_fields: dict = {},\n               input_display_value: bool = False) -\u003e dict:\n        \"\"\"Updates a ticket or a record by sending a PATCH request.\n\n        Args:\n            table_name: table name\n            record_id: record id\n            fields: fields to update\n            custom_fields: custom_fields to update\n            input_display_value: whether to set field values using the display value or the actual value.\n        Returns:\n            Response from API.\n        \"\"\"\n        body = generate_body(fields, custom_fields)\n        query_params = {'sysparm_input_display_value': input_display_value}\n        return self.send_request(f'table/{table_name}/{record_id}', 'PATCH', params=query_params, body=body)\n\n    def create(self, table_name: str, fields: dict = {}, custom_fields: dict = {},\n               input_display_value: bool = False):\n        \"\"\"Creates a ticket or a record by sending a POST request.\n\n        Args:\n        table_name: table name\n        record_id: record id\n        fields: fields to update\n        custom_fields: custom_fields to update\n        input_display_value: whether to set field values using the display value or the actual value.\n\n        Returns:\n            Response from API.\n        \"\"\"\n        body = generate_body(fields, custom_fields)\n        query_params = {'sysparm_input_display_value': input_display_value}\n        return self.send_request(f'table/{table_name}', 'POST', params=query_params, body=body)\n\n    def delete(self, table_name: str, record_id: str) -\u003e dict:\n        \"\"\"Deletes a ticket or a record by sending a DELETE request.\n\n        Args:\n        table_name: table name\n        record_id: record id\n\n        Returns:\n            Response from API.\n        \"\"\"\n        return self.send_request(f'table/{table_name}/{record_id}', 'DELETE')\n\n    def add_link(self, ticket_id: str, ticket_type: str, key: str, link: str) -\u003e dict:\n        \"\"\"Adds a link to a ticket by sending a PATCH request.\n\n        Args:\n        ticket_id: ticket ID\n        ticket_type: ticket type\n        key: link key\n        link: link str\n\n        Returns:\n            Response from API.\n        \"\"\"\n        return self.send_request(f'table/{ticket_type}/{ticket_id}', 'PATCH', body={key: link})\n\n    def add_comment(self, ticket_id: str, ticket_type: str, key: str, text: str) -\u003e dict:\n        \"\"\"Adds a comment to a ticket by sending a PATCH request.\n\n        Args:\n        ticket_id: ticket ID\n        ticket_type: ticket type\n        key: link key\n        link: link str\n\n        Returns:\n            Response from API.\n        \"\"\"\n        return self.send_request(f'table/{ticket_type}/{ticket_id}', 'PATCH', body={key: text})\n\n    def upload_file(self, ticket_id: str, file_id: str, file_name: str, ticket_type: str) -\u003e dict:\n        \"\"\"Adds a file to a ticket by sending a POST request.\n\n        Args:\n        ticket_id: ticket ID\n        file_id: file ID\n        file_name: file name\n        ticket_type: ticket type\n\n        Returns:\n            Response from API.\n        \"\"\"\n        body = {\n            'table_name': ticket_type,\n            'table_sys_id': ticket_id,\n            'file_name': file_name\n        }\n\n        return self.send_request('attachment/upload', 'POST', headers={'Accept': 'application/json'},\n                                 body=body, file={'id': file_id, 'name': file_name})\n\n    def add_tag(self, ticket_id: str, tag_id: str, title: str, ticket_type: str) -\u003e dict:\n        \"\"\"Adds a tag to a ticket by sending a POST request.\n\n        Args:\n            ticket_id: ticket id\n            tag_id:  tag id\n            title: tag title\n            ticket_type: ticket type\n\n        Returns:\n            Response from API.\n        \"\"\"\n        body = {'label': tag_id, 'table': ticket_type, 'table_key': ticket_id, 'title': title}\n        return self.send_request('/table/label_entry', 'POST', body=body)\n\n    def query(self, table_name: str, sys_param_limit: str, sys_param_offset: str, sys_param_query: str,\n              system_params: dict = {}, sysparm_fields: Optional[str] = None) -\u003e dict:\n        \"\"\"Query records by sending a GET request.\n\n        Args:\n        table_name: table name\n        sys_param_limit: limit the number of results\n        sys_param_offset: offset the results\n        sys_param_query: the query\n        system_params: system parameters\n        sysparm_fields: Comma-separated list of field names to return in the response.\n\n        Returns:\n            Response from API.\n        \"\"\"\n\n        query_params = {'sysparm_limit': sys_param_limit, 'sysparm_offset': sys_param_offset}\n        if sys_param_query:\n            query_params['sysparm_query'] = build_query_for_request_params(sys_param_query)\n        if system_params:\n            query_params.update(system_params)\n        if sysparm_fields:\n            query_params['sysparm_fields'] = sysparm_fields\n        demisto.debug(f'Running query records with the params: {query_params}')\n        return self.send_request(f'table/{table_name}', 'GET', params=query_params)\n\n    def get_table_fields(self, table_name: str) -\u003e dict:\n        \"\"\"Get table fields by sending a GET request.\n\n        Args:\n        table_name: table name\n\n        Returns:\n            Response from API.\n        \"\"\"\n        return self.send_request(f'table/{table_name}?sysparm_limit=1', 'GET')\n\n    def get_item_details(self, id_: str) -\u003e dict:\n        \"\"\"Get item details from service catalog by sending a GET request to the Service Catalog API.\n\n        Args:\n        id_: item id\n\n        Returns:\n            Response from API.\n        \"\"\"\n        return self.send_request(f'servicecatalog/items/{id_}', 'GET', sc_api=True)\n\n    def create_item_order(self, id_: str, quantity: str, variables: dict = {}) -\u003e dict:\n        \"\"\"Create item order in the service catalog by sending a POST request to the Service Catalog API.\n\n        Args:\n        id_: item id\n        quantity: order quantity\n        variables: order variables\n\n        Returns:\n            Response from API.\n        \"\"\"\n        body = {'sysparm_quantity': quantity, 'variables': variables}\n        return self.send_request(f'servicecatalog/items/{id_}/order_now', 'POST', body=body, sc_api=True)\n\n    def document_route_to_table_request(self, queue_id: str, document_table: str, document_id: str) -\u003e dict:\n        \"\"\"Routes a document(ticket/incident) to a queue by sending a GET request.\n\n        Args:\n        queue_id: Queue ID.\n        document_table: Document table.\n        document_id: Document ID.\n\n        Returns:\n            Response from API.\n        \"\"\"\n        body = {'document_sys_id': document_id, 'document_table': document_table}\n        return self.send_request(f'awa/queues/{queue_id}/work_item', 'POST', body=body)\n\n\ndef get_ticket_command(client: Client, args: dict):\n    \"\"\"Get a ticket.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n    ticket_id = str(args.get('id', ''))\n    number = str(args.get('number', ''))\n    get_attachments = args.get('get_attachments', 'false')\n    fields_delimiter = args.get('fields_delimiter', ';')\n    custom_fields = split_fields(str(args.get('custom_fields', '')), fields_delimiter)\n    additional_fields = argToList(str(args.get('additional_fields', '')))\n\n    result = client.get(ticket_type, ticket_id, generate_body({}, custom_fields), number)\n    if not result or 'result' not in result:\n        return 'Ticket was not found.'\n\n    if isinstance(result['result'], list):\n        if len(result['result']) == 0:\n            return 'Ticket was not found.'\n        ticket = result['result'][0]\n    else:\n        ticket = result['result']\n\n    entries = []  # type: List[Dict]\n\n    if get_attachments.lower() != 'false':\n        entries = client.get_ticket_attachment_entries(ticket.get('sys_id'))\n\n    hr = get_ticket_human_readable(ticket, ticket_type, additional_fields)\n    context = get_ticket_context(ticket, additional_fields)\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Approval',\n               'Created On', 'Created By', 'Active', 'Close Notes', 'Close Code', 'Description', 'Opened At',\n               'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description', 'Additional Comments']\n    if additional_fields:\n        headers.extend(additional_fields)\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents': result,\n        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable': tableToMarkdown('ServiceNow ticket', hr, headers=headers, removeNull=True),\n        'EntryContext': {\n            'Ticket(val.ID===obj.ID)': context,\n            'ServiceNow.Ticket(val.ID===obj.ID)': context\n        },\n        'IgnoreAutoExtract': True\n    }\n    entries.append(entry)\n    return entries\n\n\ndef update_ticket_command(client: Client, args: dict) -\u003e Tuple[Any, Dict, Dict, bool]:\n    \"\"\"Update a ticket.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    fields_delimiter = args.get('fields_delimiter', ';')\n    custom_fields = split_fields(str(args.get('custom_fields', '')), fields_delimiter)\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n    ticket_id = str(args.get('id', ''))\n    additional_fields = split_fields(str(args.get('additional_fields', '')), fields_delimiter)\n    additional_fields_keys = list(additional_fields.keys())\n    fields = get_ticket_fields(args, ticket_type=ticket_type)\n    fields.update(additional_fields)\n    input_display_value = argToBoolean(args.get('input_display_value', 'false'))\n\n    result = client.update(ticket_type, ticket_id, fields, custom_fields, input_display_value)\n    if not result or 'result' not in result:\n        raise Exception('Unable to retrieve response.')\n    ticket = result['result']\n\n    hr_ = get_ticket_human_readable(ticket, ticket_type, additional_fields_keys)\n    human_readable = tableToMarkdown(f'ServiceNow ticket updated successfully\\nTicket type: {ticket_type}',\n                                     t=hr_, removeNull=True)\n\n    # make the modified fields the user inserted as arguments show in the context\n    if additional_fields:\n        additional_fields_keys = list(set(additional_fields_keys).union(set(args.keys())))\n    else:\n        additional_fields_keys = list(args.keys())\n\n    entry_context = {'ServiceNow.Ticket(val.ID===obj.ID)': get_ticket_context(ticket, additional_fields_keys)}\n\n    return human_readable, entry_context, result, True\n\n\ndef create_ticket_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Create a ticket.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    fields_delimiter = args.get('fields_delimiter', ';')\n    custom_fields = split_fields(str(args.get('custom_fields', '')), fields_delimiter)\n    template = args.get('template')\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n    additional_fields = split_fields(str(args.get('additional_fields', '')), fields_delimiter)\n    additional_fields_keys = list(additional_fields.keys())\n    input_display_value = argToBoolean(args.get('input_display_value', 'false'))\n\n    if template:\n        template = client.get_template(template)\n    fields = get_ticket_fields(args, template, ticket_type)\n    if additional_fields:\n        fields.update(additional_fields)\n\n    result = client.create(ticket_type, fields, custom_fields, input_display_value)\n\n    if not result or 'result' not in result:\n        if 'successfully' in result:\n            return result, {}, {}, True\n        raise Exception('Unable to retrieve response.')\n    ticket = result['result']\n\n    hr_ = get_ticket_human_readable(ticket, ticket_type, additional_fields_keys)\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Approval',\n               'Created On', 'Created By', 'Active', 'Close Notes', 'Close Code', 'Description', 'Opened At',\n               'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description', 'Additional Comments']\n    if additional_fields:\n        headers.extend(additional_fields_keys)\n    human_readable = tableToMarkdown('ServiceNow ticket was created successfully.', t=hr_,\n                                     headers=headers, removeNull=True)\n\n    # make the modified fields the user inserted as arguments show in the context\n    if additional_fields:\n        additional_fields_keys = list(set(additional_fields_keys).union(set(args.keys())))\n    else:\n        additional_fields_keys = list(args.keys())\n\n    created_ticket_context = get_ticket_context(ticket, additional_fields_keys)\n    entry_context = {\n        'Ticket(val.ID===obj.ID)': created_ticket_context,\n        'ServiceNow.Ticket(val.ID===obj.ID)': created_ticket_context\n    }\n\n    return human_readable, entry_context, result, True\n\n\ndef delete_ticket_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Delete a ticket.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_id = str(args.get('id', ''))\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n\n    result = client.delete(ticket_type, ticket_id)\n\n    return f'Ticket with ID {ticket_id} was successfully deleted.', {}, result, True\n\n\ndef query_tickets_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Query tickets.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    sys_param_limit = args.get('limit', client.sys_param_limit)\n    sys_param_offset = args.get('offset', client.sys_param_offset)\n    sys_param_query = str(args.get('query', ''))\n    system_params = split_fields(args.get('system_params', ''))\n    additional_fields = argToList(str(args.get('additional_fields')))\n\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n\n    result = client.query(ticket_type, sys_param_limit, sys_param_offset, sys_param_query, system_params)\n\n    if not result or 'result' not in result or len(result['result']) == 0:\n        return 'No ServiceNow tickets matched the query.', {}, {}, True\n    tickets = result.get('result', {})\n    hr_ = get_ticket_human_readable(tickets, ticket_type, additional_fields)\n    context = get_ticket_context(tickets, additional_fields)\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code', 'Description', 'Opened At', 'Due Date', 'Resolved By',\n               'Resolved At', 'SLA Due', 'Short Description', 'Additional Comments']\n    if additional_fields:\n        headers.extend(additional_fields)\n    human_readable = tableToMarkdown('ServiceNow tickets', t=hr_, headers=headers, removeNull=True)\n    entry_context = {\n        'Ticket(val.ID===obj.ID)': context,\n        'ServiceNow.Ticket(val.ID===obj.ID)': context\n    }\n\n    return human_readable, entry_context, result, True\n\n\ndef add_link_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Add a link.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_id = str(args.get('id', ''))\n    key = 'comments' if args.get('post-as-comment', 'false').lower() == 'true' else 'work_notes'\n    link_argument = str(args.get('link', ''))\n    text = args.get('text', link_argument)\n    link = f'[code]\u003ca class=\"web\" target=\"_blank\" href=\"{link_argument}\" \u003e{text}\u003c/a\u003e[/code]'\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n\n    result = client.add_link(ticket_id, ticket_type, key, link)\n\n    if not result or 'result' not in result:\n        raise Exception('Unable to retrieve response.')\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code', 'Description', 'Opened At', 'Due Date', 'Resolved By',\n               'Resolved At', 'SLA Due', 'Short Description', 'Additional Comments']\n    hr_ = get_ticket_human_readable(result['result'], ticket_type)\n    human_readable = tableToMarkdown('Link successfully added to ServiceNow ticket', t=hr_,\n                                     headers=headers, removeNull=True)\n\n    return human_readable, {}, result, True\n\n\ndef add_comment_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Add a comment.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_id = str(args.get('id', ''))\n    key = 'comments' if args.get('post-as-comment', 'false').lower() == 'true' else 'work_notes'\n    text = str(args.get('comment', ''))\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n\n    result = client.add_comment(ticket_id, ticket_type, key, text)\n\n    if not result or 'result' not in result:\n        raise Exception('Unable to retrieve response.')\n\n    headers = ['System ID', 'Number', 'Impact', 'Urgency', 'Severity', 'Priority', 'State', 'Created On', 'Created By',\n               'Active', 'Close Notes', 'Close Code',\n               'Description', 'Opened At', 'Due Date', 'Resolved By', 'Resolved At', 'SLA Due', 'Short Description',\n               'Additional Comments']\n    hr_ = get_ticket_human_readable(result['result'], ticket_type)\n    human_readable = tableToMarkdown('Comment successfully added to ServiceNow ticket', t=hr_,\n                                     headers=headers, removeNull=True)\n\n    return human_readable, {}, result, True\n\n\ndef upload_file_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Upload a file.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n    ticket_id = str(args.get('id', ''))\n    file_id = str(args.get('file_id', ''))\n\n    file_name = args.get('file_name')\n    if not file_name:\n        file_data = demisto.getFilePath(file_id)\n        file_name = file_data.get('name')\n\n    result = client.upload_file(ticket_id, file_id, file_name, ticket_type)\n\n    if not result or 'result' not in result or not result['result']:\n        raise Exception('Unable to upload file.')\n    uploaded_file_resp = result.get('result', {})\n\n    hr_ = {\n        'Filename': uploaded_file_resp.get('file_name'),\n        'Download link': uploaded_file_resp.get('download_link'),\n        'System ID': uploaded_file_resp.get('sys_id')\n    }\n    human_readable = tableToMarkdown(f'File uploaded successfully to ticket {ticket_id}.', t=hr_)\n    context = {\n        'ID': ticket_id,\n        'File': {\n            'Filename': uploaded_file_resp.get('file_name'),\n            'Link': uploaded_file_resp.get('download_link'),\n            'SystemID': uploaded_file_resp.get('sys_id')\n        }\n    }\n    entry_context = {\n        'ServiceNow.Ticket(val.ID===obj.ID)': context,\n        'Ticket(val.ID===obj.ID)': context\n    }\n\n    return human_readable, entry_context, result, True\n\n\ndef add_tag_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Add tag to a ticket.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_id = str(args.get('id', ''))\n    tag_id = str(args.get('tag_id', ''))\n    title = str(args.get('title', ''))\n    ticket_type = client.get_table_name(str(args.get('ticket_type', '')))\n\n    result = client.add_tag(ticket_id, tag_id, title, ticket_type)\n    if not result or 'result' not in result:\n        raise Exception(f'Could not add tag {title} to ticket {ticket_id}.')\n\n    added_tag_resp = result.get('result', {})\n    hr_ = {\n        'Title': added_tag_resp.get('title'),\n        'Ticket ID': added_tag_resp.get('id_display'),\n        'Ticket Type': added_tag_resp.get('id_type'),\n        'Tag ID': added_tag_resp.get('sys_id'),\n    }\n    human_readable = tableToMarkdown(f'Tag {tag_id} was added successfully to ticket {ticket_id}.', t=hr_)\n    context = {\n        'ID': ticket_id,\n        'TagTitle': added_tag_resp.get('title'),\n        'TagID': added_tag_resp.get('sys_id'),\n    }\n    entry_context = {'ServiceNow.Ticket(val.ID===obj.ID)': context}\n\n    return human_readable, entry_context, result, True\n\n\ndef get_ticket_notes_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Get the ticket's note.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    ticket_id = args.get('id')\n    sys_param_limit = args.get('limit', client.sys_param_limit)\n    sys_param_offset = args.get('offset', client.sys_param_offset)\n\n    sys_param_query = f'element_id={ticket_id}^element=comments^ORelement=work_notes'\n\n    result = client.query('sys_journal_field', sys_param_limit, sys_param_offset, sys_param_query)\n\n    if not result or 'result' not in result:\n        return f'No comment found on ticket {ticket_id}.', {}, {}, True\n\n    headers = ['Value', 'CreatedOn', 'CreatedBy', 'Type']\n\n    mapped_notes = [{\n        'Value': note.get('value'),\n        'CreatedOn': note.get('sys_created_on'),\n        'CreatedBy': note.get('sys_created_by'),\n        'Type': 'Work Note' if note.get('element', '') == 'work_notes' else 'Comment'\n    } for note in result['result']]\n\n    if not mapped_notes:\n        return f'No comment found on ticket {ticket_id}.', {}, {}, True\n\n    ticket = {\n        'ID': ticket_id,\n        'Note': mapped_notes\n    }\n\n    human_readable = tableToMarkdown(f'ServiceNow notes for ticket {ticket_id}', t=mapped_notes, headers=headers,\n                                     headerTransform=pascalToSpace, removeNull=True)\n    entry_context = {'ServiceNow.Ticket(val.ID===obj.ID)': createContext(ticket, removeNull=True)}\n\n    return human_readable, entry_context, result, True\n\n\ndef get_record_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Get a record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = str(args.get('table_name', ''))\n    record_id = str(args.get('id', ''))\n    fields = str(args.get('fields', ''))\n\n    result = client.get(table_name, record_id)\n\n    if not result or 'result' not in result:\n        return f'ServiceNow record with ID {record_id} was not found.', {}, {}, True\n\n    if isinstance(result['result'], list):\n        if len(result['result']) == 0:\n            return f'ServiceNow record with ID {record_id} was not found.', {}, result, True\n        record = result['result'][0]\n    else:\n        record = result['result']\n\n    if fields:\n        list_fields = argToList(fields)\n        if 'sys_id' not in list_fields:\n            # ID is added by default\n            list_fields.append('sys_id')\n        # filter the record for the required fields\n        record = dict([kv_pair for kv_pair in list(record.items()) if kv_pair[0] in list_fields])\n        for k, v in record.items():\n            if isinstance(v, dict):\n                # For objects that refer to a record in the database, take their value(system ID).\n                record[k] = v.get('value', record[k])\n        record['ID'] = record.pop('sys_id')\n        human_readable = tableToMarkdown('ServiceNow record', record, removeNull=True)\n        entry_context = {'ServiceNow.Record(val.ID===obj.ID)': createContext(record)}\n    else:\n        mapped_record = {DEFAULT_RECORD_FIELDS[k]: record[k] for k in DEFAULT_RECORD_FIELDS if k in record}\n        human_readable = tableToMarkdown(f'ServiceNow record {record_id}', mapped_record, removeNull=True)\n        entry_context = {'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_record)}\n\n    return human_readable, entry_context, result, True\n\n\ndef create_record_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Any, bool]:\n    \"\"\"Create a record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = str(args.get('table_name', ''))\n    fields_str = str(args.get('fields', ''))\n    custom_fields_str = str(args.get('custom_fields', ''))\n    input_display_value = argToBoolean(args.get('input_display_value', 'false'))\n    fields_delimiter = args.get('fields_delimiter', ';')\n\n    fields = {}\n    if fields_str:\n        fields = split_fields(fields_str, fields_delimiter)\n    custom_fields = {}\n    if custom_fields_str:\n        custom_fields = split_fields(custom_fields_str, fields_delimiter)\n\n    result = client.create(table_name, fields, custom_fields, input_display_value)\n\n    if not result or 'result' not in result:\n        return 'Could not create record.', {}, {}, True\n\n    record = result.get('result', {})\n    mapped_record = {DEFAULT_RECORD_FIELDS[k]: record[k] for k in DEFAULT_RECORD_FIELDS if k in record}\n\n    human_readable = tableToMarkdown('ServiceNow record created successfully', mapped_record, removeNull=True)\n    entry_context = {'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_record)}\n\n    return human_readable, entry_context, result, True\n\n\ndef update_record_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Update a record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = str(args.get('table_name', ''))\n    record_id = str(args.get('id', ''))\n    fields_str = str(args.get('fields', ''))\n    custom_fields_str = str(args.get('custom_fields', ''))\n    input_display_value = argToBoolean(args.get('input_display_value', 'false'))\n    fields_delimiter = args.get('fields_delimiter', ';')\n\n    fields = {}\n    if fields_str:\n        fields = split_fields(fields_str, fields_delimiter)\n    custom_fields = {}\n    if custom_fields_str:\n        custom_fields = split_fields(custom_fields_str, fields_delimiter)\n\n    result = client.update(table_name, record_id, fields, custom_fields, input_display_value)\n\n    if not result or 'result' not in result:\n        return 'Could not retrieve record.', {}, {}, True\n\n    record = result.get('result', {})\n    mapped_record = {DEFAULT_RECORD_FIELDS[k]: record[k] for k in DEFAULT_RECORD_FIELDS if k in record}\n    human_readable = tableToMarkdown(f'ServiceNow record with ID {record_id} updated successfully',\n                                     t=mapped_record, removeNull=True)\n    entry_context = {'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_record)}\n\n    return human_readable, entry_context, result, True\n\n\ndef delete_record_command(client: Client, args: dict) -\u003e Tuple[str, Dict[Any, Any], Dict, bool]:\n    \"\"\"Delete a record.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    record_id = str(args.get('id', ''))\n    table_name = str(args.get('table_name', ''))\n\n    result = client.delete(table_name, record_id)\n\n    return f'ServiceNow record with ID {record_id} was successfully deleted.', {}, result, True\n\n\ndef query_table_command(client: Client, args: dict) -\u003e Tuple[str, Dict, Dict, bool]:\n    \"\"\"Query a table.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = str(args.get('table_name', ''))\n    sys_param_limit = args.get('limit', client.sys_param_limit)\n    sys_param_query = str(args.get('query', ''))\n    system_params = split_fields(args.get('system_params', ''))\n    sys_param_offset = args.get('offset', client.sys_param_offset)\n    fields = args.get('fields')\n\n    result = client.query(table_name, sys_param_limit, sys_param_offset, sys_param_query, system_params)\n    if not result or 'result' not in result or len(result['result']) == 0:\n        return 'No results found', {}, {}, False\n    table_entries = result.get('result', {})\n\n    if fields:\n        fields = argToList(fields)\n        if 'sys_id' not in fields:\n            # ID is added by default\n            fields.append('sys_id')\n        # Filter the records according to the given fields\n        records = [dict([kv_pair for kv_pair in iter(r.items()) if kv_pair[0] in fields]) for r in table_entries]\n        for record in records:\n            record['ID'] = record.pop('sys_id')\n            for k, v in record.items():\n                if isinstance(v, dict):\n                    # For objects that refer to a record in the database, take their value (system ID).\n                    record[k] = v.get('value', v)\n        human_readable = tableToMarkdown('ServiceNow records', records, removeNull=True)\n        entry_context = {'ServiceNow.Record(val.ID===obj.ID)': createContext(records)}\n    else:\n        mapped_records = [{DEFAULT_RECORD_FIELDS[k]: r[k] for k in DEFAULT_RECORD_FIELDS if k in r}\n                          for r in table_entries]\n        human_readable = tableToMarkdown('ServiceNow records', mapped_records, removeNull=True)\n        entry_context = {'ServiceNow.Record(val.ID===obj.ID)': createContext(mapped_records)}\n\n    return human_readable, entry_context, result, False\n\n\ndef query_computers_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Query computers.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = 'cmdb_ci_computer'\n    computer_id = args.get('computer_id', None)\n    computer_name = args.get('computer_name', None)\n    asset_tag = args.get('asset_tag', None)\n    computer_query = args.get('query', {})\n    offset = args.get('offset', client.sys_param_offset)\n    limit = args.get('limit', client.sys_param_limit)\n\n    if computer_id:\n        result = client.get(table_name, computer_id)\n    else:\n        if computer_name:\n            computer_query = f'name={computer_name}'\n        elif asset_tag:\n            computer_query = f'asset_tag={asset_tag}'\n\n        result = client.query(table_name, limit, offset, computer_query)\n\n    if not result or 'result' not in result:\n        return 'No computers found.', {}, {}, False\n\n    computers = result.get('result', {})\n    if not isinstance(computers, list):\n        computers = [computers]\n\n    if len(computers) == 0:\n        return 'No computers found.', {}, {}, False\n\n    computer_statuses = {\n        '1': 'In use',\n        '2': 'On order',\n        '3': 'On maintenance',\n        '6': 'In stock/In transit',\n        '7': 'Retired',\n        '100': 'Missing'\n    }\n\n    mapped_computers = [{\n        'ID': computer.get('sys_id'),\n        'AssetTag': computer.get('asset_tag'),\n        'Name': computer.get('name'),\n        'DisplayName': f\"{computer.get('asset_tag', '')} - {computer.get('name', '')}\",\n        'SupportGroup': computer.get('support_group'),\n        'OperatingSystem': computer.get('os'),\n        'Company': computer.get('company', {}).get('value')\n        if isinstance(computer.get('company'), dict) else computer.get('company'),\n        'AssignedTo': computer.get('assigned_to', {}).get('value')\n        if isinstance(computer.get('assigned_to'), dict) else computer.get('assigned_to'),\n        'State': computer_statuses.get(computer.get('install_status', ''), computer.get('install_status')),\n        'Cost': f\"{computer.get('cost', '').rstrip()} {computer.get('cost_cc', '').rstrip()}\",\n        'Comments': computer.get('comments')\n    } for computer in computers]\n\n    headers = ['ID', 'AssetTag', 'Name', 'DisplayName', 'SupportGroup', 'OperatingSystem', 'Company', 'AssignedTo',\n               'State', 'Cost', 'Comments']\n    human_readable = tableToMarkdown('ServiceNow Computers', t=mapped_computers, headers=headers,\n                                     removeNull=True, headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.Computer(val.ID===obj.ID)': createContext(mapped_computers, removeNull=True)}\n\n    return human_readable, entry_context, result, False\n\n\ndef query_groups_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Query groups.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = 'sys_user_group'\n    group_id = args.get('group_id')\n    group_name = args.get('group_name')\n    group_query = args.get('query', {})\n    offset = args.get('offset', client.sys_param_offset)\n    limit = args.get('limit', client.sys_param_limit)\n\n    if group_id:\n        result = client.get(table_name, group_id)\n    else:\n        if group_name:\n            group_query = f'name={group_name}'\n        result = client.query(table_name, limit, offset, group_query)\n\n    if not result or 'result' not in result:\n        return 'No groups found.', {}, {}, False\n\n    groups = result.get('result', {})\n    if not isinstance(groups, list):\n        groups = [groups]\n\n    if len(groups) == 0:\n        return 'No groups found.', {}, {}, False\n\n    headers = ['ID', 'Description', 'Name', 'Active', 'Manager', 'Updated']\n\n    mapped_groups = [{\n        'ID': group.get('sys_id'),\n        'Description': group.get('description'),\n        'Name': group.get('name'),\n        'Active': group.get('active'),\n        'Manager': group.get('manager', {}).get('value')\n        if isinstance(group.get('manager'), dict) else group.get('manager'),\n        'Updated': group.get('sys_updated_on'),\n    } for group in groups]\n\n    human_readable = tableToMarkdown('ServiceNow Groups', t=mapped_groups, headers=headers,\n                                     removeNull=True, headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.Group(val.ID===obj.ID)': createContext(mapped_groups, removeNull=True)}\n\n    return human_readable, entry_context, result, False\n\n\ndef query_users_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Query users.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = 'sys_user'\n    user_id = args.get('user_id')\n    user_name = args.get('user_name')\n    user_query = args.get('query', {})\n    offset = args.get('offset', client.sys_param_offset)\n    limit = args.get('limit', client.sys_param_limit)\n\n    if user_id:\n        result = client.get(table_name, user_id)\n    else:\n        if user_name:\n            user_query = f'user_name={user_name}'\n        result = client.query(table_name, limit, offset, user_query)\n\n    if not result or 'result' not in result:\n        return 'No users found.', {}, {}, False\n\n    users = result.get('result', {})\n    if not isinstance(users, list):\n        users = [users]\n\n    if len(users) == 0:\n        return 'No users found.', {}, {}, False\n\n    mapped_users = [{\n        'ID': user.get('sys_id'),\n        'Name': f\"{user.get('first_name', '').rstrip()} {user.get('last_name', '').rstrip()}\",\n        'UserName': user.get('user_name'),\n        'Email': user.get('email'),\n        'Created': user.get('sys_created_on'),\n        'Updated': user.get('sys_updated_on'),\n    } for user in users]\n\n    headers = ['ID', 'Name', 'UserName', 'Email', 'Created', 'Updated']\n    human_readable = tableToMarkdown('ServiceNow Users', t=mapped_users, headers=headers, removeNull=True,\n                                     headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.User(val.ID===obj.ID)': createContext(mapped_users, removeNull=True)}\n\n    return human_readable, entry_context, result, False\n\n\ndef list_table_fields_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"List table fields.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = str(args.get('table_name', ''))\n\n    result = client.get_table_fields(table_name)\n\n    if not result or 'result' not in result:\n        return 'Table was not found.', {}, {}, False\n\n    if len(result['result']) == 0:\n        return 'Table contains no records.', {}, {}, False\n\n    fields = [{'Name': k} for k, v in result['result'][0].items()]\n\n    human_readable = tableToMarkdown(f'ServiceNow Table fields - {table_name}', fields)\n    entry_context = {'ServiceNow.Field': createContext(fields)}\n\n    return human_readable, entry_context, result, False\n\n\ndef get_table_name_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"List table fields.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    label = args.get('label')\n    offset = args.get('offset', client.sys_param_offset)\n    limit = args.get('limit', client.sys_param_limit)\n    table_query = f'label={label}'\n\n    result = client.query('sys_db_object', limit, offset, table_query)\n\n    if not result or 'result' not in result:\n        return 'Table was not found.', {}, {}, False\n    tables = result.get('result', {})\n    if len(tables) == 0:\n        return 'Table was not found.', {}, {}, False\n\n    headers = ['ID', 'Name', 'SystemName']\n\n    mapped_tables = [{\n        'ID': table.get('sys_id'),\n        'Name': table.get('name'),\n        'SystemName': table.get('sys_name')\n    } for table in tables]\n\n    human_readable = tableToMarkdown(f'ServiceNow Tables for label - {label}', t=mapped_tables,\n                                     headers=headers, headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.Table(val.ID===obj.ID)': createContext(mapped_tables)}\n\n    return human_readable, entry_context, result, False\n\n\ndef query_items_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Query items.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    table_name = 'sc_cat_item'\n    limit = args.get('limit', client.sys_param_limit)\n    offset = args.get('offset', client.sys_param_offset)\n    name = str(args.get('name', ''))\n    items_query = f'nameLIKE{name}' if name else ''\n\n    result = client.query(table_name, limit, offset, items_query)\n    if not result or 'result' not in result:\n        return 'No items were found.', {}, {}, True\n    items = result.get('result', {})\n    if not isinstance(items, list):\n        items_list = [items]\n    else:\n        items_list = items\n    if len(items_list) == 0:\n        return 'No items were found.', {}, {}, True\n\n    mapped_items = []\n    for item in items_list:\n        mapped_items.append(get_item_human_readable(item))\n\n    headers = ['ID', 'Name', 'Price', 'Description']\n    human_readable = tableToMarkdown('ServiceNow Catalog Items', mapped_items, headers=headers,\n                                     removeNull=True, headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.CatalogItem(val.ID===obj.ID)': createContext(mapped_items, removeNull=True)}\n\n    return human_readable, entry_context, result, True\n\n\ndef get_item_details_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Get item details.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    id_ = str(args.get('id', ''))\n    result = client.get_item_details(id_)\n    if not result or 'result' not in result:\n        return 'Item was not found.', {}, {}, True\n    item = result.get('result', {})\n    mapped_item = get_item_human_readable(item)\n\n    human_readable = tableToMarkdown('ServiceNow Catalog Item', t=mapped_item, headers=['ID', 'Name', 'Description'],\n                                     removeNull=True, headerTransform=pascalToSpace)\n    if mapped_item.get('Variables'):\n        human_readable += tableToMarkdown('Item Variables', t=mapped_item.get('Variables'),\n                                          headers=['Question', 'Type', 'Name', 'Mandatory'],\n                                          removeNull=True, headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.CatalogItem(val.ID===obj.ID)': createContext(mapped_item, removeNull=True)}\n    return human_readable, entry_context, result, True\n\n\ndef create_order_item_command(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Create item order.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    id_ = str(args.get('id', ''))\n    quantity = str(args.get('quantity', '1'))\n    variables = split_fields(str(args.get('variables', '')))\n\n    result = client.create_item_order(id_, quantity, variables)\n    if not result or 'result' not in result:\n        return 'Order item was not created.', {}, {}, True\n    order_item = result.get('result', {})\n\n    mapped_item = {\n        'ID': order_item.get('sys_id'),\n        'RequestNumber': order_item.get('request_number')\n    }\n    human_readable = tableToMarkdown('ServiceNow Order Request', mapped_item,\n                                     removeNull=True, headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.OrderRequest(val.ID===obj.ID)': createContext(mapped_item, removeNull=True)}\n\n    return human_readable, entry_context, result, True\n\n\ndef document_route_to_table(client: Client, args: dict) -\u003e Tuple[Any, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"Document routes to table.\n\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    queue_id = str(args.get('queue_id', ''))\n    document_table = str(args.get('document_table', ''))\n    document_id = str(args.get('document_id', ''))\n\n    result = client.document_route_to_table_request(queue_id, document_table, document_id)\n    if not result or 'result' not in result:\n        return 'Route to table was not found.', {}, {}, True\n\n    route = result.get('result', {})\n    context = {\n        'DisplayName': route.get('display_name'),\n        'DocumentID': route.get('document_id'),\n        'DocumentTable': route.get('document_table'),\n        'QueueID': route.get('queue'),\n        'WorkItemID': route.get('sys_id')\n    }\n\n    headers = ['DisplayName', 'DocumentID', 'DocumentTable', 'QueueID', 'WorkItemID']\n    human_readable = tableToMarkdown('ServiceNow Queue', t=context, headers=headers, removeNull=True,\n                                     headerTransform=pascalToSpace)\n    entry_context = {'ServiceNow.WorkItem(val.WorkItemID===obj.WorkItemID)': createContext(context, removeNull=True)}\n\n    return human_readable, entry_context, result, True\n\n\ndef fetch_incidents(client: Client) -\u003e list:\n    query_params = {}\n    incidents = []\n\n    last_run = demisto.getLastRun()\n    if 'time' not in last_run:\n        snow_time, _ = parse_date_range(client.fetch_time, '%Y-%m-%d %H:%M:%S')\n    else:\n        snow_time = last_run['time']\n\n    query = ''\n    if client.sys_param_query:\n        query += f'{client.sys_param_query}^'\n    query += f'ORDERBY{client.timestamp_field}^{client.timestamp_field}\u003e{snow_time}'\n\n    if query:\n        query_params['sysparm_query'] = query\n    query_params['sysparm_limit'] = str(client.sys_param_limit)\n\n    demisto.info(f'Fetching ServiceNow incidents. with the query params: {str(query_params)}')\n    res = client.send_request(f'table/{client.ticket_type}', 'GET', params=query_params)\n\n    count = 0\n    parsed_snow_time = datetime.strptime(snow_time, '%Y-%m-%d %H:%M:%S')\n\n    severity_map = {'1': 3, '2': 2, '3': 1}  # Map SNOW severity to Demisto severity for incident creation\n\n    for result in res.get('result', []):\n        labels = []\n\n        result['mirror_direction'] = MIRROR_DIRECTION.get(demisto.params().get('mirror_direction'))\n        result['mirror_tags'] = [\n            demisto.params().get('comment_tag'),\n            demisto.params().get('file_tag'),\n            demisto.params().get('work_notes_tag')\n        ]\n        result['mirror_instance'] = demisto.integrationInstance()\n\n        if client.timestamp_field not in result:\n            raise ValueError(f\"The timestamp field [{client.timestamp_field}] does not exist in the ticket\")\n\n        if count \u003e client.sys_param_limit:\n            break\n\n        try:\n            if datetime.strptime(result[client.timestamp_field], '%Y-%m-%d %H:%M:%S') \u003c parsed_snow_time:\n                continue\n        except Exception:\n            pass\n\n        for k, v in result.items():\n            if isinstance(v, str):\n                labels.append({\n                    'type': k,\n                    'value': v\n                })\n            else:\n                labels.append({\n                    'type': k,\n                    'value': json.dumps(v)\n                })\n\n        severity = severity_map.get(result.get('severity', ''), 0)\n\n        file_names = []\n        if client.get_attachments:\n            file_entries = client.get_ticket_attachment_entries(result.get('sys_id', ''))\n            if isinstance(file_entries, list):\n                for file_result in file_entries:\n                    if file_result['Type'] == entryTypes['error']:\n                        raise Exception(f\"Error getting attachment: {str(file_result.get('Contents', ''))}\")\n                    file_names.append({\n                        'path': file_result.get('FileID', ''),\n                        'name': file_result.get('File', '')\n                    })\n\n        incidents.append({\n            'name': f\"ServiceNow Incident {result.get(client.incident_name)}\",\n            'labels': labels,\n            'details': json.dumps(result),\n            'severity': severity,\n            'attachment': file_names,\n            'rawJSON': json.dumps(result)\n        })\n\n        count += 1\n        snow_time = result.get(client.timestamp_field)\n\n    demisto.setLastRun({'time': snow_time})\n    return incidents\n\n\ndef test_instance(client: Client):\n    \"\"\"\n    The function that executes the logic for the instance testing. If the instance wasn't configured correctly, this\n    function will raise an exception and cause the test_module/oauth_test_module function to fail.\n    \"\"\"\n    # Validate fetch_time parameter is valid (if not, parse_date_range will raise the error message)\n    parse_date_range(client.fetch_time, '%Y-%m-%d %H:%M:%S')\n\n    result = client.send_request(f'table/{client.ticket_type}', params={'sysparm_limit': 1}, method='GET')\n    if 'result' not in result:\n        raise Exception('ServiceNow error: ' + str(result))\n    ticket = result.get('result')\n    if ticket and demisto.params().get('isFetch'):\n        if isinstance(ticket, list):\n            ticket = ticket[0]\n        if client.timestamp_field not in ticket:\n            raise ValueError(f\"The timestamp field [{client.timestamp_field}] does not exist in the ticket.\")\n        if client.incident_name not in ticket:\n            raise ValueError(f\"The field [{client.incident_name}] does not exist in the ticket.\")\n\n\ndef test_module(client: Client, *_) -\u003e Tuple[str, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"\n    Test the instance configurations when using basic authorization.\n    \"\"\"\n    # Notify the user that test button can't be used when using OAuth 2.0:\n    if client.use_oauth:\n        raise Exception('Test button cannot be used when using OAuth 2.0. Please use the !servicenow-oauth-login '\n                        'command followed by the !servicenow-oauth-test command to test the instance.')\n\n    if client._version == 'v2' and client.get_attachments:\n        raise DemistoException('Retrieving incident attachments is not supported when using the V2 API.')\n\n    test_instance(client)\n    return 'ok', {}, {}, True\n\n\ndef oauth_test_module(client: Client, *_) -\u003e Tuple[str, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"\n    Test the instance configurations when using OAuth authentication.\n    \"\"\"\n    if not client.use_oauth:\n        raise Exception('!servicenow-oauth-test command should be used only when using OAuth 2.0 authorization.\\n '\n                        'Please select the `Use OAuth Login` checkbox in the instance configuration before running '\n                        'this command.')\n\n    test_instance(client)\n    hr = '### Instance Configured Successfully.\\n'\n    return hr, {}, {}, True\n\n\ndef login_command(client: Client, args: Dict[str, Any]) -\u003e Tuple[str, Dict[Any, Any], Dict[Any, Any], bool]:\n    \"\"\"\n    Login the user using OAuth authorization\n    Args:\n        client: Client object with request.\n        args: Usually demisto.args()\n\n    Returns:\n        Demisto Outputs.\n    \"\"\"\n    # Verify that the user checked the `Use OAuth` checkbox:\n    if not client.use_oauth:\n        raise Exception('!servicenow-oauth-login command can be used only when using OAuth 2.0 authorization.\\n Please '\n                        'select the `Use OAuth Login` checkbox in the instance configuration before running this '\n                        'command.')\n\n    username = args.get('username', '')\n    password = args.get('password', '')\n    try:\n        client.snow_client.login(username, password)\n        hr = '### Logged in successfully.\\n A refresh token was saved to the integration context. This token will be ' \\\n             'used to generate a new access token once the current one expires.'\n    except Exception as e:\n        return_error(f'Failed to login. Please verify that the provided username and password are correct, and that you '\n                     f'entered the correct client id and client secret in the instance configuration (see ? for'\n                     f'correct usage when using OAuth).\\n\\n{e}')\n    return hr, {}, {}, True\n\n\ndef get_remote_data_command(client: Client, args: Dict[str, Any], params: Dict) -\u003e Union[List[Dict[str, Any]], str]:\n    \"\"\"\n    get-remote-data command: Returns an updated incident and entries\n    Args:\n        client: XSOAR client to use\n        args:\n            id: incident id to retrieve\n            lastUpdate: when was the last time we retrieved data\n\n    Returns:\n        List[Dict[str, Any]]: first entry is the incident (which can be completely empty) and the new entries.\n    \"\"\"\n\n    ticket_id = args.get('id', '')\n    demisto.debug(f'Getting update for remote {ticket_id}')\n    last_update = arg_to_timestamp(\n        arg=args.get('lastUpdate'),\n        arg_name='lastUpdate',\n        required=True\n    )\n    demisto.debug(f'last_update is {last_update}')\n\n    ticket_type = client.ticket_type\n    result = client.get(ticket_type, ticket_id)\n\n    if not result or 'result' not in result:\n        return 'Ticket was not found.'\n\n    if isinstance(result['result'], list):\n        if len(result['result']) == 0:\n            return 'Ticket was not found.'\n\n        ticket = result['result'][0]\n\n    else:\n        ticket = result['result']\n\n    ticket_last_update = arg_to_timestamp(\n        arg=ticket.get('sys_updated_on'),\n        arg_name='sys_updated_on',\n        required=False\n    )\n\n    demisto.debug(f'ticket_last_update is {ticket_last_update}')\n\n    if last_update \u003e ticket_last_update:\n        demisto.debug('Nothing new in the ticket')\n        ticket = {}\n\n    else:\n        demisto.debug(f'ticket is updated: {ticket}')\n\n    # get latest comments and files\n    entries = []\n    file_entries = client.get_ticket_attachment_entries(ticket_id, datetime.fromtimestamp(last_update))  # type: ignore\n    if file_entries:\n        for file in file_entries:\n            if '_mirrored_from_xsoar' not in file.get('File'):\n                entries.append(file)\n\n    sys_param_limit = args.get('limit', client.sys_param_limit)\n    sys_param_offset = args.get('offset', client.sys_param_offset)\n\n    sys_param_query = f'element_id={ticket_id}^sys_created_on\u003e' \\\n        f'{datetime.fromtimestamp(last_update)}^element=comments^ORelement=work_notes'\n\n    comments_result = client.query('sys_journal_field', sys_param_limit, sys_param_offset, sys_param_query)\n    demisto.debug(f'Comments result is {comments_result}')\n\n    if not comments_result or 'result' not in comments_result:\n        demisto.debug(f'Pull result is {ticket}')\n        return [ticket] + entries\n\n    for note in comments_result.get('result', []):\n        if 'Mirrored from Cortex XSOAR' not in note.get('value'):\n            comments_context = {'comments_and_work_notes': note.get('value')}\n            entries.append({\n                'Type': note.get('type'),\n                'Category': note.get('category'),\n                'Contents': note.get('value'),\n                'ContentsFormat': note.get('format'),\n                'Tags': note.get('tags'),\n                'Note': True,\n                'EntryContext': comments_context\n            })\n    # Parse user dict to email\n    assigned_to = ticket.get('assigned_to', {})\n    caller = ticket.get('caller_id', {})\n    assignment_group = ticket.get('assignment_group', {})\n\n    if assignment_group:\n        group_result = client.get('sys_user_group', assignment_group.get('value'))\n        group = group_result.get('result', {})\n        group_name = group.get('name')\n        ticket['assignment_group'] = group_name\n\n    if assigned_to:\n        user_result = client.get('sys_user', assigned_to.get('value'))\n        user = user_result.get('result', {})\n        user_email = user.get('email')\n        ticket['assigned_to'] = user_email\n\n    if caller:\n        user_result = client.get('sys_user', caller.get('value'))\n        user = user_result.get('result', {})\n        user_email = user.get('email')\n        ticket['caller_id'] = user_email\n\n    if ticket.get('resolved_by') or ticket.get('closed_at'):\n        if params.get('close_incident'):\n            demisto.debug(f'ticket is closed: {ticket}')\n            entries.append({\n                'Type': EntryType.NOTE,\n                'Contents': {\n                    'dbotIncidentClose': True,\n                    'closeReason': f'From ServiceNow: {ticket.get(\"close_notes\")}'\n                },\n                'ContentsFormat': EntryFormat.JSON\n            })\n\n    demisto.debug(f'Pull result is {ticket}')\n    return [ticket] + entries\n\n\ndef update_remote_system_command(client: Client, args: Dict[str, Any], params: Dict[str, Any]) -\u003e str:\n    \"\"\"\n    This command pushes local changes to the remote system.\n    Args:\n        client:  XSOAR Client to use.\n        args:\n            args['data']: the data to send to the remote system\n            args['entries']: the entries to send to the remote system\n            args['incident_changed']: boolean telling us if the local incident indeed changed or not\n            args['remote_incident_id']: the remote incident id\n        params:\n            entry_tags: the tags to pass to the entries (to separate between comments and work_notes)\n\n    Returns: The remote incident id - ticket_id\n\n    \"\"\"\n    parsed_args = UpdateRemoteSystemArgs(args)\n    if parsed_args.delta:\n        demisto.debug(f'Got the following delta keys {str(list(parsed_args.delta.keys()))}')\n\n    ticket_type = client.ticket_type\n    ticket_id = parsed_args.remote_incident_id\n    if parsed_args.incident_changed:\n        demisto.debug(f'Incident changed: {parsed_args.incident_changed}')\n        # Closing sc_type ticket. This ticket type can be closed only when changing the ticket state.\n        if (ticket_type == 'sc_task' or ticket_type == 'sc_req_item')\\\n                and parsed_args.inc_status == IncidentStatus.DONE and params.get('close_ticket'):\n            parsed_args.data['state'] = '3'\n        # Closing incident ticket.\n        if ticket_type == 'incident' and parsed_args.inc_status == IncidentStatus.DONE and params.get('close_ticket'):\n            parsed_args.data['state'] = '7'\n\n        fields = get_ticket_fields(parsed_args.data, ticket_type=ticket_type)\n        if not params.get('close_ticket'):\n            fields = {key: val for key, val in fields.items() if key != 'closed_at' and key != 'resolved_at'}\n\n        demisto.debug(f'Sending update request to server {ticket_type}, {ticket_id}, {fields}')\n        result = client.update(ticket_type, ticket_id, fields)\n\n        demisto.info(f'Ticket Update result {result}')\n\n    entries = parsed_args.entries\n    if entries:\n        demisto.debug(f'New entries {entries}')\n\n        for entry in entries:\n            demisto.debug(f'Sending entry {entry.get(\"id\")}, type: {entry.get(\"type\")}')\n            # Mirroring files as entries\n            if entry.get('type') == 3:\n                path_res = demisto.getFilePath(entry.get('id'))\n                full_file_name = path_res.get('name')\n                file_name, file_extension = os.path.splitext(full_file_name)\n                if not file_extension:\n                    file_extension = ''\n                client.upload_file(ticket_id, entry.get('id'), file_name + '_mirrored_from_xsoar' + file_extension,\n                                   ticket_type)\n            else:\n                # Mirroring comment and work notes as entries\n                tags = entry.get('tags', [])\n                key = ''\n                if params.get('work_notes_tag') in tags:\n                    key = 'work_notes'\n                elif params.get('comment_tag') in tags:\n                    key = 'comments'\n                user = entry.get('user', 'dbot')\n                text = f\"({user}): {str(entry.get('contents', ''))}\\n\\n Mirrored from Cortex XSOAR\"\n                client.add_comment(ticket_id, ticket_type, key, text)\n\n    return ticket_id\n\n\ndef get_mapping_fields_command(client: Client) -\u003e GetMappingFieldsResponse:\n    \"\"\"\n    Returns the list of fields for an incident type.\n    Args:\n        client: XSOAR client to use\n\n    Returns: Dictionary with keys as field names\n\n    \"\"\"\n\n    incident_type_scheme = SchemeTypeMapping(type_name=client.ticket_type)\n    demisto.debug(f'Collecting incident mapping for incident type - \"{client.ticket_type}\"')\n\n    for field in SNOW_ARGS:\n        incident_type_scheme.add_field(field)\n\n    mapping_response = GetMappingFieldsResponse()\n    mapping_response.add_scheme_type(incident_type_scheme)\n\n    return mapping_response\n\n\ndef get_modified_remote_data_command(\n        client: Client,\n        args: Dict[str, str],\n        update_timestamp_field: str = 'sys_updated_on',\n        mirror_limit: str = '100',\n) -\u003e GetModifiedRemoteDataResponse:\n    remote_args = GetModifiedRemoteDataArgs(args)\n    last_update = dateparser.parse(remote_args.last_update, settings={'TIMEZONE': 'UTC'}).strftime('%Y-%m-%d %H:%M:%S')\n\n    demisto.debug(f'Running get-modified-remote-data command. Last update is: {last_update}')\n\n    result = client.query(\n        table_name=client.ticket_type,\n        sys_param_limit=mirror_limit,\n        sys_param_offset=str(client.sys_param_offset),\n        sys_param_query=f'{update_timestamp_field}\u003e{last_update}',\n        sysparm_fields='sys_id',\n    )\n\n    modified_records_ids = []\n\n    if result and (modified_records := result.get('result')):\n        modified_records_ids = [record.get('sys_id') for record in modified_records if 'sys_id' in record]\n\n    return GetModifiedRemoteDataResponse(modified_records_ids)\n\n\ndef main():\n    \"\"\"\n    PARSE AND VALIDATE INTEGRATION PARAMS\n    \"\"\"\n    command = demisto.command()\n    LOG(f'Executing command {command}')\n\n    params = demisto.params()\n    verify = not params.get('insecure', False)\n    use_oauth = params.get('use_oauth', False)\n    oauth_params = {}\n\n    if use_oauth:  # if the `Use OAuth` checkbox was checked, client id \u0026 secret should be in the credentials fields\n        username = ''\n        password = ''\n        client_id = params.get('credentials', {}).get('identifier')\n        client_secret = params.get('credentials', {}).get('password')\n        oauth_params = {\n            'credentials': {\n                'identifier': username,\n                'password': password\n            },\n            'client_id': client_id,\n            'client_secret': client_secret,\n            'url': params.get('url'),\n            'headers': {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            'verify': verify,\n            'proxy': params.get('proxy'),\n            'use_oauth': use_oauth\n        }\n    else:  # use basic authentication\n        username = params.get('credentials', {}).get('identifier')\n        password = params.get('credentials', {}).get('password')\n\n    version = params.get('api_version')\n    if version:\n        api = f'/api/now/{version}/'\n        sc_api = f'/api/sn_sc/{version}/'\n    else:\n        api = '/api/now/'\n        sc_api = '/api/sn_sc/'\n    server_url = params.get('url')\n    sc_server_url = f'{get_server_url(server_url)}{sc_api}'\n    server_url = f'{get_server_url(server_url)}{api}'\n\n    fetch_time = params.get('fetch_time', '10 minutes').strip()\n    sysparm_query = params.get('sysparm_query')\n    sysparm_limit = int(params.get('fetch_limit', 10))\n    timestamp_field = params.get('timestamp_field', 'opened_at')\n    ticket_type = params.get('ticket_type', 'incident')\n    incident_name = params.get('incident_name', 'number') or 'number'\n    get_attachments = params.get('get_attachments', False)\n    update_timestamp_field = params.get('update_timestamp_field', 'sys_updated_on') or 'sys_updated_on'\n    mirror_limit = params.get('mirror_limit', '100') or '100'\n\n    raise_exception = False\n    try:\n        client = Client(server_url=server_url, sc_server_url=sc_server_url, username=username, password=password,\n                        verify=verify, fetch_time=fetch_time, sysparm_query=sysparm_query, sysparm_limit=sysparm_limit,\n                        timestamp_field=timestamp_field, ticket_type=ticket_type, get_attachments=get_attachments,\n                        incident_name=incident_name, oauth_params=oauth_params, version=version)\n        commands: Dict[str, Callable[[Client, Dict[str, str]], Tuple[str, Dict[Any, Any], Dict[Any, Any], bool]]] = {\n            'test-module': test_module,\n            'servicenow-oauth-test': oauth_test_module,\n            'servicenow-oauth-login': login_command,\n            'servicenow-update-ticket': update_ticket_command,\n            'servicenow-create-ticket': create_ticket_command,\n            'servicenow-delete-ticket': delete_ticket_command,\n            'servicenow-query-tickets': query_tickets_command,\n            'servicenow-add-link': add_link_command,\n            'servicenow-add-comment': add_comment_command,\n            'servicenow-upload-file': upload_file_command,\n            'servicenow-add-tag': add_tag_command,\n            'servicenow-get-ticket-notes': get_ticket_notes_command,\n            'servicenow-get-record': get_record_command,\n            'servicenow-update-record': update_record_command,\n            'servicenow-create-record': create_record_command,\n            'servicenow-delete-record': delete_record_command,\n            'servicenow-query-table': query_table_command,\n            'servicenow-list-table-fields': list_table_fields_command,\n            'servicenow-query-computers': query_computers_command,\n            'servicenow-query-groups': query_groups_command,\n            'servicenow-query-users': query_users_command,\n            'servicenow-get-table-name': get_table_name_command,\n            'servicenow-query-items': query_items_command,\n            'servicenow-get-item-details': get_item_details_command,\n            'servicenow-create-item-order': create_order_item_command,\n            'servicenow-document-route-to-queue': document_route_to_table,\n        }\n        args = demisto.args()\n        if command == 'fetch-incidents':\n            raise_exception = True\n            incidents = fetch_incidents(client)\n            demisto.incidents(incidents)\n        elif command == 'servicenow-get-ticket':\n            demisto.results(get_ticket_command(client, args))\n        elif command == 'get-remote-data':\n            return_results(get_remote_data_command(client, demisto.args(), demisto.params()))\n        elif command == 'update-remote-system':\n            return_results(update_remote_system_command(client, demisto.args(), demisto.params()))\n        elif demisto.command() == 'get-mapping-fields':\n            return_results(get_mapping_fields_command(client))\n        elif demisto.command() == 'get-modified-remote-data':\n            return_results(get_modified_remote_data_command(client, args, update_timestamp_field, mirror_limit))\n        elif command in commands:\n            md_, ec_, raw_response, ignore_auto_extract = commands[command](client, args)\n            return_outputs(md_, ec_, raw_response, ignore_auto_extract=ignore_auto_extract)\n        else:\n            raise_exception = True\n            raise NotImplementedError(f'{COMMAND_NOT_IMPLEMENTED_MSG}: {demisto.command()}')\n\n    except Exception as err:\n        LOG(err)\n        LOG.print_log()\n        if not raise_exception:\n            return_error(f'Unexpected error: {str(err)}', error=traceback.format_exc())\n        else:\n            raise\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\nOAUTH_URL = '/oauth_token.do'\n\n\nclass ServiceNowClient(BaseClient):\n\n    def __init__(self, credentials: dict, use_oauth: bool = False, client_id: str = '', client_secret: str = '',\n                 url: str = '', verify: bool = False, proxy: bool = False, headers: dict = None):\n        \"\"\"\n        ServiceNow Client class. The class can use either basic authorization with username and password, or OAuth2.\n        Args:\n            - credentials: the username and password given by the user.\n            - client_id: the client id of the application of the user.\n            - client_secret - the client secret of the application of the user.\n            - url: the instance url of the user, i.e: https://\u003cinstance\u003e.service-now.com.\n                   NOTE - url should be given without an API specific suffix as it is also used for the OAuth process.\n            - verify: Whether the request should verify the SSL certificate.\n            - proxy: Whether to run the integration using the system proxy.\n            - headers: The request headers, for example: {'Accept`: `application/json`}. Can be None.\n            - use_oauth: a flag indicating whether the user wants to use OAuth 2.0 or basic authorization.\n        \"\"\"\n        self.auth = None\n        self.use_oauth = use_oauth\n        if self.use_oauth:  # if user selected the `Use OAuth` box use OAuth authorization, else use basic authorization\n            self.client_id = client_id\n            self.client_secret = client_secret\n        else:\n            self.username = credentials.get('identifier')\n            self.password = credentials.get('password')\n            self.auth = (self.username, self.password)\n\n        self.base_url = url\n        super().__init__(base_url=self.base_url, verify=verify, proxy=proxy, headers=headers, auth=self.auth)  # type\n        # : ignore[misc]\n\n    def http_request(self, method, url_suffix, full_url=None, headers=None, json_data=None, params=None, data=None,\n                     files=None, return_empty_response=False, auth=None):\n        ok_codes = (200, 201, 401)  # includes responses that are ok (200) and error responses that should be\n        # handled by the client and not in the BaseClient\n        try:\n            if self.use_oauth:  # add a valid access token to the headers when using OAuth\n                access_token = self.get_access_token()\n                self._headers.update({\n                    'Authorization': 'Bearer ' + access_token\n                })\n            res = super()._http_request(method=method, url_suffix=url_suffix, full_url=full_url, resp_type='response',\n                                        headers=headers, json_data=json_data, params=params, data=data, files=files,\n                                        ok_codes=ok_codes, return_empty_response=return_empty_response, auth=auth)\n            if res.status_code in [200, 201]:\n                try:\n                    return res.json()\n                except ValueError as exception:\n                    raise DemistoException('Failed to parse json object from response: {}'\n                                           .format(res.content), exception)\n\n            if res.status_code in [401]:\n                if self.use_oauth:\n                    if demisto.getIntegrationContext().get('expiry_time', 0) \u003c= date_to_timestamp(datetime.now()):\n                        access_token = self.get_access_token()\n                        self._headers.update({\n                            'Authorization': 'Bearer ' + access_token\n                        })\n                        return self.http_request(method, url_suffix, full_url=full_url, params=params)\n                    try:\n                        err_msg = f'Unauthorized request: \\n{str(res.json())}'\n                    except ValueError:\n                        err_msg = f'Unauthorized request: \\n{str(res)}'\n                    raise DemistoException(err_msg)\n                else:\n                    raise Exception(f'Authorization failed. Please verify that the username and password are correct.'\n                                    f'\\n{res}')\n\n        except Exception as e:\n            if self._verify and 'SSL Certificate Verification Failed' in e.args[0]:\n                return_error('SSL Certificate Verification Failed - try selecting \\'Trust any certificate\\' '\n                             'checkbox in the integration configuration.')\n            raise DemistoException(e.args[0])\n\n    def login(self, username: str, password: str):\n        \"\"\"\n        Generate a refresh token using the given client credentials and save it in the integration context.\n        \"\"\"\n        data = {\n            'client_id': self.client_id,\n            'client_secret': self.client_secret,\n            'username': username,\n            'password': password,\n            'grant_type': 'password'\n        }\n        try:\n            headers = {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n            res = super()._http_request(method='POST', url_suffix=OAUTH_URL, resp_type='response', headers=headers,\n                                        data=data)\n            try:\n                res = res.json()\n            except ValueError as exception:\n                raise DemistoException('Failed to parse json object from response: {}'.format(res.content), exception)\n            if 'error' in res:\n                return_error(\n                    f'Error occurred while creating an access token. Please check the Client ID, Client Secret '\n                    f'and that the given username and password are correct.\\n{res}')\n            if res.get('refresh_token'):\n                refresh_token = {\n                    'refresh_token': res.get('refresh_token')\n                }\n                set_integration_context(refresh_token)\n        except Exception as e:\n            return_error(f'Login failed. Please check the instance configuration and the given username and password.\\n'\n                         f'{e.args[0]}')\n\n    def get_access_token(self):\n        \"\"\"\n        Get an access token that was previously created if it is still valid, else, generate a new access token from\n        the client id, client secret and refresh token.\n        \"\"\"\n        ok_codes = (200, 201, 401)\n        previous_token = get_integration_context()\n\n        # Check if there is an existing valid access token\n        if previous_token.get('access_token') and previous_token.get('expiry_time') \u003e date_to_timestamp(datetime.now()):\n            return previous_token.get('access_token')\n        else:\n            data = {'client_id': self.client_id,\n                    'client_secret': self.client_secret}\n\n            # Check if a refresh token exists. If not, raise an exception indicating to call the login function first.\n            if previous_token.get('refresh_token'):\n                data['refresh_token'] = previous_token.get('refresh_token')\n                data['grant_type'] = 'refresh_token'\n            else:\n                raise Exception('Could not create an access token. User might be not logged in. Try running the'\n                                ' oauth-login command first.')\n\n            try:\n                headers = {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n                res = super()._http_request(method='POST', url_suffix=OAUTH_URL, resp_type='response', headers=headers,\n                                            data=data, ok_codes=ok_codes)\n                try:\n                    res = res.json()\n                except ValueError as exception:\n                    raise DemistoException('Failed to parse json object from response: {}'.format(res.content),\n                                           exception)\n                if 'error' in res:\n                    return_error(\n                        f'Error occurred while creating an access token. Please check the Client ID, Client Secret '\n                        f'and try to run again the login command to generate a new refresh token as it '\n                        f'might have expired.\\n{res}')\n                if res.get('access_token'):\n                    expiry_time = date_to_timestamp(datetime.now(), date_format='%Y-%m-%dT%H:%M:%S')\n                    expiry_time += res.get('expires_in', 0) * 1000 - 10\n                    new_token = {\n                        'access_token': res.get('access_token'),\n                        'refresh_token': res.get('refresh_token'),\n                        'expiry_time': expiry_time\n                    }\n                    set_integration_context(new_token)\n                    return res.get('access_token')\n            except Exception as e:\n                return_error(f'Error occurred while creating an access token. Please check the instance configuration.'\n                             f'\\n\\n{e.args[0]}')\n\n\n\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.2.2","modified":"2021-08-24T19:36:38.156171+03:00","name":"ServiceNow v2","packID":"ServiceNow","packPropagationLabels":["all"],"prevName":"ServiceNow v2","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":false,"category":"Endpoint","commitMessage":"","configuration":[{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Default Hostname or IP Address","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"HostName","options":null,"required":false,"type":0},{"defaultValue":"amd64","display":"Target Architecture","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Architecture","options":null,"required":false,"type":0},{"defaultValue":"windows","display":"Target Operation System","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"OS","options":null,"required":false,"type":0},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Ciphers","options":null,"required":false,"type":0},{"defaultValue":"","display":"Target Domain or Workgroup","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Workgroup","options":null,"required":false,"type":0},{"defaultValue":"","display":"SMB protocol version. for windows remote installation, Leave empty to use system defaults","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"SMBv","options":null,"required":false,"type":1}],"definitionId":"","description":"File transfer and execute commands on remote machines","detailedDescription":"You can configure this module to run also from an engine.","display":"Shared Agent","fromServerVersion":"","hidden":false,"hideEngines":true,"icon":"placeholder.png","id":"sharedagent","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.361354+03:00","name":"sharedagent","packID":"","prevName":"sharedagent","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":false,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"Slack Bot API token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"slackBotToken","options":null,"required":true,"type":4},{"defaultValue":"","display":"Slack API Token for channel creation","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"slackToken","options":null,"required":true,"type":4},{"defaultValue":"","display":"Incidents channel","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentNotificationChannel","options":null,"required":true,"type":0},{"defaultValue":"1","display":"Min severity [1-4] 1=low","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"minSeverityForIncidents","options":null,"required":false,"type":1},{"defaultValue":"true","display":"Should anyone be allowed to create incidents by DM","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"allowIncidents","options":null,"required":false,"type":8}],"definitionId":"","deprecated":true,"description":"Deprecated. Use the Slack v2 integration instead.","detailedDescription":"To generate tokens, browse to [demistobot](https://demistobot.demisto.com) and follow the instructions","display":"Slack (Deprecated)","fromServerVersion":"","hidden":false,"icon":"slack.png","id":"slack","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:27.995096+03:00","name":"slack","packID":"","prevName":"slack","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Identity and Access Management","commitMessage":"","configuration":[{"defaultValue":"","display":"Access Token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"access_token","options":null,"required":true,"type":4},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow creating users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"If set to false, iam-create-user command will be skipped, and user will not be created.","name":"create_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow updating users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"update_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow enabling users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"enable_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Allow disabling users","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"disable_user_enabled","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Automatically create user if not found in update command","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"create_if_not_exists","options":null,"required":false,"type":8},{"defaultValue":"User Profile - SCIM (Incoming)","display":"Incoming Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mapper_in","options":null,"required":true,"type":0},{"defaultValue":"User Profile - SCIM (Outgoing)","display":"Outgoing Mapper","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"mapper_out","options":null,"required":true,"type":0}],"definitionId":"","description":"Integrate with Slack's services to execute CRUD operations for employee lifecycle processes.","detailedDescription":"## Get Your Slack API Token\nIn order to use this integration, you need to enter your Slack access token in the **Access Token** integration instance parameter.\nThe simplest way to acquire this token is for an Org Owner to create a new Slack app, add the admin OAuth scope, install the app, and use the generated token.\n\nFor more information on getting your Slack access token, see the [Slack Documentation](https://api.slack.com/scim#accessing-the-scim-api)\n\n## Enable/Disable CRUD Commands\nYou can select which CRUD commands are enabled in the integration instance configuration settings. By default, all commands are enabled.\n\n## Automatically create user if not found in update command\nThe *create-if-not-exists* parameter specifies if a new user should be created when the User Profile passed was not found in the 3rd-party integration.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/slack-iam)","display":"Slack IAM","fromServerVersion":"6.0.0","hidden":false,"icon":"","id":"Slack IAM","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"User Profile indicator details.","name":"user-profile","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"When set to true, after the command execution the status of the user in the 3rd-party integration will be active.","name":"allow-enable","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a user.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-create-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"When set to true, after the command execution the status of the user in the 3rd-party integration will be active.","name":"allow-enable","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates an existing user with the data passed in the user-profile argument.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-update-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves a single user resource.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-get-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"A User Profile indicator.","name":"user-profile","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Disable an active user.","docsHidden":false,"execution":true,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-disable-user","outputs":[{"contentPath":"","contextPath":"IAM.Vendor.active","description":"When true, indicates that the employee's status is active in the 3rd-party integration.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.brand","description":"Name of the integration.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.details","description":"Provides the raw data from the 3rd-party integration.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.email","description":"The employee's email address.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"IAM.Vendor.errorMessage","description":"Reason why the API failed.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.id","description":"The employee's user ID in the app.","type":"String"},{"contentPath":"","contextPath":"IAM.Vendor.instanceName","description":"Name of the integration instance.","type":"string"},{"contentPath":"","contextPath":"IAM.Vendor.success","description":"When true, indicates that the command was executed successfully.","type":"Boolean"},{"contentPath":"","contextPath":"IAM.Vendor.username","description":"The employee's username in the app.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Retrieves a User Profile schema, which holds all of the user fields within the application. Used for outgoing-mapping through the Get Schema option.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-mapping-fields","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Group SCIM data with displayName","name":"scim","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates an empty group","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-create-group","outputs":[{"contentPath":"","contextPath":"CreateGroup.id","description":"ID of the group.","type":"String"},{"contentPath":"","contextPath":"CreateGroup.displayName","description":"The display name of the group.","type":"String"},{"contentPath":"","contextPath":"CreateGroup.success","description":"Indicates whether the command succeeded.","type":"Boolean"},{"contentPath":"","contextPath":"CreateGroup.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"CreateGroup.errorMessage","description":"Reason why the API failed.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Group SCIM Data","name":"scim","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Wheather to include group's members.","name":"includeMembers","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves the group information including members","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-get-group","outputs":[{"contentPath":"","contextPath":"GetGroup.id","description":"ID of the group.","type":"String"},{"contentPath":"","contextPath":"GetGroup.displayName","description":"The display name of the group.","type":"String"},{"contentPath":"","contextPath":"GetGroup.members.display","description":"The display name of the group member.","type":"String"},{"contentPath":"","contextPath":"GetGroup.members.value","description":"ID of the group member.","type":"String"},{"contentPath":"","contextPath":"GetGroup.success","description":"Indicates whether the command succeeded.","type":"Boolean"},{"contentPath":"","contextPath":"GetGroup.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"GetGroup.errorMessage","description":"Reason why the API failed.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Group SCIM with id in it","name":"scim","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Permanently removes a group.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-delete-group","outputs":[{"contentPath":"","contextPath":"DeleteGroup.id","description":"ID of the group.","type":"String"},{"contentPath":"","contextPath":"DeleteGroup.displayName","description":"The display name of the group.","type":"String"},{"contentPath":"","contextPath":"DeleteGroup.success","description":"Indicates whether the command succeeded.","type":"Boolean"},{"contentPath":"","contextPath":"DeleteGroup.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"DeleteGroup.errorMessage","description":"Reason why the API failed.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Group SCIM data","name":"scim","required":true,"secret":false},{"default":false,"deprecated":false,"description":"List of members ids to add. A maximum of 15,000 users per call can be modified using this command","isArray":true,"name":"memberIdsToAdd","required":false,"secret":false},{"default":false,"deprecated":false,"description":"List of members ids to be deleted from the group. A maximum of 15,000 users per call can be modified using this command","isArray":true,"name":"memberIdsToDelete","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Updates an existing group resource. This command allows individual (or groups of) users to be added or removed from the group with a single operation. A max of 15,000 users can be modified in 1 call","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"iam-update-group","outputs":[{"contentPath":"","contextPath":"UpdateGroup.id","description":"ID of the group.","type":"String"},{"contentPath":"","contextPath":"UpdateGroup.displayName","description":"The display name of the group.","type":"String"},{"contentPath":"","contextPath":"UpdateGroup.success","description":"Indicates whether the command succeeded.","type":"Boolean"},{"contentPath":"","contextPath":"UpdateGroup.errorCode","description":"HTTP error response code.","type":"Number"},{"contentPath":"","contextPath":"UpdateGroup.errorMessage","description":"Reason why the API failed.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":true,"isRemoteSyncIn":false,"isRemoteSyncOut":true,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\nimport traceback\n\n# Disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n''' GLOBALS '''\nINPUT_SCIM_EXTENSION_KEY = \"urn:scim:schemas:extension:custom:1.0:user\"\nSLACK_SCIM_EXTENSION_KEY = \"urn:scim:schemas:extension:enterprise:1.0\"\nSLACK_SCIM_CORE_SCHEMA_KEY = \"urn:scim:schemas:core:1.0\"\n\n'''CLIENT CLASSES'''\n\n\nclass Client(BaseClient):\n    \"\"\"\n    Slack IAM Client class that implements logic to authenticate with Slack.\n    \"\"\"\n\n    def test(self):\n        uri = '/Users?count=1'\n        res = self._http_request(method='GET', url_suffix=uri)\n        return res\n\n    def get_user(self, email):\n        uri = '/Users'\n        query_params = {\n            'filter': f'email eq {email}'\n        }\n\n        res = self._http_request(\n            method='GET',\n            url_suffix=uri,\n            params=query_params\n        )\n        if res and res.get('totalResults') == 1:\n            user_app_data = res.get('Resources')[0]\n            user_id = user_app_data.get('id')\n            is_active = user_app_data.get('active')\n            username = user_app_data.get('userName')\n            return IAMUserAppData(user_id, username, is_active, user_app_data)\n        return None\n\n    def create_user(self, user_data):\n        uri = '/Users'\n        user_data[\"schemas\"] = [\"urn:scim:schemas:core:1.0\"]  # Mandatory user profile field.\n        res = self._http_request(\n            method='POST',\n            url_suffix=uri,\n            json_data=user_data\n        )\n        user_app_data = res\n        user_id = user_app_data.get('id')\n        is_active = user_app_data.get('active')\n        username = user_app_data.get('userName')\n\n        return IAMUserAppData(user_id, username, is_active, user_app_data)\n\n    def update_user(self, user_id, user_data):\n        uri = f'/Users/{user_id}'\n        res = self._http_request(\n            method='PATCH',\n            url_suffix=uri,\n            json_data=user_data\n        )\n        user_app_data = res\n        user_id = user_app_data.get('id')\n        is_active = user_app_data.get('active')\n        username = user_app_data.get('userName')\n\n        return IAMUserAppData(user_id, username, is_active, user_app_data)\n\n    def disable_user(self, user_id):\n        user_data = {'active': False}\n        return self.update_user(user_id, user_data)\n\n    def get_app_fields(self):\n        app_fields = {}\n        uri = '/Schemas/Users'\n        res = self._http_request(\n            method='GET',\n            url_suffix=uri\n        )\n\n        elements = res.get('attributes', [])\n        for elem in elements:\n            if elem.get('name'):\n                field_name = elem.get('name')\n                description = elem.get('description')\n                app_fields[field_name] = description\n\n        return app_fields\n\n    @staticmethod\n    def handle_exception(user_profile, e, action):\n        \"\"\" Handles failed responses from the application API by setting the User Profile object with the results.\n\n        Args:\n            user_profile (IAMUserProfile): The User Profile object.\n            e (Exception): The exception error. If DemistoException, holds the response json.\n            action (IAMActions): An enum represents the current action (get, update, create, etc).\n        \"\"\"\n        if e.__class__ is DemistoException and hasattr(e, 'res') and e.res is not None:\n            error_code = e.res.status_code\n            try:\n                resp = e.res.json()\n                error_message = resp.get('Errors', {}).get('description')\n            except ValueError:\n                error_message = str(e)\n        else:\n            error_code = ''\n            error_message = str(e)\n\n        user_profile.set_result(action=action,\n                                success=False,\n                                error_code=error_code,\n                                error_message=error_message)\n\n        demisto.error(traceback.format_exc())\n\n\nclass GroupClient(BaseClient):\n    \"\"\"\n    GroupClient will implement the service API, and should not contain any Demisto logic.\n    Should only do requests and return data.\n    \"\"\"\n    def __init__(self, base_url, verify=True, proxy=False, headers=None):\n        super().__init__(base_url=base_url, verify=verify, headers=headers, proxy=proxy)\n\n    def http_request(self, method, url_suffix, params=None, data=None, headers=None):\n        if headers is None:\n            headers = self._headers\n        full_url = self._base_url + url_suffix\n        res = requests.request(\n            method,\n            full_url,\n            verify=self._verify,\n            headers=headers,\n            params=params,\n            json=data\n        )\n\n        return res\n\n    def get_group_by_id(self, group_id):\n        uri = f'/Groups/{group_id}'\n        return self.http_request(\n            method=\"GET\",\n            url_suffix=uri\n        )\n\n    def search_group(self, group_name):\n        uri = '/Groups'\n        query_params = {\n            'filter': f'displayName eq \"{group_name}\"'\n        }\n        return self.http_request(\n            method=\"GET\",\n            url_suffix=uri,\n            params=query_params\n        )\n\n    def create_group(self, data):\n        uri = '/Groups'\n        return self.http_request(\n            method=\"POST\",\n            url_suffix=uri,\n            data=data\n        )\n\n    def update_group(self, group_id, data):\n        uri = f'/Groups/{group_id}'\n        return self.http_request(\n            method=\"PATCH\",\n            url_suffix=uri,\n            data=data\n        )\n\n    def delete_group(self, group_id):\n        uri = f'/Groups/{group_id}'\n        return self.http_request(\n            method=\"DELETE\",\n            url_suffix=uri\n        )\n\n    def build_slack_user_profile(self, args, scim, custom_mapping):\n        if args.get('customMapping'):\n            custom_mapping = json.loads(args.get('customMapping'))\n        elif custom_mapping:\n            custom_mapping = json.loads(custom_mapping)\n\n        extension_schema = scim.get(INPUT_SCIM_EXTENSION_KEY, {})\n\n        if extension_schema:\n            if custom_mapping:\n                new_extension_schema = {}\n                for key, value in custom_mapping.items():\n                    # key is the attribute name in input scim. value is the attribute name of slack profile\n                    new_extension_schema[value] = extension_schema.get(key)\n                scim[SLACK_SCIM_EXTENSION_KEY] = new_extension_schema\n            else:\n                scim[SLACK_SCIM_EXTENSION_KEY] = extension_schema\n\n        scim['schemas'] = [SLACK_SCIM_CORE_SCHEMA_KEY, SLACK_SCIM_EXTENSION_KEY]\n\n        return scim\n\n\n'''COMMAND FUNCTIONS'''\n\n\ndef test_module(client):\n    client.test()\n    return_results('ok')\n\n\ndef get_mapping_fields(client: Client) -\u003e GetMappingFieldsResponse:\n    \"\"\" Creates and returns a GetMappingFieldsResponse object of the user schema in the application\n\n    :param client: (Client) The integration Client object that implements a get_app_fields() method\n    :return: (GetMappingFieldsResponse) An object that represents the user schema\n    \"\"\"\n    app_fields = client.get_app_fields()\n    incident_type_scheme = SchemeTypeMapping(type_name=IAMUserProfile.DEFAULT_INCIDENT_TYPE)\n\n    for field, description in app_fields.items():\n        incident_type_scheme.add_field(field, description)\n\n    return GetMappingFieldsResponse([incident_type_scheme])\n\n\nclass OutputContext:\n    \"\"\"\n        Class to build a generic output and context.\n    \"\"\"\n    def __init__(self, success=None, active=None, id=None, username=None, email=None, errorCode=None,\n                 errorMessage=None, details=None, displayName=None, members=None):\n        self.instanceName = demisto.callingContext['context']['IntegrationInstance']\n        self.brand = demisto.callingContext['context']['IntegrationBrand']\n        self.command = demisto.command().replace('-', '_').title().replace('_', '')\n        self.success = success\n        self.active = active\n        self.id = id\n        self.username = username\n        self.email = email\n        self.errorCode = errorCode\n        self.errorMessage = errorMessage\n        self.details = details\n        self.displayName = displayName  # Used in group\n        self.members = members  # Used in group\n        self.data = {\n            \"brand\": self.brand,\n            \"instanceName\": self.instanceName,\n            \"success\": success,\n            \"active\": active,\n            \"id\": id,\n            \"username\": username,\n            \"email\": email,\n            \"errorCode\": errorCode,\n            \"errorMessage\": errorMessage,\n            \"details\": details,\n            \"displayName\": displayName,\n            \"members\": members\n        }\n        # Remoove empty values\n        self.data = {\n            k: v\n            for k, v in self.data.items()\n            if v is not None\n        }\n\n\ndef get_group_id_by_name(client, group_name):\n    res = client.search_group(group_name)\n\n    if res.get('totalResults') \u003e= 1:\n        return res['Resources'][0].get('id')\n    return None\n\n\ndef get_group_command(client, args):\n    scim = safe_load_json(args.get('scim'))\n\n    group_id = scim.get('id')\n    group_name = scim.get('displayName')\n\n    if not (group_id or group_name):\n        return_error(\"You must supply either 'id' or 'displayName' in the scim data\")\n    if not group_id:\n        res = client.search_group(group_name)\n        res_json = res.json()\n\n        if res.status_code == 200:\n            if res_json.get('totalResults') \u003c 1:\n                generic_iam_context = OutputContext(success=False, displayName=group_name, errorCode=404,\n                                                    errorMessage=\"Group Not Found\", details=res_json)\n                return CommandResults(\n                    raw_response=generic_iam_context.data,\n                    outputs_prefix=generic_iam_context.command,\n                    outputs_key_field='id',\n                    outputs=generic_iam_context.data,\n                    readable_output=tableToMarkdown('Slack Get Group:', generic_iam_context.data, removeNull=True)\n                )\n            else:\n                group_id = res_json['Resources'][0].get('id')\n        else:\n            generic_iam_context = OutputContext(success=False, displayName=group_name, id=group_id,\n                                                errorCode=res_json['Errors']['code'],\n                                                errorMessage=res_json['Errors']['description'], details=res_json)\n            return CommandResults(\n                raw_response=generic_iam_context.data,\n                outputs_prefix=generic_iam_context.command,\n                outputs_key_field='id',\n                outputs=generic_iam_context.data,\n                readable_output=tableToMarkdown('Slack Get Group:', generic_iam_context.data, removeNull=True)\n            )\n    res = client.get_group_by_id(group_id)\n    res_json = res.json()\n\n    if res.status_code == 200:\n        include_members = args.get('includeMembers')\n        if include_members.lower() == 'false' and 'members' in res_json:\n            del res_json['members']\n        generic_iam_context = OutputContext(success=True, id=res_json.get('id'),\n                                            displayName=res_json.get('displayName'),\n                                            members=res_json.get('members'))\n    elif res.status_code == 404:\n        generic_iam_context = OutputContext(success=False, displayName=group_name, id=group_id, errorCode=404,\n                                            errorMessage=\"Group Not Found\", details=res_json)\n    else:\n        generic_iam_context = OutputContext(success=False, displayName=group_name, id=group_id,\n                                            errorCode=res_json['Errors']['code'],\n                                            errorMessage=res_json['Errors']['description'], details=res_json)\n\n    return CommandResults(\n        raw_response=generic_iam_context.data,\n        outputs_prefix=generic_iam_context.command,\n        outputs_key_field='id',\n        outputs=generic_iam_context.data,\n        readable_output=tableToMarkdown('Slack Get Group:', generic_iam_context.data, removeNull=True)\n    )\n\n\ndef delete_group_command(client, args):\n    scim = safe_load_json(args.get('scim'))\n    group_id = scim.get('id')\n    group_name = scim.get('displayName')\n\n    if not group_id:\n        group_id = get_group_id_by_name(client, group_name)\n        if not group_id:\n            return_error(\"You must supply 'id' in the scim data\")\n\n    res = client.delete_group(group_id)\n\n    if res.status_code == 204:\n        generic_iam_context = OutputContext(success=True, id=group_id, displayName=group_name)\n    elif res.status_code == 404:\n        generic_iam_context = OutputContext(success=False, id=group_id, displayName=group_name, errorCode=404,\n                                            errorMessage=\"Group Not Found\", details=res.json())\n    else:\n        res_json = res.json()\n        generic_iam_context = OutputContext(success=False, displayName=group_name, id=group_id,\n                                            errorCode=res_json['Errors']['code'],\n                                            errorMessage=res_json['Errors']['description'], details=res_json)\n    return CommandResults(\n        raw_response=generic_iam_context.data,\n        outputs_prefix=generic_iam_context.command,\n        outputs_key_field='id',\n        outputs=generic_iam_context.data,\n        readable_output=tableToMarkdown('Slack Delete Group:', generic_iam_context.data, removeNull=True)\n    )\n\n\ndef create_group_command(client, args):\n    scim = safe_load_json(args.get('scim'))\n    group_name = scim.get('displayName')\n\n    if not group_name:\n        return_error(\"You must supply 'displayName' of the group in the scim data\")\n\n    group_data = {'schemas': [SLACK_SCIM_CORE_SCHEMA_KEY], 'displayName': group_name}\n    res = client.create_group(group_data)\n    res_json = res.json()\n\n    if res.status_code == 201:\n        generic_iam_context = OutputContext(success=True, id=res_json.get('id'),\n                                            displayName=res_json.get('displayName'))\n    else:\n        res_json = res.json()\n        generic_iam_context = OutputContext(success=False, displayName=group_name,\n                                            errorCode=res_json['Errors']['code'],\n                                            errorMessage=res_json['Errors']['description'], details=res_json)\n\n    return CommandResults(\n        raw_response=generic_iam_context.data,\n        outputs_prefix=generic_iam_context.command,\n        outputs_key_field='id',\n        outputs=generic_iam_context.data,\n        readable_output=tableToMarkdown('Slack Create Group:', generic_iam_context.data, removeNull=True)\n    )\n\n\ndef update_group_command(client, args):\n    scim = safe_load_json(args.get('scim'))\n\n    group_id = scim.get('id')\n    group_name = scim.get('displayName')\n\n    if not group_id:\n        group_id = get_group_id_by_name(client, group_name)\n        if not group_id:\n            return_error(\"You must supply 'id' in the scim data\")\n\n    member_ids_to_add = args.get('memberIdsToAdd')\n    member_ids_to_delete = args.get('memberIdsToDelete')\n\n    member_ids_json_list = []\n    if member_ids_to_add:\n        if type(member_ids_to_add) is not list:\n            member_ids_to_add = json.loads(member_ids_to_add)\n        for member_id in member_ids_to_add:\n            member_ids_json_list.append(\n                {\n                    \"value\": member_id\n                }\n            )\n    if member_ids_to_delete:\n        if type(member_ids_to_delete) is not list:\n            member_ids_to_delete = json.loads(member_ids_to_delete)\n        for member_id in member_ids_to_delete:\n            member_ids_json_list.append(\n                {\n                    \"value\": member_id,\n                    \"operation\": \"delete\"\n                }\n            )\n\n    group_input = {'schemas': [SLACK_SCIM_CORE_SCHEMA_KEY], 'members': member_ids_json_list}\n\n    res = client.update_group(group_id, group_input)\n\n    if res.status_code == 204:\n        generic_iam_context = OutputContext(success=True, id=group_id, displayName=group_name)\n    elif res.status_code == 404:\n        generic_iam_context = OutputContext(success=False, id=group_id, displayName=group_name, errorCode=404,\n                                            errorMessage=\"Group Not Found\", details=res.json())\n    else:\n        res_json = res.json()\n        generic_iam_context = OutputContext(success=False, displayName=group_name, id=group_id,\n                                            errorCode=res_json['Errors']['code'],\n                                            errorMessage=res_json['Errors']['description'], details=res_json)\n    return CommandResults(\n        raw_response=generic_iam_context.data,\n        outputs_prefix=generic_iam_context.command,\n        outputs_key_field='id',\n        outputs=generic_iam_context.data,\n        readable_output=tableToMarkdown('Slack Update Group:', generic_iam_context.data, removeNull=True)\n    )\n\n\ndef main():\n    user_profile = None\n    params = demisto.params()\n    command = demisto.command()\n    args = demisto.args()\n\n    verify_certificate = not params.get('insecure', False)\n    proxy = params.get('proxy', False)\n    access_token = params.get('access_token')\n\n    mapper_in = params.get('mapper_in')\n    mapper_out = params.get('mapper_out')\n    is_create_enabled = params.get(\"create_user_enabled\")\n    is_enable_enabled = demisto.params().get(\"enable_user_enabled\")\n    is_disable_enabled = params.get(\"disable_user_enabled\")\n    is_update_enabled = demisto.params().get(\"update_user_enabled\")\n    create_if_not_exists = demisto.params().get(\"create_if_not_exists\")\n\n    iam_command = IAMCommand(is_create_enabled, is_enable_enabled, is_disable_enabled, is_update_enabled,\n                             create_if_not_exists, mapper_in, mapper_out)\n\n    base_url = 'https://api.slack.com/scim/v1/'\n    headers = {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': f'Bearer {access_token}'\n    }\n\n    client = Client(\n        base_url=base_url,\n        verify=verify_certificate,\n        proxy=proxy,\n        headers=headers,\n        ok_codes=(200, 201),\n    )\n\n    group_client = GroupClient(\n        base_url=base_url,\n        verify=verify_certificate,\n        proxy=proxy,\n        headers=headers,\n    )\n\n    demisto.debug(f'Command being called is {command}')\n\n    if command == 'iam-get-user':\n        user_profile = iam_command.get_user(client, args)\n\n    elif command == 'iam-create-user':\n        user_profile = iam_command.create_user(client, args)\n\n    elif command == 'iam-update-user':\n        user_profile = iam_command.update_user(client, args)\n\n    elif command == 'iam-disable-user':\n        user_profile = iam_command.disable_user(client, args)\n\n    if user_profile:\n        # user_profile.return_outputs()\n        return_results(user_profile)\n\n    try:\n        if command == 'test-module':\n            test_module(client)\n\n        elif command == 'get-mapping-fields':\n            return_results(get_mapping_fields(client))\n\n    except Exception:\n        # For any other integration command exception, return an error\n        return_error(f'Failed to execute {command} command. Traceback: {traceback.format_exc()}')\n\n    if command == 'iam-get-group':\n        return_results(get_group_command(group_client, args))\n\n    elif command == 'iam-create-group':\n        return_results(create_group_command(group_client, args))\n\n    elif command == 'iam-update-group':\n        return_results(update_group_command(group_client, args))\n\n    elif command == 'iam-delete-group':\n        return_results(delete_group_command(group_client, args))\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\n\nclass IAMErrors(object):\n    \"\"\"\n    An enum class to manually handle errors in IAM integrations\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    BAD_REQUEST = 400, 'Bad request - failed to perform operation'\n    USER_DOES_NOT_EXIST = 404, 'User does not exist'\n    USER_ALREADY_EXISTS = 409, 'User already exists'\n\n\nclass IAMActions(object):\n    \"\"\"\n    Enum: contains all the IAM actions (e.g. get, update, create, etc.)\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    GET_USER = 'get'\n    UPDATE_USER = 'update'\n    CREATE_USER = 'create'\n    DISABLE_USER = 'disable'\n    ENABLE_USER = 'enable'\n\n\nclass IAMVendorActionResult:\n    \"\"\" This class is used in IAMUserProfile class to represent actions data.\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    def __init__(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                 error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        self._brand = demisto.callingContext.get('context', {}).get('IntegrationBrand')\n        self._instance_name = demisto.callingContext.get('context', {}).get('IntegrationInstance')\n        self._success = success\n        self._active = active\n        self._iden = iden\n        self._username = username\n        self._email = email\n        self._error_code = error_code\n        self._error_message = error_message\n        self._details = details\n        self._skip = skip\n        self._skip_reason = skip_reason\n        self._action = action\n        self._return_error = return_error\n\n    def should_return_error(self):\n        return self._return_error\n\n    def create_outputs(self):\n        \"\"\" Sets the outputs in `_outputs` attribute.\n        \"\"\"\n        outputs = {\n            'brand': self._brand,\n            'instanceName': self._instance_name,\n            'action': self._action,\n            'success': self._success,\n            'active': self._active,\n            'id': self._iden,\n            'username': self._username,\n            'email': self._email,\n            'errorCode': self._error_code,\n            'errorMessage': self._error_message,\n            'details': self._details,\n            'skipped': self._skip,\n            'reason': self._skip_reason\n        }\n        return outputs\n\n    def create_readable_outputs(self, outputs):\n        \"\"\" Sets the human readable output in `_readable_output` attribute.\n\n        :param outputs: (dict) the command outputs.\n        \"\"\"\n        title = self._action.title() + ' User Results ({})'.format(self._brand)\n\n        if not self._skip:\n            headers = [\"brand\", \"instanceName\", \"success\", \"active\", \"id\", \"username\",\n                       \"email\", \"errorCode\", \"errorMessage\", \"details\"]\n        else:\n            headers = [\"brand\", \"instanceName\", \"skipped\", \"reason\"]\n\n        readable_output = tableToMarkdown(\n            name=title,\n            t=outputs,\n            headers=headers,\n            removeNull=True\n        )\n\n        return readable_output\n\n\nclass IAMUserProfile:\n    \"\"\" A User Profile object class for IAM integrations.\n\n    :type _user_profile: ``str``\n    :param _user_profile: The user profile information.\n\n    :type _user_profile_delta: ``str``\n    :param _user_profile_delta: The user profile delta.\n\n    :type _vendor_action_results: ``list``\n    :param _vendor_action_results: A List of data returned from the vendor.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n\n    DEFAULT_INCIDENT_TYPE = 'User Profile'\n    CREATE_INCIDENT_TYPE = 'User Profile - Create'\n    UPDATE_INCIDENT_TYPE = 'User Profile - Update'\n\n    def __init__(self, user_profile, user_profile_delta=None):\n        self._user_profile = safe_load_json(user_profile)\n        self._user_profile_delta = safe_load_json(user_profile_delta) if user_profile_delta else {}\n        self._vendor_action_results = []\n\n    def get_attribute(self, item, use_old_user_data=False):\n        if use_old_user_data and self._user_profile.get('olduserdata', {}).get(item):\n            return self._user_profile.get('olduserdata', {}).get(item)\n        return self._user_profile.get(item)\n\n    def to_entry(self):\n        \"\"\" Generates a XSOAR IAM entry from the data in _vendor_action_results.\n        Note: Currently we are using only the first element of the list, in the future we will support multiple results.\n\n        :return: A XSOAR entry.\n        :rtype: ``dict``\n        \"\"\"\n\n        outputs = self._vendor_action_results[0].create_outputs()\n        readable_output = self._vendor_action_results[0].create_readable_outputs(outputs)\n\n        entry_context = {\n            'IAM.UserProfile(val.email \u0026\u0026 val.email == obj.email)': self._user_profile,\n            'IAM.Vendor(val.instanceName \u0026\u0026 val.instanceName == obj.instanceName \u0026\u0026 '\n            'val.email \u0026\u0026 val.email == obj.email)': outputs\n        }\n\n        return_entry = {\n            'ContentsFormat': EntryFormat.JSON,\n            'Contents': outputs,\n            'EntryContext': entry_context\n        }\n\n        if self._vendor_action_results[0].should_return_error():\n            return_entry['Type'] = EntryType.ERROR\n        else:\n            return_entry['Type'] = EntryType.NOTE\n            return_entry['HumanReadable'] = readable_output\n\n        return return_entry\n\n    def return_outputs(self):\n        return_results(self.to_entry())\n\n    def set_result(self, success=True, active=None, iden=None, username=None, email=None, error_code=None,\n                   error_message=None, details=None, skip=False, skip_reason=None, action=None, return_error=False):\n        \"\"\" Sets the outputs and readable outputs attributes according to the given arguments.\n\n        :param success: (bool) whether or not the command succeeded.\n        :param active:  (bool) whether or not the user status is active.\n        :param iden: (str) the user ID.\n        :param username: (str) the username of the user.\n        :param email:  (str) the email of the user.\n        :param error_code: (str or int) the error code of the response, if exists.\n        :param error_message: (str) the error details of the response, if exists.\n        :param details: (dict) the full response.\n        :param skip: (bool) whether or not the command is skipped.\n        :param skip_reason: (str) If the command is skipped, describes the reason.\n        :param action: (IAMActions) An enum object represents the action taken (get, update, create, etc).\n        :param return_error: (bool) Whether or not to return an error entry.\n        \"\"\"\n        if not email:\n            email = self.get_attribute('email')\n\n        vendor_action_result = IAMVendorActionResult(\n            success=success,\n            active=active,\n            iden=iden,\n            username=username,\n            email=email,\n            error_code=error_code,\n            error_message=error_message if error_message else '',\n            details=details,\n            skip=skip,\n            skip_reason=skip_reason if skip_reason else '',\n            action=action,\n            return_error=return_error\n        )\n\n        self._vendor_action_results.append(vendor_action_result)\n\n    def map_object(self, mapper_name, incident_type):\n        \"\"\" Returns the user data, in an application data format.\n\n        :type mapper_name: ``str``\n        :param mapper_name: The outgoing mapper from XSOAR to the application.\n\n        :type incident_type: ``str``\n        :param incident_type: The incident type used.\n\n        :return: the user data, in the app data format.\n        :rtype: ``dict``\n        \"\"\"\n        if incident_type not in [IAMUserProfile.CREATE_INCIDENT_TYPE, IAMUserProfile.UPDATE_INCIDENT_TYPE]:\n            raise DemistoException('You must provide a valid incident type to the map_object function.')\n        if not self._user_profile:\n            raise DemistoException('You must provide the user profile data.')\n        app_data = demisto.mapObject(self._user_profile, mapper_name, incident_type)\n        return app_data\n\n    def update_with_app_data(self, app_data, mapper_name, incident_type=None):\n        \"\"\" updates the user_profile attribute according to the given app_data\n\n        :type app_data: ``dict``\n        :param app_data: The user data in app\n\n        :type mapper_name: ``str``\n        :param mapper_name: Incoming mapper name\n\n        :type incident_type: ``str``\n        :param incident_type: Optional - incident type\n        \"\"\"\n        if not incident_type:\n            incident_type = IAMUserProfile.DEFAULT_INCIDENT_TYPE\n        if not isinstance(app_data, dict):\n            app_data = safe_load_json(app_data)\n        self._user_profile = demisto.mapObject(app_data, mapper_name, incident_type)\n\n\nclass IAMUserAppData:\n    \"\"\" Holds user attributes retrieved from an application.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, user_id, username, is_active, app_data):\n        self.id = user_id\n        self.username = username\n        self.is_active = is_active\n        self.full_data = app_data\n\n\nclass IAMCommand:\n    \"\"\" A class that implements the IAM CRUD commands - should be used.\n\n    :type id: ``str``\n    :param id: The ID of the user.\n\n    :type username: ``str``\n    :param username: The username of the user.\n\n    :type is_active: ``bool``\n    :param is_active: Whether or not the user is active in the application.\n\n    :type full_data: ``dict``\n    :param full_data: The full data of the user in the application.\n\n    :return: None\n    :rtype: ``None``\n    \"\"\"\n    def __init__(self, is_create_enabled=True, is_enable_enabled=True, is_disable_enabled=True, is_update_enabled=True,\n                 create_if_not_exists=True, mapper_in=None, mapper_out=None, attr='email'):\n        \"\"\" The IAMCommand c'tor\n\n        :param is_create_enabled: (bool) Whether or not to allow creating users in the application.\n        :param is_enable_enabled: (bool) Whether or not to allow enabling users in the application.\n        :param is_disable_enabled: (bool) Whether or not to allow disabling users in the application.\n        :param is_update_enabled: (bool) Whether or not to allow updating users in the application.\n        :param create_if_not_exists: (bool) Whether or not to create a user if does not exist in the application.\n        :param mapper_in: (str) Incoming mapper from the application to Cortex XSOAR\n        :param mapper_out: (str) Outgoing mapper from the Cortex XSOAR to the application\n        \"\"\"\n        self.is_create_enabled = is_create_enabled\n        self.is_enable_enabled = is_enable_enabled\n        self.is_disable_enabled = is_disable_enabled\n        self.is_update_enabled = is_update_enabled\n        self.create_if_not_exists = create_if_not_exists\n        self.mapper_in = mapper_in\n        self.mapper_out = mapper_out\n        self.attr = attr\n\n    def get_user(self, client, args):\n        \"\"\" Searches a user in the application and updates the user profile object with the data.\n            If not found, the error details will be resulted instead.\n        :param client: (Client) The integration Client object that implements a get_user() method\n        :param args: (dict) The `iam-get-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        try:\n            identifier = user_profile.get_attribute(self.attr)\n            user_app_data = client.get_user(identifier)\n            if not user_app_data:\n                error_code, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                user_profile.set_result(action=IAMActions.GET_USER,\n                                        success=False,\n                                        error_code=error_code,\n                                        error_message=error_message)\n            else:\n                user_profile.update_with_app_data(user_app_data.full_data, self.mapper_in)\n                user_profile.set_result(\n                    action=IAMActions.GET_USER,\n                    active=user_app_data.is_active,\n                    iden=user_app_data.id,\n                    email=user_profile.get_attribute('email'),\n                    username=user_app_data.username,\n                    details=user_app_data.full_data\n                )\n\n        except Exception as e:\n            client.handle_exception(user_profile, e, IAMActions.GET_USER)\n\n        return user_profile\n\n    def disable_user(self, client, args):\n        \"\"\" Disables a user in the application and updates the user profile object with the updated data.\n            If not found, the command will be skipped.\n\n        :param client: (Client) The integration Client object that implements get_user() and disable_user() methods\n        :param args: (dict) The `iam-disable-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        if not self.is_disable_enabled:\n            user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if not user_app_data:\n                    _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                    user_profile.set_result(action=IAMActions.DISABLE_USER,\n                                            skip=True,\n                                            skip_reason=error_message)\n                else:\n                    if user_app_data.is_active:\n                        user_app_data = client.disable_user(user_app_data.id)\n                    user_profile.set_result(\n                        action=IAMActions.DISABLE_USER,\n                        active=False,\n                        iden=user_app_data.id,\n                        email=user_profile.get_attribute('email'),\n                        username=user_app_data.username,\n                        details=user_app_data.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.DISABLE_USER)\n\n        return user_profile\n\n    def create_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If a user in the app already holds the email in the given user profile, updates\n            its data with the given data.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-create-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n\n        if not self.is_create_enabled:\n            user_profile.set_result(action=IAMActions.CREATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    # if user exists, update it\n                    user_profile = self.update_user(client, args)\n\n                else:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.CREATE_INCIDENT_TYPE)\n                    created_user = client.create_user(app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.CREATE_USER,\n                        active=created_user.is_active,\n                        iden=created_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=created_user.username,\n                        details=created_user.full_data\n                    )\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.CREATE_USER)\n\n        return user_profile\n\n    def update_user(self, client, args):\n        \"\"\" Creates a user in the application and updates the user profile object with the data.\n            If the user is disabled and `allow-enable` argument is `true`, also enables the user.\n            If the user does not exist in the app and the `create-if-not-exist` parameter is checked, creates the user.\n\n        :param client: (Client) A Client object that implements get_user(), create_user() and update_user() methods\n        :param args: (dict) The `iam-update-user` command arguments\n        :return: (IAMUserProfile) The user profile object.\n        \"\"\"\n\n        user_profile = IAMUserProfile(user_profile=args.get('user-profile'))\n        allow_enable = args.get('allow-enable') == 'true'\n        if not self.is_update_enabled:\n            user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                    skip=True,\n                                    skip_reason='Command is disabled.')\n        else:\n            try:\n                identifier = user_profile.get_attribute(self.attr, use_old_user_data=True)\n                user_app_data = client.get_user(identifier)\n                if user_app_data:\n                    app_profile = user_profile.map_object(self.mapper_out, IAMUserProfile.UPDATE_INCIDENT_TYPE)\n\n                    if allow_enable and self.is_enable_enabled and not user_app_data.is_active:\n                        client.enable_user(user_app_data.id)\n\n                    updated_user = client.update_user(user_app_data.id, app_profile)\n                    user_profile.set_result(\n                        action=IAMActions.UPDATE_USER,\n                        active=updated_user.is_active,\n                        iden=updated_user.id,\n                        email=user_profile.get_attribute('email'),\n                        username=updated_user.username,\n                        details=updated_user.full_data\n                    )\n                else:\n                    if self.create_if_not_exists:\n                        user_profile = self.create_user(client, args)\n                    else:\n                        _, error_message = IAMErrors.USER_DOES_NOT_EXIST\n                        user_profile.set_result(action=IAMActions.UPDATE_USER,\n                                                skip=True,\n                                                skip_reason=error_message)\n\n            except Exception as e:\n                client.handle_exception(user_profile, e, IAMActions.UPDATE_USER)\n\n        return user_profile\n\n\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.1.5","modified":"2021-09-05T10:49:33.530151+03:00","name":"Slack IAM","packID":"Slack","packPropagationLabels":["all"],"prevName":"Slack IAM","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"Slack API access token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"access_token","options":null,"required":true,"type":4},{"defaultValue":"","display":"Slack API bot token","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"bot_token","options":null,"required":true,"type":4},{"defaultValue":"","display":"Dedicated Slack channel to receive notifications","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentNotificationChannel","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Send notifications about incidents to the dedicated channel","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"notify_incidents","options":null,"required":false,"type":8},{"defaultValue":"Low","display":"Minimum incident severity to send messages to slack by","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"min_severity","options":["Unknown","Low","Medium","High","Critical"],"required":false,"type":15},{"defaultValue":"Unclassified","display":"Type of incidents created in Slack","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"Allow external users to create incidents via DM","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"allow_incidents","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"unsecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Long running instance. Required for investigation mirroring and direct messages.","displayPassword":"","hidden":true,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"longRunning","options":null,"required":false,"type":8},{"defaultValue":"","display":"Bot display name in Slack (Cortex XSOAR by default)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"bot_name","options":null,"required":false,"type":0},{"defaultValue":"","display":"Bot icon in Slack - Image URL (Cortex XSOAR icon by default)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"bot_icon","options":null,"required":false,"type":0},{"defaultValue":"60","display":"Maximum time to wait for a rate limiting call in seconds","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"max_limit_time","options":null,"required":false,"type":0},{"defaultValue":"200","display":"Number of objects to return in each paginated call","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"paginated_count","options":null,"required":false,"type":0},{"defaultValue":"","display":"Proxy URL to use in Slack API calls","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy_url","options":null,"required":false,"type":0},{"defaultValue":"","display":"Comma separated list of tags To filter the messages sent from demisto.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Only supported in Demisto V6.1 and above.","name":"filtered_tags","options":null,"required":false,"type":0}],"definitionId":"","description":"Send messages and notifications to your Slack team.","detailedDescription":" To allow us access to Slack, the Cortex XSOAR app has to be added to the relevant workspace. Do so by clicking on the following [link](https://oproxy.demisto.ninja/slack).\n After adding the Cortex XSOAR app, you will get an Access Token and Bot Token, which should be inserted in the integration instance configuration's corresponding fields.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/slack-v2)","display":"Slack v2","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"SlackV2","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"auto":"PREDEFINED","default":true,"defaultValue":"all","deprecated":false,"description":"The mirroring type. Can be \"all\", which mirrors everything, \"chat\", which mirrors only chats (not commands), or \"none\", which stops all mirroring.","name":"type","predefined":["all","chat","none"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"Whether the channel is auto-closed when an investigation is closed. Can be \"true\" or \"false\". Default is \"true\".","name":"autoclose","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"both","deprecated":false,"description":"The mirroring direction. Can be \"FromDemisto\", \"ToDemisto\", or \"Both\". Default is \"Both\".","name":"direction","predefined":["Both","FromDemisto","ToDemisto"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"group","deprecated":false,"description":"The channel type. Can be \"channel\" (public) or \"group\" (private).","name":"mirrorTo","predefined":["channel","group"],"required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use the \"mirror-investigation\" command instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-mirror-investigation","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":true,"defaultValue":"all","deprecated":false,"description":"The mirroring type. Can be \"all\", which mirrors everything, \"chat\", which mirrors only chats (not commands), or \"none\", which stops all mirroring.","name":"type","predefined":["all","chat","none"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"Whether the channel is auto-closed when an investigation is closed. Can be \"true\" or \"false\". Default is \"true\".","name":"autoclose","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"both","deprecated":false,"description":"The mirroring direction. Can be \"FromDemisto\", \"ToDemisto\", or \"Both\". Default value is \"Both\".","name":"direction","predefined":["Both","FromDemisto","ToDemisto"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"group","deprecated":false,"description":"The channel type. Can be \"channel\" or \"group\". The default value is \"group\".","name":"mirrorTo","predefined":["channel","group"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the channel. The default is \"incident-\u003cincidentID\u003e\".","name":"channelName","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The topic of the channel.","name":"channelTopic","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to remove the Slack administrator (channel creator) from the mirrored channel.","name":"kickAdmin","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Mirrors the investigation between Slack and the Demisto War Room.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"mirror-investigation","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The message content. When mentioning another slack user, make sure to do so in the following format: \u003c@user_name\u003e.","name":"message","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The user to whom to send the message. Can be either the username or email address.","name":"to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the Slack channel to which to send the message.","name":"channel","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An entry ID to send as a link.","name":"entry","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to include a URL to the relevant component in Demisto. Can be \"true\" or \"false\". Default value is \"false\".","name":"ignoreAddURL","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread to which to reply - can be retrieved from a previous send-notification command.","name":"threadID","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A JSON string of Slack blocks to send in the message.","name":"blocks","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sends a message to a user, group, or channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"send-notification","outputs":[{"contentPath":"","contextPath":"Slack.Thread.ID","description":"The Slack thread ID.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The text content of the message.","name":"message","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Either a user name or email of a Slack user to send to.","name":"to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A Slack channel name to send to.","name":"channel","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A Slack group (private channel) name to send to.","name":"group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An entry ID to send as a link.","name":"entry","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to add a URL in Slack to the relevant component in Demisto. Default is \"false\".","name":"IgnoreAddURL","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread to which to reply.","name":"threadID","required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use the \"send-notification\" command instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-send","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":true,"description":"Deprecated. Use the \"close-channel\" command instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-close-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the channel to archive. If not provided, the mirrored investigation channel is archived (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Archives a Slack channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"close-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The ID of the file entry to send.","name":"file","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The user to whom to send the file. Can be the username or the email address.","name":"to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the Slack group (private channel) to which to send the file.","name":"group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the Slack channel to which to send the file.","name":"channel","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread to which to reply - can be retrieved from a previous send-notification command.","name":"threadID","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comment to add to the file.","name":"comment","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sends a file to a user, channel, or group. If not specified, the file is sent to the mirrored investigation channel (if the channel exists).","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-send-file","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The channel name. If not specified, the topic of the mirrored investigation channel is set (if the channel exists).","name":"channel","required":false,"secret":false},{"default":true,"deprecated":false,"description":"The topic for the channel.","name":"topic","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sets the topic for a channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-set-channel-topic","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":false,"defaultValue":"private","deprecated":false,"description":"The channel type. Can be \"private\" or \"public\".","name":"type","predefined":["private","public"],"required":false,"secret":false},{"default":true,"deprecated":false,"description":"The name of the channel.","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A CSV list of user names or email addresses to invite to the channel. For example: \"user1, user2...\".","name":"users","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a channel in Slack.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-create-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A CSV list of usernames or email addresses to invite to join the channel. For example: \"user1, user2...\".","name":"users","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the channel to which to invite the users. If the name of the channel is not specified, the name of the mirrored investigation channel is used (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Invites users to join a channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-invite-to-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A CSV list of usernames or email addresses to remove from the a channel. For example: \"user1, user2...\"","name":"users","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the channel from which to remove the users. If the name of the channel is not specified, the mirrored investigation channel is used (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Removes users from the specified channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-kick-from-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The new name of the channel.","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The current name of the channel. If the name of the channel is not specified, the mirrored investigation channel is used (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Renames a channel in Slack.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-rename-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The Slack user (username or email).","name":"user","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get details about a specified user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-get-user-details","outputs":[{"contentPath":"","contextPath":"Slack.User.ID","description":"The ID of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.Username","description":"The username of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.Name","description":"The actual name of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.DisplayName","description":"The display name of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.Email","description":"The email address of the user.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Returns the integration context as a file. Use this command for debug purposes only.","docsHidden":false,"execution":false,"hidden":true,"important":null,"indicatorAction":false,"name":"slack-get-integration-context","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of a channel or a regex pattern","name":"name","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The member ID who created the channel","name":"creator","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Specify True to include only archived channels, False to include only unarchived channels, or leave blank for no effect","name":"is_archived","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Specify True to find the general channel (if other filters also match), False to exclude the general channel, or leave blank for no effect","name":"is_general","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Specify True to include only private channels, False to include only public channels, or leave blank for no effect","name":"is_private","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The maximum number of channels to return","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns a list of channels matching criteria","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-filter-channels","outputs":[{"contentPath":"","contextPath":"Slack.Channel.ID","description":"The channel ID","type":"String"},{"contentPath":"","contextPath":"Slack.Channel.Name","description":"The channel name","type":"String"},{"contentPath":"","contextPath":"Slack.Channel.Created","description":"The channel creation timestamp","type":"Number"},{"contentPath":"","contextPath":"Slack.Channel.Creator","description":"The channel creator's member ID","type":"String"},{"contentPath":"","contextPath":"Slack.Channel.IsArchived","description":"Has the channel been archived?","type":"Boolean"},{"contentPath":"","contextPath":"Slack.Channel.IsGeneral","description":"Is the channel the general channel?","type":"Boolean"},{"contentPath":"","contextPath":"Slack.Channel.IsPrivate","description":"Is the channel a private channel?","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/slack:1.0.0.20672","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":true,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"import asyncio\nimport concurrent\nimport json\nimport os\nimport ssl\nimport sys\nimport threading\nimport traceback\nfrom distutils.util import strtobool\nfrom typing import Any, Dict, List, Optional, Tuple, Union\n\nimport requests\nimport slack\nimport urllib3\nfrom slack.errors import SlackApiError\nfrom slack.web.slack_response import SlackResponse\n\n\n\n\n# disable unsecure warnings\nurllib3.disable_warnings()\n\n''' CONSTANTS '''\n\nSEVERITY_DICT = {\n    'Unknown': 0,\n    'Low': 1,\n    'Medium': 2,\n    'High': 3,\n    'Critical': 4\n}\n\nUSER_TAG_EXPRESSION = '\u003c@(.*?)\u003e'\nCHANNEL_TAG_EXPRESSION = '\u003c#(.*?)\u003e'\nURL_EXPRESSION = r'\u003c(https?://.+?)(?:\\|.+)?\u003e'\nGUID_REGEX = r'(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}'\nENTITLEMENT_REGEX = r'{}@(({})|(?:[\\d_]+))_*(\\|\\S+)?\\b'.format(GUID_REGEX, GUID_REGEX)\nMESSAGE_FOOTER = '\\n**From Slack**'\nMIRROR_TYPE = 'mirrorEntry'\nINCIDENT_OPENED = 'incidentOpened'\nINCIDENT_NOTIFICATION_CHANNEL = 'incidentNotificationChannel'\nPLAYGROUND_INVESTIGATION_TYPE = 9\nWARNING_ENTRY_TYPE = 11\nENDPOINT_URL = 'https://oproxy.demisto.ninja/slack-poll'\nPOLL_INTERVAL_MINUTES: Dict[Tuple, float] = {\n    (0, 15): 1,\n    (15, 60): 2,\n    (60,): 5\n}\nDATE_FORMAT = '%Y-%m-%d %H:%M:%S'\nOBJECTS_TO_KEYS = {\n    'mirrors': 'investigation_id',\n    'questions': 'entitlement',\n    'users': 'id'\n}\nSYNC_CONTEXT = True\n\n''' GLOBALS '''\n\nBOT_TOKEN: str\nACCESS_TOKEN: str\nPROXY_URL: Optional[str]\nPROXIES: dict\nDEDICATED_CHANNEL: str\nCLIENT: slack.WebClient\nCHANNEL_CLIENT: slack.WebClient\nALLOW_INCIDENTS: bool\nNOTIFY_INCIDENTS: bool\nINCIDENT_TYPE: str\nSEVERITY_THRESHOLD: int\nVERIFY_CERT: bool\nSSL_CONTEXT: Optional[ssl.SSLContext]\nQUESTION_LIFETIME: int\nBOT_NAME: str\nBOT_ICON_URL: str\nMAX_LIMIT_TIME: int\nPAGINATED_COUNT: int\n\n''' HELPER FUNCTIONS '''\n\n\ndef get_bot_id() -\u003e str:\n    \"\"\"\n    Gets the app bot ID\n\n    Returns:\n        The app bot ID\n    \"\"\"\n    response = send_slack_request_sync(CLIENT, 'auth.test')\n\n    return response.get('user_id')\n\n\ndef test_module():\n    \"\"\"\n    Sends a test message to the dedicated slack channel.\n    \"\"\"\n    if not DEDICATED_CHANNEL:\n        return_error('A dedicated slack channel must be provided.')\n    channel = get_conversation_by_name(DEDICATED_CHANNEL)\n    if not channel:\n        return_error('Dedicated channel not found.')\n    message = 'Hi there! This is a test message.'\n\n    body = {\n        'text': message,\n        'channel': channel.get('id')\n    }\n\n    send_slack_request_sync(CLIENT, 'chat.postMessage', body=body)\n\n    demisto.results('ok')\n\n\ndef get_current_utc_time() -\u003e datetime:\n    \"\"\"\n    Returns:\n        The current UTC time.\n    \"\"\"\n    return datetime.utcnow()\n\n\ndef get_user_by_name(user_to_search: str, add_to_context: bool = True) -\u003e dict:\n    \"\"\"\n    Gets a slack user by a user name\n\n    Args:\n        user_to_search: The user name or email\n        add_to_context: Whether to update the integration context\n\n    Returns:\n        A slack user object\n    \"\"\"\n\n    user: dict = {}\n    users: list = []\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    user_to_search = user_to_search.lower()\n    if integration_context.get('users'):\n        users = json.loads(integration_context['users'])\n        users_filter = list(filter(lambda u: u.get('name', '').lower() == user_to_search\n                                             or u.get('profile', {}).get('email', '').lower() == user_to_search\n                                             or u.get('real_name', '').lower() == user_to_search, users))\n        if users_filter:\n            user = users_filter[0]\n    if not user:\n        body = {\n            'limit': PAGINATED_COUNT\n        }\n        response = send_slack_request_sync(CLIENT, 'users.list', http_verb='GET', body=body)\n        while True:\n            workspace_users = response['members'] if response and response.get('members', []) else []\n            cursor = response.get('response_metadata', {}).get('next_cursor')\n            users_filter = list(filter(lambda u: u.get('name', '').lower() == user_to_search\n                                                 or u.get('profile', {}).get('email', '').lower() == user_to_search\n                                                 or u.get('real_name', '').lower() == user_to_search, workspace_users))\n            if users_filter:\n                break\n            if not cursor:\n                break\n            body = body.copy()\n            body.update({'cursor': cursor})\n            response = send_slack_request_sync(CLIENT, 'users.list', http_verb='GET', body=body)\n\n        if users_filter:\n            user = users_filter[0]\n            if add_to_context:\n                users.append(user)\n                set_to_integration_context_with_retries({'users': users}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n        else:\n            return {}\n\n    return user\n\n\ndef search_slack_users(users: Union[list, str]) -\u003e list:\n    \"\"\"\n    Search given users in Slack\n\n    Args:\n        users: The users to find\n\n    Returns:\n        The slack users\n    \"\"\"\n    slack_users = []\n\n    if not isinstance(users, list):\n        users = [users]\n\n    for user in users:\n        slack_user = get_user_by_name(user)\n        if not slack_user:\n            demisto.results({\n                'Type': WARNING_ENTRY_TYPE,\n                'Contents': f'User {user} not found in Slack',\n                'ContentsFormat': formats['text']\n            })\n        else:\n            slack_users.append(slack_user)\n    return slack_users\n\n\ndef find_mirror_by_investigation() -\u003e dict:\n    \"\"\"\n    Finds a mirrored channel by the mirrored investigation\n\n    Returns:\n        The mirror object\n    \"\"\"\n    mirror: dict = {}\n    investigation = demisto.investigation()\n    if investigation:\n        integration_context = get_integration_context(SYNC_CONTEXT)\n        if integration_context.get('mirrors'):\n            mirrors = json.loads(integration_context['mirrors'])\n            investigation_filter = list(filter(lambda m: investigation.get('id') == m['investigation_id'],\n                                               mirrors))\n            if investigation_filter:\n                mirror = investigation_filter[0]\n\n    return mirror\n\n\ndef set_name_and_icon(body: dict, method: str):\n    \"\"\"\n    If provided, sets a name and an icon for the bot if a message is sent.\n    Args:\n        body: The message body.\n        method: The current API method.\n    \"\"\"\n    if method == 'chat.postMessage':\n        if BOT_NAME:\n            body['username'] = BOT_NAME\n        if BOT_ICON_URL:\n            body['icon_url'] = BOT_ICON_URL\n\n\ndef send_slack_request_sync(client: slack.WebClient, method: str, http_verb: str = 'POST', file_: str = '',\n                            body: dict = None) -\u003e SlackResponse:\n    \"\"\"\n    Sends a request to slack API while handling rate limit errors.\n\n    Args:\n        client: The slack client.\n        method: The method to use.\n        http_verb: The HTTP method to use.\n        file_: A file path to send.\n        body: The request body.\n\n    Returns:\n        The slack API response.\n    \"\"\"\n    if body is None:\n        body = {}\n\n    set_name_and_icon(body, method)\n    total_try_time = 0\n    while True:\n        try:\n            demisto.debug(f'Sending slack {method} (sync). Body is: {str(body)}')\n            if http_verb == 'POST':\n                if file_:\n                    response = client.api_call(method, files={\"file\": file_}, data=body)\n                else:\n                    response = client.api_call(method, json=body)\n            else:\n                response = client.api_call(method, http_verb='GET', params=body)\n        except SlackApiError as api_error:\n            demisto.debug(f'Got rate limit error (sync). Body is: {str(body)}\\n{api_error}')\n            response = api_error.response\n            headers = response.headers  # type: ignore\n            if 'Retry-After' in headers:\n                retry_after = int(headers['Retry-After'])\n                total_try_time += retry_after\n                if total_try_time \u003c MAX_LIMIT_TIME:\n                    time.sleep(retry_after)\n                    continue\n            raise\n        break\n\n    return response  # type: ignore\n\n\nasync def send_slack_request_async(client: slack.WebClient, method: str, http_verb: str = 'POST', file_: str = '',\n                                   body: dict = None) -\u003e SlackResponse:\n    \"\"\"\n    Sends an async request to slack API while handling rate limit errors.\n\n    Args:\n        client: The slack client.\n        method: The method to use.\n        http_verb: The HTTP method to use.\n        file_: A file path to send.\n        body: The request body.\n\n    Returns:\n        The slack API response.\n    \"\"\"\n    if body is None:\n        body = {}\n\n    set_name_and_icon(body, method)\n    total_try_time = 0\n    while True:\n        try:\n            demisto.debug(f'Sending slack {method} (async). Body is: {str(body)}')\n            if http_verb == 'POST':\n                if file_:\n                    response = await client.api_call(method, files={\"file\": file_}, data=body)  # type: ignore\n                else:\n                    response = await client.api_call(method, json=body)  # type: ignore\n            else:\n                response = await client.api_call(method, http_verb='GET', params=body)  # type: ignore\n        except SlackApiError as api_error:\n            demisto.debug(f'Got rate limit error (async). Body is: {str(body)}\\n{api_error}')\n            response = api_error.response\n            headers = response.headers\n            if 'Retry-After' in headers:\n                retry_after = int(headers['Retry-After'])\n                total_try_time += retry_after\n                if total_try_time \u003c MAX_LIMIT_TIME:\n                    await asyncio.sleep(retry_after)\n                    continue\n            raise\n        break\n\n    return response\n\n\n''' MIRRORING '''\n\n\nasync def get_slack_name(slack_id: str, client) -\u003e str:\n    \"\"\"\n    Get the slack name of a provided user or channel by its ID\n\n    Args:\n        client: The slack client\n        slack_id: The slack user or channel ID\n\n    Returns:\n        The slack user or channel name\n    \"\"\"\n    if not slack_id:\n        return ''\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    prefix = slack_id[0]\n    slack_name = ''\n\n    if prefix in ['C', 'D', 'G']:\n        slack_id = slack_id.split('|')[0]\n        conversation: dict = {}\n        if integration_context.get('conversations'):\n            conversations = list(filter(lambda c: c['id'] == slack_id,\n                                        json.loads(integration_context['conversations'])))\n            if conversations:\n                conversation = conversations[0]\n        if not conversation:\n            body = {\n                'channel': slack_id\n            }\n\n            conversation = (await send_slack_request_async(client, 'conversations.info', http_verb='GET',\n                                                           body=body)).get('channel', {})\n        slack_name = conversation.get('name', '')\n    elif prefix == 'U':\n        user: dict = {}\n        if integration_context.get('users'):\n            users = list(filter(lambda u: u['id'] == slack_id, json.loads(integration_context['users'])))\n            if users:\n                user = users[0]\n        if not user:\n            body = {\n                'user': slack_id\n            }\n            user = (await send_slack_request_async(client, 'users.info', http_verb='GET',\n                                                   body=body)).get('user', {})\n\n        slack_name = user.get('name', '')\n\n    return slack_name\n\n\nasync def clean_message(message: str, client: slack.WebClient) -\u003e str:\n    \"\"\"\n    Prettifies a slack message - replaces tags and URLs with clean expressions\n\n    Args:\n        message: The slack message\n        client: The slack client\n\n    Returns:\n        The clean slack message\n    \"\"\"\n    matches = re.findall(USER_TAG_EXPRESSION, message)\n    matches += re.findall(CHANNEL_TAG_EXPRESSION, message)\n    message = re.sub(USER_TAG_EXPRESSION, r'\\1', message)\n    message = re.sub(CHANNEL_TAG_EXPRESSION, r'\\1', message)\n    for match in matches:\n        slack_name = await get_slack_name(match, client)\n        message = message.replace(match, slack_name)\n\n    resolved_message = re.sub(URL_EXPRESSION, r'\\1', message)\n\n    return resolved_message\n\n\ndef invite_users_to_conversation(conversation_id: str, users_to_invite: list):\n    \"\"\"\n    Invites users to a provided conversation using a provided slack client with a channel token.\n\n    Args:\n        conversation_id: The slack conversation ID to invite the users to.\n        users_to_invite: The user slack IDs to invite.\n    \"\"\"\n    for user in users_to_invite:\n        try:\n            body = {\n                'channel': conversation_id,\n                'users': user\n            }\n            send_slack_request_sync(CHANNEL_CLIENT, 'conversations.invite', body=body)\n        except SlackApiError as e:\n            message = str(e)\n            if \"already_in_channel\" in message:\n                continue\n            elif message.find('cant_invite_self') == -1:\n                raise\n\n\ndef kick_users_from_conversation(conversation_id: str, users_to_kick: list):\n    \"\"\"\n    Kicks users from a provided conversation using a provided slack client with a channel token.\n\n    Args:\n        conversation_id: The slack conversation ID to kick the users from.\n        users_to_kick: The user slack IDs to kick.\n    \"\"\"\n    for user in users_to_kick:\n        try:\n            body = {\n                'channel': conversation_id,\n                'user': user\n            }\n            send_slack_request_sync(CHANNEL_CLIENT, 'conversations.kick', body=body)\n        except SlackApiError as e:\n            message = str(e)\n            if message.find('cant_invite_self') == -1:\n                raise\n\n\ndef mirror_investigation():\n    \"\"\"\n    Updates the integration context with a new or existing mirror.\n    \"\"\"\n    mirror_type = demisto.args().get('type', 'all')\n    auto_close = demisto.args().get('autoclose', 'true')\n    mirror_direction = demisto.args().get('direction', 'both')\n    mirror_to = demisto.args().get('mirrorTo', 'group')\n    channel_name = demisto.args().get('channelName', '')\n    channel_topic = demisto.args().get('channelTopic', '')\n    kick_admin = bool(strtobool(demisto.args().get('kickAdmin', 'false')))\n\n    investigation = demisto.investigation()\n\n    if investigation.get('type') == PLAYGROUND_INVESTIGATION_TYPE:\n        return_error('Can not perform this action in playground.')\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    if not integration_context or not integration_context.get('mirrors', []):\n        mirrors: list = []\n    else:\n        mirrors = json.loads(integration_context['mirrors'])\n    if not integration_context or not integration_context.get('conversations', []):\n        conversations: list = []\n    else:\n        conversations = json.loads(integration_context['conversations'])\n\n    investigation_id = investigation.get('id')\n    send_first_message = False\n    current_mirror = list(filter(lambda m: m['investigation_id'] == investigation_id, mirrors))\n    channel_filter: list = []\n    if channel_name:\n        channel_filter = list(filter(lambda m: m['channel_name'] == channel_name, mirrors))\n\n    if not current_mirror:\n        channel_name = channel_name or f'incident-{investigation_id}'\n\n        if not channel_filter:\n            body = {\n                'name': channel_name\n            }\n\n            if mirror_to != 'channel':\n                body['is_private'] = True\n\n            conversation = send_slack_request_sync(CHANNEL_CLIENT, 'conversations.create', body=body).get('channel', {})\n\n            conversation_name = conversation.get('name')\n            conversation_id = conversation.get('id')\n            conversations.append(conversation)\n\n            # Get the bot ID so we can invite him\n            if integration_context.get('bot_id'):\n                bot_id = integration_context['bot_id']\n            else:\n                bot_id = get_bot_id()\n                set_to_integration_context_with_retries({'bot_id': bot_id}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n            invite_users_to_conversation(conversation_id, [bot_id])\n\n            send_first_message = True\n        else:\n            mirrored_channel = channel_filter[0]\n            conversation_id = mirrored_channel['channel_id']\n            conversation_name = mirrored_channel['channel_name']\n\n        mirror = {\n            'channel_id': conversation_id,\n            'channel_name': conversation_name,\n            'investigation_id': investigation.get('id'),\n            'mirror_type': mirror_type,\n            'mirror_direction': mirror_direction,\n            'mirror_to': mirror_to,\n            'auto_close': bool(strtobool(auto_close)),\n            'mirrored': False\n        }\n    else:\n        mirror = mirrors.pop(mirrors.index(current_mirror[0]))\n        conversation_id = mirror['channel_id']\n        if mirror_type:\n            mirror['mirror_type'] = mirror_type\n        if auto_close:\n            mirror['auto_close'] = bool(strtobool(auto_close))\n        if mirror_direction:\n            mirror['mirror_direction'] = mirror_direction\n        if mirror_to and mirror['mirror_to'] != mirror_to:\n            return_error('Cannot change the Slack channel type from Demisto.')\n        if channel_name:\n            return_error('Cannot change the Slack channel name.')\n        if channel_topic:\n            return_error('Cannot change the Slack channel topic.')\n        conversation_name = mirror['channel_name']\n        mirror['mirrored'] = False\n\n    set_topic = False\n    if channel_topic:\n        set_topic = True\n    else:\n        mirror_name = f'incident-{investigation_id}'\n        channel_filter = list(filter(lambda m: m['channel_name'] == conversation_name, mirrors))\n        if 'channel_topic' in mirror:\n            channel_topic = mirror['channel_topic']\n        elif channel_filter:\n            channel_mirror = channel_filter[0]\n            channel_topic = channel_mirror['channel_topic']\n        else:\n            channel_topic = ''\n        mirrored_investigations_ids = list(map(lambda m: f'incident-{m[\"investigation_id\"]}', channel_filter))\n        if not channel_topic or channel_topic.find('incident-') != -1:\n            new_topic = ', '.join(mirrored_investigations_ids + [mirror_name])\n            if channel_topic != new_topic:\n                channel_topic = new_topic\n                set_topic = True\n\n    if set_topic:\n        body = {\n            'channel': conversation_id,\n            'topic': channel_topic\n        }\n        send_slack_request_sync(CHANNEL_CLIENT, 'conversations.setTopic', body=body)\n    mirror['channel_topic'] = channel_topic\n\n    mirrors.append(mirror)\n\n    set_to_integration_context_with_retries({'mirrors': mirrors, 'conversations': conversations}, OBJECTS_TO_KEYS,\n                                            SYNC_CONTEXT)\n\n    if kick_admin:\n        body = {\n            'channel': conversation_id\n        }\n        send_slack_request_sync(CHANNEL_CLIENT, 'conversations.leave', body=body)\n    if send_first_message:\n        server_links = demisto.demistoUrls()\n        server_link = server_links.get('server')\n        message = (f'This channel was created to mirror incident {investigation_id}.'\n                   f' \\n View it on: {server_link}#/WarRoom/{investigation_id}')\n        body = {\n            'text': message,\n            'channel': conversation_id\n        }\n\n        send_slack_request_sync(CLIENT, 'chat.postMessage', body=body)\n\n    demisto.results(f'Investigation mirrored successfully, channel: {conversation_name}')\n\n\ndef long_running_loop():\n    \"\"\"\n    Runs in a long running container - checking for newly mirrored investigations and answered questions.\n    \"\"\"\n    while True:\n        error = ''\n        try:\n            check_for_mirrors()\n            check_for_answers()\n        except requests.exceptions.ConnectionError as e:\n            error = f'Could not connect to the Slack endpoint: {str(e)}'\n        except Exception as e:\n            error = f'An error occurred: {str(e)}'\n        finally:\n            if error:\n                demisto.error(error)\n                demisto.updateModuleHealth(error)\n            time.sleep(5)\n\n\ndef check_for_answers():\n    \"\"\"\n    Checks for answered questions\n    \"\"\"\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    questions = integration_context.get('questions', [])\n    users = integration_context.get('users', [])\n    if questions:\n        questions = json.loads(questions)\n    if users:\n        users = json.loads(users)\n    now = get_current_utc_time()\n    now_string = datetime.strftime(now, DATE_FORMAT)\n    updated_questions = []\n\n    for question in questions:\n        if question.get('last_poll_time'):\n            if question.get('expiry'):\n                # Check if the question expired - if it did, answer it with the default response and remove it\n                expiry = datetime.strptime(question['expiry'], DATE_FORMAT)\n                if expiry \u003c now:\n                    answer_question(question.get('default_response'), question)\n                    updated_questions.append(question)\n                    continue\n            # Check if it has been enough time(determined by the POLL_INTERVAL_MINUTES parameter)\n            # since the last polling time. if not, continue to the next question until it has.\n            last_poll_time = datetime.strptime(question['last_poll_time'], DATE_FORMAT)\n            delta = now - last_poll_time\n            minutes = delta.total_seconds() / 60\n            sent = question.get('sent')\n            poll_time_minutes = get_poll_minutes(now, sent)\n\n            if minutes \u003c poll_time_minutes:\n                continue\n        entitlement = question.get('entitlement', '')\n        demisto.info(f'Slack - polling for an answer for entitlement {entitlement}')\n        question['last_poll_time'] = now_string\n        updated_questions.append(question)\n\n        headers = {'Accept': 'application/json', 'Content-Type': 'application/json'}\n        add_info_headers(headers, question.get('expiry'))\n\n        body = {\n            'entitlement': entitlement\n        }\n        res = requests.post(ENDPOINT_URL, data=json.dumps(body), headers=headers, proxies=PROXIES, verify=VERIFY_CERT,\n                            timeout=30)\n        if res.status_code != 200:\n            demisto.error(f'Slack - failed to poll for answers: {res.content!r}, status code: {res.status_code!r}')\n            continue\n        answer: dict = {}\n        try:\n            answer = res.json()\n        except Exception:\n            demisto.info(f'Slack - Could not parse response for entitlement {entitlement!r}: {res.content!r}')\n        if not answer:\n            continue\n        payload_json: str = answer.get('payload', '')\n        if not payload_json:\n            continue\n        payload = json.loads(payload_json)\n\n        actions = payload.get('actions', [])\n        if actions:\n            demisto.info(f'Slack - received answer from user for entitlement {entitlement}.')\n            user_id = payload.get('user', {}).get('id')\n            user_filter = list(filter(lambda u: u['id'] == user_id, users))\n            if user_filter:\n                user = user_filter[0]\n            else:\n                body = {\n                    'user': user_id\n                }\n                user = send_slack_request_sync(CLIENT, 'users.info', http_verb='GET', body=body).get('user', {})\n                users.append(user)\n\n            answer_question(actions[0].get('text', {}).get('text'), question, user.get('profile', {}).get('email'))\n\n    if updated_questions:\n        set_to_integration_context_with_retries({'users': users, 'questions': questions}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n\ndef get_poll_minutes(current_time: datetime, sent: Optional[str]) -\u003e float:\n    \"\"\"\n    Get the interval to wait before polling again in minutes.\n\n    Args:\n        current_time: The current time.\n        sent: The time when the polling request was sent.\n\n    Returns:\n        Total minutes to wait before polling.\n    \"\"\"\n    poll_time_minutes = 1.0\n    if sent:\n        sent_time = datetime.strptime(sent, DATE_FORMAT)\n        total_delta = current_time - sent_time\n        total_minutes = total_delta.total_seconds() / 60\n\n        for minute_range, interval in POLL_INTERVAL_MINUTES.items():\n            if len(minute_range) \u003e 1 and total_minutes \u003e minute_range[1]:\n                continue\n            poll_time_minutes = interval\n            break\n\n    return poll_time_minutes\n\n\ndef add_info_headers(headers: dict, expiry):\n    # pylint: disable=no-member\n    try:\n        auth = send_slack_request_sync(CLIENT, 'auth.test')\n        team_name = auth.get('team', '')\n        team_id = auth.get('team_id', '')\n        headers['X-Content-TeamName'] = team_name\n        headers['X-Content-TeamID'] = team_id\n        headers['X-Content-Expiry'] = expiry if expiry else 'No expiry'\n        headers.update(get_x_content_info_headers())\n    except Exception as e:\n        demisto.error(f'Failed getting integration info: {str(e)}')\n\n\ndef answer_question(text: str, question: dict, email: str = ''):\n    entitlement = question.get('entitlement', '')\n    content, guid, incident_id, task_id = extract_entitlement(entitlement, text)\n    try:\n        demisto.handleEntitlementForUser(incident_id, guid, email, content, task_id)\n    except Exception as e:\n        demisto.error(f'Failed handling entitlement {entitlement}: {str(e)}')\n    question['remove'] = True\n\n\ndef check_for_mirrors():\n    \"\"\"\n    Checks for newly created mirrors and handles the mirroring process\n    \"\"\"\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    if integration_context.get('mirrors'):\n        mirrors = json.loads(integration_context['mirrors'])\n        updated_mirrors = []\n        updated_users = []\n        for mirror in mirrors:\n            if not mirror['mirrored']:\n                investigation_id = mirror['investigation_id']\n                demisto.info(f'Mirroring: {investigation_id}')\n                mirror = mirrors.pop(mirrors.index(mirror))\n                if mirror['mirror_to'] and mirror['mirror_direction'] and mirror['mirror_type']:\n                    mirror_type = mirror['mirror_type']\n                    auto_close = mirror['auto_close']\n                    direction = mirror['mirror_direction']\n                    channel_id = mirror['channel_id']\n                    if isinstance(auto_close, str):\n                        auto_close = bool(strtobool(auto_close))\n                    users: List[Dict] = demisto.mirrorInvestigation(investigation_id,\n                                                                    f'{mirror_type}:{direction}', auto_close)\n                    if mirror_type != 'none':\n                        try:\n                            invited_users = invite_to_mirrored_channel(channel_id, users)\n                            updated_users.extend(invited_users)\n                        except Exception as error:\n                            demisto.error(f\"Could not invite investigation users to the mirrored channel: {error}\")\n\n                    mirror['mirrored'] = True\n                    updated_mirrors.append(mirror)\n                else:\n                    demisto.info(f'Could not mirror {investigation_id}')\n\n        if updated_mirrors:\n            context = {'mirrors': updated_mirrors}\n            if updated_users:\n                context['users'] = updated_users\n\n            set_to_integration_context_with_retries(context, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n\ndef invite_to_mirrored_channel(channel_id: str, users: List[Dict]) -\u003e list:\n    \"\"\"\n    Invite the relevant users to a mirrored channel\n    Args:\n        channel_id: The mirrored channel\n        users: The users to invite, each a dict of username and email\n\n    Returns:\n        users: The slack users that were invited\n    \"\"\"\n    slack_users = []\n    for user in users:\n        slack_user: dict = {}\n        # Try to invite by Demisto email\n        user_email = user.get('email', '')\n        user_name = user.get('username', '')\n        if user_email:\n            slack_user = get_user_by_name(user_email, False)\n        if not slack_user:\n            # Try to invite by Demisto user name\n            if user_name:\n                slack_user = get_user_by_name(user_name, False)\n        if slack_user:\n            slack_users.append(slack_user)\n        else:\n            demisto.results({\n                'Type': WARNING_ENTRY_TYPE,\n                'Contents': f'User {user_name} not found in Slack',\n                'ContentsFormat': formats['text']\n            })\n\n    users_to_invite = [user.get('id') for user in slack_users]\n    invite_users_to_conversation(channel_id, users_to_invite)\n\n    return slack_users\n\n\ndef extract_entitlement(entitlement: str, text: str) -\u003e Tuple[str, str, str, str]:\n    \"\"\"\n    Extracts entitlement components from an entitlement string\n    Args:\n        entitlement: The entitlement itself\n        text: The actual reply text\n\n    Returns:\n        Entitlement components\n    \"\"\"\n    parts = entitlement.split('@')\n    guid = parts[0]\n    id_and_task = parts[1].split('|')\n    incident_id = id_and_task[0]\n    task_id = ''\n    if len(id_and_task) \u003e 1:\n        task_id = id_and_task[1]\n    content = text.replace(entitlement, '', 1)\n\n    return content, guid, incident_id, task_id\n\n\nasync def slack_loop():\n    \"\"\"\n    Starts a Slack RTM client while checking the connection.\n    \"\"\"\n    while True:\n        loop = asyncio.get_running_loop()\n        rtm_client = None\n        try:\n            rtm_client = slack.RTMClient(\n                token=BOT_TOKEN,\n                run_async=True,\n                loop=loop,\n                auto_reconnect=False,\n                proxy=PROXY_URL,\n                ssl=SSL_CONTEXT\n            )\n\n            client_future = rtm_client.start()\n            while True:\n                await asyncio.sleep(10)\n                if rtm_client._websocket is None or rtm_client._websocket.closed or client_future.done():\n                    ex = client_future.exception()\n                    if ex:\n                        demisto.error(f'Slack client raised an exception: {ex}')\n                    demisto.info('Slack - websocket is closed or done')\n                    break\n        except Exception as e:\n            error = f'Slack client raised an exception: {e}'\n            await handle_listen_error(error)\n        finally:\n            # If we got here, the websocket is closed or the client can't connect. Will try to connect every 5 seconds.\n            if rtm_client and not rtm_client._stopped:\n                rtm_client.stop()\n            await asyncio.sleep(5)\n\n\nasync def handle_listen_error(error: str):\n    \"\"\"\n    Logs an error and updates the module health accordingly.\n\n    Args:\n        error: The error string.\n    \"\"\"\n    demisto.error(error)\n    demisto.updateModuleHealth(error)\n\n\nasync def start_listening():\n    \"\"\"\n    Starts a Slack RTM client and checks for mirrored incidents.\n    \"\"\"\n    executor = concurrent.futures.ThreadPoolExecutor(max_workers=1)\n    loop = asyncio.get_running_loop()\n    loop.run_in_executor(executor, long_running_loop)\n    await slack_loop()\n\n\nasync def handle_dm(user: dict, text: str, client: slack.WebClient):\n    \"\"\"\n    Handles a direct message sent to the bot\n\n    Args:\n        user: The user who sent the message\n        text: The message text\n        client: The Slack client\n\n    Returns:\n        Text to return to the user\n    \"\"\"\n    demisto.info('Slack - handling direct message.')\n    message: str = text.lower()\n    if message.find('incident') != -1 and (message.find('create') != -1\n                                           or message.find('open') != -1\n                                           or message.find('new') != -1):\n        user_email = user.get('profile', {}).get('email', '')\n        user_name = user.get('name', '')\n        if user_email:\n            demisto_user = demisto.findUser(email=user_email)\n        else:\n            demisto_user = demisto.findUser(username=user.get('name'))\n\n        if not demisto_user and not ALLOW_INCIDENTS:\n            data = 'You are not allowed to create incidents.'\n        else:\n            try:\n                data = await translate_create(text, user_name, user_email, demisto_user)\n            except Exception as e:\n                data = f'Failed creating incidents: {str(e)}'\n    else:\n        try:\n            data = demisto.directMessage(text, user.get('name'), user.get('profile', {}).get('email'), ALLOW_INCIDENTS)\n        except Exception as e:\n            data = str(e)\n\n    if not data:\n        data = 'Sorry, I could not perform the selected operation.'\n    body = {\n        'users': user.get('id')\n    }\n    im = await send_slack_request_async(client, 'conversations.open', body=body)\n    channel = im.get('channel', {}).get('id')\n    body = {\n        'text': data,\n        'channel': channel\n    }\n\n    await send_slack_request_async(client, 'chat.postMessage', body=body)\n\n\nasync def translate_create(message: str, user_name: str, user_email: str, demisto_user: dict) -\u003e str:\n    \"\"\"\n    Processes an incident creation message\n    Args:\n        message: The creation message\n        user_name: The name of the user in Slack\n        user_email: The email of the user in Slack\n        demisto_user: The demisto user associated with the request (if exists)\n\n    Returns:\n        Creation result\n    \"\"\"\n    json_pattern = r'(?\u003c=json=).*'\n    name_pattern = r'(?\u003c=name=).*'\n    type_pattern = r'(?\u003c=type=).*'\n    message = message.replace(\"\\n\", '').replace('`', '')\n    json_match = re.search(json_pattern, message)\n    created_incident = None\n    data = ''\n    user_demisto_id = ''\n    if demisto_user:\n        user_demisto_id = demisto_user.get('id', '')\n\n    if json_match:\n        if re.search(name_pattern, message) or re.search(type_pattern, message):\n            data = 'No other properties other than json should be specified.'\n        else:\n            incidents_json = json_match.group()\n            incidents = json.loads(incidents_json.replace('“', '\"').replace('”', '\"'))\n            if not isinstance(incidents, list):\n                incidents = [incidents]\n            created_incident = await create_incidents(incidents, user_name, user_email, user_demisto_id)\n\n            if not created_incident:\n                data = 'Failed creating incidents.'\n    else:\n        name_match = re.search(name_pattern, message)\n        if not name_match:\n            data = 'Please specify arguments in the following manner: name=\u003cname\u003e type=[type] or json=\u003cjson\u003e.'\n        else:\n            incident_name = re.sub('type=.*', '', name_match.group()).strip()\n            incident_type = ''\n\n            type_match = re.search(type_pattern, message)\n            if type_match:\n                incident_type = re.sub('name=.*', '', type_match.group()).strip()\n\n            incident = {'name': incident_name}\n\n            incident_type = incident_type or INCIDENT_TYPE\n            if incident_type:\n                incident['type'] = incident_type\n\n            created_incident = await create_incidents([incident], user_name, user_email, user_demisto_id)\n            if not created_incident:\n                data = 'Failed creating incidents.'\n\n    if created_incident:\n        if isinstance(created_incident, list):\n            created_incident = created_incident[0]\n        server_links = demisto.demistoUrls()\n        server_link = server_links.get('server')\n        incident_name = created_incident['name']\n        incident_id = created_incident['id']\n        data = f'Successfully created incident {incident_name}.\\n View it on: {server_link}#/WarRoom/{incident_id}'\n\n    return data\n\n\nasync def create_incidents(incidents: list, user_name: str, user_email: str, user_demisto_id: str = '') -\u003e dict:\n    \"\"\"\n    Creates incidents according to a provided JSON object\n    Args:\n        incidents: The incidents JSON\n        user_name The name of the user in Slack\n        user_email The email of the user in Slack\n        user_demisto_id: The id of demisto user associated with the request (if exists)\n\n    Returns:\n        The creation result\n    \"\"\"\n\n    for incident in incidents:\n        # Add relevant labels to context\n        labels = incident.get('labels', [])\n        keys = [label.get('type') for label in labels]\n        if 'Reporter' not in keys:\n            labels.append({'type': 'Reporter', 'value': user_name})\n        if 'ReporterEmail' not in keys:\n            labels.append({'type': 'ReporterEmail', 'value': user_email})\n        if 'Source' not in keys:\n            labels.append({'type': 'Source', 'value': 'Slack'})\n        incident['labels'] = labels\n\n    if user_demisto_id:\n        data = demisto.createIncidents(incidents, userID=user_demisto_id)\n    else:\n        data = demisto.createIncidents(incidents)\n\n    return data\n\n\n@slack.RTMClient.run_on(event='message')\nasync def listen(**payload: Any):\n    \"\"\"\n    Listens to Slack RTM messages\n\n    Args:\n        payload: The message payload\n    \"\"\"\n    data: dict = payload.get('data', {})\n    data_type: str = payload.get('type', '')\n    client: slack.WebClient = payload.get('web_client', CLIENT)\n\n    if data_type == 'error':\n        error = payload.get('error', {})\n        error_code = error.get('code')\n        error_msg = error.get('msg')\n        await handle_listen_error(f'Slack API has thrown an error. Code: {error_code}, Message: {error_msg}.')\n        return\n    try:\n        subtype = data.get('subtype', '')\n        text = data.get('text', '')\n        user_id = data.get('user', '')\n        channel = data.get('channel', '')\n        message_bot_id = data.get('bot_id', '')\n        thread = data.get('thread_ts', '')\n        message = data.get('message', {})\n\n        if subtype == 'bot_message' or message_bot_id or message.get('subtype') == 'bot_message':\n            return\n\n        user = await get_user_by_id_async(client, user_id)\n        entitlement_reply = await check_and_handle_entitlement(text, user, thread)\n        if entitlement_reply:\n            body = {\n                'text': entitlement_reply,\n                'thread_ts': thread,\n                'channel': channel\n            }\n\n            await send_slack_request_async(client, 'chat.postMessage', body=body)\n        elif channel and channel[0] == 'D':\n            # DM\n            await handle_dm(user, text, client)\n        else:\n            channel_id = data.get('channel')\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            if not integration_context or 'mirrors' not in integration_context:\n                return\n\n            mirrors = json.loads(integration_context['mirrors'])\n            mirror_filter = list(filter(lambda m: m['channel_id'] == channel_id, mirrors))\n            if not mirror_filter:\n                return\n\n            for mirror in mirror_filter:\n                if mirror['mirror_direction'] == 'FromDemisto' or mirror['mirror_type'] == 'none':\n                    return\n\n                if not mirror['mirrored']:\n                    # In case the investigation is not mirrored yet\n                    mirror = mirrors.pop(mirrors.index(mirror))\n                    if mirror['mirror_to'] and mirror['mirror_direction'] and mirror['mirror_type']:\n                        investigation_id = mirror['investigation_id']\n                        mirror_type = mirror['mirror_type']\n                        auto_close = mirror['auto_close']\n                        direction = mirror['mirror_direction']\n                        if isinstance(auto_close, str):\n                            auto_close = bool(strtobool(auto_close))\n                        demisto.info(f'Mirroring: {investigation_id}')\n                        demisto.mirrorInvestigation(investigation_id, f'{mirror_type}:{direction}', auto_close)\n                        mirror['mirrored'] = True\n                        mirrors.append(mirror)\n                        set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n                investigation_id = mirror['investigation_id']\n                await handle_text(client, investigation_id, text, user)\n        # Reset module health\n        demisto.updateModuleHealth(\"\")\n    except Exception as e:\n        await handle_listen_error(f'Error occurred while listening to Slack: {str(e)}')\n\n\nasync def get_user_by_id_async(client: slack.WebClient, user_id: str) -\u003e dict:\n    \"\"\"\n    Get the details of a slack user by id asynchronously.\n    Args:\n        client: The slack web client to use.\n        user_id: The id of the user.\n\n    Returns:\n        The slack user.\n    \"\"\"\n    user: dict = {}\n    users: list = []\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    if integration_context.get('users'):\n        users = json.loads(integration_context['users'])\n        user_filter = list(filter(lambda u: u['id'] == user_id, users))\n        if user_filter:\n            user = user_filter[0]\n    if not user:\n        body = {\n            'user': user_id\n        }\n        user = (await send_slack_request_async(client, 'users.info', http_verb='GET', body=body)).get('user', {})\n        users.append(user)\n        set_to_integration_context_with_retries({'users': users}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n    return user\n\n\nasync def handle_text(client: slack.WebClient, investigation_id: str, text: str, user: dict):\n    \"\"\"\n    Handles text received in the Slack workspace (not DM)\n\n    Args:\n        client: The Slack client\n        investigation_id: The mirrored investigation ID\n        text: The received text\n        user: The sender\n    \"\"\"\n    demisto.info(f'Slack - adding entry to incident {investigation_id}')\n    if text:\n        demisto.addEntry(id=investigation_id,\n                         entry=await clean_message(text, client),\n                         username=user.get('name', ''),\n                         email=user.get('profile', {}).get('email', ''),\n                         footer=MESSAGE_FOOTER\n                         )\n\n\nasync def check_and_handle_entitlement(text: str, user: dict, thread_id: str) -\u003e str:\n    \"\"\"\n    Handles an entitlement message (a reply to a question)\n    Args:\n        text: The message text\n        user: The user who sent the reply\n        thread_id: The thread ID\n\n    Returns:\n        If the message contains entitlement, return a reply.\n    \"\"\"\n\n    entitlement_match = re.search(ENTITLEMENT_REGEX, text)\n    if entitlement_match:\n        demisto.info('Slack - handling entitlement in message.')\n        content, guid, incident_id, task_id = extract_entitlement(entitlement_match.group(), text)\n        demisto.handleEntitlementForUser(incident_id, guid, user.get('profile', {}).get('email'), content, task_id)\n\n        return 'Thank you for your response.'\n    else:\n        integration_context = get_integration_context(SYNC_CONTEXT)\n        questions = integration_context.get('questions', [])\n        if questions and thread_id:\n            questions = json.loads(questions)\n            question_filter = list(filter(lambda q: q.get('thread') == thread_id, questions))\n            if question_filter:\n                question = question_filter[0]\n                demisto.info('Slack - handling entitlement in thread.')\n                entitlement = question.get('entitlement')\n                reply = question.get('reply', 'Thank you for your response.')\n                content, guid, incident_id, task_id = extract_entitlement(entitlement, text)\n                demisto.handleEntitlementForUser(incident_id, guid, user.get('profile', {}).get('email'), content,\n                                                 task_id)\n                question['remove'] = True\n                set_to_integration_context_with_retries({'questions': questions}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n                return reply\n\n    return ''\n\n\n''' SEND '''\n\n\ndef get_conversation_by_name(conversation_name: str) -\u003e dict:\n    \"\"\"\n    Get a slack conversation by its name\n\n    Args:\n        conversation_name: The conversation name\n\n    Returns:\n        The slack conversation\n    \"\"\"\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    conversation_to_search = conversation_name.lower()\n    # Find conversation in the cache\n    conversations = integration_context.get('conversations')\n    if conversations:\n        conversations = json.loads(conversations)\n        conversation_filter = list(\n            filter(\n                lambda c: conversation_to_search == c.get('name', '').lower(),\n                conversations\n            )\n        )\n        if conversation_filter:\n            return conversation_filter[0]\n\n    demisto.debug(f'could not find slack channel \"{conversation_to_search}\" in integration context, searching via API')\n    # If not found in cache, search for it\n    body = {\n        'types': 'private_channel,public_channel',\n        'limit': PAGINATED_COUNT\n    }\n    response = send_slack_request_sync(CLIENT, 'conversations.list', http_verb='GET', body=body)\n    conversation: dict = {}\n    while True:\n        conversations = response['channels'] if response and response.get('channels') else []\n        cursor = response.get('response_metadata', {}).get('next_cursor')\n        conversation_filter = [c for c in conversations if c.get('name') == conversation_name]\n        if conversation_filter:\n            break\n        if not cursor:\n            break\n\n        body = body.copy()  # strictly for unit-test purposes (test_get_conversation_by_name_paging)\n        body.update({'cursor': cursor})\n        response = send_slack_request_sync(CLIENT, 'conversations.list', http_verb='GET', body=body)\n\n    if conversation_filter:\n        conversation = conversation_filter[0]\n\n    # Save conversations to cache\n    if conversation:\n        conversations = integration_context.get('conversations')\n        if conversations:\n            conversations = json.loads(conversations)\n            conversations.append(conversation)\n        else:\n            conversations = [conversation]\n        set_to_integration_context_with_retries({'conversations': conversations}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n    return conversation\n\n\ndef filter_conversations(\n    name: str = '',\n    creator: str = '',\n    is_archived: Union[bool, None] = None,\n    is_general: Union[bool, None] = None,\n    is_private: Union[bool, None] = None\n) -\u003e list:\n    \"\"\"\n    Get a filtered list of slack conversations\n\n    Args:\n        name: The name of a channel or a regex pattern\n        creator: The member ID who created the channel\n        is_archived: True, False, or None to ignore\n        is_general: True, False, or None to ignore\n        is_private: True, False, or None to ignore\n\n    Returns:\n        A filtered list of slack conversations\n    \"\"\"\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    # Find conversation in the cache\n    conversations = integration_context.get('conversations')\n    if conversations:\n        conversations = json.loads(conversations)\n        conversation_filter = []\n        for c in conversations:\n            if name and not re.search(name, c.get('name'), re.IGNORECASE):\n                continue\n            if creator and not creator.upper() == c.get('creator'):\n                continue\n            if is_archived is not None and is_archived != c.get('is_archived'):\n                continue\n            if is_general is not None and is_general != c.get('is_general'):\n                continue\n            if is_private is not None and is_private != c.get('is_private'):\n                continue\n\n            conversation_filter.append(c)\n\n        if conversation_filter:\n            return conversation_filter\n\n    filters: Dict[str, Union[str, bool]] = {}\n    if name:\n        filters.update({'name': name})\n    if creator:\n        filters.update({'creator': creator})\n    if is_archived:\n        filters.update({'is_archived': is_archived})\n    if is_general:\n        filters.update({'is_general': is_general})\n    if is_private:\n        filters.update({'is_private': is_private})\n    filter_string = ', '.join([f'{k}={v}' for k, v in filters.items()])\n    demisto.debug(\n        f'could not find channels matching filters {filter_string} in integration context, searching via API'\n    )\n\n    # If not found in cache, search for it\n    body = {\n        'types': 'private_channel,public_channel',\n        'limit': PAGINATED_COUNT\n    }\n    response = send_slack_request_sync(CLIENT, 'conversations.list', http_verb='GET', body=body)\n    filtered_conversations: list = []\n    while True:\n        conversations = response['channels'] if response and response.get('channels') else []\n        cursor = response.get('response_metadata', {}).get('next_cursor')\n        conversation_filter = []\n        for c in conversations:\n            if name and not re.search(name, c.get('name'), re.IGNORECASE):\n                continue\n            if creator and not creator.upper() == c.get('creator'):\n                continue\n            if is_archived is not None and is_archived != c.get('is_archived'):\n                continue\n            if is_general is not None and is_general != c.get('is_general'):\n                continue\n            if is_private is not None and is_private != c.get('is_private'):\n                continue\n\n            conversation_filter.append(c)\n\n        if conversation_filter:\n            filtered_conversations.extend(conversation_filter)\n        if not cursor:\n            break\n\n        body = body.copy()  # strictly for unit-test purposes (test_filter_conversations_by_regex_paging)\n        body.update({'cursor': cursor})\n        response = send_slack_request_sync(CLIENT, 'conversations.list', http_verb='GET', body=body)\n\n    # Save conversations to cache\n    if filtered_conversations:\n        conversations = integration_context.get('conversations')\n        if conversations:\n            conversations = json.loads(conversations)\n            conversations.extend(filtered_conversations)\n        else:\n            conversations = filtered_conversations\n        set_to_integration_context_with_retries({'conversations': conversations}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n    return filtered_conversations\n\n\ndef slack_send():\n    \"\"\"\n    Sends a message to slack\n    \"\"\"\n\n    args = demisto.args()\n    demisto.debug(f'Got slack send request. args: {args}')\n    message = args.get('message', '')\n    to = args.get('to')\n    original_channel = args.get('channel')\n    group = args.get('group')\n    message_type = args.get('messageType', '')  # From server\n    original_message = args.get('originalMessage', '')  # From server\n    entry = args.get('entry')\n    ignore_add_url = args.get('ignoreAddURL', False) or args.get('IgnoreAddURL', False)\n    thread_id = args.get('threadID', '')\n    severity = args.get('severity')  # From server\n    blocks = args.get('blocks')\n    entry_object = args.get('entryObject')  # From server, available from demisto v6.1 and above\n    entitlement = ''\n\n    if message_type == MIRROR_TYPE and original_message.find(MESSAGE_FOOTER) != -1:\n        # return so there will not be a loop of messages\n        return\n\n    if message_type == MIRROR_TYPE:\n        tags = argToList(demisto.params().get('filtered_tags', []))\n        entry_tags = entry_object.get('tags', [])\n\n        if tags and not entry_tags:\n            return\n\n        # return if the entry tags is not containing any of the filtered_tags\n        if tags and not any(elem in entry_tags for elem in tags):\n            return\n\n    if (to and group) or (to and original_channel) or (to and original_channel and group):\n        return_error('Only one destination can be provided.')\n\n    if severity:\n        try:\n            severity = int(severity)\n        except Exception:\n            severity = None\n            pass\n\n    channel = original_channel\n    if original_channel == INCIDENT_NOTIFICATION_CHANNEL or (not original_channel and message_type == INCIDENT_OPENED):\n        original_channel = INCIDENT_NOTIFICATION_CHANNEL\n        channel = DEDICATED_CHANNEL\n        demisto.debug(f'trying to send message to channel {original_channel}, changing slack channel to {channel}')\n\n    if (channel == DEDICATED_CHANNEL and original_channel == INCIDENT_NOTIFICATION_CHANNEL\n            and ((severity is not None and severity \u003c SEVERITY_THRESHOLD)\n                 or not NOTIFY_INCIDENTS)):\n        channel = None\n\n    if not (to or group or channel):\n        return_error('Either a user, group or channel must be provided.')\n\n    reply = ''\n    expiry = ''\n    default_response = ''\n    if blocks:\n        entitlement_match = re.search(ENTITLEMENT_REGEX, blocks)\n        if entitlement_match:\n            try:\n                parsed_message = json.loads(blocks)\n                entitlement = parsed_message.get('entitlement')\n                blocks = parsed_message.get('blocks')\n                reply = parsed_message.get('reply')\n                expiry = parsed_message.get('expiry')\n                default_response = parsed_message.get('default_response')\n            except Exception:\n                demisto.info('Slack - could not parse JSON from entitlement blocks.')\n    elif message:\n        entitlement_match = re.search(ENTITLEMENT_REGEX, message)\n        if entitlement_match:\n            try:\n                parsed_message = json.loads(message)\n                entitlement = parsed_message.get('entitlement')\n                message = parsed_message.get('message')\n                reply = parsed_message.get('reply')\n                expiry = parsed_message.get('expiry')\n                default_response = parsed_message.get('default_response')\n            except Exception:\n                demisto.info('Slack - could not parse JSON from entitlement message.')\n\n    response = slack_send_request(to, channel, group, entry, ignore_add_url, thread_id, message=message, blocks=blocks)\n\n    if response:\n        thread = response.get('ts')\n        if entitlement:\n            save_entitlement(entitlement, thread, reply, expiry, default_response)\n\n        demisto.results({\n            'Type': entryTypes['note'],\n            'HumanReadable': f'Message sent to Slack successfully.\\nThread ID is: {thread}',\n            'Contents': response.data,\n            'ContentsFormat': formats['json'],\n            'EntryContext': {\n                'Slack.Thread(val.ID===obj.ID)': {\n                    'ID': thread\n                },\n            }\n        })\n    else:\n        demisto.results('Could not send the message to Slack.')\n\n\ndef save_entitlement(entitlement, thread, reply, expiry, default_response):\n    \"\"\"\n    Saves an entitlement with its thread\n\n    Args:\n        entitlement: The entitlement\n        thread: The thread\n        reply: The reply to send to the user.\n        expiry: The question expiration date.\n        default_response: The response to send if the question times out.\n    \"\"\"\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    questions = integration_context.get('questions', [])\n    if questions:\n        questions = json.loads(integration_context['questions'])\n    questions.append({\n        'thread': thread,\n        'entitlement': entitlement,\n        'reply': reply,\n        'expiry': expiry,\n        'sent': datetime.strftime(get_current_utc_time(), DATE_FORMAT),\n        'default_response': default_response\n    })\n\n    set_to_integration_context_with_retries({'questions': questions}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n\ndef slack_send_file():\n    \"\"\"\n    Sends a file to slack\n    \"\"\"\n    to = demisto.args().get('to')\n    channel = demisto.args().get('channel')\n    group = demisto.args().get('group')\n    entry_id = demisto.args().get('file')\n    thread_id = demisto.args().get('threadID')\n    comment = demisto.args().get('comment', '')\n\n    if not (to or channel or group):\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel = mirror.get('channel_name')\n\n    if not (to or channel or group):\n        return_error('Either a user, group or channel must be provided.')\n\n    file_path = demisto.getFilePath(entry_id)\n\n    file_dict = {\n        'path': file_path['path'],\n        'name': file_path['name'],\n        'comment': comment\n    }\n\n    response = slack_send_request(to, channel, group, thread_id=thread_id, file_dict=file_dict)\n    if response:\n        demisto.results('File sent to Slack successfully.')\n    else:\n        demisto.results('Could not send the file to Slack.')\n\n\ndef send_message(destinations: list, entry: str, ignore_add_url: bool, integration_context: dict, message: str,\n                 thread_id: str, blocks: str):\n    \"\"\"\n    Sends a message to Slack.\n    Args:\n        destinations: The destinations to send to.\n        entry: A WarRoom entry to send.\n        ignore_add_url: Do not add a Demisto URL to the message.\n        integration_context: Current integration context.\n        message: The message to send.\n        thread_id: The Slack thread ID to send the message to.\n        blocks: Message blocks to send\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    if not message:\n        if blocks:\n            message = 'New message from SOC Bot'\n            # This is shown in the notification bubble from Slack\n        else:\n            message = '\\n'\n\n    if message and not blocks:\n        if ignore_add_url and isinstance(ignore_add_url, str):\n            ignore_add_url = bool(strtobool(ignore_add_url))\n        if not ignore_add_url:\n            investigation = demisto.investigation()\n            server_links = demisto.demistoUrls()\n            if investigation:\n                if investigation.get('type') != PLAYGROUND_INVESTIGATION_TYPE:\n                    link = server_links.get('warRoom')\n                    if link:\n                        if entry:\n                            link += '/' + entry\n                        message += f'\\nView it on: {link}'\n                else:\n                    link = server_links.get('server', '')\n                    if link:\n                        message += f'\\nView it on: {link}#/home'\n    try:\n        response = send_message_to_destinations(destinations, message, thread_id, blocks)\n    except SlackApiError as e:\n        if str(e).find('not_in_channel') == -1 and str(e).find('channel_not_found') == -1:\n            raise\n        bot_id = integration_context.get('bot_id')\n        if not bot_id:\n            bot_id = get_bot_id()\n        for dest in destinations:\n            invite_users_to_conversation(dest, [bot_id])\n        response = send_message_to_destinations(destinations, message, thread_id, blocks)\n    return response\n\n\ndef send_message_to_destinations(destinations: list, message: str, thread_id: str, blocks: str = '') \\\n        -\u003e Optional[SlackResponse]:\n    \"\"\"\n    Sends a message to provided destinations Slack.\n\n    Args:\n        destinations: Destinations to send to.\n        message: The message to send.\n        thread_id: Slack thread ID to send to.\n        blocks: Message blocks to send\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    response: Optional[SlackResponse] = None\n    body: dict = {}\n\n    if message:\n        body['text'] = message\n    if blocks:\n        block_list = json.loads(blocks, strict=False)\n        body['blocks'] = block_list\n    if thread_id:\n        body['thread_ts'] = thread_id\n\n    for destination in destinations:\n        body['channel'] = destination\n        response = send_slack_request_sync(CLIENT, 'chat.postMessage', body=body)\n\n    return response\n\n\ndef send_file(destinations: list, file_dict: dict, integration_context: dict, thread_id: str) -\u003e \\\n        Optional[SlackResponse]:\n    \"\"\"\n    Sends a file to Slack.\n\n    Args:\n        destinations: Destinations to send the file to.\n        file_dict: The file to send.\n        integration_context: The current integration context.\n        thread_id: A Slack thread to send to.\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    try:\n        response = send_file_to_destinations(destinations, file_dict, thread_id)\n    except SlackApiError as e:\n        if str(e).find('not_in_channel') == -1 and str(e).find('channel_not_found') == -1:\n            raise\n        bot_id = integration_context.get('bot_id')\n        if not bot_id:\n            bot_id = get_bot_id()\n            integration_context['bot_id'] = bot_id\n        for dest in destinations:\n            invite_users_to_conversation(dest, [bot_id])\n        response = send_file_to_destinations(destinations, file_dict, thread_id)\n\n    return response\n\n\ndef send_file_to_destinations(destinations: list, file_dict: dict, thread_id: str) -\u003e Optional[SlackResponse]:\n    \"\"\"\n    Sends a file to provided destinations in Slack.\n\n    Args:\n        destinations: The destinations to send to.\n        file_dict: The file to send.\n        thread_id: A thread ID to send to.\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    response: Optional[SlackResponse] = None\n    body = {\n        'filename': file_dict['name']\n    }\n\n    if 'comment' in file_dict:\n        body['initial_comment'] = file_dict['comment']\n\n    for destination in destinations:\n        body['channels'] = destination\n        if thread_id:\n            body['thread_ts'] = thread_id\n\n        response = send_slack_request_sync(CLIENT, 'files.upload', file_=file_dict['path'], body=body)\n\n    return response\n\n\ndef slack_send_request(to: str, channel: str, group: str, entry: str = '', ignore_add_url: bool = False,\n                       thread_id: str = '', message: str = '', blocks: str = '', file_dict: dict = None) \\\n        -\u003e Optional[SlackResponse]:\n    \"\"\"\n    Requests to send a message or a file to Slack.\n\n    Args:\n        to: A Slack user to send to.\n        channel: A Slack channel to send to.\n        group: A Slack private channel to send to.\n        entry: WarRoom entry to send.\n        ignore_add_url: Do not add a Demisto URL to the message.\n        thread_id: The Slack thread ID to send to.\n        message: A message to send.\n        blocks: Blocks to send with a slack message\n        file_dict: A file to send.\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    mirrors: list = []\n    if integration_context:\n        if 'mirrors' in integration_context:\n            mirrors = json.loads(integration_context['mirrors'])\n\n    destinations = []\n\n    if to:\n        if isinstance(to, list):\n            to = to[0]\n        user = get_user_by_name(to)\n        if not user:\n            demisto.error(f'Could not find the Slack user {to}')\n        else:\n            body = {\n                'users': user.get('id')\n            }\n            im = send_slack_request_sync(CLIENT, 'conversations.open', body=body)\n            destinations.append(im.get('channel', {}).get('id'))\n    if channel or group:\n        if not destinations:\n            destination_name = channel or group\n            mirrored_channel_filter = list(filter(lambda m: f'incident-{m[\"investigation_id\"]}' == destination_name,\n                                                  mirrors))\n            if mirrored_channel_filter:\n                channel_mirror = mirrored_channel_filter[0]\n                conversation_id = channel_mirror['channel_id']\n            else:\n                conversation = get_conversation_by_name(destination_name)\n                if not conversation:\n                    return_error(f'Could not find the Slack conversation {destination_name}')\n                conversation_id = conversation.get('id')\n\n            if conversation_id:\n                destinations.append(conversation_id)\n\n    if not destinations:\n        return_error('Could not find any destination to send to.')\n\n    if file_dict:\n        response = send_file(destinations, file_dict, integration_context, thread_id)\n        return response\n\n    response = send_message(destinations, entry, ignore_add_url, integration_context, message,\n                            thread_id, blocks)\n\n    return response\n\n\ndef set_channel_topic():\n    \"\"\"\n    Sets a topic for a slack channel\n    \"\"\"\n\n    channel = demisto.args().get('channel')\n    topic = demisto.args().get('topic')\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror.get('channel_id', '')\n            # We need to update the topic in the mirror\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            mirrors = json.loads(integration_context['mirrors'])\n            mirror = mirrors.pop(mirrors.index(mirror))\n            mirror['channel_topic'] = topic\n            mirrors.append(mirror)\n            set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel not found - the Demisto app needs to be a member of the channel in order to look it up.')\n\n    body = {\n        'channel': channel_id,\n        'topic': topic\n    }\n    send_slack_request_sync(CHANNEL_CLIENT, 'conversations.setTopic', body=body)\n\n    demisto.results('Topic successfully set.')\n\n\ndef rename_channel():\n    \"\"\"\n    Renames a slack channel\n    \"\"\"\n\n    channel = demisto.args().get('channel')\n    new_name = demisto.args().get('name')\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror.get('channel_id', '')\n            # We need to update the name in the mirror\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            mirrors = json.loads(integration_context['mirrors'])\n            mirror = mirrors.pop(mirrors.index(mirror))\n            mirror['channel_name'] = new_name\n            mirrors.append(mirror)\n            set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel not found - the Demisto app needs to be a member of the channel in order to look it up.')\n\n    body = {\n        'channel': channel_id,\n        'name': new_name\n    }\n    send_slack_request_sync(CHANNEL_CLIENT, 'conversations.rename', body=body)\n\n    demisto.results('Channel renamed successfully.')\n\n\ndef close_channel():\n    \"\"\"\n    Archives a slack channel by name or its incident ID if mirrored.\n    \"\"\"\n    channel = demisto.args().get('channel')\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror.get('channel_id', '')\n            # We need to update the topic in the mirror\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            mirrors = json.loads(integration_context['mirrors'])\n            channel_id = mirror['channel_id']\n            # Check for mirrors on the archived channel\n            channel_mirrors = list(filter(lambda m: channel_id == m['channel_id'], mirrors))\n            for mirror in channel_mirrors:\n                mirror['remove'] = True\n                demisto.mirrorInvestigation(mirror['investigation_id'], f'none:{mirror[\"mirror_direction\"]}',\n                                            mirror['auto_close'])\n\n            set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel not found - the Demisto app needs to be a member of the channel in order to look it up.')\n\n    body = {\n        'channel': channel_id\n    }\n    send_slack_request_sync(CHANNEL_CLIENT, 'conversations.archive', body=body)\n\n    demisto.results('Channel successfully archived.')\n\n\ndef create_channel():\n    \"\"\"\n    Creates a channel in Slack using the provided arguments.\n    \"\"\"\n    channel_type = demisto.args().get('type', 'private')\n    channel_name = demisto.args()['name']\n    users = argToList(demisto.args().get('users', []))\n    topic = demisto.args().get('topic')\n\n    body = {\n        'name': channel_name\n    }\n\n    if channel_type == 'private':\n        body['is_private'] = True\n\n    conversation = send_slack_request_sync(CHANNEL_CLIENT, 'conversations.create', body=body).get('channel', {})\n\n    if users:\n        slack_users = search_slack_users(users)\n        invite_users_to_conversation(conversation.get('id'), list(map(lambda u: u.get('id'), slack_users)))\n    if topic:\n        body = {\n            'channel': conversation.get('id'),\n            'topic': topic\n        }\n        send_slack_request_sync(CHANNEL_CLIENT, 'conversations.setTopic', body=body)\n\n    created_channel_name = conversation.get('name')\n    demisto.results(f'Successfully created the channel {created_channel_name}')\n\n\ndef invite_to_channel():\n    channel = demisto.args().get('channel')\n    users = argToList(demisto.args().get('users', []))\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror['channel_id']\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel not found - the Demisto app needs to be a member of the channel in order to look it up.')\n\n    slack_users = search_slack_users(users)\n    if slack_users:\n        invite_users_to_conversation(channel_id, list(map(lambda u: u.get('id'), slack_users)))\n    else:\n        return_error('No users found')\n\n    demisto.results('Successfully invited users to the channel.')\n\n\ndef kick_from_channel():\n    channel = demisto.args().get('channel')\n    users = argToList(demisto.args().get('users', []))\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror['channel_id']\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel not found - the Demisto app needs to be a member of the channel in order to look it up.')\n\n    slack_users = search_slack_users(users)\n    if slack_users:\n        kick_users_from_conversation(channel_id, list(map(lambda u: u.get('id'), slack_users)))\n    else:\n        return_error('No users found')\n\n    demisto.results('Successfully kicked users from the channel.')\n\n\ndef get_user():\n    user = demisto.args()['user']\n\n    slack_user = get_user_by_name(user)\n    if not slack_user:\n        return_error('User not found')\n\n    profile = slack_user.get('profile', {})\n    result_user = {\n        'ID': slack_user.get('id'),\n        'Username': slack_user.get('name'),\n        'Name': profile.get('real_name_normalized') or profile.get('real_name'),\n        'DisplayName': profile.get('display_name'),\n        'Email': profile.get('email')\n    }\n\n    hr = tableToMarkdown('Details for Slack user: ' + user, result_user,\n                         headers=['ID', 'Username', 'Name', 'DisplayName', 'Email'], headerTransform=pascalToSpace,\n                         removeNull=True)\n    context = {\n        'Slack.User(val.ID === obj.ID)': createContext(result_user, removeNull=True)\n    }\n\n    return_outputs(hr, context, slack_user)\n\n\ndef long_running_main():\n    \"\"\"\n    Starts the long running thread.\n    \"\"\"\n    asyncio.run(start_listening())\n\n\ndef init_globals(command_name: str = ''):\n    \"\"\"\n    Initializes global variables according to the integration parameters\n    \"\"\"\n    global BOT_TOKEN, ACCESS_TOKEN, PROXY_URL, PROXIES, DEDICATED_CHANNEL, CLIENT, CHANNEL_CLIENT\n    global SEVERITY_THRESHOLD, ALLOW_INCIDENTS, NOTIFY_INCIDENTS, INCIDENT_TYPE, VERIFY_CERT\n    global BOT_NAME, BOT_ICON_URL, MAX_LIMIT_TIME, PAGINATED_COUNT, SSL_CONTEXT\n\n    VERIFY_CERT = not demisto.params().get('unsecure', False)\n    if not VERIFY_CERT:\n        SSL_CONTEXT = ssl.create_default_context()\n        SSL_CONTEXT.check_hostname = False\n        SSL_CONTEXT.verify_mode = ssl.CERT_NONE\n    else:\n        # Use default SSL context\n        SSL_CONTEXT = None\n\n    if command_name != 'long-running-execution':\n        loop = asyncio.get_event_loop()\n        if not loop._default_executor:  # type: ignore[attr-defined]\n            demisto.info(f'setting _default_executor on loop: {loop} id: {id(loop)}')\n            loop.set_default_executor(concurrent.futures.ThreadPoolExecutor(max_workers=4))\n\n    BOT_TOKEN = demisto.params().get('bot_token', '')\n    ACCESS_TOKEN = demisto.params().get('access_token', '')\n    PROXIES = handle_proxy()\n    proxy_url = demisto.params().get('proxy_url')\n    PROXY_URL = proxy_url or PROXIES.get('http')  # aiohttp only supports http proxy\n    DEDICATED_CHANNEL = demisto.params().get('incidentNotificationChannel')\n    CLIENT = slack.WebClient(token=BOT_TOKEN, proxy=PROXY_URL, ssl=SSL_CONTEXT)\n    CHANNEL_CLIENT = slack.WebClient(token=ACCESS_TOKEN, proxy=PROXY_URL, ssl=SSL_CONTEXT)\n    SEVERITY_THRESHOLD = SEVERITY_DICT.get(demisto.params().get('min_severity', 'Low'), 1)\n    ALLOW_INCIDENTS = demisto.params().get('allow_incidents', False)\n    NOTIFY_INCIDENTS = demisto.params().get('notify_incidents', True)\n    INCIDENT_TYPE = demisto.params().get('incidentType')\n    BOT_NAME = demisto.params().get('bot_name')  # Bot default name defined by the slack plugin (3-rd party)\n    BOT_ICON_URL = demisto.params().get('bot_icon')  # Bot default icon url defined by the slack plugin (3-rd party)\n    MAX_LIMIT_TIME = int(demisto.params().get('max_limit_time', '60'))\n    PAGINATED_COUNT = int(demisto.params().get('paginated_count', '200'))\n\n\ndef print_thread_dump():\n    demisto.info(f'current thread: {threading.current_thread().name}')\n    for threadId, stack in sys._current_frames().items():\n        stack_str = '\\n'.join(traceback.format_stack(stack))\n        demisto.info(f'{threadId} stack: {stack_str}')\n\n\ndef loop_info(loop: asyncio.AbstractEventLoop):\n    if not loop:\n        return \"loop is None\"\n    info = f'loop: {loop}. id: {id(loop)}.'\n    info += f'executor: {loop._default_executor} id: {id(loop._default_executor)}'  # type: ignore[attr-defined]\n    if loop._default_executor:  # type: ignore[attr-defined]\n        info += f' executor threads size: {len(loop._default_executor._threads)}'  # type: ignore[attr-defined]\n        info += f' max: {loop._default_executor._max_workers} {loop._default_executor._threads}'  # type: ignore[attr-defined]\n    return info\n\n\ndef slack_get_integration_context():\n    integration_context = get_integration_context()\n    return_results(fileResult('slack_integration_context', json.dumps(integration_context), EntryType.ENTRY_INFO_FILE))\n\n\ndef filter_channels_command():\n    \"\"\"\n    Gets channels that match criteria\n    \"\"\"\n    name = demisto.args().get('name', '')\n    creator = demisto.args().get('creator', '')\n    is_archived = demisto.args().get('is_archived')\n    is_general = demisto.args().get('is_general')\n    is_private = demisto.args().get('is_private')\n    limit = int(demisto.args().get('limit', '20'))\n\n    is_archived = bool(strtobool(is_archived)) if is_archived else None\n    is_general = bool(strtobool(is_general)) if is_general else None\n    is_private = bool(strtobool(is_private)) if is_private else None\n\n    command_results_list: List[Dict[str, Union[bool, str]]] = []\n    filtered_conversations = filter_conversations(\n        name=name,\n        creator=creator,\n        is_archived=is_archived,\n        is_general=is_general,\n        is_private=is_private\n    )\n    demisto.debug(f'found {len(filtered_conversations)} filtered conversations; limiting results to {limit}')\n    for conversation in filtered_conversations[:limit]:\n        result_conversation = {\n            'ID': conversation.get('id'),\n            'Name': conversation.get('name'),\n            'Created': conversation.get('created'),\n            'Creator': conversation.get('creator'),\n            'IsArchived': conversation.get('is_archived'),\n            'IsGeneral': conversation.get('is_general'),\n            'IsPrivate': conversation.get('is_private'),\n        }\n        command_results_list.append(result_conversation)\n\n    if command_results_list:\n        human_readable = tableToMarkdown('Channels: ', command_results_list,\n                                         headers=['ID', 'Name', 'Created', 'Creator', 'IsArchived', 'IsGeneral', 'IsPrivate'],\n                                         removeNull=True)\n\n    else:\n        human_readable = 'No channels found.'\n\n    return_results(CommandResults(\n        outputs_prefix='Slack.Channel',\n        outputs_key_field='ID',\n        outputs=command_results_list,\n        readable_output=human_readable\n    ))\n\n\ndef main():\n    \"\"\"\n    Main\n    \"\"\"\n    global CLIENT\n    if is_debug_mode():\n        os.environ['PYTHONASYNCIODEBUG'] = \"1\"\n\n    commands = {\n        'test-module': test_module,\n        'long-running-execution': long_running_main,\n        'slack-mirror-investigation': mirror_investigation,\n        'mirror-investigation': mirror_investigation,\n        'slack-send': slack_send,\n        'send-notification': slack_send,\n        'slack-send-file': slack_send_file,\n        'slack-set-channel-topic': set_channel_topic,\n        'close-channel': close_channel,\n        'slack-close-channel': close_channel,\n        'slack-create-channel': create_channel,\n        'slack-invite-to-channel': invite_to_channel,\n        'slack-kick-from-channel': kick_from_channel,\n        'slack-rename-channel': rename_channel,\n        'slack-get-user-details': get_user,\n        'slack-get-integration-context': slack_get_integration_context,\n        'slack-filter-channels': filter_channels_command,\n    }\n\n    command_name = demisto.command()\n    init_globals(command_name)\n\n    try:\n        command_func = commands[command_name]\n        command_func()\n    except Exception as e:\n        LOG(e)\n        return_error(str(e))\n    finally:\n        demisto.info(f'{command_name} completed. loop: {loop_info(CLIENT._event_loop)}')  # type: ignore\n        if is_debug_mode():\n            print_thread_dump()\n\n\nif __name__ in ['__main__', '__builtin__', 'builtins']:\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.1.5","modified":"2021-09-05T10:49:33.529845+03:00","name":"SlackV2","packID":"Slack","packPropagationLabels":["all"],"prevName":"SlackV2","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"beta":true,"brand":"","canGetSamples":true,"category":"Messaging","commitMessage":"","configuration":[{"defaultValue":"","display":"","displayPassword":"Bot Token","hidden":false,"hiddenPassword":false,"hiddenUsername":true,"info":"","name":"bot_token","options":null,"required":false,"type":9},{"defaultValue":"","display":"","displayPassword":"App Token","hidden":false,"hiddenPassword":false,"hiddenUsername":true,"info":"","name":"app_token","options":null,"required":false,"type":9},{"defaultValue":"","display":"Dedicated Slack channel to receive notifications","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentNotificationChannel","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Send notifications about incidents to the dedicated channel","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"notify_incidents","options":null,"required":false,"type":8},{"defaultValue":"Low","display":"Minimum incident severity to send messages to slack by","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"min_severity","options":["Unknown","Low","Medium","High","Critical"],"required":false,"type":15},{"defaultValue":"Unclassified","display":"Type of incidents created in Slack","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"","display":"Allow external users to create incidents via DM","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"allow_incidents","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"unsecure","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Long running instance. Required for investigation mirroring and direct messages.","displayPassword":"","hidden":true,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"longRunning","options":null,"required":false,"type":8},{"defaultValue":"Cortex XSOAR","display":"Bot display name in Slack","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"bot_name","options":null,"required":false,"type":0},{"defaultValue":"https://avatars.slack-edge.com/2020-05-24/1142885630851_5529c7f034d9b96ec39c_512.png","display":"Bot icon in Slack - Image URL (Cortex XSOAR icon by default)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"bot_icon","options":null,"required":false,"type":0},{"defaultValue":"60","display":"Maximum time to wait for a rate limiting call in seconds","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"max_limit_time","options":null,"required":false,"type":0},{"defaultValue":"200","display":"Number of objects to return in each paginated call","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"paginated_count","options":null,"required":false,"type":0},{"defaultValue":"","display":"Comma separated list of tags To filter the messages sent from demisto.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Only supported in Demisto V6.1 and above.","name":"filtered_tags","options":null,"required":false,"type":0},{"defaultValue":"","display":"Enable DMs to the bot","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"enable_dm","options":null,"required":false,"type":8}],"definitionId":"","description":"Send messages and notifications to your Slack team.","detailedDescription":"Slack V3 utilizes \"Socket Mode\" to enable the integration to communicate directly with Slack for mirroring. \nThis requires a dedicated Slack app to be created for the XSOAR integration. For instructions on how to create and configure your custom Slack app, please review the documentation found [here](https://xsoar.pan.dev/docs/reference/integrations/slack-v3).\n\nNote: This is a beta Integration, which lets you implement and test pre-release software. Since the integration is beta, it might contain bugs. Updates to the integration during the beta phase might include non-backward compatible features. We appreciate your feedback on the quality and usability of the integration to help us identify issues, fix them, and continually improve.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/slack-v3)","display":"Slack v3 (beta)","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"SlackV3","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"auto":"PREDEFINED","default":true,"defaultValue":"all","deprecated":false,"description":"The mirroring type. Can be \"all\", which mirrors everything, \"chat\", which mirrors only chats (not commands), or \"none\", which stops all mirroring.","name":"type","predefined":["all","chat","none"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"true","deprecated":false,"description":"Whether the channel is auto-closed when an investigation is closed. Can be \"true\" or \"false\". Default is \"true\".","name":"autoclose","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"both","deprecated":false,"description":"The mirroring direction. Can be \"FromDemisto\", \"ToDemisto\", or \"Both\". Default value is \"Both\".","name":"direction","predefined":["Both","FromDemisto","ToDemisto"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"group","deprecated":false,"description":"The channel type. Can be \"channel\" or \"group\". The default value is \"group\".","name":"mirrorTo","predefined":["channel","group"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the channel. The default is \"incident-\u003cincidentID\u003e\".","name":"channelName","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The topic of the channel.","name":"channelTopic","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to remove the Slack administrator (channel creator) from the mirrored channel.","name":"kickAdmin","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Mirrors the investigation between Slack and the Demisto War Room.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"mirror-investigation","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The message content. When mentioning another slack user, make sure to do so in the following format: \u003c@user_name\u003e.","name":"message","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The user to whom to send the message. Can be either the username or email address.","name":"to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the Slack channel to which to send the message.","name":"channel","required":false,"secret":false},{"default":false,"deprecated":false,"description":"An entry ID to send as a link.","name":"entry","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to include a URL to the relevant component in Demisto. Can be \"true\" or \"false\". Default value is \"false\".","name":"ignoreAddURL","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread to which to reply - can be retrieved from a previous send-notification command.","name":"threadID","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A JSON string of Slack blocks to send in the message.","name":"blocks","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sends a message to a user, group, or channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"send-notification","outputs":[{"contentPath":"","contextPath":"Slack.Thread.ID","description":"The Slack thread ID.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The name of the channel to archive. If not provided, the mirrored investigation channel is archived (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Archives a Slack channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"close-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The ID of the file entry to send.","name":"file","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The user to whom to send the file. Can be the username or the email address.","name":"to","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the Slack group (private channel) to which to send the file.","name":"group","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The name of the Slack channel to which to send the file.","name":"channel","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread to which to reply - can be retrieved from a previous send-notification command.","name":"threadID","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comment to add to the file.","name":"comment","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sends a file to a user, channel, or group. If not specified, the file is sent to the mirrored investigation channel (if the channel exists).","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-send-file","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The channel name. If not specified, the topic of the mirrored investigation channel is set (if the channel exists).","name":"channel","required":false,"secret":false},{"default":true,"deprecated":false,"description":"The topic for the channel.","name":"topic","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Sets the topic for a channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-set-channel-topic","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"auto":"PREDEFINED","default":false,"defaultValue":"private","deprecated":false,"description":"The channel type. Can be \"private\" or \"public\".","name":"type","predefined":["private","public"],"required":false,"secret":false},{"default":true,"deprecated":false,"description":"The name of the channel.","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A CSV list of user names or email addresses to invite to the channel. For example: \"user1, user2...\".","name":"users","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Creates a channel in Slack.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-create-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A CSV list of usernames or email addresses to invite to join the channel. For example: \"user1, user2...\".","name":"users","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the channel to which to invite the users. If the name of the channel is not specified, the name of the mirrored investigation channel is used (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Invites users to join a channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-invite-to-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A CSV list of usernames or email addresses to remove from the a channel. For example: \"user1, user2...\"","name":"users","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The name of the channel from which to remove the users. If the name of the channel is not specified, the mirrored investigation channel is used (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Removes users from the specified channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-kick-from-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The new name of the channel.","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The current name of the channel. If the name of the channel is not specified, the mirrored investigation channel is used (if the channel exists).","name":"channel","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Renames a channel in Slack.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-rename-channel","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The Slack user (username or email).","name":"user","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get details about a specified user.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-get-user-details","outputs":[{"contentPath":"","contextPath":"Slack.User.ID","description":"The ID of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.Username","description":"The username of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.Name","description":"The actual name of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.DisplayName","description":"The display name of the user.","type":"String"},{"contentPath":"","contextPath":"Slack.User.Email","description":"The email address of the user.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Returns the integration context as a file. Use this command for debug purposes only.","docsHidden":false,"execution":false,"hidden":true,"important":null,"indicatorAction":false,"name":"slack-get-integration-context","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The channel containing the message.","name":"channel","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread of which to pin - can be retrieved from a previous send-notification command.","name":"threadID","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Pins a selected message to the given channel.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-pin-message","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The channel the message is posted in.","name":"channel","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The ID of the thread of which to edit - can be retrieved from a previous send-notification command.","name":"threadID","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The updated message.","name":"message","required":false,"secret":false},{"default":false,"deprecated":false,"description":"A JSON string of the block to send.","name":"blocks","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Whether to include a URL to the relevant component in XSOAR. Can be \"true\" or \"false\". Default value is \"false\".","name":"ignore_add_url","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Edit an existing Slack message.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"slack-edit-message","outputs":[{"contentPath":"","contextPath":"Slack.Thread.ID","description":"The timestamp identifier for the message.","type":"String"},{"contentPath":"","contextPath":"Slack.Thread.Channel","description":"The channel ID the message was posted in.","type":"String"},{"contentPath":"","contextPath":"Slack.Thread.Text","description":"The text the message was updated with.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/slackv3:1.0.0.23423","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":true,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"from typing import Tuple\n\n\n\n\nimport ssl\nimport asyncio\nimport concurrent\nimport slack_sdk\nimport threading\nimport aiohttp\n\nfrom distutils.util import strtobool\nfrom slack_sdk.web.async_client import AsyncWebClient\nfrom slack_sdk.socket_mode.aiohttp import SocketModeClient\nfrom slack_sdk.errors import SlackApiError\nfrom slack_sdk.web.slack_response import SlackResponse\nfrom slack_sdk.socket_mode.response import SocketModeResponse\nfrom slack_sdk.socket_mode.request import SocketModeRequest\n\n\n''' CONSTANTS '''\n\nSEVERITY_DICT = {\n    'Unknown': 0,\n    'Low': 1,\n    'Medium': 2,\n    'High': 3,\n    'Critical': 4\n}\n\nUSER_TAG_EXPRESSION = '\u003c@(.*?)\u003e'\nCHANNEL_TAG_EXPRESSION = '\u003c#(.*?)\u003e'\nURL_EXPRESSION = r'\u003c(https?://.+?)(?:\\|.+)?\u003e'\nGUID_REGEX = r'(\\{){0,1}[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}(\\}){0,1}'\nENTITLEMENT_REGEX = r'{}@(({})|(?:[\\d_]+))_*(\\|\\S+)?\\b'.format(GUID_REGEX, GUID_REGEX)\nCOMMAND_REGEX = r\"command.*?(?=;)\"\nMESSAGE_FOOTER = '\\n**From Slack**'\nMIRROR_TYPE = 'mirrorEntry'\nINCIDENT_OPENED = 'incidentOpened'\nINCIDENT_NOTIFICATION_CHANNEL = 'incidentNotificationChannel'\nPLAYGROUND_INVESTIGATION_TYPE = 9\nWARNING_ENTRY_TYPE = 11\nPOLL_INTERVAL_MINUTES: Dict[Tuple, float] = {\n    (0, 15): 1,\n    (15, 60): 2,\n    (60,): 5\n}\nDATE_FORMAT = '%Y-%m-%d %H:%M:%S'\nOBJECTS_TO_KEYS = {\n    'mirrors': 'investigation_id',\n    'questions': 'entitlement',\n    'users': 'id'\n}\nSYNC_CONTEXT = True\n\n''' GLOBALS '''\n\nBOT_TOKEN: str\nAPP_TOKEN: str\nPROXY_URL: Optional[str]\nPROXIES: dict\nDEDICATED_CHANNEL: str\nASYNC_CLIENT: slack_sdk.web.async_client.AsyncWebClient\nCLIENT: slack_sdk.WebClient\nALLOW_INCIDENTS: bool\nNOTIFY_INCIDENTS: bool\nINCIDENT_TYPE: str\nSEVERITY_THRESHOLD: int\nVERIFY_CERT: bool\nSSL_CONTEXT: Optional[ssl.SSLContext]\nQUESTION_LIFETIME: int\nBOT_NAME: str\nBOT_ICON_URL: str\nMAX_LIMIT_TIME: int\nPAGINATED_COUNT: int\nENABLE_DM: bool\n\n\n''' HELPER FUNCTIONS '''\n\n\ndef get_bot_id() -\u003e str:\n    \"\"\"\n    Gets the app bot ID\n\n    Returns:\n        The app bot ID\n    \"\"\"\n    response = CLIENT.auth_test()\n    return response.get('user_id')\n\n\ndef test_module():\n    \"\"\"\n    Sends a test message to the dedicated slack channel.\n    \"\"\"\n    if not DEDICATED_CHANNEL:\n        return_error('A dedicated slack channel must be provided.')\n    channel = get_conversation_by_name(DEDICATED_CHANNEL)\n    if not channel:\n        return_error('Dedicated channel not found.')\n    message = 'Hi there! This is a test message.'\n\n    CLIENT.chat_postMessage(channel=channel.get('id'), text=message)  # type: ignore\n\n    demisto.results('ok')\n\n\ndef get_current_utc_time() -\u003e datetime:\n    \"\"\"\n    Returns:\n        The current UTC time.\n    \"\"\"\n    return datetime.utcnow()\n\n\ndef get_user_by_name(user_to_search: str, add_to_context: bool = True) -\u003e dict:\n    \"\"\"\n    Gets a slack user by a user name\n\n    Args:\n        user_to_search: The user name or email\n        add_to_context: Whether to update the integration context\n\n    Returns:\n        A slack user object\n    \"\"\"\n\n    user: dict = {}\n    users: list = []\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    user_to_search = user_to_search.lower()\n    if integration_context.get('users'):\n        users = json.loads(integration_context['users'])\n        users_filter = list(filter(lambda u: u.get('name', '').lower() == user_to_search\n                                             or u.get('profile', {}).get('email', '').lower() == user_to_search\n                                             or u.get('real_name', '').lower() == user_to_search, users))\n        if users_filter:\n            user = users_filter[0]\n    if not user:\n        body = {\n            'limit': PAGINATED_COUNT\n        }\n\n        response = send_slack_request_sync(CLIENT, 'users.list', http_verb='GET', body=body)\n        while True:\n            workspace_users = response['members'] if response and response.get('members',\n                                                                               []) else []\n            cursor = response.get('response_metadata', {}).get('next_cursor')\n            users_filter = list(filter(lambda u: u.get('name', '').lower() == user_to_search\n                                       or u.get('profile', {}).get('email', '').lower() == user_to_search\n                                       or u.get('real_name', '').lower() == user_to_search, workspace_users))\n            if users_filter:\n                break\n            if not cursor:\n                break\n            body = body.copy()  # strictly for unit testing purposes\n            body.update({'cursor': cursor})\n            response = send_slack_request_sync(CLIENT, 'users.list', http_verb='GET', body=body)\n\n        if users_filter:\n            user = users_filter[0]\n            if add_to_context:\n                users.append(user)\n                set_to_integration_context_with_retries({'users': users}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n        else:\n            return {}\n\n    return user\n\n\ndef search_slack_users(users: Union[list, str]) -\u003e list:\n    \"\"\"\n    Search given users in Slack\n\n    Args:\n        users: The users to find\n\n    Returns:\n        The slack users\n    \"\"\"\n    slack_users = []\n\n    if not isinstance(users, list):\n        users = [users]\n\n    for user in users:\n        slack_user = get_user_by_name(user)\n        if not slack_user:\n            demisto.results({\n                'Type': WARNING_ENTRY_TYPE,\n                'Contents': f'User {user} not found in Slack',\n                'ContentsFormat': formats['text']\n            })\n        else:\n            slack_users.append(slack_user)\n    return slack_users\n\n\ndef find_mirror_by_investigation() -\u003e dict:\n    \"\"\"\n    Finds a mirrored channel by the mirrored investigation\n\n    Returns:\n        The mirror object\n    \"\"\"\n    mirror: dict = {}\n    investigation = demisto.investigation()\n    if investigation:\n        integration_context = get_integration_context(SYNC_CONTEXT)\n        if integration_context.get('mirrors'):\n            mirrors = json.loads(integration_context['mirrors'])\n            investigation_filter = list(filter(lambda m: investigation.get('id') == m['investigation_id'],\n                                               mirrors))\n            if investigation_filter:\n                mirror = investigation_filter[0]\n\n    return mirror\n\n\ndef set_name_and_icon(body: dict, method: str):\n    \"\"\"\n    If provided, sets a name and an icon for the bot if a message is sent.\n    Args:\n        body: The message body.\n        method: The current API method.\n    \"\"\"\n    if method == 'chat.postMessage':\n        if BOT_NAME:\n            body['username'] = BOT_NAME\n        if BOT_ICON_URL:\n            body['icon_url'] = BOT_ICON_URL\n\n\ndef send_slack_request_sync(client: slack_sdk.WebClient, method: str, http_verb: str = 'POST', file_: str = '',\n                            body: dict = None) -\u003e SlackResponse:\n    \"\"\"\n    Sends a request to slack API while handling rate limit errors.\n\n    Args:\n        client: The slack client.\n        method: The method to use.\n        http_verb: The HTTP method to use.\n        file_: A file path to send.\n        body: The request body.\n\n    Returns:\n        The slack API response.\n    \"\"\"\n    if body is None:\n        body = {}\n\n    set_name_and_icon(body, method)\n    total_try_time = 0\n    while True:\n        try:\n            demisto.debug(f'Sending slack {method} (sync). Body is: {str(body)}')\n            if http_verb == 'POST':\n                if file_:\n                    response = client.api_call(method, files={\"file\": file_}, data=body)\n                else:\n                    response = client.api_call(method, json=body)\n            else:\n                response = client.api_call(method, http_verb='GET', params=body)\n        except SlackApiError as api_error:\n            demisto.debug(f'Got rate limit error (sync). Body is: {str(body)}\\n{api_error}')\n            response = api_error.response\n            headers = response.headers  # type: ignore\n            if 'Retry-After' in headers:\n                retry_after = int(headers['Retry-After'])\n                total_try_time += retry_after\n                if total_try_time \u003c MAX_LIMIT_TIME:\n                    time.sleep(retry_after)\n                    continue\n            raise\n        break\n\n    return response  # type: ignore\n\n\nasync def send_slack_request_async(client: AsyncWebClient, method: str, http_verb: str = 'POST', file_: str = '',\n                                   body: dict = None) -\u003e SlackResponse:\n    \"\"\"\n    Sends an async request to slack API while handling rate limit errors.\n\n    Args:\n        client: The slack client.\n        method: The method to use.\n        http_verb: The HTTP method to use.\n        file_: A file path to send.\n        body: The request body.\n\n    Returns:\n        The slack API response.\n    \"\"\"\n    if body is None:\n        body = {}\n\n    set_name_and_icon(body, method)\n    total_try_time = 0\n    while True:\n        try:\n            demisto.debug(f'Sending slack {method} (async). Body is: {str(body)}')\n            if http_verb == 'POST':\n                if file_:\n                    response = await client.api_call(method, files={\"file\": file_}, data=body)  # type: ignore\n                else:\n                    response = await client.api_call(method, json=body)  # type: ignore\n            else:\n                response = await client.api_call(method, http_verb='GET', params=body)  # type: ignore\n        except SlackApiError as api_error:\n            demisto.debug(f'Got rate limit error (async). Body is: {str(body)}\\n{api_error}')\n            response = api_error.response\n            headers = response.headers\n            if 'Retry-After' in headers:\n                retry_after = int(headers['Retry-After'])\n                total_try_time += retry_after\n                if total_try_time \u003c MAX_LIMIT_TIME:\n                    await asyncio.sleep(retry_after)\n                    continue\n            raise\n        break\n\n    return response  # type: ignore\n\n\n''' MIRRORING '''\n\n\nasync def get_slack_name(slack_id: str, client: AsyncWebClient) -\u003e str:\n    \"\"\"\n    Get the slack name of a provided user or channel by its ID\n\n    Args:\n        client: The slack client\n        slack_id: The slack user or channel ID\n\n    Returns:\n        The slack user or channel name\n    \"\"\"\n    if not slack_id:\n        return ''\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    prefix = slack_id[0]\n    slack_name = ''\n\n    if prefix in ['C', 'D', 'G']:\n        slack_id = slack_id.split('|')[0]\n        conversation: dict = {}\n        if integration_context.get('conversations'):\n            conversations = list(filter(lambda c: c['id'] == slack_id,\n                                        json.loads(integration_context['conversations'])))\n            if conversations:\n                conversation = conversations[0]\n        if not conversation:\n            conversation = await client.conversations_info(channel=slack_id)  # type: ignore\n        slack_name = conversation.get('name', '')\n    elif prefix == 'U':\n        user: dict = {}\n        if integration_context.get('users'):\n            users = list(filter(lambda u: u['id'] == slack_id, json.loads(integration_context['users'])))\n            if users:\n                user = users[0]\n        if not user:\n            user = await client.users_info(user=slack_id)  # type: ignore\n\n        slack_name = user.get('name', '')\n\n    return slack_name\n\n\nasync def clean_message(message: str, client: AsyncWebClient) -\u003e str:\n    \"\"\"\n    Prettifies a slack message - replaces tags and URLs with clean expressions\n\n    Args:\n        message: The slack message\n        client: The slack client\n\n    Returns:\n        The clean slack message\n    \"\"\"\n    matches = re.findall(USER_TAG_EXPRESSION, message)\n    matches += re.findall(CHANNEL_TAG_EXPRESSION, message)\n    message = re.sub(USER_TAG_EXPRESSION, r'\\1', message)\n    message = re.sub(CHANNEL_TAG_EXPRESSION, r'\\1', message)\n    for match in matches:\n        slack_name = await get_slack_name(match, client)\n        message = message.replace(match, slack_name)\n\n    resolved_message = re.sub(URL_EXPRESSION, r'\\1', message)\n\n    return resolved_message\n\n\ndef invite_users_to_conversation(conversation_id: str, users_to_invite: list):\n    \"\"\"\n    Invites users to a provided conversation using a provided slack client with a channel token.\n\n    Args:\n        conversation_id: The slack conversation ID to invite the users to.\n        users_to_invite: The user slack IDs to invite.\n    \"\"\"\n    for user in users_to_invite:\n        try:\n            body = {\n                'channel': conversation_id,\n                'users': user\n            }\n            send_slack_request_sync(CLIENT, 'conversations.invite', body=body)\n\n        except SlackApiError as e:\n            message = str(e)\n            if \"already_in_channel\" in message:\n                continue\n            elif message.find('cant_invite_self') == -1:\n                raise\n\n\ndef kick_users_from_conversation(conversation_id: str, users_to_kick: list):\n    \"\"\"\n    Kicks users from a provided conversation using a provided slack client with a channel token.\n\n    Args:\n        conversation_id: The slack conversation ID to kick the users from.\n        users_to_kick: The user slack IDs to kick.\n    \"\"\"\n    for user in users_to_kick:\n        try:\n            body = {\n                'channel': conversation_id,\n                'user': user\n            }\n            send_slack_request_sync(CLIENT, 'conversations.kick', body=body)\n        except SlackApiError as e:\n            message = str(e)\n            if message.find('cant_invite_self') == -1:\n                raise\n\n\ndef mirror_investigation():\n    \"\"\"\n    Updates the integration context with a new or existing mirror.\n    \"\"\"\n    mirror_type = demisto.args().get('type', 'all')\n    auto_close = demisto.args().get('autoclose', 'true')\n    mirror_direction = demisto.args().get('direction', 'both')\n    mirror_to = demisto.args().get('mirrorTo', 'group')\n    channel_name = demisto.args().get('channelName', '')\n    channel_topic = demisto.args().get('channelTopic', '')\n    kick_admin = bool(strtobool(demisto.args().get('kickAdmin', 'false')))\n\n    investigation = demisto.investigation()\n\n    if investigation.get('type') == PLAYGROUND_INVESTIGATION_TYPE:\n        return_error('Can not perform this action in playground.')\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    if not integration_context or not integration_context.get('mirrors', []):\n        mirrors: list = []\n    else:\n        mirrors = json.loads(integration_context['mirrors'])\n    if not integration_context or not integration_context.get('conversations', []):\n        conversations: list = []\n    else:\n        conversations = json.loads(integration_context['conversations'])\n\n    investigation_id = investigation.get('id')\n    send_first_message = False\n    current_mirror = list(filter(lambda m: m['investigation_id'] == investigation_id, mirrors))\n    channel_filter: list = []\n    if channel_name:\n        channel_filter = list(filter(lambda m: m['channel_name'] == channel_name, mirrors))\n    if not current_mirror:\n        channel_name = channel_name or f'incident-{investigation_id}'\n\n        if not channel_filter:\n            body = {\n                'name': channel_name\n            }\n\n            if mirror_to != 'channel':\n                body['is_private'] = True\n\n            conversation = send_slack_request_sync(CLIENT, 'conversations.create',\n                                                   body=body).get('channel', {})\n            conversation_name = conversation.get('name')\n            conversation_id = conversation.get('id')\n            conversations.append(conversation)\n\n            # Get the bot ID so we can invite him\n            if integration_context.get('bot_id'):\n                bot_id = integration_context['bot_id']\n            else:\n                bot_id = get_bot_id()\n                set_to_integration_context_with_retries({'bot_id': bot_id}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n            invite_users_to_conversation(conversation_id, [bot_id])\n\n            send_first_message = True\n        else:\n            mirrored_channel = channel_filter[0]\n            conversation_id = mirrored_channel['channel_id']\n            conversation_name = mirrored_channel['channel_name']\n\n        mirror = {\n            'channel_id': conversation_id,\n            'channel_name': conversation_name,\n            'investigation_id': investigation.get('id'),\n            'mirror_type': mirror_type,\n            'mirror_direction': mirror_direction,\n            'mirror_to': mirror_to,\n            'auto_close': bool(strtobool(auto_close)),\n            'mirrored': False\n        }\n\n    else:\n        mirror = mirrors.pop(mirrors.index(current_mirror[0]))\n        conversation_id = mirror['channel_id']\n        if mirror_type:\n            mirror['mirror_type'] = mirror_type\n        if auto_close:\n            mirror['auto_close'] = bool(strtobool(auto_close))\n        if mirror_direction:\n            mirror['mirror_direction'] = mirror_direction\n        if mirror_to and mirror['mirror_to'] != mirror_to:\n            return_error('Cannot change the Slack channel type from XSOAR.')\n        if channel_name:\n            return_error('Cannot change the Slack channel name.')\n        if channel_topic:\n            return_error('Cannot change the Slack channel topic.')\n        conversation_name = mirror['channel_name']\n        mirror['mirrored'] = False\n\n    set_topic = False\n    if channel_topic:\n        set_topic = True\n    else:\n        mirror_name = f'incident-{investigation_id}'\n        channel_filter = list(filter(lambda m: m['channel_name'] == conversation_name, mirrors))\n        if 'channel_topic' in mirror:\n            channel_topic = mirror['channel_topic']\n        elif channel_filter:\n            channel_mirror = channel_filter[0]\n            channel_topic = channel_mirror['channel_topic']\n        else:\n            channel_topic = ''\n        mirrored_investigations_ids = list(map(lambda m: f'incident-{m[\"investigation_id\"]}', channel_filter))\n        if not channel_topic or channel_topic.find('incident-') != -1:\n            new_topic = ', '.join(mirrored_investigations_ids + [mirror_name])\n            if channel_topic != new_topic:\n                channel_topic = new_topic\n                set_topic = True\n\n    if set_topic:\n        body = {\n            'channel': conversation_id,\n            'topic': channel_topic\n        }\n        send_slack_request_sync(CLIENT, 'conversations.setTopic', body=body)\n    mirror['channel_topic'] = channel_topic\n\n    mirrors.append(mirror)\n\n    set_to_integration_context_with_retries({'mirrors': mirrors, 'conversations': conversations}, OBJECTS_TO_KEYS,\n                                            SYNC_CONTEXT)\n\n    if kick_admin:\n        body = {\n            'channel': conversation_id\n        }\n        send_slack_request_sync(CLIENT, 'conversations.leave', body=body)\n    if send_first_message:\n        server_links = demisto.demistoUrls()\n        server_link = server_links.get('server')\n        message = (f'This channel was created to mirror incident {investigation_id}.'\n                   f' \\n View it on: {server_link}#/WarRoom/{investigation_id}')\n        body = {\n            'text': message,\n            'channel': conversation_id\n        }\n\n        send_slack_request_sync(CLIENT, 'chat.postMessage', body=body)\n\n    demisto.results(f'Investigation mirrored successfully, channel: {conversation_name}')\n\n\nasync def long_running_loop():\n    while True:\n        error = ''\n        try:\n            check_for_mirrors()\n            check_for_unanswered_questions()\n        except requests.exceptions.ConnectionError as e:\n            error = f'Could not connect to the Slack endpoint: {str(e)}'\n        except Exception as e:\n            error = f'An error occurred: {e}'\n        finally:\n            demisto.updateModuleHealth('')\n            if error:\n                demisto.error(error)\n                demisto.updateModuleHealth(error)\n\n\ndef get_poll_minutes(current_time: datetime, sent: Optional[str]) -\u003e float:\n    \"\"\"\n    Get the interval to wait before polling again in minutes.\n\n    Args:\n        current_time: The current time.\n        sent: The time when the polling request was sent.\n\n    Returns:\n        Total minutes to wait before polling.\n    \"\"\"\n    poll_time_minutes = 1.0\n    if sent:\n        sent_time = datetime.strptime(sent, DATE_FORMAT)\n        total_delta = current_time - sent_time\n        total_minutes = total_delta.total_seconds() / 60\n\n        for minute_range, interval in POLL_INTERVAL_MINUTES.items():\n            if len(minute_range) \u003e 1 and total_minutes \u003e minute_range[1]:\n                continue\n            poll_time_minutes = interval\n            break\n\n    return poll_time_minutes\n\n\ndef answer_question(text: str, question: dict, email: str = ''):\n    entitlement = question.get('entitlement', '')\n    content, guid, incident_id, task_id = extract_entitlement(entitlement, text)\n    try:\n        demisto.handleEntitlementForUser(incident_id, guid, email, content, task_id)\n    except Exception as e:\n        demisto.error(f'Failed handling entitlement {entitlement}: {str(e)}')\n    question['remove'] = True\n\n\ndef check_for_unanswered_questions():\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    questions = integration_context.get('questions', [])\n    users = integration_context.get('users', [])\n    if questions:\n        questions = json.loads(questions)\n    if users:\n        users = json.loads(users)\n    now = get_current_utc_time()\n    now_string = datetime.strftime(now, DATE_FORMAT)\n    updated_questions = []\n\n    for question in questions:\n        if question.get('last_poll_time'):\n            if question.get('expiry'):\n                # Check if the question expired - if it did, answer it with the default response\n                # and remove it\n                expiry = datetime.strptime(question['expiry'], DATE_FORMAT)\n                if expiry \u003c now:\n                    answer_question(question.get('default_response'), question, email='')\n                    updated_questions.append(question)\n                    continue\n            # Check if it has been enough time(determined by the POLL_INTERVAL_MINUTES parameter)\n            # since the last polling time. if not, continue to the next question until it has.\n            last_poll_time = datetime.strptime(question['last_poll_time'], DATE_FORMAT)\n            delta = now - last_poll_time\n            minutes = delta.total_seconds() / 60\n            sent = question.get('sent', None)\n            poll_time_minutes = get_poll_minutes(now, sent)\n            if minutes \u003c poll_time_minutes:\n                continue\n        entitlement = question.get('entitlement', '')\n        demisto.info(f'Slack - polling for an answer for entitlement {entitlement}')\n        question['last_poll_time'] = now_string\n        updated_questions.append(question)\n    if updated_questions:\n        set_to_integration_context_with_retries({'users': users, 'questions': questions}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n\ndef check_for_mirrors():\n    \"\"\"\n    Checks for newly created mirrors and handles the mirroring process\n    \"\"\"\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    if integration_context.get('mirrors'):\n        mirrors = json.loads(integration_context['mirrors'])\n        updated_mirrors = []\n        updated_users = []\n        for mirror in mirrors:\n            if not mirror['mirrored']:\n                investigation_id = mirror['investigation_id']\n                demisto.info(f'Mirroring: {investigation_id}')\n                mirror = mirrors.pop(mirrors.index(mirror))\n                if mirror['mirror_to'] and mirror['mirror_direction'] and mirror['mirror_type']:\n                    mirror_type = mirror['mirror_type']\n                    auto_close = mirror['auto_close']\n                    direction = mirror['mirror_direction']\n                    channel_id = mirror['channel_id']\n                    if isinstance(auto_close, str):\n                        auto_close = bool(strtobool(auto_close))\n                    users: List[Dict] = demisto.mirrorInvestigation(investigation_id,\n                                                                    f'{mirror_type}:{direction}', auto_close)\n                    if mirror_type != 'none':\n                        try:\n                            invited_users = invite_to_mirrored_channel(channel_id, users)\n                            updated_users.extend(invited_users)\n                        except Exception as error:\n                            demisto.error(f\"Could not invite investigation users to the mirrored channel: {error}\")\n\n                    mirror['mirrored'] = True\n                    updated_mirrors.append(mirror)\n                else:\n                    demisto.info(f'Could not mirror {investigation_id}')\n\n        if updated_mirrors:\n            context = {'mirrors': updated_mirrors}\n            if updated_users:\n                context['users'] = updated_users\n\n            set_to_integration_context_with_retries(context, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n        return\n\n\ndef invite_to_mirrored_channel(channel_id: str, users: List[Dict]) -\u003e list:\n    \"\"\"\n    Invite the relevant users to a mirrored channel\n    Args:\n        channel_id: The mirrored channel\n        users: The users to invite, each a dict of username and email\n\n    Returns:\n        users: The slack users that were invited\n    \"\"\"\n    slack_users = []\n    for user in users:\n        slack_user: dict = {}\n        # Try to invite by XSOAR email\n        user_email = user.get('email', '')\n        user_name = user.get('username', '')\n        if user_email:\n            slack_user = get_user_by_name(user_email, False)\n        if not slack_user:\n            # Try to invite by XSOAR user name\n            if user_name:\n                slack_user = get_user_by_name(user_name, False)\n        if slack_user:\n            slack_users.append(slack_user)\n        else:\n            demisto.results({\n                'Type': WARNING_ENTRY_TYPE,\n                'Contents': f'User {user_name} not found in Slack',\n                'ContentsFormat': formats['text']\n            })\n\n    users_to_invite = [user.get('id') for user in slack_users]\n    invite_users_to_conversation(channel_id, users_to_invite)\n\n    return slack_users\n\n\ndef extract_entitlement(entitlement: str, text: str) -\u003e Tuple[str, str, str, str]:\n    \"\"\"\n    Extracts entitlement components from an entitlement string\n    Args:\n        entitlement: The entitlement itself\n        text: The actual reply text\n\n    Returns:\n        Entitlement components\n    \"\"\"\n    parts = entitlement.split('@')\n    guid = parts[0]\n    id_and_task = parts[1].split('|')\n    incident_id = id_and_task[0]\n    task_id = ''\n\n    if len(id_and_task) \u003e 1:\n        task_id = id_and_task[1]\n    content = text.replace(entitlement, '', 1)\n\n    return content, guid, incident_id, task_id\n\n\nclass SlackLogger:\n    \"\"\"\n    Slack's Socket listener by default pipes messages via stdout. This is an attempt to capture those\n    and instead log them into the XSOAR server logs.\n\n    Essentially this converts Logger.info() to demisto.info()\n    \"\"\"\n    def __init__(self):\n        \"\"\"\n        Set the base level as debug. The server will handle the filtering as needed.\n        \"\"\"\n        self.level = logging.DEBUG\n\n    @staticmethod\n    def info(message):\n        demisto.info(message)\n\n    @staticmethod\n    def error(message):\n        demisto.error(message)\n\n    @staticmethod\n    def debug(message):\n        demisto.debug(message)\n\n    @staticmethod\n    def exception(message):\n        demisto.error(message)\n\n\nasync def slack_loop():\n    while True:\n        # SocketModeClient does not respect environment variables for ssl verification.\n        # Instead we use a custom session.\n        session = aiohttp.ClientSession(connector=aiohttp.TCPConnector(verify_ssl=VERIFY_CERT))\n        slack_logger = SlackLogger()\n        client = SocketModeClient(\n            app_token=APP_TOKEN,\n            web_client=ASYNC_CLIENT,\n            logger=slack_logger  # type: ignore\n        )\n        client.aiohttp_client_session = session\n        client.socket_mode_request_listeners.append(listen)  # type: ignore\n        try:\n            await client.connect()\n            await asyncio.sleep(float(\"inf\"))\n        except Exception as e:\n            await handle_listen_error(f\"An error occurred {str(e)}\")\n\n\nasync def handle_listen_error(error: str):\n    \"\"\"\n    Logs an error and updates the module health accordingly.\n\n    Args:\n        error: The error string.\n    \"\"\"\n    demisto.error(error)\n    demisto.updateModuleHealth(error)\n\n\nasync def start_listening():\n    \"\"\"\n    Starts a Slack SocketMode client and checks for mirrored incidents.\n    \"\"\"\n    await slack_loop()\n    long_loop_task = asyncio.create_task(long_running_loop(), name=\"Unanswered loop\")\n    await asyncio.gather(long_loop_task)\n\n\nasync def handle_dm(user: dict, text: str, client: AsyncWebClient):\n    \"\"\"\n    Handles a direct message sent to the bot\n\n    Args:\n        user: The user who sent the message\n        text: The message text\n        client: The Slack client\n\n    Returns:\n        Text to return to the user\n    \"\"\"\n    demisto.info('Slack - handling direct message.')\n    message: str = text.lower()\n    if message.find('incident') != -1 and (message.find('create') != -1\n                                           or message.find('open') != -1\n                                           or message.find('new') != -1):\n        user_email = user.get('profile', {}).get('email', '')\n        user_name = user.get('name', '')\n        if user_email:\n            demisto_user = demisto.findUser(email=user_email)\n        else:\n            demisto_user = demisto.findUser(username=user.get('name'))\n\n        if not demisto_user and not ALLOW_INCIDENTS:\n            data = 'You are not allowed to create incidents.'\n        else:\n            try:\n                data = await translate_create(text, user_name, user_email, demisto_user)\n            except Exception as e:\n                data = f'Failed creating incidents: {str(e)}'\n    else:\n        try:\n            data = demisto.directMessage(text, user.get('name'), user.get('profile', {}).get('email'), ALLOW_INCIDENTS)\n        except Exception as e:\n            data = str(e)\n\n    if not data:\n        data = 'Sorry, I could not perform the selected operation.'\n    body = {\n        'users': user.get('id')\n    }\n    im = await send_slack_request_async(client, 'conversations.open', body=body)\n    channel = im.get('channel', {}).get('id')\n    body = {\n        'text': data,\n        'channel': channel\n    }\n\n    await send_slack_request_async(client, 'chat.postMessage', body=body)\n\n\nasync def translate_create(message: str, user_name: str, user_email: str, demisto_user: dict) -\u003e str:\n    \"\"\"\n    Processes an incident creation message\n    Args:\n        message: The creation message\n        user_name: The name of the user in Slack\n        user_email: The email of the user in Slack\n        demisto_user: The demisto user associated with the request (if exists)\n\n    Returns:\n        Creation result\n    \"\"\"\n    json_pattern = r'(?\u003c=json=).*'\n    name_pattern = r'(?\u003c=name=).*'\n    type_pattern = r'(?\u003c=type=).*'\n    message = message.replace(\"\\n\", '').replace('`', '')\n    json_match = re.search(json_pattern, message)\n    created_incident = None\n    data = ''\n    user_demisto_id = ''\n    if demisto_user:\n        user_demisto_id = demisto_user.get('id', '')\n\n    if json_match:\n        if re.search(name_pattern, message) or re.search(type_pattern, message):\n            data = 'No other properties other than json should be specified.'\n        else:\n            incidents_json = json_match.group()\n            incidents = json.loads(incidents_json.replace('“', '\"').replace('”', '\"'))\n            if not isinstance(incidents, list):\n                incidents = [incidents]\n            created_incident = await create_incidents(incidents, user_name, user_email, user_demisto_id)\n\n            if not created_incident:\n                data = 'Failed creating incidents.'\n    else:\n        name_match = re.search(name_pattern, message)\n        if not name_match:\n            data = 'Please specify arguments in the following manner: name=\u003cname\u003e type=[type] or json=\u003cjson\u003e.'\n        else:\n            incident_name = re.sub('type=.*', '', name_match.group()).strip()\n            incident_type = ''\n\n            type_match = re.search(type_pattern, message)\n            if type_match:\n                incident_type = re.sub('name=.*', '', type_match.group()).strip()\n\n            incident = {'name': incident_name}\n\n            incident_type = incident_type or INCIDENT_TYPE\n            if incident_type:\n                incident['type'] = incident_type\n\n            created_incident = await create_incidents([incident], user_name, user_email, user_demisto_id)\n            if not created_incident:\n                data = 'Failed creating incidents.'\n\n    if created_incident:\n        if isinstance(created_incident, list):\n            created_incident = created_incident[0]\n        server_links = demisto.demistoUrls()\n        server_link = server_links.get('server')\n        incident_name = created_incident['name']\n        incident_id = created_incident['id']\n        data = f'Successfully created incident {incident_name}.\\n View it on: {server_link}#/WarRoom/{incident_id}'\n\n    return data\n\n\nasync def create_incidents(incidents: list, user_name: str, user_email: str, user_demisto_id: str = '') -\u003e dict:\n    \"\"\"\n    Creates incidents according to a provided JSON object\n    Args:\n        incidents: The incidents JSON\n        user_name The name of the user in Slack\n        user_email The email of the user in Slack\n        user_demisto_id: The id of demisto user associated with the request (if exists)\n\n    Returns:\n        The creation result\n    \"\"\"\n\n    for incident in incidents:\n        # Add relevant labels to context\n        labels = incident.get('labels', [])\n        keys = [label.get('type') for label in labels]\n        if 'Reporter' not in keys:\n            labels.append({'type': 'Reporter', 'value': user_name})\n        if 'ReporterEmail' not in keys:\n            labels.append({'type': 'ReporterEmail', 'value': user_email})\n        if 'Source' not in keys:\n            labels.append({'type': 'Source', 'value': 'Slack'})\n        incident['labels'] = labels\n\n    if user_demisto_id:\n        data = demisto.createIncidents(incidents, userID=user_demisto_id)\n    else:\n        data = demisto.createIncidents(incidents)\n\n    return data\n\n\nasync def listen(client: SocketModeClient, req: SocketModeRequest):\n    demisto.info(\"Handling request\")\n    if req.envelope_id:\n        response = SocketModeResponse(envelope_id=req.envelope_id)\n        await client.send_socket_mode_response(response)\n    data_type: str = req.type\n    payload: dict = req.payload\n    if data_type == 'error':\n        error = payload.get('error', {})\n        error_code = error.get('code')\n        error_msg = error.get('msg')\n        await handle_listen_error(\n            f'Slack API has thrown an error. Code: {error_code}, Message: {error_msg}.')\n        return\n    try:\n        data: dict = req.payload\n        event: dict = data.get('event', {})\n        subtype = data.get('subtype', '')\n        text = event.get('text', '')\n        user_id = event.get('user', '')\n        channel = event.get('channel', '')\n        message_bot_id = data.get('bot_id', '')\n        thread = event.get('thread_ts', None)\n        message = data.get('message', {})\n        # Check if slash command received. If so, ignore for now.\n        if data.get('command', None):\n            demisto.debug(\"Slash command event received. Ignoring.\")\n            return\n\n        actions = data.get('actions', [])\n        if subtype == 'bot_message' or message_bot_id or message.get('subtype') == 'bot_message' \\\n                or \\\n                event.get('bot_id', None):\n            if len(actions) == 0:\n                demisto.debug(\"Received bot_message event type. Ignoring.\")\n                return\n        if event.get('subtype') == 'message_changed':\n            demisto.debug(\"Received message_changed event type. Ignoring.\")\n            return\n\n        if len(actions) \u003e 0:\n            channel = data.get('channel', {}).get('id', '')\n            user_id = data.get('user', {}).get('id', '')\n            entitlement_json = actions[0].get('value')\n            entitlement_string = json.loads(entitlement_json)\n            entitlement_reply = json.loads(entitlement_json).get(\"reply\", \"Thank you for your reply.\")\n            action_text = actions[0].get('text').get('text')\n            user = await ASYNC_CLIENT.users_info(user=user_id)\n            answer_question(action_text, entitlement_string, user.get('profile', {}).get('email'))\n\n        else:\n            user = await get_user_by_id_async(ASYNC_CLIENT, user_id)  # type: ignore\n            entitlement_reply = await check_and_handle_entitlement(text, user, thread)  # type: ignore\n\n        if entitlement_reply:\n            await send_slack_request_async(client=ASYNC_CLIENT, method='chat.postMessage',\n                                           body={\n                                               'channel': channel,\n                                               'thread_ts': thread,\n                                               'text': entitlement_reply\n                                           })\n\n        elif channel and channel[0] == 'D' and ENABLE_DM:\n            # DM\n            await handle_dm(user, text, ASYNC_CLIENT)  # type: ignore\n        else:\n            channel_id = channel\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            if not integration_context or 'mirrors' not in integration_context:\n                return\n\n            mirrors = json.loads(integration_context['mirrors'])\n            mirror_filter = list(filter(lambda m: m['channel_id'] == channel_id, mirrors))\n            if not mirror_filter:\n                demisto.info(\"No mirror filter\")\n                return\n\n            for mirror in mirror_filter:\n                if mirror['mirror_direction'] == 'FromDemisto' or mirror['mirror_type'] == 'none':\n                    return\n\n                if not mirror['mirrored']:\n                    demisto.info(\"Not mirrored yet\")\n                    # In case the investigation is not mirrored yet\n                    mirror = mirrors.pop(mirrors.index(mirror))\n                    if mirror['mirror_to'] and mirror['mirror_direction'] and mirror['mirror_type']:\n                        investigation_id = mirror['investigation_id']\n                        mirror_type = mirror['mirror_type']\n                        auto_close = mirror['auto_close']\n                        direction = mirror['mirror_direction']\n                        if isinstance(auto_close, str):\n                            auto_close = bool(strtobool(auto_close))\n                        demisto.info(f'Mirroring: {investigation_id}')\n                        demisto.mirrorInvestigation(investigation_id,\n                                                    f'{mirror_type}:{direction}', auto_close)\n                        mirror['mirrored'] = True\n                        mirrors.append(mirror)\n                        set_to_integration_context_with_retries({'mirrors': mirrors},\n                                                                OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n                investigation_id = mirror['investigation_id']\n                await handle_text(ASYNC_CLIENT, investigation_id, text, user)  # type: ignore\n        # Reset module health\n        demisto.updateModuleHealth(\"\")\n        demisto.info(\"SlackV3 - Event handled successfully.\")\n        return\n    except Exception as e:\n        await handle_listen_error(f'Error occurred while listening to Slack: {e}')\n\n\nasync def get_user_by_id_async(client: AsyncWebClient, user_id: str) -\u003e dict:\n    \"\"\"\n    Get the details of a slack user by id asynchronously.\n    Args:\n        client: The slack web client to use.\n        user_id: The id of the user.\n\n    Returns:\n        The slack user.\n    \"\"\"\n    user: dict = {}\n    users: list = []\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    if integration_context.get('users'):\n        users = json.loads(integration_context['users'])\n        user_filter = list(filter(lambda u: u['id'] == user_id, users))\n        if user_filter:\n            user = user_filter[0]\n    if not user:\n        body = {\n            'user': user_id\n        }\n        user = (\n            await send_slack_request_async(client, 'users.info', http_verb='GET', body=body)).get(\n            'user', {})\n        users.append(user)\n        set_to_integration_context_with_retries({'users': users}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n    return user\n\n\nasync def handle_text(client: AsyncWebClient, investigation_id: str, text: str, user: dict):\n    \"\"\"\n    Handles text received in the Slack workspace (not DM)\n\n    Args:\n        client: The Slack client\n        investigation_id: The mirrored investigation ID\n        text: The received text\n        user: The sender\n    \"\"\"\n    demisto.info(f'SlackV3 - adding entry to incident {investigation_id}')\n    if text:\n        demisto.addEntry(id=investigation_id,\n                         entry=await clean_message(text, client),\n                         username=user.get('name', ''),\n                         email=user.get('profile', {}).get('email', ''),\n                         footer=MESSAGE_FOOTER\n                         )\n        demisto.info(\"SlackV3 - Text handled successfully.\")\n\n\nasync def check_and_handle_entitlement(text: str, user: dict, thread_id: str) -\u003e str:\n    \"\"\"\n    Handles an entitlement message (a reply to a question)\n    Args:\n        text: The message text\n        user: The user who sent the reply\n        thread_id: The thread ID\n\n    Returns:\n        If the message contains entitlement, return a reply.\n    \"\"\"\n\n    entitlement_match = re.search(ENTITLEMENT_REGEX, text)\n    if entitlement_match:\n        demisto.info('Slack - handling entitlement in message.')\n        content, guid, incident_id, task_id = extract_entitlement(entitlement_match.group(), text)\n        demisto.handleEntitlementForUser(incident_id, guid, user.get('profile', {}).get('email'), content, task_id)\n\n        return 'Thank you for your response.'\n    else:\n        integration_context = get_integration_context(SYNC_CONTEXT)\n        questions = integration_context.get('questions', [])\n        if questions and thread_id:\n            questions = json.loads(questions)\n            question_filter = list(filter(lambda q: q.get('thread') == thread_id, questions))\n            if question_filter:\n                question = question_filter[0]\n                demisto.info('Slack - handling entitlement in thread.')\n                entitlement = question.get('entitlement')\n                reply = question.get('reply', 'Thank you for your response.')\n                content, guid, incident_id, task_id = extract_entitlement(entitlement, text)\n                demisto.handleEntitlementForUser(incident_id, guid, user.get('profile', {}).get('email'), content,\n                                                 task_id)\n                question['remove'] = True\n                set_to_integration_context_with_retries({'questions': questions}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n                return reply\n\n    return ''\n\n\n''' SEND '''\n\n\ndef get_conversation_by_name(conversation_name: str) -\u003e dict:\n    \"\"\"\n    Get a slack conversation by its name\n\n    Args:\n        conversation_name: The conversation name\n\n    Returns:\n        The slack conversation\n    \"\"\"\n    integration_context = get_integration_context(SYNC_CONTEXT)\n\n    conversation_to_search = conversation_name.lower()\n    # Find conversation in the cache\n    conversations = integration_context.get('conversations')\n    if conversations:\n        conversations = json.loads(conversations)\n        conversation_filter = list(\n            filter(\n                lambda c: conversation_to_search == c.get('name', '').lower(),\n                conversations\n            )\n        )\n        if conversation_filter:\n            return conversation_filter[0]\n\n    demisto.debug(f'could not find slack channel \"{conversation_to_search}\" in integration context, searching via API')\n    # If not found in cache, search for it\n    body = {\n        'types': 'private_channel,public_channel',\n        'limit': PAGINATED_COUNT\n    }\n    response = send_slack_request_sync(CLIENT, 'conversations.list', http_verb='GET', body=body)\n\n    conversation: dict = {}\n    while True:\n        conversations = response['channels'] if response and response.get('channels') else []\n        cursor = response.get('response_metadata', {}).get('next_cursor')\n        conversation_filter = list(filter(lambda c: c.get('name') == conversation_name, conversations))\n        if conversation_filter:\n            break\n        if not cursor:\n            demisto.info(\"Reached the end of looking for a channel\")\n            break\n\n        body = body.copy()  # strictly for unit-test purposes (test_get_conversation_by_name_paging)\n        body.update({'cursor': cursor})\n        response = send_slack_request_sync(CLIENT, 'conversations.list', http_verb='GET', body=body)\n    if conversation_filter:\n        conversation = conversation_filter[0]\n\n    # Save conversations to cache\n    if conversation:\n        conversations = integration_context.get('conversations')\n        if conversations:\n            conversations = json.loads(conversations)\n            conversations.append(conversation)\n        else:\n            conversations = [conversation]\n        set_to_integration_context_with_retries({'conversations': conversations}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    return conversation\n\n\ndef slack_send():\n    \"\"\"\n    Sends a message to slack\n    \"\"\"\n\n    args = demisto.args()\n    message = args.get('message', '')\n    to = args.get('to')\n    original_channel = args.get('channel')\n    group = args.get('group')\n    message_type = args.get('messageType', '')  # From server\n    original_message = args.get('originalMessage', '')  # From server\n    entry = args.get('entry')\n    ignore_add_url = args.get('ignoreAddURL', False) or args.get('IgnoreAddURL', False)\n    thread_id = args.get('threadID', '')\n    severity = args.get('severity')  # From server\n    blocks = args.get('blocks')\n    entry_object = args.get('entryObject')  # From server, available from demisto v6.1 and above\n    entitlement = ''\n\n    if message_type == MIRROR_TYPE and original_message.find(MESSAGE_FOOTER) != -1:\n        # return so there will not be a loop of messages\n        return\n\n    if message_type == MIRROR_TYPE:\n        tags = argToList(demisto.params().get('filtered_tags', []))\n        entry_tags = entry_object.get('tags', [])\n\n        if tags and not entry_tags:\n            return\n\n        # return if the entry tags is not containing any of the filtered_tags\n        if tags and not any(elem in entry_tags for elem in tags):\n            return\n\n    if (to and group) or (to and original_channel) or (to and original_channel and group):\n        return_error('Only one destination can be provided.')\n\n    if severity:\n        try:\n            severity = int(severity)\n        except Exception:\n            severity = None\n\n    channel = original_channel\n    if original_channel == INCIDENT_NOTIFICATION_CHANNEL or (not original_channel and message_type == INCIDENT_OPENED):\n        original_channel = INCIDENT_NOTIFICATION_CHANNEL\n        channel = DEDICATED_CHANNEL\n        demisto.debug(f'trying to send message to channel {original_channel}, changing slack channel to {channel}')\n\n    if (channel == DEDICATED_CHANNEL and original_channel == INCIDENT_NOTIFICATION_CHANNEL\n            and ((severity is not None and severity \u003c SEVERITY_THRESHOLD)\n                 or not NOTIFY_INCIDENTS)):\n        channel = None\n\n    if not (to or group or channel):\n        return_error('Either a user, group or channel must be provided.')\n\n    reply = ''\n    expiry = ''\n    default_response = ''\n    if blocks:\n        entitlement_match = re.search(ENTITLEMENT_REGEX, blocks)\n        if entitlement_match:\n            try:\n                parsed_message = json.loads(blocks)\n                entitlement = parsed_message.get('entitlement')\n                blocks = parsed_message.get('blocks')\n                reply = parsed_message.get('reply')\n                expiry = parsed_message.get('expiry')\n                default_response = parsed_message.get('default_response')\n            except Exception:\n                demisto.info('Slack - could not parse JSON from entitlement blocks.')\n    elif message:\n        entitlement_match = re.search(ENTITLEMENT_REGEX, message)\n        if entitlement_match:\n            try:\n                parsed_message = json.loads(message)\n                entitlement = parsed_message.get('entitlement')\n                message = parsed_message.get('message')\n                reply = parsed_message.get('reply')\n                expiry = parsed_message.get('expiry')\n                default_response = parsed_message.get('default_response')\n            except Exception:\n                demisto.info('Slack - could not parse JSON from entitlement message.')\n\n    response = slack_send_request(to, channel, group, entry, ignore_add_url, thread_id, message=message, blocks=blocks)\n\n    if response:\n        thread = response.get('ts')\n        if entitlement:\n            save_entitlement(entitlement, thread, reply, expiry, default_response)\n\n        demisto.results({\n            'Type': entryTypes['note'],\n            'HumanReadable': f'Message sent to Slack successfully.\\nThread ID is: {thread}',\n            'Contents': response.data,\n            'ContentsFormat': formats['json'],\n            'EntryContext': {\n                'Slack.Thread(val.ID===obj.ID)': {\n                    'ID': thread\n                },\n            }\n        })\n    else:\n        demisto.results('Could not send the message to Slack.')\n\n\ndef save_entitlement(entitlement, thread, reply, expiry, default_response):\n    \"\"\"\n    Saves an entitlement with its thread\n\n    Args:\n        entitlement: The entitlement\n        thread: The thread\n        reply: The reply to send to the user.\n        expiry: The question expiration date.\n        default_response: The response to send if the question times out.\n    \"\"\"\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    questions = integration_context.get('questions', [])\n    if questions:\n        questions = json.loads(integration_context['questions'])\n    questions.append({\n        'thread': thread,\n        'entitlement': entitlement,\n        'reply': reply,\n        'expiry': expiry,\n        'sent': datetime.strftime(get_current_utc_time(), DATE_FORMAT),\n        'default_response': default_response\n    })\n\n    set_to_integration_context_with_retries({'questions': questions}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n\n\ndef slack_send_file():\n    \"\"\"\n    Sends a file to slack\n    \"\"\"\n    to = demisto.args().get('to')\n    channel = demisto.args().get('channel')\n    group = demisto.args().get('group')\n    entry_id = demisto.args().get('file')\n    thread_id = demisto.args().get('threadID')\n    comment = demisto.args().get('comment', '')\n\n    if not (to or channel or group):\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel = mirror.get('channel_name')\n\n    if not (to or channel or group):\n        return_error('Either a user, group or channel must be provided.')\n\n    file_path = demisto.getFilePath(entry_id)\n\n    file_dict = {\n        'path': file_path['path'],\n        'name': file_path['name'],\n        'comment': comment\n    }\n\n    response = slack_send_request(to, channel, group, thread_id=thread_id, file_dict=file_dict)\n    if response:\n        demisto.results('File sent to Slack successfully.')\n    else:\n        demisto.results('Could not send the file to Slack.')\n\n\ndef handle_tags_in_message_sync(message: str) -\u003e str:\n    \"\"\"\n    Handles user tags in a slack send message\n\n    Args:\n        message: The slack message\n\n    Returns:\n        The tagged slack message\n    \"\"\"\n    matches = re.findall(USER_TAG_EXPRESSION, message)\n    message = re.sub(USER_TAG_EXPRESSION, r'\\1', message)\n    for match in matches:\n        slack_user = get_user_by_name(match)\n        if slack_user:\n            message = message.replace(match, f\"\u003c@{slack_user.get('id')}\u003e\")\n\n    resolved_message = re.sub(URL_EXPRESSION, r'\\1', message)\n\n    return resolved_message\n\n\ndef send_message(destinations: list, entry: str, ignore_add_url: bool, integration_context: dict, message: str,\n                 thread_id: str, blocks: str):\n    \"\"\"\n    Sends a message to Slack.\n    Args:\n        destinations: The destinations to send to.\n        entry: A WarRoom entry to send.\n        ignore_add_url: Do not add a XSOAR URL to the message.\n        integration_context: Current integration context.\n        message: The message to send.\n        thread_id: The Slack thread ID to send the message to.\n        blocks: Message blocks to send\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    if not message:\n        if blocks:\n            message = 'New message from SOC Bot'\n            # This is shown in the notification bubble from Slack\n        else:\n            message = '\\n'\n\n    if message and not blocks:\n        if ignore_add_url and isinstance(ignore_add_url, str):\n            ignore_add_url = bool(strtobool(ignore_add_url))\n        if not ignore_add_url:\n            investigation = demisto.investigation()\n            server_links = demisto.demistoUrls()\n            if investigation:\n                if investigation.get('type') != PLAYGROUND_INVESTIGATION_TYPE:\n                    link = server_links.get('warRoom')\n                    if link:\n                        if entry:\n                            link += '/' + entry\n                        message += f'\\nView it on: {link}'\n                else:\n                    link = server_links.get('server', '')\n                    if link:\n                        message += f'\\nView it on: {link}#/home'\n    try:\n        response = send_message_to_destinations(destinations, message, thread_id, blocks)\n    except SlackApiError as e:\n        if str(e).find('not_in_channel') == -1 and str(e).find('channel_not_found') == -1:\n            raise\n        bot_id = integration_context.get('bot_id')\n        if not bot_id:\n            bot_id = get_bot_id()\n        for dest in destinations:\n            invite_users_to_conversation(dest, [bot_id])\n        response = send_message_to_destinations(destinations, message, thread_id, blocks)\n    return response\n\n\ndef send_message_to_destinations(destinations: list, message: str, thread_id: str, blocks: str = '') \\\n        -\u003e Optional[SlackResponse]:\n    \"\"\"\n    Sends a message to provided destinations Slack.\n\n    Args:\n        destinations: Destinations to send to.\n        message: The message to send.\n        thread_id: Slack thread ID to send to.\n        blocks: Message blocks to send\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    response: Optional[SlackResponse] = None\n    body: dict = {}\n\n    if message:\n        clean_message = handle_tags_in_message_sync(message)\n        body['text'] = clean_message\n    if blocks:\n        block_list = json.loads(blocks, strict=False)\n        body['blocks'] = block_list\n    if thread_id:\n        body['thread_ts'] = thread_id\n\n    for destination in destinations:\n        body['channel'] = destination\n        response = send_slack_request_sync(CLIENT, 'chat.postMessage', body=body)\n\n    return response\n\n\ndef send_file(destinations: list, file_dict: dict, integration_context: dict, thread_id: str) -\u003e \\\n        Optional[SlackResponse]:\n    \"\"\"\n    Sends a file to Slack.\n\n    Args:\n        destinations: Destinations to send the file to.\n        file_dict: The file to send.\n        integration_context: The current integration context.\n        thread_id: A Slack thread to send to.\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    try:\n        response = send_file_to_destinations(destinations, file_dict, thread_id)\n    except SlackApiError as e:\n        if str(e).find('not_in_channel') == -1 and str(e).find('channel_not_found') == -1:\n            raise\n        bot_id = integration_context.get('bot_id')\n        if not bot_id:\n            bot_id = get_bot_id()\n            integration_context['bot_id'] = bot_id\n        for dest in destinations:\n            invite_users_to_conversation(dest, [bot_id])\n        response = send_file_to_destinations(destinations, file_dict, thread_id)\n\n    return response\n\n\ndef send_file_to_destinations(destinations: list, file_dict: dict, thread_id: str) -\u003e Optional[SlackResponse]:\n    \"\"\"\n    Sends a file to provided destinations in Slack.\n\n    Args:\n        destinations: The destinations to send to.\n        file_dict: The file to send.\n        thread_id: A thread ID to send to.\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n    response: Optional[SlackResponse] = None\n    body = {\n        'filename': file_dict['name']\n    }\n\n    if 'comment' in file_dict:\n        body['initial_comment'] = file_dict['comment']\n\n    for destination in destinations:\n        body['channels'] = destination\n        if thread_id:\n            body['thread_ts'] = thread_id\n\n        response = send_slack_request_sync(CLIENT, 'files.upload', file_=file_dict['path'], body=body)\n\n    return response\n\n\ndef slack_send_request(to: str, channel: str, group: str, entry: str = '', ignore_add_url: bool = False,\n                       thread_id: str = '', message: str = '', blocks: str = '', file_dict: dict = None) \\\n        -\u003e Optional[SlackResponse]:\n    \"\"\"\n    Requests to send a message or a file to Slack.\n\n    Args:\n        to: A Slack user to send to.\n        channel: A Slack channel to send to.\n        group: A Slack private channel to send to.\n        entry: WarRoom entry to send.\n        ignore_add_url: Do not add a Demisto URL to the message.\n        thread_id: The Slack thread ID to send to.\n        message: A message to send.\n        blocks: Blocks to send with a slack message\n        file_dict: A file to send.\n\n    Returns:\n        The Slack send response.\n    \"\"\"\n\n    integration_context = get_integration_context(SYNC_CONTEXT)\n    mirrors: list = []\n    if integration_context:\n        if 'mirrors' in integration_context:\n            mirrors = json.loads(integration_context['mirrors'])\n\n    destinations = []\n\n    if to:\n        if isinstance(to, list):\n            to = to[0]\n        user = get_user_by_name(to)\n        if not user:\n            demisto.error(f'Could not find the Slack user {to}')\n        else:\n            body = {\n                'users': user.get('id')\n            }\n            im = send_slack_request_sync(CLIENT, 'conversations.open', body=body)\n            destinations.append(im.get('channel', {}).get('id'))\n    if channel or group:\n        if not destinations:\n            destination_name = channel or group\n            mirrored_channel_filter = list(filter(lambda m: f'incident-{m[\"investigation_id\"]}' == destination_name,\n                                                  mirrors))\n            if mirrored_channel_filter:\n                channel_mirror = mirrored_channel_filter[0]\n                conversation_id = channel_mirror['channel_id']\n            else:\n                conversation = get_conversation_by_name(destination_name)\n                if not conversation:\n                    return_error(f'Could not find the Slack conversation {destination_name}')\n                conversation_id = conversation.get('id')\n\n            if conversation_id:\n                destinations.append(conversation_id)\n\n    if not destinations:\n        return_error('Could not find any destination to send to.')\n\n    if file_dict:\n        response = send_file(destinations, file_dict, integration_context, thread_id)\n        return response\n\n    response = send_message(destinations, entry, ignore_add_url, integration_context, message,\n                            thread_id, blocks)\n\n    return response\n\n\ndef set_channel_topic():\n    \"\"\"\n    Sets a topic for a slack channel\n    \"\"\"\n\n    channel = demisto.args().get('channel')\n    topic = demisto.args().get('topic')\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror.get('channel_id', '')\n            # We need to update the topic in the mirror\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            mirrors = json.loads(integration_context['mirrors'])\n            mirror = mirrors.pop(mirrors.index(mirror))\n            mirror['channel_topic'] = topic\n            mirrors.append(mirror)\n            set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n\n    body = {\n        'channel': channel_id,\n        'topic': topic\n    }\n    send_slack_request_sync(CLIENT, 'conversations.setTopic', body=body)\n\n    demisto.results('Topic successfully set.')\n\n\ndef rename_channel():\n    \"\"\"\n    Renames a slack channel\n    \"\"\"\n\n    channel = demisto.args().get('channel')\n    new_name = demisto.args().get('name')\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror.get('channel_id', '')\n            # We need to update the name in the mirror\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            mirrors = json.loads(integration_context['mirrors'])\n            mirror = mirrors.pop(mirrors.index(mirror))\n            mirror['channel_name'] = new_name\n            mirrors.append(mirror)\n            set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n    body = {\n        'channel': channel_id,\n        'name': new_name\n    }\n    send_slack_request_sync(CLIENT, 'conversations.rename', body=body)\n\n    demisto.results('Channel renamed successfully.')\n\n\ndef close_channel():\n    \"\"\"\n    Archives a slack channel by name or its incident ID if mirrored.\n    \"\"\"\n    channel = demisto.args().get('channel')\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror.get('channel_id', '')\n            # We need to update the topic in the mirror\n            integration_context = get_integration_context(SYNC_CONTEXT)\n            mirrors = json.loads(integration_context['mirrors'])\n            channel_id = mirror['channel_id']\n            # Check for mirrors on the archived channel\n            channel_mirrors = list(filter(lambda m: channel_id == m['channel_id'], mirrors))\n            for mirror in channel_mirrors:\n                mirror['remove'] = True\n                demisto.mirrorInvestigation(mirror['investigation_id'], f'none:{mirror[\"mirror_direction\"]}',\n                                            mirror['auto_close'])\n\n            set_to_integration_context_with_retries({'mirrors': mirrors}, OBJECTS_TO_KEYS, SYNC_CONTEXT)\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n    body = {\n        'channel': channel_id\n    }\n    send_slack_request_sync(CLIENT, 'conversations.archive', body=body)\n\n    demisto.results('Channel successfully archived.')\n\n\ndef create_channel():\n    \"\"\"\n    Creates a channel in Slack using the provided arguments.\n    \"\"\"\n    channel_type = demisto.args().get('type', 'private')\n    channel_name = demisto.args()['name']\n    users = argToList(demisto.args().get('users', []))\n    topic = demisto.args().get('topic')\n\n    body = {\n        'name': channel_name\n    }\n\n    if channel_type == 'private':\n        body['is_private'] = True\n\n    conversation = send_slack_request_sync(CLIENT, 'conversations.create', body=body).get(\n        'channel', {})\n\n    if users:\n        slack_users = search_slack_users(users)\n        invite_users_to_conversation(conversation.get('id'),\n                                     list(map(lambda u: u.get('id'), slack_users)))\n    if topic:\n        body = {\n            'channel': conversation.get('id'),\n            'topic': topic\n        }\n        send_slack_request_sync(CLIENT, 'conversations.setTopic', body=body)\n    created_channel_name = conversation.get('name')\n    demisto.results(f'Successfully created the channel {created_channel_name}')\n\n\ndef invite_to_channel():\n    channel = demisto.args().get('channel')\n    users = argToList(demisto.args().get('users', []))\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror['channel_id']\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n    slack_users = search_slack_users(users)\n    if slack_users:\n        invite_users_to_conversation(channel_id, list(map(lambda u: u.get('id'), slack_users)))\n    else:\n        return_error('No users found')\n\n    demisto.results('Successfully invited users to the channel.')\n\n\ndef kick_from_channel():\n    channel = demisto.args().get('channel')\n    users = argToList(demisto.args().get('users', []))\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror['channel_id']\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n    slack_users = search_slack_users(users)\n    if slack_users:\n        kick_users_from_conversation(channel_id, list(map(lambda u: u.get('id'), slack_users)))\n    else:\n        return_error('No users were found')\n\n    demisto.results('Successfully kicked users from the channel.')\n\n\ndef get_user():\n    user = demisto.args()['user']\n\n    slack_user = get_user_by_name(user)\n    if not slack_user:\n        return_error('User not found')\n\n    profile = slack_user.get('profile', {})\n    result_user = {\n        'ID': slack_user.get('id'),\n        'Username': slack_user.get('name'),\n        'Name': profile.get('real_name_normalized') or profile.get('real_name'),\n        'DisplayName': profile.get('display_name'),\n        'Email': profile.get('email')\n    }\n\n    hr = tableToMarkdown('Details for Slack user: ' + user, result_user,\n                         headers=['ID', 'Username', 'Name', 'DisplayName', 'Email'], headerTransform=pascalToSpace,\n                         removeNull=True)\n    context = {\n        'Slack.User(val.ID === obj.ID)': createContext(result_user, removeNull=True)\n    }\n\n    return_outputs(hr, context, slack_user)\n\n\ndef slack_edit_message():\n    args = demisto.args()\n    channel = args.get('channel')\n    thread_id = demisto.args().get('threadID')\n    message = args.get('message')\n    blocks = args.get('blocks')\n    ignore_add_url = args.get('ignore_add_url')\n    entry = args.get('entry')\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror['channel_id']\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n    if not thread_id:\n        return_error('The timestamp of the message to edit is required.')\n\n    if message and not blocks:\n        if ignore_add_url and isinstance(ignore_add_url, str):\n            ignore_add_url = bool(strtobool(ignore_add_url))\n        if not ignore_add_url:\n            investigation = demisto.investigation()\n            server_links = demisto.demistoUrls()\n            if investigation:\n                if investigation.get('type') != PLAYGROUND_INVESTIGATION_TYPE:\n                    link = server_links.get('warRoom')\n                    if link:\n                        if entry:\n                            link += '/' + entry\n                        message += f'\\nView it on: {link}'\n                else:\n                    link = server_links.get('server', '')\n                    if link:\n                        message += f'\\nView it on: {link}#/home'\n\n    body = {\n        'channel': channel_id,\n        'ts': thread_id\n    }\n    if message:\n        clean_message = handle_tags_in_message_sync(message)\n        body['text'] = clean_message\n    if blocks:\n        block_list = json.loads(blocks, strict=False)\n        body['blocks'] = block_list\n    try:\n        response = send_slack_request_sync(CLIENT, 'chat.update', body=body)\n\n        hr = \"The message was successfully edited.\"\n        result_edit = {\n            'ID': response.get('ts', None),\n            'Channel': response.get('channel', None),\n            'Text': response.get('text', None)\n        }\n        context = {\n            'Slack.Thread(val.ID === obj.ID)': result_edit\n        }\n        return_results(CommandResults(\n            readable_output=hr,\n            outputs=context,\n            raw_response=json.dumps(response.data)))\n\n    except SlackApiError as slack_error:\n        return_error(f\"{slack_error}\")\n\n\ndef pin_message():\n    channel = demisto.args().get('channel')\n    thread_id = demisto.args().get('threadID')\n\n    channel_id = ''\n\n    if not channel:\n        mirror = find_mirror_by_investigation()\n        if mirror:\n            channel_id = mirror['channel_id']\n    else:\n        channel = get_conversation_by_name(channel)\n        channel_id = channel.get('id')\n\n    if not channel_id:\n        return_error('Channel was not found - Either the Slack app is not a member of the channel, '\n                     'or the slack app does not have permission to find the channel.')\n    body = {\n        'channel': channel_id,\n        'timestamp': thread_id\n    }\n    try:\n        send_slack_request_sync(CLIENT, 'pins.add', body=body)\n        return_results('The message was successfully pinned.')\n\n    except SlackApiError as slack_error:\n        return_error(f\"{slack_error}\")\n\n\ndef long_running_main():\n    \"\"\"\n    Starts the long running thread.\n    \"\"\"\n    try:\n        asyncio.run(start_listening(), debug=True)\n    except Exception as e:\n        demisto.error(f\"The Loop has failed to run {str(e)}\")\n    finally:\n        loop = asyncio.get_running_loop()\n        try:\n            loop.stop()\n            loop.close()\n        except Exception as e_:\n            demisto.error(f'Failed to gracefully close the loop - {e_}')\n\n\ndef init_globals(command_name: str = ''):\n    \"\"\"\n    Initializes global variables according to the integration parameters\n    \"\"\"\n    global BOT_TOKEN, PROXY_URL, PROXIES, DEDICATED_CHANNEL, CLIENT\n    global SEVERITY_THRESHOLD, ALLOW_INCIDENTS, NOTIFY_INCIDENTS, INCIDENT_TYPE, VERIFY_CERT, ENABLE_DM\n    global BOT_NAME, BOT_ICON_URL, MAX_LIMIT_TIME, PAGINATED_COUNT, SSL_CONTEXT, APP_TOKEN, ASYNC_CLIENT\n\n    VERIFY_CERT = not demisto.params().get('unsecure', False)\n    if not VERIFY_CERT:\n        SSL_CONTEXT = ssl.create_default_context()\n        SSL_CONTEXT.check_hostname = False\n        SSL_CONTEXT.verify_mode = ssl.CERT_NONE\n    else:\n        # Use default SSL context\n        SSL_CONTEXT = None\n\n    if command_name == 'long-running-execution':\n        loop = asyncio.get_event_loop()\n        if not loop._default_executor:  # type: ignore[attr-defined]\n            demisto.info(f'setting _default_executor on loop: {loop} id: {id(loop)}')\n            loop.set_default_executor(concurrent.futures.ThreadPoolExecutor(max_workers=4))\n\n    BOT_TOKEN = demisto.params().get('bot_token', {}).get('password', '')\n    APP_TOKEN = demisto.params().get('app_token', {}).get('password', '')\n    PROXIES = handle_proxy()\n    PROXY_URL = PROXIES.get('http')  # aiohttp only supports http proxy\n    DEDICATED_CHANNEL = demisto.params().get('incidentNotificationChannel')\n    ASYNC_CLIENT = AsyncWebClient(token=BOT_TOKEN, ssl=SSL_CONTEXT, proxy=PROXY_URL)\n    CLIENT = slack_sdk.WebClient(token=BOT_TOKEN, proxy=PROXY_URL, ssl=SSL_CONTEXT)\n    SEVERITY_THRESHOLD = SEVERITY_DICT.get(demisto.params().get('min_severity', 'Low'), 1)\n    ALLOW_INCIDENTS = demisto.params().get('allow_incidents', False)\n    NOTIFY_INCIDENTS = demisto.params().get('notify_incidents', True)\n    INCIDENT_TYPE = demisto.params().get('incidentType')\n    BOT_NAME = demisto.params().get('bot_name')  # Bot default name defined by the slack plugin (3-rd party)\n    BOT_ICON_URL = demisto.params().get('bot_icon')  # Bot default icon url defined by the slack plugin (3-rd party)\n    MAX_LIMIT_TIME = int(demisto.params().get('max_limit_time', '60'))\n    PAGINATED_COUNT = int(demisto.params().get('paginated_count', '200'))\n    ENABLE_DM = demisto.params().get('enable_dm', True)\n\n\ndef print_thread_dump():\n    demisto.info(f'current thread: {threading.current_thread().name}')\n    for threadId, stack in sys._current_frames().items():\n        stack_str = '\\n'.join(traceback.format_stack(stack))\n        demisto.info(f'{threadId} stack: {stack_str}')\n\n\ndef loop_info(loop: asyncio.AbstractEventLoop):\n    if not loop:\n        return \"loop is None\"\n    info = f'loop: {loop}. id: {id(loop)}.'\n    info += f'executor: {loop._default_executor} id: {id(loop._default_executor)}'  # type: ignore[attr-defined]\n    if loop._default_executor:  # type: ignore[attr-defined]\n        info += f' executor threads size: {len(loop._default_executor._threads)}'  # type: ignore[attr-defined]\n        info += f' max: {loop._default_executor._max_workers} {loop._default_executor._threads}'  # type: ignore[attr-defined]\n    return info\n\n\ndef slack_get_integration_context():\n    integration_context = get_integration_context()\n    return_results(fileResult('slack_integration_context', json.dumps(integration_context), EntryType.ENTRY_INFO_FILE))\n\n\ndef main() -\u003e None:\n    \"\"\"\n    Main\n    \"\"\"\n    global CLIENT\n    if is_debug_mode():\n        os.environ['PYTHONASYNCIODEBUG'] = \"1\"\n\n    commands = {\n        'test-module': test_module,\n        'long-running-execution': long_running_main,\n        'mirror-investigation': mirror_investigation,\n        'send-notification': slack_send,\n        'slack-send-file': slack_send_file,\n        'slack-set-channel-topic': set_channel_topic,\n        'close-channel': close_channel,\n        'slack-create-channel': create_channel,\n        'slack-invite-to-channel': invite_to_channel,\n        'slack-kick-from-channel': kick_from_channel,\n        'slack-rename-channel': rename_channel,\n        'slack-get-user-details': get_user,\n        'slack-get-integration-context': slack_get_integration_context,\n        'slack-edit-message': slack_edit_message,\n        'slack-pin-message': pin_message\n    }\n\n    command_name: str = demisto.command()\n\n    try:\n        demisto.info(f'{command_name} started.')\n        command_func = commands[command_name]\n        init_globals(command_name)\n        support_multithreading()\n        command_func()\n    except Exception as e:\n        LOG(e)\n        return_error(str(e))\n    finally:\n        demisto.info(\n            f'{command_name} completed.')\n\n\n''' ENTRY POINT '''\n\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.1.5","modified":"2021-09-05T10:49:33.530013+03:00","name":"SlackV3","packID":"Slack","packPropagationLabels":["all"],"prevName":"SlackV3","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":false,"category":"Database","commitMessage":"","configuration":[{"defaultValue":"","display":"Server Address","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"server","options":null,"required":true,"type":0},{"defaultValue":"1433","display":"Server Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"port","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"user id","options":null,"required":true,"type":0},{"defaultValue":"","display":"Password","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"password","options":null,"required":true,"type":4},{"defaultValue":"","display":"Database","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"database","options":null,"required":false,"type":0},{"defaultValue":"","display":"Encrypt","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"encrypt","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust server certificate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"TrustServerCertificate","options":null,"required":false,"type":8},{"defaultValue":"","display":"Host name that should appear in certificate","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"hostNameInCertificate","options":null,"required":false,"type":0},{"defaultValue":"","display":"Additional connection parameters","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"AdvancedParams","options":null,"required":false,"type":0}],"definitionId":"","deprecated":true,"description":"Deprecated. Use The Generic SQL integration instead.","detailedDescription":"Use to query SQL Server, using a remote (TCP) connection to the DB. \n\nPlease note the default timeout for queries is 30 seconds. To increase the timeout set the following parameter in the **Additional connection parameters** field: _connection timeout_ (notice the space in the name of the parameter) with the desired timeout in seconds. For example to set a timeout of 120 seconds use: _connection timeout=120_.","display":"SQL Server (Deprecated)","fromServerVersion":"","hidden":false,"icon":"mssql.png","id":"mssql","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.480601+03:00","name":"mssql","packID":"","prevName":"mssql","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Analytics \u0026 SIEM","commitMessage":"","configuration":[{"defaultValue":"","display":"IP address (e.g. 127.0.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0},{"defaultValue":"514","display":"Port","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"port","options":null,"required":true,"type":0},{"defaultValue":"UDP","display":"Protocol (TCP / UDP / Unix)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"protocol","options":null,"required":true,"type":0},{"defaultValue":"Auto","display":"Format (Auto / RFC5424 / RFC3164 / RFC6587)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"format","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log content field as a filter for incident creation (Regex).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"content","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log message field as a filter for incident creation (Regex).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"message","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log tag field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tag","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log client field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"client","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log hostname field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"hostname","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log TLS peer field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tls_peer","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log app name field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"app_name","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log process id field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proc_id","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log message id field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"msg_id","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log structured data field as a filter for incident creation (Equal).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"structured_data","options":null,"required":false,"type":0},{"defaultValue":"","display":"Log version field as a filter for incident creation (Greater than).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"version","options":null,"required":false,"type":1},{"defaultValue":"","display":"Log severity field as a filter for incident creation (Greater than).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"severity","options":null,"required":false,"type":1},{"defaultValue":"","display":"Log priority field as a filter for incident creation (Greater than).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"priority","options":null,"required":false,"type":1},{"defaultValue":"","display":"Log facility field as a filter for incident creation (Greater than).","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"facility","options":null,"required":false,"type":1},{"defaultValue":"true","display":"","displayPassword":"","hidden":true,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13}],"definitionId":"","description":"Syslog events logger automatically converts incoming logs to incidents","detailedDescription":"### You may add a combination of filters, leave empty to convert all incoming logs to incidents.\n\n### Filter types:\n\n* Regex - Use a regular expression as a filter.\nExample: \"[abc]\", that matches the letters 'a', 'b' or 'c', will filter the logs \"boot\" or \"cab\", but will not filter the log \"system\"\".\nExample: \"abc\", will filter the string \"abc\" but will not filter the strings \"ab\" or \"bac\".\n* Equal - Compare the field to the filter, match if they are exactly equal.\nExample: \"localhost\" will filter by a field \"ocalhost\" but will not filter by a field \"localhost-1\".\n* Greater than - Compare the field to the filter, match if it is greater than the filter.\nExample: 17 will filter by a field 10 but will not filter by a field 17 or 20.\n\n*Applies only to incoming logs from the moment the module was enabled (previously received logs will not be converted)*","display":"Syslog","fromServerVersion":"","hidden":false,"icon":"syslog.png","id":"syslog","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:28.72201+03:00","name":"syslog","packID":"","prevName":"syslog","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"true","display":"Fetch indicators","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feed","options":null,"required":false,"type":8},{"defaultValue":"","display":"Indicator Reputation","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Indicators from this integration instance will be marked with this reputation","name":"feedReputation","options":["None","Good","Suspicious","Bad"],"required":false,"type":18},{"defaultValue":"","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data","name":"feedReliability","options":["A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Traffic Light Protocol Color","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The Traffic Light Protocol (TLP) designation to apply to indicators fetched from the feed","name":"tlp_color","options":["RED","AMBER","GREEN","WHITE"],"required":false,"type":15},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationPolicy","options":["never","interval","indicatorType","suddenDeath"],"required":false,"type":17},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationInterval","options":null,"required":false,"type":1},{"defaultValue":"240","display":"Feed Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedFetchInterval","options":null,"required":false,"type":19},{"defaultValue":"","display":"Bypass exclusion list","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, the exclusion list is ignored for indicators from this feed. This means that if an indicator from this feed is on the exclusion list, the indicator might still be added to the system.","name":"feedBypassExclusionList","options":null,"required":false,"type":8},{"defaultValue":"","display":"Discovery Service URL (e.g. https://example.net/taxii)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0},{"defaultValue":"","display":"Username / API Key (see '?')","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Collection Name To Fetch Indicators From","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Indicators will be fetched from this collection. Run \"taxii2-get-collections\" command to get a valid value. If left empty, the instance will try to fetch from all the collections in the given discovery service.","name":"collection_to_fetch","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Incremental Feed","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Incremental feeds pull only new or modified indicators that have been sent from the integration. As the determination if the indicator is new or modified happens on the 3rd-party vendor's side, and only indicators that are new or modified are sent to Cortex XSOAR, all indicators coming from these feeds are labeled new or modified.","name":"feedIncremental","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Full Feed Fetch","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When enabled, fetch-indicators will try to fetch the entire feed for every fetch. When disabled, fetch-indicators will try to fetch just the latest entries (since the last fetch).","name":"fetch_full_feed","options":null,"required":false,"type":8},{"defaultValue":"","display":"Max Indicators Per Fetch (disabled for Full Feed Fetch)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The maximum number of indicators that can be fetched per fetch. If this field is left empty, there will be no limit on the number of indicators fetched.","name":"limit","options":null,"required":false,"type":0},{"defaultValue":"1 year","display":"First Fetch Time","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The time interval for the first fetch (retroactive). \u003cnumber\u003e \u003ctime unit\u003e of type minute/hour/day/year. For example, 1 minute, 12 hour","name":"initial_interval","options":null,"required":false,"type":0},{"defaultValue":"100","display":"Max STIX Objects Per Poll","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Set the number of stix object that will be requested with each taxii poll (http request). A single fetch is made of several taxii polls. Changing this setting can help speed up fetches, or fix issues on slower networks. Please note server restrictions may apply, overriding and limiting the \"requested limit\".","name":"limit_per_request","options":null,"required":false,"type":0},{"defaultValue":"Skip indicators with more than a single observation","display":"Complex Observation Mode","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Choose how to handle complex observations. Two or more Observation Expressions MAY be combined using a complex observation operator such as \"AND\", \"OR\". e.g. `[ IP = 'b' ] AND [ URL = 'd' ]`","name":"observation_operator_mode","options":["Create indicator for each observation","Skip indicators with more than a single observation"],"required":false,"type":15},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Tags","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Supports CSV values.","name":"feedTags","options":null,"required":false,"type":0}],"definitionId":"","description":"Ingests indicator feeds from TAXII 2.0 and 2.1 servers.","detailedDescription":"### Using API Token authentication\nIn order to use the integration with an API token you'll first need to change the `Username / API Key (see '?')` field to `_api_token_key`. Following this step, you can now enter the API Token into the `Password` field - this value will be used as an API key.\n\n\n### Using custom authentication header\nIn case the TAXII 2 server you're trying to connect to requires a custom authentication header, you'll first need to change the `Username / API Key (see '?')` field to `_header:` and the custom header name, e.g. `_header:custom_auth`. Following this step, you can now enter the custom authentication header value into the `Password` field - this value will be used as a custom authentication header.\n\n### Complex Observation Mode\nTwo or more Observation Expressions MAY be combined using a complex observation operator such as \"AND\", \"OR\", and \"FOLLOWEDBY\", e.g. `[ IP = 'b' ] AND [ URL = 'd' ]`. These relationships are not represented in CORTEX XSOAR threat intel management indicators. You can opt to create them while ignoring these relations, or you can opt to ignore these expressions - if you choose to ignore these expressions, then no indicators will be created for complex observations.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/taxii-2-feed)","display":"TAXII 2 Feed","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"TAXII 2 Feed","image":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAAAXNSR0IArs4c6QAAEhxJREFUeAHtPAl0VFWy9/W+pJMQlmxkD1lI0iSEsIedYR8cBVn9/EEH/X7UcQQhCoj4VYTvOOK4gSgoDmoABwERCEsyKGsICYYsdDYISUggZOnl9eu3/LqB9/p16E7CcUk7v+ucnLtU3br3Vb2ue6tuvSDkAY8EPBLwSMAjAY8EPBLwSMAjAY8EPBK4PwkQnZFHRUWFjE0i98aF0WxntPeLL74qYf912fuBkpKSGn7s2rVrJVW5W7ZH96UTlQrE8P18ybIccfmq/PrJQvVsg8Fg5fudlXjtSSHW3aMGUDKaIYjD5xWhDEsIzzywH10f0oc2l9XJZPkl8jk5F6qK2vNJTU3VDI6q3Rbsx8QpFRxz5JwyxMYQEp5OH0nfjAikja0WCfv198q3gvxsLTHB3Iag3qyJpxGXZdUS1eGLmgfKysoMcyYFbRkQyaYqFJxT2eZdkd3+/NvrE8Xj77cu62yAAiGf6cPIgN+PJAM7o71ffOZxVWVOHucN4wQF79ixI27tI2T6/AlkmCt+351RhJ8uVA8E/ClXNLgfhHgtMSRke1ocvXGE3qr28VKjDTu9hCEEIe3xymMtiLIR6NXPvDbdsibMKSwsbBQIoBLRs+6ZR6eYZw6MsSk2wtiyGqmAjg+n0cYnm3u0mCRo3afafSZK9Y1cws5ePK0lrj/gnMHxC8qWrFxlT8AZevlyPZ6eZUzRqDhnpGjDPzTnnCLuo1N4E+9jzC9KmhZFTk+NoV0qF0+eGMn4jUg0zenKQqpb+3zyxTHlgdpbEvToNAsaEG0XfFWdFG3cqUXeWhYtmGgekxTc/DTHccIvPFUfPmRKGrUEK7egTIY+OqAWppSBnjc83oKkIMHME2pD1jmvl8AStQoEblJxKwXr9XptaAAzLSrYrgRncurbm0ERAeyI6Ojo3s7w4r7c3FzzkXO61ZnZ6hIWfigbnmhFYBIFkk8PqdG5YjnSR9GyqcOti1MTIkdiZHJ4su+YJOvLfxhFhlMUgZ7/QIdYkSFd+qAJxYUx6Gyxgjx8VvneZYMhT2DqRhW3UjBLmQaMGmBNxL+OzmBMsi0hwJsa0hkdxpdWlhZn56nePFmgNEcG0egvs80Ow1Z+qEMWK4FmDidDJgyyvBQXF9czJvrW0vkTLON8vVj0VqYWlV2372YJYH6f+L0Z3WqWoJ1ZqkOXazQfOTB0o4ZbKXhovGUOHFr8uiKf+HCbGgQ9V2xSOxp3uzzys905qv3XG6Ro8VQzSomxCeRXb0hhv9MiXZuptoyO6GXaOHmY5TGgkeeVytHWb+2mWQ563vhkK5LcMc1XDp1RrXFH08w/nP215HuclEZSQuSWyJ1gEOrbh0H+PUS2qx0V3vtqbjr/SRZWygXJ6aOi+kQGmkYGg/ntCvTQsWhAFJUCv7ZwoK/obMyJyhNktSz6hchARr/0QWPchsdb0fSVPZAVDlgYdhxRo0mDKTQ0gZK9+qhxZkIk5YdxKzbrEGe36Ojph0yoX18anfpRaTl8VvVuSUVFQWdzdye+UwXD3lI4WB8xl5NxmvYLZRmJLDnc+spHK5oHtMfx7eXvel8srZe9wLfFJUdJW0sqSkoI8Fx8e1NDRydbE8T4zupDE+nY/aesY0pKOlcw5gVuVdnJH0PXJ0ba3p04yKpdNtcMp2etME3GZi904I3bKDmGarMir+3QoArRqTkxkkZLZpjRzSYwzUeV311p0G0VBrtppVMFg/Dx+5vtbP3gI8r9vGuWO8PxfT192abzh6oO8u32JVYuNrNPzgqeHx9GK9vjcdtoJpCXRvQzuksUG0JLo4Nts2AdO+AwZbe5zpjc7Sut0+3c9z09KSaEnrdoshl9d1aBeOtUDeZ7PZjqdYuN6AKY5m0H7e+0AgzYxv+6c0j+6pi6NOu8+qXi8kJjB1O5Bcot9mA4DUelxNpS8IGmPZgsBJq0zM+ITX17UCs5NCzRmmi6fTuuPc5VG/xc6ug5ZUbmMXWRDUzwG3CqVolO1Tuz1Cj7ohI9/76jaf7zLCOKhtP9mctgmnMV7xSXl19yNYc79d8rtW5YnT6MmjC0P9XP2dQQWOB8vLk1ZdflFmd48FFDU+Koac5wrvqKKiqqThWpXj12QWkK82fQ8nmOQadn3tGhKjh48YB9Z+xD19+WoH8cU35b2ej3CY9z97LbFZyQkKCICGAe7NeXEQIMYqHlG+RlldflWedLZaXifr4eGUijsN70FOBjD1HxyA7K20zElwfOKvZg9+c/JlnQ4Hi7hcdWgwfsM2PfGcNXJzTFh3K1LxUUFDi+ETyxG5bdrmCr0ZoAYcREpfzePRafYnNLFYaA0NAiQ7X0Ct6L24MUfmjYd2ZIUt8e11H7xIkT9JE8XcauHNVlEgIZ6+FUjU1+e8A+M/adTxUqzYfOKTbBQa2wPY07t7tdwel6y0PJUTance7y61IEe+93WBlVNxQHKyC06AyScOgyiXzYGa6jvtLS0ut1jZJ/FhjkXAi4e0kRjhE0hYxDD4+1oBYTgQrK5RWXKogvOuLnjrhuVTAOB4b60+PDA537vper5NUg/ONYcCU18tOXK2VVzoSIfefIAGZkV0KX4vHg/qWnRtOLBveniNOFCgg7Ovr6FE2g13Z4QayaQ+OSLfHpiWwGvu0S83D3ercuVq5rHDQaQo72Czy7uBjQ+ekixZVALozfe8vOlyrLcb8zGJ1C9e9q6BKPx+HIcSmWdXBLFmwmCbQSfGBnsOuECuVcVKDYMEYycyT5yKGvt010Rueufd2q4JRoel7/cJvOmXCqbsjQxSuymmquOj46LDoF2VD/S2XS+moXUbH4MJs6MZye15XQJaZJiWh9dt4ESzq+ScK+Lw5h8oBP1mJ4YYsOtcKV4NQhZMD4QeSqhPCEADHeneudBjp+qcXjy/j4iNa0Pi7CnNjsPjPLOEkq4X7HrwH0QgS6oMehS30/OrkrocthaRGjn5ph/WNSJC394UcFXBgIEdM2n3jryma0ZqsXwjgMN8A9euUzLzhNt6CFEy0jKmubls/+z7XLwVzf67jzi3WTstsUHB1oTU/XU/Gu5IBP1dOHWXu5wjvrHxZPxe0/3XHoMiYmptfYpJa1M4aTQdgdWgmxZjFgnxj/gtcvaUVTV/gh412X6escJZoyRIHGplDEH0ZaF/w185MsGOcyQifm2Z31bjHRs2fPlsYE0XNj+9I/6wsWE0pLooPaQpeOp6W7EsamOS3G+Nz88ZZ0HPp8/XMvVHvTLgLsC2OfGENgLxZlLHSMRL4Iphpnb0weSvqPTyVXxcfHOz39353OLQr70/2Ky8nLy4sdkmBL0qrv9Tt/yjKwHzu8v+vQ5fCBYeOmDaEWJUTQkpMFcvTlMZUwHR6LfWF8c/TxAW0Vvut9eCyJ0vX2AEgDXDKs265t85cX/o4cNiiy5Xn8sgpM3LDSLQpOjSanQVpO+C8hD7jDDR0Ya53Rnje+jhyXQq2B/LJAbHZf2IJTweywYr4JYV8Y4tCtn2dp3v5wnyYfB0BeW9LicNGx96QKZZ1X4Lg08UA6Ob+u6uxkOxf3q/2sJrIrj4fTcsL7NEx3lZZDwQ9m20FtGYM4x7QLEfOeOs4XAhAhoi6hikOXof7MJAhdboKLhTYbi31Xw/nNy8A0j/QCq5EB+6748gLi4JCTZYF7awn+VX/D1Ye/f6rQUHU0V/nxtGGkz6pHjAhnffCwaqsODYq7jSYPtvbJN8herG+OzRNnhvJ07lD+6gqmzGZ9R2k5F0oV1PZDmmW3zAqXGYX6cPOf02KpZRFBju4MFmhb6BJCn/tOkfiO+nvcd3jf1gnPPEQ9AlmQEuzTYt+WB5zRuP5xI6KB1RdZ6ks5F1UvF0FywJjwMd/s/aE0E64wH3toNIkOnlWi7Lw7p2psvl/epkVvLW1FYKqHVtxoXaHXz/5LZmbmvQviJ/oJZUxERDrLEmmEFJVAYthNAimakYQOLi0vP9oZ21/dRI9IhLScKNdpOedK5MUNRtl5HEZ09XexVLXbUCNrcvVwOHQ5LM7SFrpMjIjwH5dsWz11MBmAfVns04ohY4ERYZcs56Ky5Uie/H+LysuvYDwOjx7PV6/74qg6DyfdvfZYa1tKDz92/w8qBMl2bab6wXTrvPprZ6byuJ+7LK2o+BeScPXAl+AkkmgGMXEMy3bJw/hZFIwF4OqPYZEwB94H4eYovbcP65S+yShBRVWyYgjoV3ckJKVWWXq6SH7F1ZyYf19/Lh0rVx9PrQDTPEIOR6GXt+vafFqe97D+NgTKQZW1UgSX+HvL6tRf8jhc4rzq7HzF60cvKJt8IVyZAfu0GFaDqb7RKEUTU629RydYX4RQaV+Mx9mbrtYmdpwJFhEd0To7gsJ1SzNBsF22FD/JRM+YMYP58eSWS8s+8G4WP7i4XtsoKefbDMepCgyyZqDfz/eJS5rhpM0k8Tdxn7M6Tk43hPbdtfRt70aVEmJcTuBGo0RjJohQkwVFvbdXe4CmCWl5jTQ0KsguYrkc1T73njfZbCKIomLlU4bye7+UGDFp8e49OZvjd2Ur07VqRMaGMCHwlYQgt2f/7t3Yy5dtpmlO0ltlSyM59jIkyJ/w8eIcfay7a7zVTKgUSNsWU69rlF1c8YFOLZUSThUGL89N/tEMFRU7+Lqn9EjAI4H/LxK49wbdxZPjKFBsbGyEGL1l5U3bqCRGiBrl5WuYuRt0Do7/xS03bWqNneZvu1Xo/T0+ApuAAMaW/eZNgQdGTFvhxxiq8a55B6aPMNrefNIk0FyvZ2XjngV/SARf/08D3T+CFUznnmyCydjcR+CBkweLt93gkIwTzgSrP1RxX+X4CDIYGmukt68xCTww+4FL/BiTyb6W/55ipJ9eaKcBX5kZ8Ef7PHjMx8810CMG2tdy+DTinnrHX5hHQknYop11SLyWVds0TOYRu+xC+9D0kbduOaxlyvIebHmNQli/XC5vav8tFZ5fDA4MxIj29X79+uk4G10m7g/zZY5xFD2O7wsJMp5hrMohfBuXcgl1haO4fnxfpJ/tNGOlhvJtL5bJBx4Oabc+KiqfsXJCX7APfRhohEuHIF+EgAfPoq0M8aPPcRSbxnfGBsqOA81Yvg0KtiGWtsJahHvBXt4oF2hSeRqdhsuBeUbxbVxqCO5ai5UK4fvCgqlvgUY4MUNGTy3wcAhZhgey2UAzmh8TEyjLA5oUvg3JSSTibBxHIeGWI1DDHAMaQZZeCjoXeAhrw2PVUrqUsaIYng9L0W9AfSXfdlYKb4MzpKfvty8Bj4J/+zrs8Ak8Cu5QPL99pLDxd/YodYf8tTLWfEBMt/WApq74qlzIbhgQbbu2cKJZ2K8w7YrN3kaWIYR9b+ZIU9XIJPv3v00mifnVT3X2TwhgzOpFrfXeGrYPP9eZQsXVXTnqUL4thT1s/RPN9ngjID47rLYWlCmELyPGD6IqJqdZIvgxDEdYn3/PWwEfjQnPvGiq6VpiGC2s91qD9PamXV49+DG4fP1Pza0yGRLCXwfPqiqP5SrDeRo/b6YBomG9+TYu/75XW1tVIxP25eQY8tqC8VZhHrixIjK2+HDi9KM/zTBWxvRlwnk+1Q2yurd3aQXZ4n6Qy02QixDBajJJ90TPatrEj3FWdvmQ5d+TknFWVjg4YGaQ6XA2J182mGcc0JM+7uftSAOfgDS0GJEggAUTiYNiGi81ew14CA+PeQX3YgrkMk5Ig/Xz4Y4CjXju28DDQRGQlH4VaISXYKTeahHPQyCi9eQlmaAoPM/KBewRMQ18/3sJeCRhHA/+Pdk6UIggaLmUtYnXEtxbWgQ8HBIXrtdLzwGNcOALC5AeFc+Def9wSSp8+IbbGQs4m5hGKmXOA49BGMcDyKUI5CLMBZ8FneZxrkqPiXYlmX+Tfo+C/00U6eoxumyiEaWFKwXbl2JGNlZSC/5lBd9H0pIKMIX41kMAuOYyQlqssAe3mAkD0LTwBC0WiQV4qPk2Ls0kqvX1Ior4vmYTVwk0QlwWccgIPASemI60ETagEYIhFiu6AjRCjJzlOBLwDvt2k1lSBjTCP11pbJU0Ac1lfl5cwj/1gctBJERmjGYZXsstnobl2BvAw+EbYdqGaoCmnKchbbJyoBHWDxcMcA6AwwB8WMnTNN9Zi8C3xYSwbMt4PC7hrvyGQiaai+PyxXhP3SMBjwQ8EvBIwCMBjwQ8EvBI4FeSwP8BQEKQq9vDLR0AAAAASUVORK5CYII=","integrationScript":{"commands":[{"arguments":[{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Will return only the rawJSON of the indicator object.","name":"raw","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of indicators to fetch.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Fetch only indicators that were added to the server after the given time. Please provide a \u003cnumber\u003e and \u003ctime unit\u003e of type minute/hour/day. For example, 1 minute, 12 hour, 24 days.","name":"added_after","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Allows you to test your feed and to make sure you can fetch indicators successfuly.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"taxii2-get-indicators","outputs":[{"contentPath":"","contextPath":"TAXII2.Indicators.type","description":"Indicator type.","type":"String"},{"contentPath":"","contextPath":"TAXII2.Indicators.value","description":"Indicator value.","type":"String"},{"contentPath":"","contextPath":"TAXII2.Indicators.rawJSON","description":"Indicator rawJSON.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Gets the list of collections from the discovery service.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"taxii2-get-collections","outputs":[{"contentPath":"","contextPath":"TAXII2.Collections.ID","description":"Collection ID.","type":"String"},{"contentPath":"","contextPath":"TAXII2.Collections.Name","description":"Collection Name.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":true,"description":"WARNING: This command will reset your fetch history.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"taxii2-reset-fetch-indicators","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/taxii2:1.0.0.19258","feed":true,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\nfrom typing import Any, Tuple\n\n\"\"\" CONSTANT VARIABLES \"\"\"\n\n\nCONTEXT_PREFIX = \"TAXII2\"\nCOMPLEX_OBSERVATION_MODE_SKIP = \"Skip indicators with more than a single observation\"\nCOMPLEX_OBSERVATION_MODE_CREATE_ALL = \"Create indicator for each observation\"\n\n\"\"\" HELPER FUNCTIONS \"\"\"\n\n\ndef try_parse_integer(\n    int_to_parse: Any, err_msg: str = \"Please provide a valid limit (positive integer)\"\n) -\u003e int:\n    \"\"\"\n    Tries to parse an integer, and if fails will throw DemistoException with given err_msg\n    \"\"\"\n    if not int_to_parse:\n        return int_to_parse\n    try:\n        res = int(int_to_parse)\n    except (TypeError, ValueError):\n        raise DemistoException(err_msg)\n    return res\n\n\ndef assert_incremental_feed_params(fetch_full_feed, is_incremental_feed):\n    if fetch_full_feed == is_incremental_feed:\n        toggle_value = 'enabled' if fetch_full_feed else 'disabled'\n        raise DemistoException(f\"'Full Feed Fetch' cannot be {toggle_value} when 'Incremental Feed' is {toggle_value}.\")\n\n\n\"\"\" COMMAND FUNCTIONS \"\"\"\n\n\ndef module_test_command(client, limit, fetch_full_feed):\n    if client.collections:\n        if fetch_full_feed:\n            if limit and limit != -1:\n                return_error(\n                    \"Configuration Error - Max Indicators Per Fetch is disabled when Full Feed Fetch is enabled\"\n                )\n        demisto.results(\"ok\")\n    else:\n        return_error(\"Could not connect to server\")\n\n\ndef fetch_indicators_command(\n    client,\n    initial_interval,\n    limit,\n    last_run_ctx,\n    fetch_full_feed: bool = False,\n) -\u003e Tuple[list, dict]:\n    \"\"\"\n    Fetch indicators from TAXII 2 server\n    :param client: Taxii2FeedClient\n    :param initial_interval: initial interval in parse_date_range format\n    :param limit: upper limit of indicators to fetch\n    :param last_run_ctx: last run dict with {collection_id: last_run_time string}\n    :param fetch_full_feed: when set to true, will ignore last run, and try to fetch the entire feed\n    :return: indicators in cortex TIM format\n    \"\"\"\n    if initial_interval:\n        initial_interval, _ = parse_date_range(\n            initial_interval, date_format=TAXII_TIME_FORMAT\n        )\n\n    last_fetch_time = (\n        last_run_ctx.get(client.collection_to_fetch.id)\n        if client.collection_to_fetch\n        else None\n    )\n\n    # add filter for indicator types by default\n    filter_args = {\"type\": \"indicator\"}\n\n    if client.collection_to_fetch is None:\n        # fetch all collections\n        if client.collections is None:\n            raise DemistoException(ERR_NO_COLL)\n        indicators: list = []\n        for collection in client.collections:\n            client.collection_to_fetch = collection\n            filter_args[\"added_after\"] = get_added_after(\n                fetch_full_feed, initial_interval, last_run_ctx.get(collection.id)\n            )\n            fetched_iocs = client.build_iterator(limit, **filter_args)\n            indicators.extend(fetched_iocs)\n            if limit \u003e= 0:\n                limit -= len(fetched_iocs)\n                if limit \u003c= 0:\n                    break\n            last_run_ctx[collection.id] = client.last_fetched_indicator__modified\n    else:\n        # fetch from a single collection\n        filter_args[\"added_after\"] = get_added_after(fetch_full_feed, initial_interval, last_fetch_time)\n        indicators = client.build_iterator(limit, **filter_args)\n        last_run_ctx[client.collection_to_fetch.id] = (\n            client.last_fetched_indicator__modified\n            if client.last_fetched_indicator__modified\n            else filter_args.get(\"added_after\")\n        )\n    return indicators, last_run_ctx\n\n\ndef get_added_after(\n    fetch_full_feed, initial_interval, last_fetch_time=None\n):\n    \"\"\"\n    Creates the added_after param, or extracts it from the filter_args\n    :param fetch_full_feed: when set to true, will limit added_after\n    :param initial_interval: initial_interval if no\n    :param last_fetch_time: last_fetch time value (str)\n    :return: added_after\n    \"\"\"\n    if fetch_full_feed:\n        return initial_interval\n\n    return last_fetch_time or initial_interval\n\n\ndef get_indicators_command(\n    client, raw=\"false\", limit=10, added_after=None\n):\n    \"\"\"\n    Fetch indicators from TAXII 2 server\n    :param client: Taxii2FeedClient\n    :param raw: When set to \"true\" will return only rawJSON\n    :param limit: upper limit of indicators to fetch\n    :param (Optional) added_after: added after time string in parse_date_range format\n    :return: indicators in cortex TIM format\n    \"\"\"\n\n    # add filter for indicator types by default\n    filter_args = {\"type\": \"indicator\"}\n\n    limit = try_parse_integer(limit)\n    if added_after:\n        added_after, _ = parse_date_range(added_after, date_format=TAXII_TIME_FORMAT)\n        filter_args[\"added_after\"] = added_after\n    raw = argToBoolean(raw)\n\n    if client.collection_to_fetch is None:\n        # fetch all collections\n        if client.collections is None:\n            raise DemistoException(ERR_NO_COLL)\n        indicators: list = []\n        for collection in client.collections:\n            client.collection_to_fetch = collection\n            fetched_iocs = client.build_iterator(limit, **filter_args)\n            indicators.extend(fetched_iocs)\n            if limit \u003e= 0:\n                limit -= len(fetched_iocs)\n                if limit \u003c= 0:\n                    break\n\n    else:\n        indicators = client.build_iterator(limit=limit, **filter_args)\n\n    if raw:\n        demisto.results({\"indicators\": [x.get(\"rawJSON\") for x in indicators]})\n        return\n\n    md = f\"Found {len(indicators)} results:\\n\" + tableToMarkdown(\n        \"\", indicators, [\"value\", \"type\"]\n    )\n    if indicators:\n        return CommandResults(\n            outputs_prefix=CONTEXT_PREFIX + \".Indicators\",\n            outputs_key_field=\"value\",\n            outputs=indicators,\n            readable_output=md,\n        )\n    return md\n\n\ndef get_collections_command(client):\n    \"\"\"\n    Get the available collections in the TAXII server\n    :param client: FeedClient\n    :return: available collections\n    \"\"\"\n    collections = list()\n    for collection in client.collections:\n        collections.append({\"Name\": collection.title, \"ID\": collection.id})\n    md = tableToMarkdown(\"TAXII2 Server Collections:\", collections, [\"Name\", \"ID\"])\n    return CommandResults(\n        outputs_prefix=CONTEXT_PREFIX + \".Collections\",\n        outputs_key_field=\"ID\",\n        outputs=collections,\n        readable_output=md,\n    )\n\n\ndef reset_fetch_command(client):\n    \"\"\"\n    Reset the last fetch from the integration context\n    \"\"\"\n    demisto.setIntegrationContext({})\n    return (\n        \"Fetch was reset successfully. Your next indicator fetch will collect indicators from \"\n        'the configured \"First Fetch Time\"'\n    )\n\n\ndef main():\n    params = demisto.params()\n    args = demisto.args()\n    url = params.get(\"url\")\n    collection_to_fetch = params.get(\"collection_to_fetch\")\n    credentials = params.get(\"credentials\") or {}\n    username = credentials.get(\"identifier\")\n    password = credentials.get(\"password\")\n    proxies = handle_proxy()\n    verify_certificate = not params.get(\"insecure\", False)\n    skip_complex_mode = COMPLEX_OBSERVATION_MODE_SKIP == params.get(\n        \"observation_operator_mode\"\n    )\n    feed_tags = argToList(params.get(\"feedTags\"))\n    tlp_color = params.get('tlp_color', '')\n\n    initial_interval = params.get(\"initial_interval\")\n    fetch_full_feed = params.get(\"fetch_full_feed\") or False\n    is_incremental_feed = params.get('feedIncremental') or False\n    limit = try_parse_integer(params.get(\"limit\") or -1)\n    limit_per_request = try_parse_integer(params.get(\"limit_per_request\"))\n\n    command = demisto.command()\n    demisto.info(f\"Command being called in {CONTEXT_PREFIX} is {command}\")\n    try:\n        assert_incremental_feed_params(fetch_full_feed, is_incremental_feed)\n        client = Taxii2FeedClient(\n            url=url,\n            collection_to_fetch=collection_to_fetch,\n            proxies=proxies,\n            verify=verify_certificate,\n            skip_complex_mode=skip_complex_mode,\n            username=username,\n            password=password,\n            tags=feed_tags,\n            limit_per_request=limit_per_request,\n            tlp_color=tlp_color\n        )\n        client.initialise()\n        commands = {\n            \"taxii2-reset-fetch-indicators\": reset_fetch_command,\n            \"taxii2-get-indicators\": get_indicators_command,\n            \"taxii2-get-collections\": get_collections_command,\n        }\n\n        if demisto.command() == \"test-module\":\n            # This is the call made when pressing the integration Test button.\n            module_test_command(client, limit, fetch_full_feed)\n\n        elif demisto.command() == \"fetch-indicators\":\n            if fetch_full_feed:\n                limit = -1\n\n            last_run_indicators = get_feed_last_run()\n            (indicators, last_run_indicators) = fetch_indicators_command(\n                client,\n                initial_interval,\n                limit,\n                last_run_indicators,\n                fetch_full_feed,\n            )\n            for iter_ in batch(indicators, batch_size=2000):\n                demisto.createIndicators(iter_)\n\n            set_feed_last_run(last_run_indicators)\n        else:\n            return_results(commands[command](client, **args))  # type: ignore[operator]\n\n    except Exception as e:\n        err_msg = f\"Failed to execute {command} command. Error: {str(e)}\\n\\ntraceback: {traceback.format_exc()}\"\n        if isinstance(e, requests.exceptions.SSLError):\n            LOG(err_msg)\n            err_msg = (\n                \"Encountered an HTTPS certificate error. This error can be ignored by enabling \"\n                '\"Trust any certificate (not secure)\" in the instance configuration.'\n            )\n        return_error(err_msg)\n\n\n\n### GENERATED CODE ###\n# This code was inserted in place of an API module.\n\n\n\nfrom typing import Union, Optional, List, Dict, Tuple\nfrom requests.sessions import merge_setting, CaseInsensitiveDict\nimport re\nimport copy\nimport types\nimport urllib3\nfrom taxii2client import v20, v21\nfrom taxii2client.common import TokenAuth, _HTTPConnection\n\n# disable insecure warnings\nurllib3.disable_warnings()\n\n# CONSTANTS\nTAXII_VER_2_0 = \"2.0\"\nTAXII_VER_2_1 = \"2.1\"\n\nDFLT_LIMIT_PER_REQUEST = 100\nAPI_USERNAME = \"_api_token_key\"\nHEADER_USERNAME = \"_header:\"\n\nERR_NO_COLL = \"No collection is available for this user, please make sure you entered the configuration correctly\"\n\n# Pattern Regexes - used to extract indicator type and value\nINDICATOR_OPERATOR_VAL_FORMAT_PATTERN = r\"(\\w.*?{value}{operator})'(.*?)'\"\nINDICATOR_EQUALS_VAL_PATTERN = INDICATOR_OPERATOR_VAL_FORMAT_PATTERN.format(\n    value=\"value\", operator=\"=\"\n)\nCIDR_ISSUBSET_VAL_PATTERN = INDICATOR_OPERATOR_VAL_FORMAT_PATTERN.format(\n    value=\"value\", operator=\"ISSUBSET\"\n)\nCIDR_ISUPPERSET_VAL_PATTERN = INDICATOR_OPERATOR_VAL_FORMAT_PATTERN.format(\n    value=\"value\", operator=\"ISUPPERSET\"\n)\nHASHES_EQUALS_VAL_PATTERN = INDICATOR_OPERATOR_VAL_FORMAT_PATTERN.format(\n    value=r\"hashes\\..*?\", operator=\"=\"\n)\n\nTAXII_TIME_FORMAT = \"%Y-%m-%dT%H:%M:%S.%fZ\"\nTAXII_TIME_FORMAT_NO_MS = \"%Y-%m-%dT%H:%M:%SZ\"\n\nSTIX_2_TYPES_TO_CORTEX_TYPES = {\n    \"ipv4-addr\": FeedIndicatorType.IP,\n    \"ipv6-addr\": FeedIndicatorType.IPv6,\n    \"domain\": FeedIndicatorType.Domain,\n    \"domain-name\": FeedIndicatorType.Domain,\n    \"url\": FeedIndicatorType.URL,\n    \"md5\": FeedIndicatorType.File,\n    \"sha-1\": FeedIndicatorType.File,\n    \"sha-256\": FeedIndicatorType.File,\n    \"file:hashes\": FeedIndicatorType.File,\n}\n\nSTIX_2_TYPES_TO_CORTEX_CIDR_TYPES = {\n    \"ipv4-addr\": FeedIndicatorType.CIDR,\n    \"ipv6-addr\": FeedIndicatorType.IPv6CIDR,\n}\n\n\nclass Taxii2FeedClient:\n    def __init__(\n            self,\n            url: str,\n            collection_to_fetch,\n            proxies,\n            verify: bool,\n            skip_complex_mode: bool = False,\n            username: Optional[str] = None,\n            password: Optional[str] = None,\n            field_map: Optional[dict] = None,\n            tags: Optional[list] = None,\n            tlp_color: Optional[str] = None,\n            limit_per_request: int = DFLT_LIMIT_PER_REQUEST,\n    ):\n        \"\"\"\n        TAXII 2 Client used to poll and parse indicators in XSOAR formar\n        :param url: discovery service URL\n        :param collection_to_fetch: Collection to fetch objects from\n        :param proxies: proxies used in request\n        :param skip_complex_mode: if set to True will skip complex observations\n        :param verify: verify https\n        :param username: username used for basic authentication OR api_key used for authentication\n        :param password: password used for basic authentication\n        :param field_map: map used to create fields entry ({field_name: field_value})\n        :param tags: custom tags to be added to the created indicator\n        :param limit_per_request: Limit the objects requested per poll request\n        :param tlp_color: Traffic Light Protocol color\n        \"\"\"\n        self._conn = None\n        self.server = None\n        self.api_root = None\n        self.collections = None\n        self.last_fetched_indicator__modified = None\n\n        self.collection_to_fetch = collection_to_fetch\n        self.skip_complex_mode = skip_complex_mode\n        if not limit_per_request:\n            limit_per_request = DFLT_LIMIT_PER_REQUEST\n        self.limit_per_request = limit_per_request\n\n        self.base_url = url\n        self.proxies = proxies\n        self.verify = verify\n\n        self.auth = None\n        self.auth_header = None\n        self.auth_key = None\n        if username and password:\n            # authentication methods:\n            # 1. API Token\n            # 2. Authentication Header\n            # 3. Basic\n            if username == API_USERNAME:\n                self.auth = TokenAuth(key=password)\n            elif username.startswith(HEADER_USERNAME):\n                self.auth_header = username.split(HEADER_USERNAME)[1]\n                self.auth_key = password\n            else:\n                self.auth = requests.auth.HTTPBasicAuth(username, password)\n\n        self.field_map = field_map if field_map else {}\n        self.tags = tags if tags else []\n        self.tlp_color = tlp_color\n        self.indicator_regexes = [\n            re.compile(INDICATOR_EQUALS_VAL_PATTERN),\n            re.compile(HASHES_EQUALS_VAL_PATTERN),\n        ]\n        self.cidr_regexes = [\n            re.compile(CIDR_ISSUBSET_VAL_PATTERN),\n            re.compile(CIDR_ISUPPERSET_VAL_PATTERN),\n        ]\n\n    def init_server(self, version=TAXII_VER_2_0):\n        \"\"\"\n        Initializes a server in the requested version\n        :param version: taxii version key (either 2.0 or 2.1)\n        \"\"\"\n        server_url = urljoin(self.base_url)\n        self._conn = _HTTPConnection(\n            verify=self.verify, proxies=self.proxies, version=version, auth=self.auth\n        )\n        if self.auth_header:\n            # add auth_header to the session object\n            self._conn.session.headers = (  # type: ignore[attr-defined]\n                merge_setting(\n                    self._conn.session.headers,  # type: ignore[attr-defined]\n                    {self.auth_header: self.auth_key},\n                    dict_class=CaseInsensitiveDict,\n                ),\n            )\n        if version is TAXII_VER_2_0:\n            self.server = v20.Server(\n                server_url, verify=self.verify, proxies=self.proxies, conn=self._conn,\n            )\n        else:\n            self.server = v21.Server(\n                server_url, verify=self.verify, proxies=self.proxies, conn=self._conn,\n            )\n\n    def init_roots(self):\n        \"\"\"\n        Initializes the api roots (used to get taxii server objects)\n        \"\"\"\n        if not self.server:\n            self.init_server()\n        try:\n            # try TAXII 2.0\n            self.api_root = self.server.api_roots[0]  # type: ignore[union-attr, attr-defined]\n            # override _conn - api_root isn't initialized with the right _conn\n            self.api_root._conn = self._conn  # type: ignore[attr-defined]\n        # (TAXIIServiceException, HTTPError) should suffice, but sometimes it raises another type of HTTPError\n        except Exception as e:\n            if \"406 Client Error\" not in str(e):\n                raise e\n            # switch to TAXII 2.1\n            self.init_server(version=TAXII_VER_2_1)\n            self.api_root = self.server.api_roots[0]  # type: ignore[union-attr, attr-defined]\n            # override _conn - api_root isn't initialized with the right _conn\n            self.api_root._conn = self._conn  # type: ignore[attr-defined]\n\n    def init_collections(self):\n        \"\"\"\n        Collects available taxii collections\n        \"\"\"\n        self.collections = [x for x in self.api_root.collections]  # type: ignore[union-attr, attr-defined, assignment]\n\n    def init_collection_to_fetch(self, collection_to_fetch=None):\n        \"\"\"\n        Tries to initialize `collection_to_fetch` if possible\n        \"\"\"\n        if collection_to_fetch is None and isinstance(self.collection_to_fetch, str):\n            # self.collection_to_fetch will be changed from str -\u003e Union[v20.Collection, v21.Collection]\n            collection_to_fetch = self.collection_to_fetch\n        if not self.collections:\n            raise DemistoException(ERR_NO_COLL)\n        if collection_to_fetch:\n            collection_found = False\n            for collection in self.collections:\n                if collection.title == collection_to_fetch:\n                    self.collection_to_fetch = collection\n                    collection_found = True\n                    break\n            if not collection_found:\n                raise DemistoException(\n                    \"Could not find the provided Collection name in the available collections. \"\n                    \"Please make sure you entered the name correctly.\"\n                )\n\n    def initialise(self):\n        self.init_server()\n        self.init_roots()\n        self.init_collections()\n        self.init_collection_to_fetch()\n\n    def build_iterator(self, limit: int = -1, **kwargs) -\u003e List[Dict[str, str]]:\n        \"\"\"\n        Polls the taxii server and builds a list of cortex indicators objects from the result\n        :param limit: max amount of indicators to fetch\n        :return: Cortex indicators list\n        \"\"\"\n        if not isinstance(self.collection_to_fetch, (v20.Collection, v21.Collection)):\n            raise DemistoException(\n                \"Could not find a collection to fetch from. \"\n                \"Please make sure you provided a collection.\"\n            )\n        if limit is None:\n            limit = -1\n\n        page_size = self.get_page_size(limit, limit)\n        if page_size \u003c= 0:\n            return []\n        envelope = self.poll_collection(page_size, **kwargs)\n        indicators = self.extract_indicators_from_envelope_and_parse(envelope, limit)\n        return indicators\n\n    def extract_indicators_from_envelope_and_parse(\n            self, envelope: Union[types.GeneratorType, Dict[str, str]], limit: int = -1\n    ) -\u003e List[Dict[str, str]]:\n        \"\"\"\n        Extract indicators from an 2.0 envelope generator, or 2.1 envelope (which then polls and repeats process)\n        and parses them as cortex indicators\n        :param envelope: envelope containing stix objects\n        :param limit: max amount of indicators to fetch\n        :return: Cortex indicators list\n        \"\"\"\n        indicators = []\n        obj_cnt = 0\n        # TAXII 2.0\n        if isinstance(envelope, types.GeneratorType):\n            for sub_envelope in envelope:\n                stix_objects = sub_envelope.get(\"objects\")\n                if not stix_objects:\n                    # no fetched objects\n                    break\n                obj_cnt += len(stix_objects)\n                indicators.extend(\n                    self.parse_indicators_list(\n                        self.extract_indicators_from_stix_objects(stix_objects)\n                    )\n                )\n                if 0 \u003c limit \u003c= len(indicators):\n                    break\n        # TAXII 2.1\n        elif isinstance(envelope, Dict):\n            cur_limit = limit\n            stix_objects = envelope.get(\"objects\")\n            obj_cnt += len(stix_objects)\n            indicators_list = self.extract_indicators_from_stix_objects(stix_objects)\n            indicators = self.parse_indicators_list(indicators_list)\n            while envelope.get(\"more\", False):\n                page_size = self.get_page_size(limit, cur_limit)\n                envelope = self.collection_to_fetch.get_objects(\n                    limit=page_size, next=envelope.get(\"next\", \"\")\n                )\n                if isinstance(envelope, Dict):\n                    stix_objects = envelope.get(\"objects\")\n                    obj_cnt += len(stix_objects)\n                    extracted_iocs = self.extract_indicators_from_stix_objects(\n                        stix_objects\n                    )\n                    parsed_iocs = self.parse_indicators_list(extracted_iocs)\n                    indicators.extend(parsed_iocs)\n\n                    if limit \u003e -1:\n                        cur_limit -= len(envelope)  # type: ignore\n                        if cur_limit \u003c 0:\n                            break\n                else:\n                    raise DemistoException(\n                        \"Error: TAXII 2 client received the following response while requesting \"\n                        f\"indicators: {str(envelope)}\\n\\nExpected output is json\"\n                    )\n        demisto.debug(\n            f\"TAXII 2 Feed has extracted {len(indicators)} indicators / {obj_cnt} stix objects\"\n        )\n        if limit \u003e -1:\n            return indicators[:limit]\n        return indicators\n\n    def poll_collection(\n            self, page_size: int, **kwargs\n    ) -\u003e Union[types.GeneratorType, Dict[str, str]]:\n        \"\"\"\n        Polls a taxii collection\n        :param page_size: size of the request page\n        \"\"\"\n        get_objects = self.collection_to_fetch.get_objects\n        if isinstance(self.collection_to_fetch, v20.Collection):\n            envelope = v20.as_pages(get_objects, per_request=page_size, **kwargs)\n        else:\n            envelope = get_objects(limit=page_size, **kwargs)\n        return envelope\n\n    def get_page_size(self, max_limit: int, cur_limit: int) -\u003e int:\n        \"\"\"\n        Get a page size given the limit on entries `max_limit` and the limit on the current poll\n        :param max_limit: max amount of entries allowed overall\n        :param cur_limit: max amount of entries allowed in a page\n        :return: page size\n        \"\"\"\n        return (\n            min(self.limit_per_request, cur_limit)\n            if max_limit \u003e -1\n            else self.limit_per_request\n        )\n\n    @staticmethod\n    def extract_indicators_from_stix_objects(\n            stix_objs: List[Dict[str, str]]\n    ) -\u003e List[Dict[str, str]]:\n        \"\"\"\n        Extracts indicators from taxii objects\n        :param stix_objs: taxii objects\n        :return: indicators in json format\n        \"\"\"\n        indicators_objs = [\n            item for item in stix_objs if item.get(\"type\") == \"indicator\"\n        ]  # retrieve only indicators\n\n        return indicators_objs\n\n    def parse_indicators_list(\n            self, indicators_objs: List[Dict[str, str]]\n    ) -\u003e List[Dict[str, str]]:\n        \"\"\"\n        Parses a list of indicator objects, and updates the client.latest_fetched_indicator_created\n        :param indicators_objs: indicator objects\n        :return: Parsed list of indicators\n        \"\"\"\n        indicators = []\n        if indicators_objs:\n            for indicator_obj in indicators_objs:\n                indicators.extend(self.parse_single_indicator(indicator_obj))\n                indicator_modified_str = indicator_obj.get(\"modified\")\n                if self.last_fetched_indicator__modified is None:\n                    self.last_fetched_indicator__modified = indicator_modified_str  # type: ignore[assignment]\n                else:\n                    last_datetime = self.stix_time_to_datetime(\n                        self.last_fetched_indicator__modified\n                    )\n                    indicator_created_datetime = self.stix_time_to_datetime(\n                        indicator_modified_str\n                    )\n                    if indicator_created_datetime \u003e last_datetime:\n                        self.last_fetched_indicator__modified = indicator_modified_str\n        return indicators\n\n    def parse_single_indicator(\n            self, indicator_obj: Dict[str, str]\n    ) -\u003e List[Dict[str, str]]:\n        \"\"\"\n        Parses a single indicator object\n        :param indicator_obj: indicator object\n        :return: list of indicators extracted from the object in cortex format\n        \"\"\"\n        field_map = self.field_map if self.field_map else {}\n        pattern = indicator_obj.get(\"pattern\")\n        indicators = []\n        if pattern:\n            # this is done in case the server doesn't properly space the operator,\n            # supported indicators have no spaces, so this action shouldn't affect extracted values\n            trimmed_pattern = pattern.replace(\" \", \"\")\n\n            indicator_groups = self.extract_indicator_groups_from_pattern(\n                trimmed_pattern, self.indicator_regexes\n            )\n            indicators.extend(\n                self.get_indicators_from_indicator_groups(\n                    indicator_groups,\n                    indicator_obj,\n                    STIX_2_TYPES_TO_CORTEX_TYPES,\n                    field_map,\n                )\n            )\n\n            cidr_groups = self.extract_indicator_groups_from_pattern(\n                trimmed_pattern, self.cidr_regexes\n            )\n            indicators.extend(\n                self.get_indicators_from_indicator_groups(\n                    cidr_groups,\n                    indicator_obj,\n                    STIX_2_TYPES_TO_CORTEX_CIDR_TYPES,\n                    field_map,\n                )\n            )\n\n        return indicators\n\n    def get_indicators_from_indicator_groups(\n            self,\n            indicator_groups: List[Tuple[str, str]],\n            indicator_obj: Dict[str, str],\n            indicator_types: Dict[str, str],\n            field_map: Dict[str, str],\n    ) -\u003e List[Dict[str, str]]:\n        \"\"\"\n        Get indicators from indicator regex groups\n        :param indicator_groups: caught regex group in pattern of: [`type`, `indicator`]\n        :param indicator_obj: taxii indicator object\n        :param indicator_types: supported indicator types -\u003e cortex types\n        :param field_map: map used to create fields entry ({field_name: field_value})\n        :return: Indicators list\n        \"\"\"\n        indicators = []\n        if indicator_groups:\n            for term in indicator_groups:\n                for taxii_type in indicator_types.keys():\n                    # term should be list with 2 argument parsed with regex - [`type`, `indicator`]\n                    if len(term) == 2 and taxii_type in term[0]:\n                        type_ = indicator_types[taxii_type]\n                        value = term[1]\n                        indicator = self.create_indicator(\n                            indicator_obj, type_, value, field_map\n                        )\n                        indicators.append(indicator)\n                        break\n        if self.skip_complex_mode and len(indicators) \u003e 1:\n            # we managed to pull more than a single indicator - indicating complex relationship\n            return []\n        return indicators\n\n    def create_indicator(self, indicator_obj, type_, value, field_map):\n        \"\"\"\n        Create a cortex indicator from a stix indicator\n        :param indicator_obj: rawJSON value of the indicator\n        :param type_: cortex type of the indicator\n        :param value: indicator value\n        :param field_map: field map used for mapping fields ({field_name: field_value})\n        :return: Cortex indicator\n        \"\"\"\n        ioc_obj_copy = copy.deepcopy(indicator_obj)\n        ioc_obj_copy[\"value\"] = value\n        ioc_obj_copy[\"type\"] = type_\n        indicator = {\n            \"value\": value,\n            \"type\": type_,\n            \"rawJSON\": ioc_obj_copy,\n        }\n        fields = {}\n        tags = list(self.tags)\n        # create tags from labels:\n        for label in ioc_obj_copy.get(\"labels\", []):\n            tags.append(label)\n\n        # add description if able\n        if \"description\" in ioc_obj_copy:\n            fields[\"description\"] = ioc_obj_copy[\"description\"]\n\n        # add field_map fields\n        for field_name, field_path in field_map.items():\n            if field_path in ioc_obj_copy:\n                fields[field_name] = ioc_obj_copy.get(field_path)\n\n        # union of tags and labels\n        if \"tags\" in fields:\n            field_tag = fields.get(\"tags\")\n            if isinstance(field_tag, list):\n                tags.extend(field_tag)\n            else:\n                tags.append(field_tag)\n\n        fields[\"tags\"] = tags\n\n        if self.tlp_color:\n            fields[\"trafficlightprotocol\"] = self.tlp_color\n\n        indicator[\"fields\"] = fields\n        return indicator\n\n    @staticmethod\n    def extract_indicator_groups_from_pattern(\n            pattern: str, regexes: List\n    ) -\u003e List[Tuple[str, str]]:\n        \"\"\"\n        Extracts indicator [`type`, `indicator`] groups from pattern\n        :param pattern: stix pattern\n        :param regexes: regexes to run to pattern\n        :return: extracted indicators list from pattern\n        \"\"\"\n        groups: List[Tuple[str, str]] = []\n        for regex in regexes:\n            find_result = regex.findall(pattern)\n            if find_result:\n                groups.extend(find_result)\n        return groups\n\n    @staticmethod\n    def stix_time_to_datetime(s_time):\n        \"\"\"\n        Converts datetime to str in \"%Y-%m-%dT%H:%M:%S.%fZ\" format\n        :param s_time: time in string format\n        :return: datetime\n        \"\"\"\n        try:\n            return datetime.strptime(s_time, TAXII_TIME_FORMAT)\n        except ValueError:\n            return datetime.strptime(s_time, TAXII_TIME_FORMAT_NO_MS)\n\n\n\nif __name__ in (\"__main__\", \"__builtin__\", \"builtins\"):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.10","modified":"2021-09-07T09:21:43.460831+03:00","name":"TAXII 2 Feed","packID":"FeedTAXII","packPropagationLabels":["all"],"prevName":"TAXII 2 Feed","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"true","display":"Fetch indicators","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feed","options":null,"required":false,"type":8},{"defaultValue":"","display":"Indicator Reputation","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Indicators from this integration instance will be marked with this reputation","name":"feedReputation","options":["None","Good","Suspicious","Bad"],"required":false,"type":18},{"defaultValue":"","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data","name":"feedReliability","options":["A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Traffic Light Protocol Color","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The Traffic Light Protocol (TLP) designation to apply to indicators fetched from the feed","name":"tlp_color","options":["RED","AMBER","GREEN","WHITE"],"required":false,"type":15},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationPolicy","options":["never","interval","indicatorType","suddenDeath"],"required":false,"type":17},{"defaultValue":"","display":"","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedExpirationInterval","options":null,"required":false,"type":1},{"defaultValue":"240","display":"Feed Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"feedFetchInterval","options":null,"required":false,"type":19},{"defaultValue":"","display":"Bypass exclusion list","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"When selected, the exclusion list is ignored for indicators from this feed. This means that if an indicator from this feed is on the exclusion list, the indicator might still be added to the system.","name":"feedBypassExclusionList","options":null,"required":false,"type":8},{"defaultValue":"","display":"Discovery Service","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"TAXII discovery service endpoint. For example, http://hailataxii.com/taxii-discovery-service","name":"discovery_service","options":null,"required":true,"type":0},{"defaultValue":"","display":"Collection","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Collection name to fetch indicators from.","name":"collection","options":null,"required":false,"type":0},{"defaultValue":"","display":"Subscription ID","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Subscription ID for the TAXII consumer.","name":"subscription_id","options":null,"required":false,"type":0},{"defaultValue":"","display":"Name (To use the API key click the \"?\" icon)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":false,"type":9},{"defaultValue":"","display":"Certificate File as Text","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Add a certificate file as text to connect to the TAXII server","name":"cert_text","options":null,"required":false,"type":12},{"defaultValue":"","display":"Key File as Text","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Add a key file as text to connect to the TAXII server","name":"key_text","options":null,"required":false,"type":4},{"defaultValue":"20","display":"Request Timeout","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Time (in seconds) before HTTP requests timeout.","name":"polling_timeout","options":null,"required":false,"type":0},{"defaultValue":"","display":"Poll Service","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Used by a TAXII Client to request information from a TAXII Server.","name":"poll_service","options":null,"required":false,"type":0},{"defaultValue":"1 day","display":"First Fetch Time","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"The time interval for the first fetch (retroactive). \u003cnumber\u003e \u003ctime unit\u003e of type minute/hour/day. For example, 1 minute, 12 hours, 7 days.","name":"initial_interval","options":null,"required":false,"type":0},{"defaultValue":"","display":"Tags","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Supports CSV values.","name":"feedTags","options":null,"required":false,"type":0},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8}],"definitionId":"","description":"Ingests indicator feeds from TAXII 1.x servers.","detailedDescription":"TAXII Feed integration is a TAXII client that ingests indicators from TAXII feeds. The integration will fetch new indicators after they are published.\n\n# Connect the TAXII Feed Integration to a TAXII Server\nTo connect the TAXII Feed integration to a TAXII server you'll need to configure the following parameters.\n* **Discovery Service** - Available TAXII services and their use can be communicated via the TAXII Discovery Service. The Discovery Service provides a requester with a list of TAXII Services and how these Services can be invoked.\n* **Collection** - A Collection is an interface to a logical repository of CTI objects provided by a TAXII Server. This will usually be the feed name. If you do not know which collections\nare available to you, you can leave it empty and press the Test button. In the error message you will receive a list of available collections for the specified discovery path.\n* **Subscription ID** (Optional) - TAXII defines Subscription IDs. When a Consumer successfully establishes a subscription on a TAXII Server, the server assigns that\nsubscription a *Subscription ID* value. From then on, both the Consumer and the Server refer to this subscription in messages using this Subscription ID value.\n* **Poll Service** (Optional) - Used by a TAXII Client to request information from a TAXII Server. If not provided, will be fetched from the discovery service.\n\n# Authentication\n* **Username + Password** - Username and Password for TAXII servers that require basic authentication. \nThese fields also support the use of API key headers. To use API key headers, specify the header name and value in the following format:\n`_header:\u003cheader_name\u003e` in the **Username** field and the header value in the **Password** field.\n\n\n## Step by step configuration\nAs an example, we'll use the public TAXII threat intelligence feed by Abuse_ch accessible via _Hail a TAXII_. These are the feed instance configuration parameters for our example.\n\n**Indicator Reputation** - Because this is just an example, we can leave the default value. Ordinarily you would set the reputation based on the specific feed's information about what type of indicators they are returning, i.e., whether they are good or bad.\n\n**Source Reliability** - Because this is just an example, we can leave the default value. Ordinarily you would set the reliability according to your level of trust in this feed.\n\n**Indicator Expiration Method** - For this example, we can leave the default value here. Ordinarily you would set the value according to the type of feed you were fetching from. As an example, let's that you are a customer of a Cloud Services provider and you want to add the URLs from which that provider serves up many of the services you use to your network firewall exclusion list. Assuming that that same Cloud Services provider maintains an up-to-date feed of the URLs from which they currently provide service, you would probably want to configure a feed integration instance with this parameter set to `Expire indicators when they disappear from feed` so that you don't continue to mark a given URL with a `Good` reputation after it is no longer being used by your Cloud Services provider.\n\n**Feed Fetch Interval** - For this example, we can leave the default value here.\n\n**Discovery Service** - Enter `http://hailataxii.com/taxii-discovery-service`.\n\n**Collection** - Enter `guest.Abuse_ch`.\n\n**Subscription ID** - No need to enter a value here for this example since the TAXII server we are addressing does not require it so we'll leave it blank.\n\n**Username** - Enter `guest`.\n\n**Password** - Enter `guest`.\n\n**Request Timeout** - Let's increase the number to `80` seconds since the request may take a while to complete.\n\n**Poll Service** - We don't have to enter a value here for this example because the poll service will be determined dynamically in the integration code if it is not explicitly provided.\n\n**API Key** - We don't have to enter a value here for this example because the TAXII server we are addressing doesn't require an API key.\n\n**API Header Name** - We don't have to enter a value here for this example because the TAXII server we are addressing doesn't require an API header name.\n\n**First Fetch Time** - Since this example feed isn't very high volume, let's enter `500 days`  to make sure we fetch a sufficient number of indicators.\n\nClick the `Test` button and ensure that a green `Success` message is returned.\n\nNow we have successfully configured an instance for the TAXII threat intelligence feed by Abuse_ch accessible via _Hail a TAXII_, once we enable `Fetches indicators` the instance will start pulling indicators.\n\nBy clicking `Mapping` in the integration instance, we can map indicator data returned by the feed to actual indicator fields in Cortex XSOAR.\nWe can use `Set up a new classification rule` using actual data from the feed.\n\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/taxii-feed)","display":"TAXII Feed","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"TAXIIFeed","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"defaultValue":"50","deprecated":false,"description":"The maximum number of results to return.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"1 day","deprecated":false,"description":"The time interval for the first fetch (retroactive). \u003cnumber\u003e \u003ctime unit\u003e of type minute/hour/day. For example, 1 minute, 12 hours, 7 days.","name":"initial_interval","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Gets indicators from the the feed.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"get-indicators","outputs":[{"contentPath":"","contextPath":"TAXII.Indicator.Value","description":"The indicator value.","type":"String"},{"contentPath":"","contextPath":"TAXII.Indicator.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"TAXII.Indicator.Rawjson","description":"The indicator rawJSON value.","type":"Unknown"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/taxii:1.0.0.23209","feed":true,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"import tempfile\nfrom typing import Dict, Optional\n\n\n\n\n\n''' IMPORTS '''\nimport urllib3\nimport collections\n\nimport cabby\nimport requests\nfrom lxml import etree\nimport dateutil.parser\nfrom bs4 import BeautifulSoup\nfrom netaddr import IPAddress\nfrom six import string_types\n\n# TAXII11 import\n\nimport uuid\nimport dateutil\nimport pytz\n\n# disable insecure warnings\nurllib3.disable_warnings()\n\nEPOCH = datetime.utcfromtimestamp(0).replace(tzinfo=pytz.UTC)\nINTEGRATION_NAME = 'TAXII1'\n\n\nclass AddressObject(object):\n    \"\"\"\n    Implements address object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/AddressObj/AddressObjectType/\n    \"\"\"\n\n    @staticmethod\n    def decode(props, **kwargs):\n        indicator = props.find('Address_Value')\n        if indicator is None:\n            return []\n        indicator = indicator.string.encode('ascii', 'replace').decode()\n\n        acategory = props.get('category', None)\n        if acategory is None:\n            try:\n                ip = IPAddress(indicator)\n                if ip.version == 4:\n                    type_ = 'IP'\n                elif ip.version == 6:\n                    type_ = 'IPv6'\n                else:\n                    LOG('Unknown ip version: {!r}'.format(ip.version))\n                    return []\n\n            except Exception:\n                return []\n\n        elif acategory == 'ipv4-addr':\n            type_ = 'IP'\n        elif acategory == 'ipv6-addr':\n            type_ = 'IPv6'\n        elif acategory == 'e-mail':\n            type_ = 'Email'\n        else:\n            LOG('Unknown AddressObjectType category: {!r}'.format(acategory))\n            return []\n\n        return [{\n            'indicator': indicator,\n            'type': type_\n        }]\n\n\nclass DomainNameObject(object):\n    \"\"\"\n    Implements domain object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/DomainNameObj/DomainNameObjectType/\n    \"\"\"\n\n    @staticmethod\n    def decode(props, **kwargs):\n        dtype = props.get('type', 'FQDN')\n        if dtype != 'FQDN':\n            return []\n\n        domain = props.find('Value')\n        if domain is None:\n            return []\n\n        return [{\n            'indicator': domain.string.encode('ascii', 'replace').decode(),\n            'type': 'Domain'\n        }]\n\n\nclass FileObject(object):\n    \"\"\"\n    Implements file object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/FileObj/FileObjectType/\n    \"\"\"\n\n    @staticmethod\n    def _decode_basic_props(props):\n        result = {}\n\n        name = next((c for c in props if c.name == 'File_Name'), None)\n        if name is not None:\n            result['stix_file_name'] = name.text\n\n        size = next((c for c in props if c.name == 'File_Size'), None)\n        if size is not None:\n            result['stix_file_size'] = size.text\n\n        file_format = next((c for c in props if c.name == 'File_Format'), None)\n        if file_format is not None:\n            result['stix_file_format'] = file_format.text\n\n        return result\n\n    @staticmethod\n    def decode(props, **kwargs):\n        result = []\n\n        bprops = FileObject._decode_basic_props(props)\n\n        hashes = props.find_all('Hash')\n        for h in hashes:\n            htype = h.find('Type')\n            if htype is None:\n                continue\n            htype = htype.string.lower()\n            if htype not in ['md5', 'sha1', 'sha256', 'ssdeep']:\n                continue\n\n            value = h.find('Simple_Hash_Value')\n            if value is None:\n                continue\n            value = value.string.lower()\n\n            result.append({\n                'indicator': value,\n                'htype': htype,\n                'type': 'File'\n            })\n\n        for r in result:\n            for r2 in result:\n                if r['htype'] == r2['htype']:\n                    continue\n\n                r['stix_file_{}'.format(r2['htype'])] = r2['indicator']\n\n            r.update(bprops)\n\n        return result\n\n\nclass URIObject(object):\n    \"\"\"\n    Implements URI object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/URIObj/URIObjectType/\n    \"\"\"\n\n    @staticmethod\n    def decode(props, **kwargs):\n        utype = props.get('type', 'URL')\n        if utype == 'URL':\n            type_ = 'URL'\n        elif utype == 'Domain Name':\n            type_ = 'Domain'\n        else:\n            return []\n\n        url = props.find('Value')\n        if url is None:\n            return []\n\n        return [{\n            'indicator': url.string.encode('utf8', 'replace').decode(),\n            'type': type_\n        }]\n\n\nclass SocketAddressObject(object):\n    \"\"\"\n    Implements socket address object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/SocketAddressObj/SocketAddressObjectType/\n    \"\"\"\n\n    @staticmethod\n    def decode(props, **kwargs):\n        ip = props.get('ip_address', None)\n        if ip:\n            return AddressObject.decode(ip)\n        return []\n\n\nclass LinkObject(object):\n    \"\"\"\n    Implements link object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/LinkObj/LinkObjectType/\n    \"\"\"\n\n    @staticmethod\n    def decode(props, **kwargs):\n        ltype = props.get('type', 'URL')\n        if ltype != 'URL':\n            LOG('Unhandled LinkObjectType type: {}'.format(ltype))\n            return []\n        value = props.get('value', None)\n        if value is None:\n            LOG('no value in observable LinkObject')\n            return []\n        if not isinstance(value, string_types):\n            value = value.get('value', None)\n            if value is None:\n                LOG('no value in observable LinkObject')\n                return []\n        return [{\n            'indicator': value,\n            'type': ltype\n        }]\n\n\nclass HTTPSessionObject(object):\n    \"\"\"\n    Implements http session object indicator decoding\n    based on: https://stixproject.github.io/data-model/1.2/HTTPSessionObj/HTTPSessionObjectType/\n    \"\"\"\n\n    @staticmethod\n    def decode(props, **kwargs):\n        if 'http_request_response' in props.keys():\n            tmp = props['http_request_response']\n\n            if len(tmp) == 1:\n                item = tmp[0]\n                http_client_request = item.get('http_client_request', None)\n                if http_client_request is not None:\n                    http_request_header = http_client_request.get('http_request_header', None)\n                    if http_request_header is not None:\n                        raw_header = http_request_header.get('raw_header', None)\n                        if raw_header is not None:\n                            return [{\n                                'indicator': raw_header.split('\\n')[0],\n                                'type': 'http-session',  # we don't support this type natively in demisto\n                                'header': raw_header\n                            }]\n            else:\n                LOG('multiple HTTPSessionObjectTypes not supported')\n        return []\n\n\nclass StixDecode(object):\n    \"\"\"\n    Decode STIX strings formatted as xml, and extract indicators from them\n    \"\"\"\n    DECODERS = {\n        'DomainNameObjectType': DomainNameObject.decode,\n        'FileObjectType': FileObject.decode,\n        'WindowsFileObjectType': FileObject.decode,\n        'URIObjectType': URIObject.decode,\n        'AddressObjectType': AddressObject.decode,\n        'SocketAddressObjectType': SocketAddressObject.decode,\n        'LinkObjectType': LinkObject.decode,\n        'HTTPSessionObjectType': HTTPSessionObject.decode,\n    }\n\n    @staticmethod\n    def object_extract_properties(props, kwargs):\n        type_ = props.get('xsi:type').rsplit(':')[-1]\n\n        if type_ not in StixDecode.DECODERS:\n            LOG('Unhandled cybox Object type: {!r} - {!r}'.format(type_, props))\n            return []\n\n        return StixDecode.DECODERS[type_](props, **kwargs)\n\n    @staticmethod\n    def _parse_stix_timestamp(stix_timestamp):\n        dt = dateutil.parser.parse(stix_timestamp)\n\n        if dt.tzinfo is None:\n            dt = dt.replace(tzinfo=pytz.UTC)\n        delta = dt - EPOCH\n        return int(delta.total_seconds() * 1000)\n\n    @staticmethod\n    def _deduplicate(indicators):\n        result = {}\n\n        for iv in indicators:\n            result['{}:{}'.format(iv['indicator'], iv['type'])] = iv\n\n        return result.values()\n\n    @staticmethod\n    def decode(content, **kwargs):\n        result = []\n\n        package = BeautifulSoup(content, 'xml')\n\n        if package.contents[0].name != 'STIX_Package':\n            return None, []\n\n        package = package.contents[0]\n\n        timestamp = package.get('timestamp', None)\n        if timestamp is not None:\n            timestamp = StixDecode._parse_stix_timestamp(timestamp)\n\n        pprops = package_extract_properties(package)\n\n        observables = package.find_all('Observable')\n        for o in observables:\n            gprops = observable_extract_properties(o)\n\n            obj = next((ob for ob in o if ob.name == 'Object'), None)\n            if obj is None:\n                continue\n\n            # main properties\n            properties = next((c for c in obj if c.name == 'Properties'), None)\n            if properties is not None:\n                for r in StixDecode.object_extract_properties(properties, kwargs):\n                    r.update(gprops)\n                    r.update(pprops)\n\n                    result.append(r)\n\n            # then related objects\n            related = next((c for c in obj if c.name == 'Related_Objects'), None)\n            if related is not None:\n                for robj in related:\n                    if robj.name != 'Related_Object':\n                        continue\n\n                    properties = next((c for c in robj if c.name == 'Properties'), None)\n                    if properties is None:\n                        continue\n\n                    for r in StixDecode.object_extract_properties(properties, kwargs):\n                        r.update(gprops)\n                        r.update(pprops)\n                        result.append(r)\n\n        return timestamp, StixDecode._deduplicate(result)\n\n\nclass Taxii11(object):\n    \"\"\"\n    TAXII 1 client utilities class\n    \"\"\"\n    MESSAGE_BINDING = 'urn:taxii.mitre.org:message:xml:1.1'\n    SERVICES = 'urn:taxii.mitre.org:services:1.1'\n    PROTOCOLS = {\n        'http': 'urn:taxii.mitre.org:protocol:http:1.0',\n        'https': 'urn:taxii.mitre.org:protocol:https:1.0'\n    }\n    # 2014-12-19T00:00:00Z\n    TAXII_DT_FORMAT = '%Y-%m-%dT%H:%M:%SZ'\n\n    @staticmethod\n    def new_message_id():\n        return str(uuid.uuid4())\n\n    @staticmethod\n    def discovery_request(message_id=None):\n        if message_id is None:\n            message_id = Taxii11.new_message_id()\n\n        return f'''\u003cDiscovery_Request xmlns=\"http://taxii.mitre.org/messages/taxii_xml_binding-1.1\" message_id=\"{message_id}\"/\u003e'''\n\n    @staticmethod\n    def collection_information_request(message_id=None):\n        if message_id is None:\n            message_id = Taxii11.new_message_id()\n\n        return '''\u003ctaxii_11:Collection_Information_Request xmlns:taxii_11=\n        \"http://taxii.mitre.org/messages/taxii_xml_binding-1.1\" message_id=\"{}\"/\u003e'''.format(\n            message_id)\n\n    @staticmethod\n    def poll_request(\n            collection_name,\n            exclusive_begin_timestamp,\n            inclusive_end_timestamp,\n            message_id=None,\n            subscription_id=None):\n        if message_id is None:\n            message_id = Taxii11.new_message_id()\n\n        exclusive_begin_timestamp = exclusive_begin_timestamp.strftime(Taxii11.TAXII_DT_FORMAT)\n        inclusive_end_timestamp = inclusive_end_timestamp.strftime(Taxii11.TAXII_DT_FORMAT)\n\n        result = [\n            '\u003ctaxii_11:Poll_Request xmlns:taxii_11=\"http://taxii.mitre.org/messages/taxii_xml_binding-1.1\"',\n            'message_id=\"{}\"'.format(message_id),\n            'collection_name=\"{}\"'.format(collection_name)\n        ]\n        if subscription_id is not None:\n            result.append('subscription_id=\"{}\"'.format(subscription_id))\n        result.append('\u003e')\n        result.append('\u003ctaxii_11:Exclusive_Begin_Timestamp\u003e{}\u003c/taxii_11:Exclusive_Begin_Timestamp\u003e'.format(\n            exclusive_begin_timestamp))\n        result.append(\n            '\u003ctaxii_11:Inclusive_End_Timestamp\u003e{}\u003c/taxii_11:Inclusive_End_Timestamp\u003e'.format(inclusive_end_timestamp))\n\n        if subscription_id is None:\n            result.append(\n                '\u003ctaxii_11:Poll_Parameters allow_asynch=\"false\"\u003e\u003ctaxii_11:Response_Type\u003e'\n                'FULL\u003c/taxii_11:Response_Type\u003e\u003c/taxii_11:Poll_Parameters\u003e')\n\n        result.append('\u003c/taxii_11:Poll_Request\u003e')\n\n        return '\\n'.join(result)\n\n    @staticmethod\n    def poll_fulfillment_request(result_id, result_part_number, collection_name, message_id=None):\n        if message_id is None:\n            message_id = Taxii11.new_message_id()\n\n        return f'''\u003ctaxii_11:Poll_Fulfillment xmlns:taxii_11=\"http://taxii.mitre.org/messages/taxii_xml_binding-1.1\"\n                    message_id=\"{message_id}\" collection_name=\"{collection_name}\" result_id=\"{result_id}\"\n                    result_part_number=\"{result_part_number}\"/\u003e'''\n\n    @staticmethod\n    def headers(content_type=None, accept=None, services=None, protocol=None):\n        if content_type is None:\n            content_type = Taxii11.MESSAGE_BINDING\n\n        if accept is None:\n            accept = Taxii11.MESSAGE_BINDING\n\n        if services is None:\n            services = Taxii11.SERVICES\n\n        if protocol is None:\n            protocol = 'urn:taxii.mitre.org:protocol:http:1.0'\n        if protocol in Taxii11.PROTOCOLS:\n            protocol = Taxii11.PROTOCOLS[protocol]\n\n        return {\n            'Content-Type': 'application/xml',\n            'X-TAXII-Content-Type': content_type,\n            'X-TAXII-Accept': accept,\n            'X-TAXII-Services': services,\n            'X-TAXII-Protocol': protocol\n        }\n\n    @staticmethod\n    def parse_timestamp_label(timestamp_label):\n        try:\n            dt = dateutil.parser.parse(timestamp_label)\n\n            if dt.tzinfo is None:\n                dt = dt.replace(tzinfo=pytz.UTC)\n            delta = dt - EPOCH\n            return int(delta.total_seconds() * 1000)\n\n        except Exception:\n            return None\n\n\nclass TAXIIClient(object):\n    def __init__(self, insecure: bool = True, polling_timeout: int = 20, initial_interval: str = '1 day',\n                 discovery_service: str = '', poll_service: str = None, collection: str = None,\n                 credentials: dict = None, cert_text: str = None, key_text: str = None, tags: str = None,\n                 tlp_color: Optional[str] = None, **kwargs):\n        \"\"\"\n        TAXII Client\n        :param insecure: Set to true to ignore https certificate\n        :param polling_timeout: Time before send request timeout\n        :param initial_interval: Interval between each read from TAXII server\n        :param discovery_service: TAXII server discovery service\n        :param poll_service: TAXII poll service\n        :param collection: TAXII collection\n        :param credentials: Username and password dict for basic auth\n        :param cert_text: Certificate File as Text\n        :param cert_Key: Key File as Text\n        :param kwargs:\n        \"\"\"\n        self.discovered_poll_service = None\n        self.last_taxii_run = demisto.getLastRun()\n        if isinstance(self.last_taxii_run, dict):\n            self.last_taxii_run = self.last_taxii_run.get('time')\n        self.last_stix_package_ts = None\n        self.last_taxii_content_ts = None\n        self.verify_cert = not insecure\n        self.polling_timeout = polling_timeout\n        try:\n            self.polling_timeout = int(self.polling_timeout)\n        except (ValueError, TypeError):\n            raise TypeError('Please provide a valid integer for \"Polling Timeout\"')\n        self.initial_interval = initial_interval\n        self.initial_interval = interval_in_sec(self.initial_interval)\n        if self.initial_interval is None:\n            self.initial_interval = 86400\n\n        self.discovery_service = discovery_service\n        self.poll_service = poll_service\n        self.collection = collection\n\n        self.api_key = None\n        self.api_header = None\n        self.username = None\n        self.password = None\n        self.crt = None\n        self.tags = argToList(tags)\n        self.tlp_color = tlp_color\n        # authentication\n        if credentials:\n            if '_header:' in credentials.get('identifier', None):\n                self.api_header = credentials.get('identifier', None).split('_header:')[1]\n                self.api_key = credentials.get('password', None)\n            else:\n                self.username = credentials.get('identifier', None)\n                self.password = credentials.get('password', None)\n\n        if (cert_text and not key_text) or (not cert_text and key_text):\n            raise Exception('You can not configure either certificate text or key, both are required.')\n        if cert_text and key_text:\n\n            cert_text_list = cert_text.split('-----')\n            # replace spaces with newline characters\n            cert_text_fixed = '-----'.join(cert_text_list[:2] + [cert_text_list[2].replace(' ', '\\n')] + cert_text_list[3:])\n            cf = tempfile.NamedTemporaryFile(delete=False)\n            cf.write(cert_text_fixed.encode())\n            cf.flush()\n\n            key_text_list = key_text.split('-----')\n            # replace spaces with newline characters\n            key_text_fixed = '-----'.join(key_text_list[:2] + [key_text_list[2].replace(' ', '\\n')] + key_text_list[3:])\n            kf = tempfile.NamedTemporaryFile(delete=False)\n            kf.write(key_text_fixed.encode())\n            kf.flush()\n            self.crt = (cf.name, kf.name)\n\n        if collection is None or collection == '':\n            all_collections = self.get_all_collections()\n            return_error(f\"No collection set. Here is a list of all accessible collections: \"\n                         f\"{str(all_collections)}\")\n\n    def get_all_collections(self, is_raise_error=False):\n        \"\"\"Gets a list of all collections listed in the discovery service instance.\n\n        Args:\n            is_raise_error(bool): Whether to raise an error when one occurs.\n\n        Returns:\n            list. A list of all collection names in discovery service.\n        \"\"\"\n        if self.discovery_service:\n            taxii_client = cabby.create_client(discovery_path=self.discovery_service)\n            if self.username:\n                taxii_client.set_auth(username=str(self.username), password=self.password, verify_ssl=self.verify_cert)\n            elif self.api_key:\n                taxii_client.set_auth(username=str(self.api_key), verify_ssl=self.verify_cert)\n            else:\n                taxii_client.set_auth(verify_ssl=self.verify_cert)\n\n            try:\n                all_collections = taxii_client.get_collections()\n                return [collection.name for collection in all_collections]\n            except Exception as e:\n                if is_raise_error:\n                    raise ConnectionError()\n                return_error(f'{INTEGRATION_NAME} - An error occurred when trying to fetch available collections.\\n{e}')\n\n        return []\n\n    def _send_request(self, url, headers, data, stream=False):\n        if self.api_key is not None and self.api_header is not None:\n            headers[self.api_header] = self.api_key\n\n        rkwargs = dict(\n            stream=stream,\n            verify=self.verify_cert,\n            timeout=self.polling_timeout,\n            headers=headers,\n            cert=self.crt,\n            data=data\n        )\n\n        if self.username is not None and self.password is not None:\n            rkwargs['auth'] = (self.username, self.password)\n\n        r = requests.post(\n            url,\n            **rkwargs\n        )\n\n        try:\n            r.raise_for_status()\n        except Exception:\n            demisto.debug(\n                '{} - exception in request: {!r} {!r}'.format(INTEGRATION_NAME, r.status_code, r.content)\n            )\n            raise\n\n        return r\n\n    @staticmethod\n    def _raise_for_taxii_error(response):\n        if response.contents[0].name != 'Status_Message':\n            return\n\n        if response.contents[0]['status_type'] == 'SUCCESS':\n            return\n\n        raise RuntimeError('{} - error returned by TAXII Server: {}'.format(\n            INTEGRATION_NAME, response.contents[0]['status_type']\n        ))\n\n    def _discover_poll_service(self):\n        # let's start from discovering the available services\n        req = Taxii11.discovery_request()\n        reqhdrs = Taxii11.headers(\n            protocol=self.discovery_service.split(':', 1)[0]\n        )\n        result = self._send_request(\n            url=self.discovery_service,\n            headers=reqhdrs,\n            data=req\n        )\n\n        result = BeautifulSoup(result.text, 'xml')\n        self._raise_for_taxii_error(result)\n\n        # from here we look for a good collection management service\n        coll_services = result.find_all(\n            'Service_Instance',\n            service_type='COLLECTION_MANAGEMENT'\n        )\n        if len(coll_services) == 0:\n            raise RuntimeError('{} - Collection management service not found'.format(INTEGRATION_NAME))\n\n        selected_coll_service = None\n        for coll_service in coll_services:\n            address = coll_service.find('Address')\n            if address is None:\n                LOG(\n                    '{} - Collection management service with no address: {!r}'.format(\n                        INTEGRATION_NAME, coll_service\n                    )\n                )\n                continue\n            address = address.string\n\n            if selected_coll_service is None:\n                selected_coll_service = address\n                continue\n\n            msgbindings = coll_service.find_all('Message_Binding')\n            if len(msgbindings) != 0:\n                for msgbinding in msgbindings:\n                    if msgbinding.string == Taxii11.MESSAGE_BINDING:\n                        selected_coll_service = address\n                        break\n\n        if selected_coll_service is None:\n            raise RuntimeError(\n                '{} - Collection management service not found'.format(INTEGRATION_NAME)\n            )\n\n        # from here we look for the correct poll service\n        req = Taxii11.collection_information_request()\n        reqhdrs = Taxii11.headers(\n            protocol=selected_coll_service.split(':', 1)[0]\n        )\n        result = self._send_request(\n            url=selected_coll_service,\n            headers=reqhdrs,\n            data=req\n        )\n\n        result = BeautifulSoup(result.text, 'xml')\n        self._raise_for_taxii_error(result)\n\n        # from here we look for the collection\n        collections_found = result.find_all('Collection', collection_name=self.collection)\n        if len(collections_found) == 0:\n            raise RuntimeError(f'{INTEGRATION_NAME} - collection {self.collection} not found')\n\n        # and the right poll service\n        poll_service = None\n        for coll in collections_found:\n            pservice = coll.find('Polling_Service')\n            if pservice is None:\n                LOG('{} - Collection with no Polling_Service: {!r}'.format(INTEGRATION_NAME, coll))\n                continue\n\n            address = pservice.find('Address')\n            if address is None:\n                LOG('{} - Collection with no Address: {!r}'.format(INTEGRATION_NAME, coll))\n                continue\n            address = address.string\n\n            if poll_service is None:\n                poll_service = address\n                continue\n            msgbindings = coll_service.find_all('Message_Binding')\n            if len(msgbindings) != 0:\n                for msgbinding in msgbindings:\n                    if msgbinding.string == Taxii11.MESSAGE_BINDING:\n                        poll_service = address\n                        break\n\n        if poll_service is None:\n            raise RuntimeError('{} - No valid Polling Service found'.format(INTEGRATION_NAME))\n\n        return poll_service\n\n    def _poll_collection(self, poll_service, begin, end):\n        req = Taxii11.poll_request(\n            collection_name=self.collection,\n            exclusive_begin_timestamp=begin,\n            inclusive_end_timestamp=end\n        )\n        reqhdrs = Taxii11.headers(\n            protocol=poll_service.split(':', 1)[0]\n        )\n        result = self._send_request(\n            url=poll_service,\n            headers=reqhdrs,\n            data=req,\n            stream=True\n        )\n        result.raw.decode_content = True\n\n        while True:\n            result_part_number = None\n            result_id = None\n            more = None\n            tag_stack = collections.deque()  # type: ignore\n\n            try:\n                for action, element in etree.iterparse(result.raw, events=('start', 'end'), recover=True):\n                    if action == 'start':\n                        tag_stack.append(element.tag)\n\n                    else:\n                        last_tag = tag_stack.pop()\n                        if last_tag != element.tag:\n                            raise RuntimeError(\n                                '{} - error parsing poll response, mismatched tags'.format(INTEGRATION_NAME))\n\n                    if action == 'end' and element.tag.endswith('Status_Message') and len(tag_stack) == 0:\n                        self._raise_for_taxii_error(\n                            BeautifulSoup(etree.tostring(element, encoding='unicode'), 'xml')\n                        )\n                        return\n\n                    elif action == 'end' and element.tag.endswith('Poll_Response') and len(tag_stack) == 0:\n                        result_id = element.get('result_id', None)\n                        more = element.get('more', None)\n                        result_part_number = element.get('result_part_number', None)\n                        if result_part_number is not None:\n                            result_part_number = int(result_part_number)\n\n                    elif action == 'end' and element.tag.endswith('Content_Block') and len(tag_stack) == 1:\n                        for c in element:\n                            if c.tag.endswith('Content'):\n                                if len(c) == 0:\n                                    continue\n\n                                content = etree.tostring(c[0], encoding='unicode')\n                                timestamp, indicators = StixDecode.decode(content)\n\n                                for indicator in indicators:\n                                    yield indicator\n                                if timestamp:\n                                    if self.last_stix_package_ts is None or timestamp \u003e self.last_stix_package_ts:\n                                        self.last_stix_package_ts = timestamp\n\n                            elif c.tag.endswith('Timestamp_Label'):\n                                timestamp = Taxii11.parse_timestamp_label(c.text)\n\n                                if timestamp:\n                                    if self.last_taxii_content_ts is None or timestamp \u003e self.last_taxii_content_ts:\n                                        self.last_taxii_content_ts = timestamp\n\n                        element.clear()\n\n            finally:\n                result.close()\n\n            if not more or more == '0' or more.lower() == 'false':\n                break\n\n            if result_id is None or result_part_number is None:\n                break\n\n            req = Taxii11.poll_fulfillment_request(\n                collection_name=self.collection,\n                result_id=result_id,\n                result_part_number=result_part_number + 1\n            )\n            result = self._send_request(\n                url=poll_service,\n                headers=reqhdrs,\n                data=req,\n                stream=True\n            )\n\n    def _incremental_poll_collection(self, poll_service, begin, end):\n        \"\"\"Polls collection in increments of 10 days\"\"\"\n        cbegin = begin\n        dt = timedelta(days=10)\n\n        self.last_stix_package_ts = None\n        self.last_taxii_content_ts = None\n\n        while cbegin \u003c end:\n            cend = min(end, cbegin + dt)\n\n            result = self._poll_collection(\n                poll_service=poll_service,\n                begin=cbegin,\n                end=cend\n            )\n\n            for i in result:\n                yield i\n\n            if self.last_taxii_content_ts is not None:\n                self.last_taxii_run = self.last_taxii_content_ts\n\n            cbegin = cend\n\n    def build_iterator(self, now):\n        \"\"\"Creates an indicator iterator from the TAXII feed\"\"\"\n        if self.poll_service is not None:\n            discovered_poll_service = self.poll_service\n        else:\n            discovered_poll_service = self._discover_poll_service()\n\n        last_run = self.last_taxii_run\n\n        if last_run is None:\n            last_run = now - (self.initial_interval * 1000)\n            self.last_taxii_run = last_run\n\n        begin = datetime.utcfromtimestamp(last_run / 1000)\n        begin = begin.replace(microsecond=0, tzinfo=pytz.UTC)\n\n        end = datetime.utcfromtimestamp(now / 1000)\n        end = end.replace(tzinfo=pytz.UTC)\n\n        # lower time precision - solve issues with certain taxii servers\n        end = end.replace(second=0, microsecond=0)\n        begin = begin.replace(second=0, microsecond=0)\n        return self._incremental_poll_collection(\n            discovered_poll_service,\n            begin=begin,\n            end=end\n        )\n\n\n\"\"\" Helper Methods \"\"\"\n\n\ndef package_extract_properties(package):\n    \"\"\"Extracts properties from the STIX package\"\"\"\n    result: Dict[str, str] = {}\n\n    header = package.find_all('STIX_Header')\n    if len(header) == 0:\n        return result\n\n    # share level\n    mstructures = header[0].find_all('Marking_Structure')\n    for ms in mstructures:\n        type_ = ms.get('xsi:type')\n        if type_ is result:\n            continue\n\n        color = ms.get('color')\n        if color is result:\n            continue\n\n        type_ = type_.lower()\n        if 'tlpmarkingstructuretype' not in type_:\n            continue\n\n        result['share_level'] = color.lower()  # https://www.us-cert.gov/tlp\n        break\n\n    # decode title\n    title = next((c for c in header[0] if c.name == 'Title'), None)\n    if title is not None:\n        result['stix_package_title'] = title.text\n\n    # decode description\n    description = next((c for c in header[0] if c.name == 'Description'), None)\n    if description is not None:\n        result['stix_package_description'] = description.text\n\n    # decode description\n    sdescription = next((c for c in header[0] if c.name == 'Short_Description'), None)\n    if sdescription is not None:\n        result['stix_package_short_description'] = sdescription.text\n\n    # decode identity name from information_source\n    information_source = next((c for c in header[0] if c.name == 'Information_Source'), None)\n    if information_source is not None:\n        identity = next((c for c in information_source if c.name == 'Identity'), None)\n        if identity is not None:\n            name = next((c for c in identity if c.name == 'Name'))\n            if name is not None:\n                result['stix_package_information_source'] = name.text\n\n    return result\n\n\ndef observable_extract_properties(observable):\n    \"\"\"Extracts properties from observable\"\"\"\n    result = {}\n\n    title = next((c for c in observable if c.name == 'Title'), None)\n    if title is not None:\n        title = title.text\n        result['stix_title'] = title\n\n    description = next((c for c in observable if c.name == 'Description'), None)\n    if description is not None:\n        description = description.text\n        result['stix_description'] = description\n\n    return result\n\n\ndef interval_in_sec(val):\n    \"\"\"Translates interval string to seconds int\"\"\"\n    if val is None:\n        return None\n    if isinstance(val, int):\n        return val\n    else:\n        range_split = val.split()\n        if len(range_split) != 2:\n            raise ValueError('Interval must be \"number date_range_unit\", examples: (2 hours, 4 minutes,6 months, 1 day.')\n        number = int(range_split[0])\n        range_unit = range_split[1].lower()\n        if range_unit not in ['minute', 'minutes', 'hour', 'hours', 'day', 'days']:\n            raise ValueError('The unit of Interval is invalid. Must be minutes, hours or days')\n\n    multipliers = {\n        'minute': 60,\n        'hour': 3600,\n        'day': 86400,\n    }\n    for m, m_value in multipliers.items():\n        if m in range_unit:\n            return number * m_value\n\n    return None\n\n\ndef test_module(client, *_):\n    try:\n        all_collections = client.get_all_collections(is_raise_error=True)\n    except ConnectionError:\n        all_collections = [client.collection]\n\n    if client.collection not in all_collections:\n        return_error(f'Collection could not be found at this time. Here is a list of all accessible collections:'\n                     f' {str(all_collections)}')\n\n    client._discover_poll_service()\n    return 'ok', {}, {}\n\n\ndef fetch_indicators_command(client):\n    iterator = client.build_iterator(date_to_timestamp(datetime.now()))\n    indicators = []\n    for item in iterator:\n        indicator = item.get('indicator')\n        if indicator:\n            item['value'] = indicator\n            indicator_obj = {\n                'value': indicator,\n                'type': item.get('type'),\n                'fields': {\n                    'tags': client.tags,\n                },\n                'rawJSON': item,\n            }\n            if client.tlp_color:\n                indicator_obj['fields']['trafficlightprotocol'] = client.tlp_color\n\n            indicators.append(indicator_obj)\n\n    return indicators\n\n\ndef get_indicators_command(client, args):\n    limit = int(args.get('limit', 10))\n    client.initial_interval = interval_in_sec(args.get('initial_interval'))\n    client.last_taxii_run = None\n    indicators_list = fetch_indicators_command(client)\n    entry_result = camelize(indicators_list[:limit])\n    hr = tableToMarkdown('Indicators', entry_result, headers=['Value', 'Type', 'Rawjson'])\n    return hr, {'TAXII.Indicator': entry_result}, indicators_list\n\n\ndef main():\n    # Write configure here\n    params = {key: value for key, value in demisto.params().items() if value is not None}\n    handle_proxy()\n    client = TAXIIClient(**params)\n    command = demisto.command()\n    demisto.info('Command being called is {command}'.format(command=command))\n    # Switch case\n    commands = {\n        'test-module': test_module,\n        'get-indicators': get_indicators_command\n    }\n    try:\n        if demisto.command() == 'fetch-indicators':\n            indicators = fetch_indicators_command(client)\n            # we submit the indicators in batches\n            for b in batch(indicators, batch_size=2000):\n                demisto.createIndicators(b)\n            demisto.setLastRun({'time': client.last_taxii_run})\n        else:\n            readable_output, outputs, raw_response = commands[command](client, demisto.args())  # type: ignore\n            return_outputs(readable_output, outputs, raw_response)\n    except Exception as e:\n        err_msg = f'Error in {INTEGRATION_NAME} Integration [{e}]'\n        raise Exception(err_msg)\n\n\nif __name__ == \"__builtin__\" or __name__ == \"builtins\":\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"1.0.10","modified":"2021-09-07T09:21:43.460922+03:00","name":"TAXIIFeed","packID":"FeedTAXII","packPropagationLabels":["all"],"prevName":"TAXIIFeed","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":false,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"https://threatcentral.io/tc/rest/summaries","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"APIAddress","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"APIKey","options":null,"required":true,"type":4},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tcIgnoreTLS","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8}],"definitionId":"","description":"Get actionable threat analysis and intelligence from HPE’s cloud-based, standards-compliant sharing platform","detailedDescription":"For an API key, go to your user profile at your ThreatCentral account, and press Manage API Keys, where you can generate a new API key.","display":"Threat Central","fromServerVersion":"","hidden":false,"icon":"tc.png","id":"threatcentral","image":"data:image/png;base64,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","integrationScript":null,"isPasswordProtected":true,"itemVersion":"","modified":"2021-09-08T08:30:28.519758+03:00","name":"threatcentral","packID":"","prevName":"threatcentral","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"API Key (only required for scanning URLs)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"apikey","options":null,"required":false,"type":4},{"defaultValue":"C - Fairly reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data.","name":"integrationReliability","options":["A+ - 3rd party enrichment","A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"1","display":"URL Threshold. Minimum number of positive results from urlscan.io to consider the URL malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url_threshold","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Enable public submissions by default.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"is_public","options":null,"required":false,"type":8},{"defaultValue":"true","display":"Create relationships","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Create relationships between indicators as part of Enrichment.","name":"create_relationships","options":null,"required":false,"type":8}],"definitionId":"","description":"Use urlscan.io integration to perform scans on suspected URLs and see their reputation.","detailedDescription":"This integration checks domain information from the urlscan.io Database.  \nThis is a free service with an API key required. contact urlscan.io to obtain one.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/urlscanio)","display":"urlscan.io","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"urlscan.io","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"A parameter for which to search (as a string), for example an IP address, file name, SHA256 hash, URL, domain, and so on.","name":"searchParameter","required":true,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The maximum number of results to return. Default is 20.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search for an indicator that is related to former urlscan.io scans.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"urlscan-search","outputs":[{"contentPath":"","contextPath":"URLScan.URL","description":"The URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Domain","description":"The domain of the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.ASN","description":"The ASN of the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.IP","description":"The IP address of the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.ScanID","description":"The scan ID of the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.ScanDate","description":"The date that the URL was last scanned.","type":"string"},{"contentPath":"","contextPath":"URLScan.Hash","description":"The SHA256 hash of the scanned file.","type":"string"},{"contentPath":"","contextPath":"URLScan.FileName","description":"The file name of the scanned file.","type":"string"},{"contentPath":"","contextPath":"URLScan.FileSize","description":"The size of the scanned file.","type":"number"},{"contentPath":"","contextPath":"URLScan.FileType","description":"File type of the file scanned","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The URL to scan.","isArray":true,"name":"url","required":true,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"The amount of time (in seconds) to wait for the scan ID result before timeout. Default is 60.","name":"timeout","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The submission type. Can be \"public\" or \"private\".","name":"public","required":false,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The maximum number of Limits the returned list of Certificates, IP's and ASN's","name":"limit","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Determines whether a scan should continue if one of the URLs is blacklisted.","isArray":true,"name":"continue_on_blacklisted_urls","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":true,"description":"Deprecated. Use the url command instead.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"urlscan-submit","outputs":[{"contentPath":"","contextPath":"URL.Data","description":"The URL submitted for scanning.","type":"string"},{"contentPath":"","contextPath":"URL.Malicious.Vendor","description":"For malicious URLs, the vendor that made the decision.","type":"string"},{"contentPath":"","contextPath":"URL.Malicious.Description","description":"For malicious URLs, the reason that the vendor made the decision.","type":"string"},{"contentPath":"","contextPath":"URLScan.RelatedIPs","description":"IP addresses related to the the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.RelatedASNs","description":"ASNs related to the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Countries","description":"Countries associated with the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.RelatedHash","description":"File hashes related to the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Subdomains","description":"Subdomains related to the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.ASN","description":"ASN of the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Data","description":"URL of the file.","type":"string"},{"contentPath":"","contextPath":"URLScan.Malicious.Vendor","description":"The vendor reporting the malicious indicator for the file","type":"string"},{"contentPath":"","contextPath":"URLScan.Malicious.Description","description":"A description of the malicious indicator.","type":"string"},{"contentPath":"","contextPath":"URLScan.File.Hash","description":"SHA256 of file found","type":"string"},{"contentPath":"","contextPath":"URLScan.File.FileName","description":"File name of file found","type":"string"},{"contentPath":"","contextPath":"URLScan.File.FileType","description":"File type of the file found","type":"string"},{"contentPath":"","contextPath":"URLScan.File.Hostname","description":"URL where the file was found","type":"string"},{"contentPath":"","contextPath":"URLScan.Certificates","description":"Certificates found for the URL scanned","type":"string"},{"contentPath":"","contextPath":"DBotScore.Score","description":"Score retrieved for Dbot","type":"number"},{"contentPath":"","contextPath":"DBotScore.Type","description":"Type of indicator tested for","type":"string"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"Vendor who provided DBot Score","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"Indicator URLScan tested for","type":"string"},{"contentPath":"","contextPath":"URLScan.RedirectedURLs","description":"Redirected URLs from the URL scanned","type":"string"},{"contentPath":"","contextPath":"URLScan.EffectiveURL","description":"Effective URL of the original URL","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Url to scan","isArray":true,"name":"url","required":true,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"The amount of time (in seconds) to wait for the scan ID result before timeout. Default is 60.","name":"timeout","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The submission type. Can be \"public\" or \"private\".","name":"public","required":false,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The maximum number of results to return.","name":"limit","required":false,"secret":false},{"default":false,"defaultValue":"5","deprecated":false,"description":"The amount of time (in seconds) to wait between tries if the API rate limit is exceeded.","name":"wait","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Number of retries for the API rate limit. Default is 0.","name":"retries","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Determines whether a scan should continue if one of the URLs is blacklisted.","isArray":true,"name":"continue_on_blacklisted_urls","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Submits a URL to scan.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"url","outputs":[{"contentPath":"","contextPath":"URL.Data","description":"The URL submitted for scanning.","type":"string"},{"contentPath":"","contextPath":"URL.Malicious.Vendor","description":"For malicious URLs, the vendor that made the decision.","type":"string"},{"contentPath":"","contextPath":"URL.Malicious.Description","description":"For malicious URLs, the reason that the vendor made the decision.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"URLScan.RelatedIPs","description":"The IP addresses related to the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.RelatedASNs","description":"The ASNs related to the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Countries","description":"The countries associated with the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.RelatedHash","description":"File hashes related to the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Subdomains","description":"Subdomains associated with the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.ASN","description":"The ASN of the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.Data","description":"The URL of the file.","type":"string"},{"contentPath":"","contextPath":"URLScan.Malicious.Vendor","description":"The vendor that reported the malicious indicator for the file.","type":"string"},{"contentPath":"","contextPath":"URLScan.Malicious.Description","description":"A description of the malicious indicator.","type":"string"},{"contentPath":"","contextPath":"URLScan.File.Hash","description":"The SHA256 hash of file.","type":"string"},{"contentPath":"","contextPath":"URLScan.File.FileName","description":"The name of the file.","type":"string"},{"contentPath":"","contextPath":"URLScan.File.FileType","description":"The file type.","type":"string"},{"contentPath":"","contextPath":"URLScan.File.Hostname","description":"The URL of the file.","type":"string"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"string"},{"contentPath":"","contextPath":"File.Name","description":"The name of the file.","type":"string"},{"contentPath":"","contextPath":"File.Type","description":"The file type.","type":"string"},{"contentPath":"","contextPath":"File.Hostname","description":"The URL of the file.","type":"string"},{"contentPath":"","contextPath":"URLScan.Certificates","description":"The certificates found for the scanned URL.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"string"},{"contentPath":"","contextPath":"URLScan.RedirectedURLs","description":"Redirected URLs from the scanned URL.","type":"string"},{"contentPath":"","contextPath":"URLScan.EffectiveURL","description":"Effective URL of the original URL.","type":"string"},{"contentPath":"","contextPath":"URL.ASN","description":"The URL ASN.","type":"String"},{"contentPath":"","contextPath":"URL.FeedRelatedIndicators.value","description":"Indicators that are associated with the URL.","type":"String"},{"contentPath":"","contextPath":"URL.FeedRelatedIndicators.type","description":"the type of the indicators that are associated with the URL.","type":"String"},{"contentPath":"","contextPath":"URL.Geo.Country","description":"The URL country.","type":"String"},{"contentPath":"","contextPath":"URL.ASOwner","description":"The URL AS owner.","type":"String"},{"contentPath":"","contextPath":"URL.Tags","description":"Tags that are associated with the URL.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The UUID of the URL for which to search the transaction list.","name":"uuid","required":true,"secret":false},{"default":false,"defaultValue":"20","deprecated":false,"description":"The maximum number of results to return to the War Room. Maximum is 100. Default is 20.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The URL for which to search the transaction list.","name":"url","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Returns the HTTP transaction list for the specified URL. Do not use this command in conjunction with the urlscan-get-http-transactions script.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"urlscan-get-http-transaction-list","outputs":[{"contentPath":"","contextPath":"URLScan.URL","description":"The URL address that was scanned.","type":"string"},{"contentPath":"","contextPath":"URLScan.httpTransaction","description":"A link to the HTTP transaction made during the search for the specified URL.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The URL sought after.","name":"url","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Submits a URL to retrieve its UUID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"urlscan-submit-url-command","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The URI for which to get the results.","name":"uri","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Polls the urlscan service regarding the results of the specified URI.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"urlscan-poll-uri","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The UUID of the URL for which to search.","name":"uuid","required":true,"secret":false}],"cartesian":false,"deprecated":true,"description":"Returns the results page for the specified UUID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"urlscan-get-result-page","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python:2.7.18.24019","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\n\n'''IMPORTS'''\nimport time\nimport requests\nimport collections\nimport json as JSON\nfrom urlparse import urlparse\nfrom requests.utils import quote  # type: ignore\n\n\"\"\" POLLING FUNCTIONS\"\"\"\ntry:\n    from Queue import Queue\nexcept ImportError:\n    from queue import Queue  # type: ignore\n\n# disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n'''GLOBAL VARS'''\nBLACKLISTED_URL_ERROR_MESSAGE = 'The submitted domain is on our blacklist. ' \\\n                                'For your own safety we did not perform this scan...'\nBRAND = 'urlscan.io'\n\n\"\"\" RELATIONSHIP TYPE\"\"\"\nRELATIONSHIP_TYPE = {\n    'page': {\n        'domain': {\n            'indicator_type': FeedIndicatorType.Domain,\n            'name': EntityRelationship.Relationships.HOSTED_ON,\n            'detect_type': False\n        },\n        'ip': {\n            'indicator_type': FeedIndicatorType.IP,\n            'name': EntityRelationship.Relationships.HOSTED_ON,\n            'detect_type': False\n        }\n    }\n}\n\n\nclass Client:\n    def __init__(self, api_key='', threshold=None, use_ssl=False, reliability=DBotScoreReliability.C):\n        self.base_url = 'https://urlscan.io/api/v1/'\n        self.api_key = api_key\n        self.threshold = threshold\n        self.use_ssl = use_ssl\n        self.reliability = reliability\n\n\n'''HELPER FUNCTIONS'''\n\n\ndef detect_ip_type(indicator):\n    \"\"\"\n    Helper function which detects wheather an IP is a IP or IPv6 by string\n    \"\"\"\n    indicator_type = ''\n    if '::' in indicator:\n        indicator_type = FeedIndicatorType.IPv6\n    else:\n        indicator_type = FeedIndicatorType.IP\n    return indicator_type\n\n\ndef http_request(client, method, url_suffix, json=None, wait=0, retries=0):\n    headers = {'API-Key': client.api_key,\n               'Accept': 'application/json'}\n    if method == 'POST':\n        headers.update({'Content-Type': 'application/json'})\n    demisto.debug(\n        'requesting https request with method: {}, url: {}, data: {}'.format(method, client.base_url + url_suffix,\n                                                                             json))\n    r = requests.request(\n        method,\n        client.base_url + url_suffix,\n        data=json,\n        headers=headers,\n        verify=client.use_ssl\n    )\n\n    rate_limit_remaining = int(r.headers.get('X-Rate-Limit-Remaining', 99))\n    if rate_limit_remaining \u003c 10:\n        return_warning('Your available rate limit remaining is {} and is about to be exhausted. '\n                       'The rate limit will reset at {}'.format(str(rate_limit_remaining),\n                                                                r.headers.get(\"X-Rate-Limit-Reset\")))\n    if r.status_code != 200:\n        if r.status_code == 429:\n            if retries \u003c= 0:\n                # Error in API call to URLScan.io [429] - Too Many Requests\n                return_error('API rate limit reached [%d] - %s.\\nUse the retries and wait arguments when submitting '\n                             'multiple URls' % (r.status_code, r.reason))\n            else:\n                time.sleep(wait)  # pylint: disable=sleep-exists\n                return http_request(method, url_suffix, json, wait, retries - 1)\n\n        response_json = r.json()\n        error_description = response_json.get('description')\n        should_continue_on_blacklisted_urls = argToBoolean(demisto.args().get('continue_on_blacklisted_urls', False))\n        if should_continue_on_blacklisted_urls and error_description == BLACKLISTED_URL_ERROR_MESSAGE:\n            response_json['url_is_blacklisted'] = True\n            requested_url = JSON.loads(json)['url']\n            blacklisted_message = 'The URL {} is blacklisted, no results will be returned for it.'.format(requested_url)\n            demisto.results(blacklisted_message)\n            return response_json\n\n        return_error('Error in API call to URLScan.io [%d] - %s: %s' % (r.status_code, r.reason, error_description))\n\n    return r.json()\n\n\n# Allows nested keys to be accesible\ndef makehash():\n    return collections.defaultdict(makehash)\n\n\ndef get_result_page(client):\n    uuid = demisto.args().get('uuid')\n    uri = client.base_url + 'result/{}'.format(uuid)\n    return uri\n\n\ndef polling(client, uuid):\n    TIMEOUT = int(demisto.args().get('timeout', 60))\n    uri = client.base_url + 'result/{}'.format(uuid)\n\n    ready = poll(\n        lambda: requests.get(uri, headers={'API-Key': client.api_key}, verify=client.use_ssl).status_code == 200,\n        step=5,\n        ignore_exceptions=(requests.exceptions.ConnectionError),\n        timeout=int(TIMEOUT)\n    )\n    return ready\n\n\ndef poll_uri(client):\n    uri = demisto.args().get('uri')\n    demisto.results(requests.get(uri, verify=client.use_ssl).status_code)\n\n\ndef step_constant(step):\n    return step\n\n\ndef is_truthy(val):\n    return bool(val)\n\n\ndef poll(target, step, args=(), kwargs=None, timeout=60,\n         check_success=is_truthy, step_function=step_constant,\n         ignore_exceptions=(), collect_values=None, **k):\n    kwargs = kwargs or dict()\n    values = collect_values or Queue()\n\n    max_time = time.time() + timeout\n    tries = 0\n    # According to the doc - The most efficient approach would be to wait at least 10 seconds before starting to poll\n    time.sleep(10)\n    while True:\n        demisto.debug('Number of Polling attempts: {}'.format(tries))\n        try:\n            val = target(*args, **kwargs)\n            last_item = val\n        except ignore_exceptions as e:\n            last_item = e\n            demisto.debug('Polling request failed with exception {}'.format(str(e)))\n        else:\n            if check_success(val):\n                return val\n        demisto.debug('Polling request returned False')\n        values.put(last_item)\n        tries += 1\n        if max_time is not None and time.time() \u003e= max_time:\n            demisto.results('The operation timed out. Please try again with a longer timeout period.')\n            demisto.debug('The operation timed out.')\n            return False\n        time.sleep(step)  # pylint: disable=sleep-exists\n        step = step_function(step)\n\n\n'''MAIN FUNCTIONS'''\n\n\ndef urlscan_submit_url(client):\n    submission_dict = {}\n    if demisto.args().get('public'):\n        if demisto.args().get('public') == 'public':\n            submission_dict['visibility'] = 'public'\n    else:\n        if demisto.params().get('is_public') is True:\n            submission_dict['visibility'] = 'public'\n\n    submission_dict['url'] = demisto.args().get('url')\n    sub_json = json.dumps(submission_dict)\n    wait = int(demisto.args().get('wait', 5))\n    retries = int(demisto.args().get('retries', 0))\n    r = http_request(client, 'POST', 'scan/', sub_json, wait, retries)\n    return r\n\n\ndef create_relationship(scan_type, field, entity_a, entity_a_type, entity_b, entity_b_type, reliability):\n    \"\"\"\n    Create a single relation with the given arguments.\n    \"\"\"\n    return EntityRelationship(name=RELATIONSHIP_TYPE.get(scan_type, {}).get(field, {}).get('name', ''),\n                              entity_a=entity_a,\n                              entity_a_type=entity_a_type,\n                              entity_b=entity_b,\n                              entity_b_type=entity_b_type,\n                              source_reliability=reliability,\n                              brand=BRAND)\n\n\ndef create_list_relationships(scans_dict, url, reliability):\n    \"\"\"\n    Creates a list of EntityRelationships object from all of the lists in scans_dict according to RELATIONSHIP_TYPE dict.\n    \"\"\"\n    relationships_list = []\n    for scan_name, scan_dict in scans_dict.items():\n        fields = RELATIONSHIP_TYPE.get(scan_name, {}).keys()\n        for field in fields:\n            indicators = scan_dict.get(field)\n            if not isinstance(indicators, list):\n                indicators = [indicators]\n            relationship_dict = RELATIONSHIP_TYPE.get(scan_name, {}).get(field, {})\n            indicator_type = relationship_dict.get('indicator_type', '')\n            for indicator in indicators:\n                # For a case where the destination side does not exist\n                if not indicator:\n                    pass\n                # For a case where the type of the IP indicator should be detected, whether its IPv6/IP\n                if not indicator_type and relationship_dict.get('detect_type'):\n                    indicator_type = detect_ip_type(indicator)\n                relationship = create_relationship(scan_type=scan_name, field=field, entity_a=url,\n                                                   entity_a_type=FeedIndicatorType.URL, entity_b=indicator,\n                                                   entity_b_type=indicator_type, reliability=reliability)\n                relationships_list.append(relationship)\n    return relationships_list\n\n\ndef format_results(client, uuid):\n    # Scan Lists sometimes returns empty\n    num_of_attempts = 0\n    relationships = []\n    response = urlscan_submit_request(client, uuid)\n    scan_lists = response.get('lists')\n    while scan_lists is None:\n        try:\n            num_of_attempts += 1\n            demisto.debug('Attempting to get scan lists {} times'.format(num_of_attempts))\n            response = urlscan_submit_request(client, uuid)\n            scan_lists = response.get('lists')\n        except Exception:\n            if num_of_attempts == 5:\n                break\n            demisto.debug('Could not get scan lists, sleeping for 5 minutes before trying again')\n            time.sleep(5)\n    scan_data = response.get('data', {})\n    scan_lists = response.get('lists', {})\n    scan_tasks = response.get('task', {})\n    scan_page = response.get('page', {})\n    scan_stats = response.get('stats', {})\n    scan_meta = response.get('meta', {})\n    url_query = scan_tasks.get('url', {})\n    scan_verdicts = response.get('verdicts', {})\n    ec = makehash()\n    dbot_score = makehash()\n    human_readable = makehash()\n    cont = makehash()\n    file_context = makehash()\n    url_cont = makehash()\n\n    feed_related_indicators = []\n\n    LIMIT = int(demisto.args().get('limit', 20))\n    if 'certificates' in scan_lists:\n        cert_md = []\n        cert_ec = []\n        certs = scan_lists['certificates']\n        for x in certs[:LIMIT]:\n            info, ec_info = cert_format(x)\n            cert_md.append(info)\n            cert_ec.append(ec_info)\n        CERT_HEADERS = ['Subject Name', 'Issuer', 'Validity']\n        cont['Certificates'] = cert_ec\n    url_cont['Data'] = url_query\n    if 'urls' in scan_lists:\n        url_cont['Data'] = demisto.args().get('url')\n        cont['URL'] = demisto.args().get('url')\n        if isinstance(scan_lists.get('urls'), list):\n            for url in scan_lists['urls']:\n                feed_related_indicators.append({'value': url, 'type': 'URL'})\n    # effective url of the submitted url\n    human_readable['Effective URL'] = scan_page.get('url')\n    cont['EffectiveURL'] = scan_page.get('url')\n    if 'uuid' in scan_tasks:\n        ec['URLScan']['UUID'] = scan_tasks['uuid']\n    if 'ips' in scan_lists:\n        ip_asn_MD = []\n        ip_ec_info = makehash()\n        ip_list = scan_lists['ips']\n        asn_list = scan_lists['asns']\n\n        ip_asn_dict = dict(zip(ip_list, asn_list))\n        i = 1\n        for k in ip_asn_dict:\n            if i - 1 == LIMIT:\n                break\n            v = ip_asn_dict[k]\n            ip_info = {\n                'Count': i,\n                'IP': k,\n                'ASN': v\n            }\n            ip_ec_info[i]['IP'] = k\n            ip_ec_info[i]['ASN'] = v\n            ip_asn_MD.append(ip_info)\n            i = i + 1\n        cont['RelatedIPs'] = ip_ec_info\n        if isinstance(scan_lists.get('ips'), list):\n            for ip in scan_lists.get('ips'):\n                feed_related_indicators.append({'value': ip, 'type': 'IP'})\n        IP_HEADERS = ['Count', 'IP', 'ASN']\n    # add redirected URLs\n    if 'requests' in scan_data:\n        redirected_urls = []\n        for o in scan_data['requests']:\n            if 'redirectResponse' in o['request']:\n                if 'url' in o['request']['redirectResponse']:\n                    url = o['request']['redirectResponse']['url']\n                    redirected_urls.append(url)\n        cont['RedirectedURLs'] = redirected_urls\n    if 'countries' in scan_lists:\n        countries = scan_lists['countries']\n        human_readable['Associated Countries'] = countries\n        cont['Country'] = countries\n    if None not in scan_lists.get('hashes', []):\n        hashes = scan_lists.get('hashes', [])\n        cont['RelatedHash'] = hashes\n        human_readable['Related Hashes'] = hashes\n        for hashe in hashes:\n            feed_related_indicators.append({'value': hashe, 'type': 'File'})\n    if 'domains' in scan_lists:\n        subdomains = scan_lists.get('domains', [])\n        cont['Subdomains'] = subdomains\n        human_readable['Subdomains'] = subdomains\n        for domain in subdomains:\n            feed_related_indicators.append({'value': domain, 'type': 'Domain'})\n    if 'linkDomains' in scan_lists:\n        link_domains = scan_lists.get('domains', [])\n        for domain in link_domains:\n            feed_related_indicators.append({'value': domain, 'type': 'Domain'})\n    if 'asn' in scan_page:\n        cont['ASN'] = scan_page['asn']\n        url_cont['ASN'] = scan_page.get('asn')\n    if 'asnname' in scan_page:\n        url_cont['ASOwner'] = scan_page['asnname']\n    if 'country' in scan_page:\n        url_cont['Geo']['Country'] = scan_page['country']\n    if 'domain' in scan_page:\n        feed_related_indicators.append({'value': scan_page['domain'], 'type': 'Domain'})\n    if 'ip' in scan_page:\n        feed_related_indicators.append({'value': scan_page['ip'], 'type': 'IP'})\n    if 'url' in scan_page:\n        feed_related_indicators.append({'value': scan_page['url'], 'type': 'URL'})\n    if 'overall' in scan_verdicts:\n        human_readable['Malicious URLs Found'] = scan_stats['malicious']\n        if scan_verdicts['overall'].get('malicious'):\n            human_readable['Verdict'] = 'Malicious'\n            url_cont['Data'] = demisto.args().get('url')\n            cont['Data'] = demisto.args().get('url')\n            dbot_score['Indicator'] = demisto.args().get('url')\n            url_cont['Malicious']['Vendor'] = 'urlscan.io'\n            cont['Malicious']['Vendor'] = 'urlscan.io'\n            dbot_score['Vendor'] = 'urlscan.io'\n            url_cont['Malicious']['Description'] = 'Match found in Urlscan.io database'\n            cont['Malicious']['Description'] = 'Match found in Urlscan.io database'\n            dbot_score['Score'] = 3\n            dbot_score['Type'] = 'url'\n        else:\n            dbot_score['Vendor'] = 'urlscan.io'\n            dbot_score['Indicator'] = demisto.args().get('url')\n            dbot_score['Score'] = 0\n            dbot_score['Type'] = 'url'\n            human_readable['Verdict'] = 'Unknown'\n        dbot_score['Reliability'] = client.reliability\n    if 'urlscan' in scan_verdicts and 'tags' in scan_verdicts['urlscan']:\n        url_cont['Tags'] = scan_verdicts['urlscan']['tags']\n    processors_data = scan_meta['processors']\n    if 'download' in processors_data and len(scan_meta['processors']['download']['data']) \u003e 0:\n        meta_data = processors_data['download']['data'][0]\n        sha256 = meta_data['sha256']\n        filename = meta_data['filename']\n        filesize = meta_data['filesize']\n        filetype = meta_data['mimeType']\n        human_readable['File']['Hash'] = sha256\n        cont['File']['Hash'] = sha256\n        file_context['SHA256'] = sha256\n        human_readable['File']['Name'] = filename\n        cont['File']['FileName'] = filename\n        file_context['Name'] = filename\n        human_readable['File']['Size'] = filesize\n        cont['File']['FileSize'] = filesize\n        file_context['Size'] = filesize\n        human_readable['File']['Type'] = filetype\n        cont['File']['FileType'] = filetype\n        file_context['Type'] = filetype\n        file_context['Hostname'] = demisto.args().get('url')\n    if feed_related_indicators:\n        related_indicators = []\n        for related_indicator in feed_related_indicators:\n            related_indicators.append(Common.FeedRelatedIndicators(value=related_indicator['value'],\n                                                                   indicator_type=related_indicator['type']))\n        url_cont['FeedRelatedIndicators'] = related_indicators\n    if demisto.params().get('create_relationships') is True:\n        relationships = create_list_relationships({'page': scan_page}, url_query,\n                                                  client.reliability)\n    outputs = {\n        'URLScan(val.URL \u0026\u0026 val.URL == obj.URL)': cont,\n        outputPaths['file']: file_context\n    }\n\n    if 'screenshotURL' in scan_tasks:\n        human_readable['Screenshot'] = scan_tasks['screenshotURL']\n        screen_path = scan_tasks['screenshotURL']\n        response_img = requests.request(\"GET\", screen_path, verify=client.use_ssl)\n        stored_img = fileResult('screenshot.png', response_img.content)\n\n    dbot_score = Common.DBotScore(indicator=dbot_score.get('Indicator'), indicator_type=dbot_score.get('Type'),\n                                  integration_name=BRAND, score=dbot_score.get('Score'),\n                                  reliability=dbot_score.get('Reliability'))\n\n    url = Common.URL(url=url_cont.get('Data'), dbot_score=dbot_score, relationships=relationships,\n                     feed_related_indicators=url_cont.get('FeedRelatedIndicators'))\n\n    command_result = CommandResults(\n        readable_output=tableToMarkdown('{} - Scan Results'.format(url_query), human_readable),\n        outputs=outputs,\n        indicator=url,\n        raw_response=response,\n        relationships=relationships\n    )\n\n    demisto.results(command_result.to_context())\n\n    if len(cert_md) \u003e 0:\n        demisto.results({\n            'Type': entryTypes['note'],\n            'ContentsFormat': formats['markdown'],\n            'Contents': tableToMarkdown('Certificates', cert_md, CERT_HEADERS),\n            'HumanReadable': tableToMarkdown('Certificates', cert_md, CERT_HEADERS)\n        })\n    if 'ips' in scan_lists:\n        if isinstance(scan_lists.get('ips'), list):\n            feed_related_indicators += scan_lists.get('ips')\n        demisto.results({\n            'Type': entryTypes['note'],\n            'ContentsFormat': formats['markdown'],\n            'Contents': tableToMarkdown('Related IPs and ASNs', ip_asn_MD, IP_HEADERS),\n            'HumanReadable': tableToMarkdown('Related IPs and ASNs', ip_asn_MD, IP_HEADERS)\n        })\n\n    if 'screenshotURL' in scan_tasks:\n        demisto.results({\n            'Type': entryTypes['image'],\n            'ContentsFormat': formats['text'],\n            'File': stored_img['File'],\n            'FileID': stored_img['FileID'],\n            'Contents': ''\n        })\n\n\ndef urlscan_submit_request(client, uuid):\n    response = http_request(client, 'GET', 'result/{}'.format(uuid))\n    return response\n\n\ndef get_urlscan_submit_results_polling(client, uuid):\n    ready = polling(client, uuid)\n    if ready is True:\n        format_results(client, uuid)\n\n\ndef urlscan_submit_command(client):\n    urls = argToList(demisto.args().get('url'))\n    for url in urls:\n        demisto.args()['url'] = url\n        response = urlscan_submit_url(client)\n        if response.get('url_is_blacklisted'):\n            pass\n        uuid = response.get('uuid')\n        get_urlscan_submit_results_polling(client, uuid)\n\n\ndef urlscan_search(client, search_type, query):\n    r = http_request(client, 'GET', 'search/?q=' + search_type + ':\"' + query + '\"')\n    return r\n\n\ndef cert_format(x):\n    valid_to = datetime.fromtimestamp(x['validTo']).strftime('%Y-%m-%d %H:%M:%S')\n    valid_from = datetime.fromtimestamp(x['validFrom']).strftime('%Y-%m-%d %H:%M:%S')\n    info = {\n        'Subject Name': x['subjectName'],\n        'Issuer': x['issuer'],\n        'Validity': \"{} - {}\".format(valid_to, valid_from)\n    }\n    ec_info = {\n        'SubjectName': x['subjectName'],\n        'Issuer': x['issuer'],\n        'ValidFrom': valid_from,\n        'ValidTo': valid_to\n    }\n    return info, ec_info\n\n\ndef urlscan_search_command(client):\n    LIMIT = int(demisto.args().get('limit'))\n    HUMAN_READBALE_HEADERS = ['URL', 'Domain', 'IP', 'ASN', 'Scan ID', 'Scan Date']\n    raw_query = demisto.args().get('searchParameter', '')\n    if is_ip_valid(raw_query, accept_v6_ips=True):\n        search_type = 'ip'\n    else:\n        # Parsing query to see if it's a url\n        parsed = urlparse(raw_query)\n        # Checks to see if Netloc is present. If it's not a url, Netloc will not exist\n        if parsed[1] == '' and len(raw_query) == 64:\n            search_type = 'hash'\n        else:\n            search_type = 'page.url'\n\n    # Making the query string safe for Elastic Search\n    query = quote(raw_query, safe='')\n\n    r = urlscan_search(client, search_type, query)\n\n    if r['total'] == 0:\n        demisto.results('No results found for {}'.format(raw_query))\n        return\n    if r['total'] \u003e 0:\n        demisto.results('{} results found for {}'.format(r['total'], raw_query))\n\n    # Opening empty string for url comparison\n    last_url = ''\n    hr_md = []\n    cont_array = []\n    ip_array = []\n    dom_array = []\n    url_array = []\n\n    for res in r['results'][:LIMIT]:\n        ec = makehash()\n        cont = makehash()\n        url_cont = makehash()\n        ip_cont = makehash()\n        dom_cont = makehash()\n        file_context = makehash()\n        res_dict = res\n        res_tasks = res_dict['task']\n        res_page = res_dict['page']\n\n        if last_url == res_tasks['url']:\n            continue\n\n        human_readable = makehash()\n\n        if 'url' in res_tasks:\n            url = res_tasks['url']\n            human_readable['URL'] = url\n            cont['URL'] = url\n            url_cont['Data'] = url\n        if 'domain' in res_page:\n            domain = res_page['domain']\n            human_readable['Domain'] = domain\n            cont['Domain'] = domain\n            dom_cont['Name'] = domain\n        if 'asn' in res_page:\n            asn = res_page['asn']\n            cont['ASN'] = asn\n            ip_cont['ASN'] = asn\n            human_readable['ASN'] = asn\n        if 'ip' in res_page:\n            ip = res_page['ip']\n            cont['IP'] = ip\n            ip_cont['Address'] = ip\n            human_readable['IP'] = ip\n        if '_id' in res_dict:\n            scanID = res_dict['_id']\n            cont['ScanID'] = scanID\n            human_readable['Scan ID'] = scanID\n        if 'time' in res_tasks:\n            scanDate = res_tasks['time']\n            cont['ScanDate'] = scanDate\n            human_readable['Scan Date'] = scanDate\n        if 'files' in res_dict:\n            HUMAN_READBALE_HEADERS = ['URL', 'Domain', 'IP', 'ASN', 'Scan ID', 'Scan Date', 'File']\n            files = res_dict['files'][0]\n            sha256 = files['sha256']\n            filename = files['filename']\n            filesize = files['filesize']\n            filetype = files['mimeType']\n            url = res_tasks['url']\n            human_readable['File']['Hash'] = sha256\n            cont['Hash'] = sha256\n            file_context['SHA256'] = sha256\n            human_readable['File']['Name'] = filename\n            cont['FileName'] = filename\n            file_context['File']['Name'] = filename\n            human_readable['File']['Size'] = filesize\n            cont['FileSize'] = filesize\n            file_context['Size'] = filesize\n            human_readable['File']['Type'] = filetype\n            cont['FileType'] = filetype\n            file_context['File']['Type'] = filetype\n            file_context['File']['Hostname'] = url\n\n        ec[outputPaths['file']] = file_context\n        hr_md.append(human_readable)\n        cont_array.append(cont)\n        ip_array.append(ip_cont)\n        url_array.append(url_cont)\n        dom_array.append(dom_cont)\n\n        # Storing last url in memory for comparison on next loop\n        last_url = url\n\n    ec = ({\n        'URLScan(val.URL \u0026\u0026 val.URL == obj.URL)': cont_array,\n        'URL': url_array,\n        'IP': ip_array,\n        'Domain': dom_array\n    })\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['markdown'],\n        'Contents': r,\n        'HumanReadable': tableToMarkdown('URLScan.io query results for {}'.format(raw_query), hr_md,\n                                         HUMAN_READBALE_HEADERS, removeNull=True),\n        'EntryContext': ec\n    })\n\n\ndef format_http_transaction_list(client):\n    url = demisto.args().get('url')\n    uuid = demisto.args().get('uuid')\n\n    # Scan Lists sometimes returns empty\n    scan_lists = {}  # type: dict\n    while not scan_lists:\n        response = urlscan_submit_request(client, uuid)\n        scan_lists = response.get('lists', {})\n\n    limit = int(demisto.args().get('limit'))\n    metadata = None\n    if limit \u003e 100:\n        limit = 100\n        metadata = \"Limited the data to the first 100 http transactions\"\n\n    url_list = scan_lists.get('urls', [])[:limit]\n\n    context = {\n        'URL': url,\n        'httpTransaction': url_list\n    }\n\n    ec = {\n        'URLScan(val.URL \u0026\u0026 val.URL == obj.URL)': context,\n    }\n\n    human_readable = tableToMarkdown('{} - http transaction list'.format(url), url_list, ['URLs'], metadata=metadata)\n    return_outputs(human_readable, ec, response)\n\n\n\"\"\"COMMAND FUNCTIONS\"\"\"\n\n\ndef main():\n    params = demisto.params()\n\n    api_key = params.get('apikey')\n    threshold = int(params.get('url_threshold', '1'))\n    use_ssl = not params.get('insecure', False)\n    reliability = params.get('integrationReliability')\n    reliability = reliability if reliability else DBotScoreReliability.C\n\n    if DBotScoreReliability.is_valid_type(reliability):\n        reliability = DBotScoreReliability.get_dbot_score_reliability_from_str(reliability)\n    else:\n        Exception(\"Please provide a valid value for the Source Reliability parameter.\")\n\n    client = Client(\n        api_key=api_key,\n        threshold=threshold,\n        use_ssl=use_ssl,\n        reliability=reliability\n    )\n\n    try:\n        handle_proxy()\n        if demisto.command() == 'test-module':\n            search_type = 'ip'\n            query = '8.8.8.8'\n            urlscan_search(client, search_type, query)\n            demisto.results('ok')\n        if demisto.command() in {'urlscan-submit', 'url'}:\n            urlscan_submit_command(client)\n        if demisto.command() == 'urlscan-search':\n            urlscan_search_command(client)\n        if demisto.command() == 'urlscan-submit-url-command':\n            demisto.results(urlscan_submit_url(client).get('uuid'))\n        if demisto.command() == 'urlscan-get-http-transaction-list':\n            format_http_transaction_list(client)\n        if demisto.command() == 'urlscan-get-result-page':\n            demisto.results(get_result_page(client))\n        if demisto.command() == 'urlscan-poll-uri':\n            poll_uri(client)\n\n    except Exception as e:\n        LOG(e)\n        LOG.print_log(False)\n        return_error(e.message)\n\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python2","type":"python"},"itemVersion":"1.1.10","modified":"2021-09-05T10:48:02.786436+03:00","name":"urlscan.io","packID":"UrlScan","packPropagationLabels":["all"],"prevName":"urlscan.io","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"https://www.virustotal.com/vtapi/v2/","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Server","options":null,"required":true,"type":0},{"defaultValue":"","display":"API Key","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"APIKey","options":null,"required":true,"type":4},{"defaultValue":"C - Fairly reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data.","name":"integrationReliability","options":["A+ - 3rd party enrichment","A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8},{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"10","display":"File Threshold. Minimum number of positive results from VT scanners to consider the file malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fileThreshold","options":null,"required":false,"type":0},{"defaultValue":"10","display":"IP Threshold. Minimum number of positive results from VT scanners to consider the IP malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ipThreshold","options":null,"required":false,"type":0},{"defaultValue":"10","display":"URL Threshold. Minimum number of positive results from VT scanners to consider the URL malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"urlThreshold","options":null,"required":false,"type":0},{"defaultValue":"10","display":"Domain Threshold. Minimum number of positive results from VT scanners to consider the domain malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"domainThreshold","options":null,"required":false,"type":0},{"defaultValue":"","display":"Preferred Vendors List. CSV list of vendors which are considered more trustworthy.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"preferredVendors","options":null,"required":false,"type":12},{"defaultValue":"","display":"Preferred Vendor Threshold. The minimum number of highly trusted vendors required to consider a domain, IP address, URL, or file as malicious. ","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"preferredVendorsThreshold","options":null,"required":false,"type":0},{"defaultValue":"false","display":"Determines whether to return all results, which can number in the thousands. If “true”, returns all results and overrides the _fullResponse_, _long_ arguments (if set to “false”) in a command. If “false”, the _fullResponse_, _long_ arguments in the command determines how results are returned.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fullResponseGlobal","options":null,"required":false,"type":8}],"definitionId":"","description":"VirusTotal has been updated to VirusTotal (API v3). Please use the updated version instead. Analyze suspicious hashes, URLs, domains and IP addresses.","detailedDescription":"VirusTotal has been updated to VirusTotal (API v3). Please use the updated version instead.\n## Get a VirusTotal API Key\nTo use this integration, you need a VirusTotal API key.\n1. Log in to your VirusTotal console.\n2. Click your username, and select **My API Key**.\n\n## Indicator Thresholds\nConfigure the default threshold for each indicator type in the instance settings.\nYou can also specify the threshold as an argument when running relevant commands.\nIndicators with positive results equal to or higher than the threshold will be considered malicious.\nIndicators with positive results equal to or higher than half of the threshold value, and lower than the threshold, will be considered suspicious.","display":"VirusTotal","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"VirusTotal","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"A CSV list of hashes of the file to query. Supports MD5, SHA1, and SHA256.","name":"file","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return full response for scans. Default is \"false\".","name":"long","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"If the number of positives is higher than the threshold, the file will be considered malicious. If the threshold is not specified, the default file threshold, as configured in the instance settings, will be used.","name":"threshold","required":false,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"Time (in seconds) to wait between tries if the API rate limit is reached. Default is \"60\".","name":"wait","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Number of retries for the API rate limit. Default is \"0\".","name":"retries","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the file reputation of the specified hash.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file","outputs":[{"contentPath":"","contextPath":"File.MD5","description":"Bad MD5 hash.","type":""},{"contentPath":"","contextPath":"File.SHA1","description":"Bad SHA1 hash.","type":""},{"contentPath":"","contextPath":"File.SHA256","description":"Bad SHA256 hash.","type":""},{"contentPath":"","contextPath":"File.Malicious.Vendor","description":"For malicious files, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"File.Malicious.Detections","description":"For malicious files, the total number of detections.","type":""},{"contentPath":"","contextPath":"File.Malicious.TotalEngines","description":"For malicious files, the total number of engines that checked the file hash.","type":""},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"File.VirusTotal.Scans.Source","description":"Vendor used to scan the hash.","type":""},{"contentPath":"","contextPath":"File.VirusTotal.Scans.Detected","description":"Scan detection for this hash (True or False).","type":""},{"contentPath":"","contextPath":"File.VirusTotal.Scans.Result","description":"Scan result for this hash, for example, signature.","type":""},{"contentPath":"","contextPath":"File.VirusTotal.ScanID","description":"Scan ID for this hash.","type":"string"},{"contentPath":"","contextPath":"File.PositiveDetections","description":"Number of engines that positively detected the indicator as malicious.","type":"number"},{"contentPath":"","contextPath":"File.DetectionEngines","description":"Total number of engines that checked the indicator.","type":"number"},{"contentPath":"","contextPath":"File.VirusTotal.vtLink","description":"Virus Total permanent link.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"IP address to check.","isArray":true,"name":"ip","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return full response for detected URLs. Default is \"false\".","name":"long","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"If the number of positives is higher than the threshold, the IP address will be considered malicious. If the threshold is not specified, the default IP threshold, as configured in the instance settings, will be used.","name":"threshold","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"The number of samples from each type (resolutions, detections, etc.) to display for long format. Default is \"10\".","name":"sampleSize","required":false,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"Time (in seconds) to wait between tries if the API rate limit is reached. Default is \"60\".","name":"wait","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Number of retries for API rate limit. Default is \"0\".","name":"retries","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return all results, which can be thousands. Default is \"false\". We recommend that you don't return full results in playbooks.","name":"fullResponse","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of an IP address.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ip","outputs":[{"contentPath":"","contextPath":"IP.Address","description":"Bad IP address.","type":""},{"contentPath":"","contextPath":"IP.ASN","description":"Bad IP ASN.","type":""},{"contentPath":"","contextPath":"IP.Geo.Country","description":"Bad IP country.","type":""},{"contentPath":"","contextPath":"IP.Malicious.Vendor","description":"For malicious IPs, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"IP.Malicious.Description","description":"For malicious IPs, the reason that the vendor made the decision.","type":""},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"IP.VirusTotal.DownloadedHashes","description":"Latest files that were detected by at least one antivirus solution, and were downloaded by VirusTotal from the IP address.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.UnAVDetectedDownloadedHashes","description":"Latest files that were not detected by any antivirus solution, and were downloaded by VirusTotal from the specified IP address.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.DetectedURLs","description":"Latest URLs hosted in this IP address that were detected by at least one URL scanner.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.CommunicatingHashes","description":"Latest detected files that communicate with this IP address.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.UnAVDetectedCommunicatingHashes","description":"Latest undetected files that communicate with this IP address.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.Resolutions.hostname","description":"Domains that resolved to the specified IP address.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.ReferrerHashes","description":"Latest detected files that embed this IP address in their strings.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.UnAVDetectedReferrerHashes","description":"Latest undetected files that embed this IP address in their strings.","type":""},{"contentPath":"","contextPath":"IP.VirusTotal.Resolutions.last_resolved","description":"Last resolution times of the domains that resolved to the specified IP address.","type":""}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A comma-seperated list of URLs to check. This command will not work properly on URLs containing commas.","isArray":true,"name":"url","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"The number of samples from each type (resolutions, detections, etc.) to display for long format.","name":"sampleSize","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return the full response for the detected URLs.","name":"long","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"If the number of positives is higher than the threshold, the URL will be considered malicious. If the threshold is not specified, the default URL threshold, as configured in the instance settings, will be used.","name":"threshold","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Time (in seconds) to wait if the URL does not exist and is submitted for scanning. Default is \"0\".","name":"submitWait","required":false,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"Time (in seconds) to wait between tries if the API rate limit is reached. Default is \"60\".","name":"wait","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Number of retries for API rate limit. Default is \"0\".","name":"retries","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a URL.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"url","outputs":[{"contentPath":"","contextPath":"URL.Data","description":"Bad URLs found.","type":""},{"contentPath":"","contextPath":"URL.Malicious.Vendor","description":"For malicious URLs, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"URL.Malicious.Description","description":"For malicious URLs, the reason that the vendor made the decision.","type":""},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"URL.VirusTotal.Scans.Source","description":"Vendor that scanned this URL.","type":""},{"contentPath":"","contextPath":"URL.VirusTotal.Scans.Detected","description":"Scan detection for this URL (True or False).","type":""},{"contentPath":"","contextPath":"URL.VirusTotal.Scans.Result","description":"Scan result for this URL, for example, signature.","type":""},{"contentPath":"","contextPath":"URL.DetectionEngines","description":"Total number of engines that checked the indicator.","type":"number"},{"contentPath":"","contextPath":"URL.PositiveDetections","description":"Number of engines that positively detected the indicator as malicious.","type":"number"},{"contentPath":"","contextPath":"url.VirusTotal.ScanID","description":"Scan ID for this URL.","type":"string"},{"contentPath":"","contextPath":"File.VirusTotal.vtLink","description":"Virus Total permanent link.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Domain name to check.","isArray":true,"name":"domain","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return the full response for detected URLs. Default is \"false\".","name":"long","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"The number of samples from each type (resolutions, detections, etc.) to display for long format.","name":"sampleSize","required":false,"secret":false},{"default":false,"deprecated":false,"description":"If the number of positives is higher than the threshold, the domain will be considered malicious. If the threshold is not specified, the default domain threshold, as configured in the instance settings, will be used.","name":"threshold","required":false,"secret":false},{"default":false,"defaultValue":"60","deprecated":false,"description":"Time (in seconds) to wait between tries if the API rate limit is reached. Default is \"60\".","name":"wait","required":false,"secret":false},{"default":false,"defaultValue":"0","deprecated":false,"description":"Number of retries for API rate limit. Default is \"0\".","name":"retries","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return all results, which can be thousands. Default is \"false\". We recommend that you don't return full results in playbooks.","name":"fullResponse","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a domain.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"domain","outputs":[{"contentPath":"","contextPath":"Domain.Name","description":"Bad domain found.","type":""},{"contentPath":"","contextPath":"Domain.Malicious.Vendor","description":"For malicious domains, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"Domain.Malicious.Description","description":"For malicious domains, the reason that the vendor made the decision.","type":""},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"Domain.VirusTotal.DownloadedHashes","description":"Hashes of files that were downloaded from this domain.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.CommunicatingHashes","description":"Hashes of files that communicated with this domain in a sandbox.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.Resolutions.ip_address","description":"IP addresses that resolved to this domain.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.Whois","description":"Whois report.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.Subdomains","description":"Subdomains.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.UnAVDetectedDownloadedHashes","description":"Latest files that were not detected by any antivirus solution, and were downloaded by VirusTotal from the specified IP address.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.DetectedURLs","description":"Latest URLs hosted in this domain address that were detected by at least one URL scanner.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.ReferrerHashes","description":"Latest detected files that embed this domain address in their strings.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.UnAVDetectedReferrerHashes","description":"Latest undetected files that embed this domain address in their strings.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.UnAVDetectedCommunicatingHashes","description":"Latest undetected files that communicated with this domain in a sandbox.","type":""},{"contentPath":"","contextPath":"Domain.VirusTotal.Resolutions.last_resolved","description":"Last resolution times of the IP addresses that resolve to this domain.","type":""}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The file entry ID to submit.","name":"entryID","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Private API extension. Special upload URL for files larger than 32 MB.","name":"uploadURL","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Submits a file for scanning.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file-scan","outputs":[{"contentPath":"","contextPath":"vtScanID","description":"Scan IDs of the submitted files.","type":""},{"contentPath":"","contextPath":"vtLink","description":"Virus Total permanent link.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Hash of the file to re-scan. Supports MD5, SHA1, and SHA256.","name":"file","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Re-scans an already submitted file. This avoids having to upload the file again.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file-rescan","outputs":[{"contentPath":"","contextPath":"vtScanID","description":"Scan IDs of the submitted files.","type":""},{"contentPath":"","contextPath":"vtLink","description":"Virus Total permanent link.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The URL to scan.","name":"url","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Scans a specified URL.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"url-scan","outputs":[{"contentPath":"","contextPath":"vtScanID","description":"Scan IDs of the submitted URLs.","type":""},{"contentPath":"","contextPath":"vtLink","description":"Virus Total permanent link.","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The file hash (MD5, SHA1, or SHA256) or URL on which you're commenting.","name":"resource","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The actual review, which you can tag by using the \"#\" twitter-like syntax, for example, #disinfection #zbot, and reference users using the \"@\" syntax, for example, @VirusTotalTeam).","name":"comment","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Adds comments to files and URLs.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-comments-add","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[],"cartesian":false,"deprecated":false,"description":"Private API. Get a special URL for files larger than 32 MB.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-file-scan-upload-url","outputs":[{"contentPath":"","contextPath":"vtUploadURL","description":"The special upload URL for large files.","type":""}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The file hash (MD5, SHA1, orSHA256) or URL from which you're retrieving comments.","name":"resource","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Datetime token in the format YYYYMMDDHHMISS. You can use this for paging.","name":"before","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Private API. Retrieves comments for a given resource.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-comments-get","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"var DBOTSCORE_KEY = \"DBotScore(val.Indicator \u0026\u0026 val.Indicator === obj.Indicator \u0026\u0026 val.Vendor === obj.Vendor \u0026\u0026 val.Type === obj.Type)\"\nvar serverUrl = params.Server;\nif (serverUrl[serverUrl.length - 1] !== '/') {\n    serverUrl += '/';\n}\n//THRESHOLDS PARAMETERS\nvar FILE_THRESHOLD = params.fileThreshold;\nvar IP_THRESHOLD = params.ipThreshold;\nvar URL_THRESHOLD = params.urlThreshold;\nvar DOMAIN_THRESHOLD = params.domainThreshold;\nvar PREFERRED_VENDORS = params.preferredVendors\nvar PREFERRED_VENDORS_THRESHOLD = params.preferredVendorsThreshold\nvar FULL_RESPONSE = params.fullResponseGlobal\nif (isNaN(FILE_THRESHOLD) || isNaN(IP_THRESHOLD) || isNaN(URL_THRESHOLD) || isNaN(DOMAIN_THRESHOLD)) {\n    throw 'Threshold parameters must be numbers.\\n';\n}\n\nvar isValidReliability = function(reliability) {\n    var reliability_options = ['A+ - 3rd party enrichment', 'A - Completely reliable', 'B - Usually reliable', 'C - Fairly reliable', 'D - Not usually reliable', 'E - Unreliable', 'F - Reliability cannot be judged'];\n    return reliability_options.indexOf(reliability) \u003e= 0;\n}\n\nvar reliability = '';\nif (params['integrationReliability']) {\n    reliability = params.integrationReliability;\n}\nif(!reliability) {\n    reliability = 'C - Fairly reliable';\n}\nif(!isValidReliability(reliability)) {\n    return 'Error, Source Reliability value is invalid. Please choose from available reliability options.';\n}\n\nfunction isEnoughPreferredVendors(scanResults) {\n    if (!(PREFERRED_VENDORS \u0026\u0026 PREFERRED_VENDORS_THRESHOLD)) {\n        return false;\n    }\n    if (PREFERRED_VENDORS \u0026\u0026 !(PREFERRED_VENDORS_THRESHOLD)) {\n        return(\"Error: If you entered Preferred Vendors List you must also enter Preferred Vendors Threshold\")\n    }\n    if (!(\"scans\" in scanResults)) {\n        return false;\n    }\n    counter = 0;\n    vendorsScansDict = scanResults[\"scans\"];\n    listOfPrefferedVendors = PREFERRED_VENDORS.split(',');\n    for (var i=0; i \u003c listOfPrefferedVendors.length; i++) {\n        listOfPrefferedVendors[i] = listOfPrefferedVendors[i].toLowerCase();\n    }\n    for (var vendorName in vendorsScansDict) {\n        if (vendorsScansDict.hasOwnProperty(vendorName)) {\n            curVendorScan = vendorsScansDict[vendorName];\n            vendorNameLowercase = vendorName.toLowerCase();\n            if (listOfPrefferedVendors.indexOf(vendorNameLowercase) != -1) {\n                if (\"detected\" in curVendorScan \u0026\u0026 curVendorScan[\"detected\"]) {\n                    counter++;\n                }\n            }\n        }\n    }\n    return (parseInt(PREFERRED_VENDORS_THRESHOLD) \u003c= counter);\n}\nfunction createScansTable(scans){\n    // Returns a table with the scan result for each vendor\n    scans_table = [];\n    positives_scans_table = [];\n    negative_scans_table = [];\n    for (var scan in scans) {\n        dict_for_table = {};\n        dict_for_table['Source'] = scan;\n        if (scans[scan]['detected']){\n            dict_for_table['Detected'] = scans[scan]['detected'];\n        }\n        if (scans[scan]['result']){\n            dict_for_table['Result'] = scans[scan]['result'];\n        }\n        if (scans[scan]['update']){\n            dict_for_table['Update'] = scans[scan]['update'];\n        }\n        if (scans[scan]['detail']){\n            dict_for_table['Details'] = scans[scan]['detail'];\n        }\n        if (dict_for_table['Detected'] \u0026\u0026 dict_for_table['Detected'] === true)\n            positives_scans_table.push(dict_for_table);\n        else\n            negative_scans_table.push(dict_for_table);\n    }\n    positives_scans_table.sort(function(a, b){\n      return a.Source \u003e b.Source;\n    });\n    negative_scans_table.sort(function(a, b){\n      return a.Source \u003e b.Source;\n    });\n    scans_table = positives_scans_table.concat(negative_scans_table);\n    return scans_table;\n}\nfunction doReq(method, path, parameters) {\n    if (!parameters) {\n        parameters = {};\n    }\n    parameters.apikey = params.APIKey;\n    var result = http(\n        serverUrl + path + (method === 'GET' ? encodeToURLQuery(parameters) : ''),\n        {\n            Headers: {'Content-Type': ['application/x-www-form-urlencoded'], 'Accept': ['application/json']},\n            Method: method,\n            Body: method == 'POST' ? encodeToURLQuery(parameters).substring(1) : ''\n        },\n        params.insecure,\n        params.useproxy\n    );\n    if (result.StatusCode == 401) {\n        throw '401 Unauthorized - Wrong or invalid API key.';\n    }\n    if (result.StatusCode == 403) {\n        throw '403 Forbidden - The API key is not valid';\n    }\n    if (result.StatusCode == 404) {\n        throw '404 - Cannot find the requested resource. Check your Server URL.';\n    }\n    if (result.StatusCode \u003c 200 || result.StatusCode \u003e 299) {\n        throw 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode;\n    }\n    if (result.Body === '' \u0026\u0026 result.StatusCode === 204) {\n        return {statusCode: result.StatusCode};\n    }\n    if (result.Body === '') {\n        throw 'No content received. Maybe you tried a private API?.';\n    }\n    var obj;\n    try {\n        obj = JSON.parse(result.Body);\n    } catch (ex) {\n        throw 'Error parsing reply - ' + result.Body + ' - ' + ex;\n    }\n    if (!Array.isArray(obj) \u0026\u0026 obj.response_code !== 1 \u0026\u0026 obj.response_code !== 0) {\n        throw 'Response code: ' + obj.response_code + ', message: ' + obj.verbose_msg;\n    }\n    return {\n        body: result.Body,\n        obj: obj,\n        statusCode: result.StatusCode\n    };\n}\nfunction withRetries(waitForRateLimit, retries, reqCall) {\n    if (waitForRateLimit) {\n        waitForRateLimit = parseInt(waitForRateLimit);\n    }\n    if (!waitForRateLimit) {\n        waitForRateLimit = 60;\n    }\n    if (retries) {\n        retries = parseInt(retries);\n    }\n    if (!retries) {\n        retries = 0;\n    }\n    var res = reqCall();\n    var tries = 0;\n    while (res.statusCode === 204 \u0026\u0026 !res.body \u0026\u0026 tries \u003c retries \u0026\u0026 waitForRateLimit \u003e 0) {\n        wait(waitForRateLimit);\n        tries++;\n        res = reqCall();\n    }\n    if (res.statusCode === 204 \u0026\u0026 !res.body) {\n        throw 'No content received. Possible API rate limit reached.';\n    }\n    return res;\n}\nfunction doFile(hash, longFormat, threshold, waitForRateLimit, retries) {\n    if (!threshold) {\n        threshold = FILE_THRESHOLD || 10;\n    }\n    threshold = parseInt(threshold);\n\n    var res = withRetries(waitForRateLimit, retries, function() {return doReq('POST', 'file/report', {resource: hash});});\n\n    var r = [];\n    if (Array.isArray(res.obj)) { // Got multiple hashes so need to nicely iterate\n        r = res.obj;\n    } else {\n        r = [res.obj];\n    }\n    var entryList = [];\n    for (var i=0; i\u003cr.length; i++) {\n        if (r[i].response_code === 0) {\n            var ec = {};\n            ec[DBOTSCORE_KEY] = {Indicator: hash, Type: 'hash', Vendor: 'VirusTotal', Score: 0, Reliability: reliability};\n            ec[DBOTSCORE_KEY] = {Indicator: hash, Type: 'file', Vendor: 'VirusTotal', Score: 0, Reliability: reliability};\n            entryList.push(\n                {\n                    Type: entryTypes.note,\n                    Contents: res.body,\n                    ContentsFormat: formats.json,\n                    EntryContext: ec,\n                    HumanReadable: '## VirusTotal does not have details about ' + r[i].resource + '\\n' + res.obj.verbose_msg\n                }\n            );\n            continue;\n        }\n        ec = {};\n        ec[DBOTSCORE_KEY] = [];\n        ec[outputPaths.file] = [];\n        var md = '## VirusTotal Hash Reputation for: ' + r[i].resource + '\\n';\n        md += 'Scan date: **' + r[i].scan_date + '**\\n';\n        md += 'Positives / Total: **' + r[i].positives + '/' + r[i].total + '**\\n';\n        md += 'VT Link: [' + r[i].resource + '](' + r[i].permalink + ')\\n';\n        var dbotScore = 0;\n        if (r[i].positives \u003e= threshold || isEnoughPreferredVendors(r[i])) {\n            dbotScore = 3;\n            var malFile = {};\n            addMalicious(malFile, outputPaths.file, {\n                MD5: r[i].md5,\n                SHA1: r[i].sha1,\n                SHA256: r[i].sha256,\n                PositiveDetections: r[i].positives,\n                DetectionEngines: Object.keys(r[i].scans).length,\n                Malicious: {Vendor: 'VirusTotal', Detections: r[i].positives, TotalEngines: r[i].total}\n            });\n            ec[outputPaths.file].push(malFile[outputPaths.file]);\n        } else if (r[i].positives \u003e= threshold / 2) {\n            dbotScore = 2;\n        } else {\n            dbotScore = 1;\n        }\n\n        ec[DBOTSCORE_KEY].push({Indicator: r[i].md5, Type: 'hash', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability});\n        ec[DBOTSCORE_KEY].push({Indicator: r[i].md5, Type: 'file', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability});\n\n        ec[DBOTSCORE_KEY].push({Indicator: r[i].sha1, Type: 'hash', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability});\n        ec[DBOTSCORE_KEY].push({Indicator: r[i].sha1, Type: 'file', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability});\n\n        ec[DBOTSCORE_KEY].push({Indicator: r[i].sha256, Type: 'hash', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability});\n        ec[DBOTSCORE_KEY].push({Indicator: r[i].sha256, Type: 'file', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability});\n\n        md += 'MD5 / SHA1 / SHA256: **' + r[i].md5 + ' / ' + r[i].sha1 + ' / ' + r[i].sha256 + '**\\n';\n        longFormat = FULL_RESPONSE? 'true': longFormat;\n        if (longFormat === 'true' \u0026\u0026 r[i].scans) { // add scans table\n            scansTable = createScansTable(r[i].scans);\n            md += tableToMarkdown('Scans', scansTable);\n            if (ec[outputPaths.file]){\n                scans_ec = {\n                    Scans: scansTable,\n                    ScanID: r[i].scan_id,\n                    vtLink: r[i].permalink\n                };\n                if (typeof ec[outputPaths.file][i] === 'object') { // malicous\n                    ec[outputPaths.file][i].VirusTotal = scans_ec;\n                } else { // not malicious\n                    ec[outputPaths.file][i] = {\n                        SHA256: r[i].sha256,\n                        SHA1: r[i].sha1,\n                        MD5: r[i].md5,\n                        VirusTotal: scans_ec,\n                        PositiveDetections: r[i].positives,\n                        DetectionEngines: Object.keys(r[i].scans).length\n                    };\n                }\n            } else {\n                scans_ec = {\n                    MD5: r[i].md5,\n                    SHA1: r[i].sha1,\n                    SHA256: r[i].sha256,\n                    VirusTotal: {\n                        Scans: scansTable,\n                        ScanID: r[i].scan_id,\n                        vtLink: r[i].permalink\n                    },\n                    PositiveDetections: r[i].positives,\n                    DetectionEngines: Object.keys(r[i].scans).length\n                };\n                ec[outputPaths.file] = scans_ec;\n            }\n        } else { // short format\n            if (ec[outputPaths.file]){\n                scans_ec = {\n                    ScanID: r[i].scan_id,\n                    vtLink: r[i].permalink\n                };\n                if (typeof ec[outputPaths.file][i] === 'object') { // malicious\n                    ec[outputPaths.file][i].VirusTotal = scans_ec;\n                } else { // not malicious\n                    ec[outputPaths.file][i] = {\n                        SHA256: r[i].sha256,\n                        SHA1: r[i].sha1,\n                        MD5: r[i].md5,\n                        VirusTotal: scans_ec,\n                        PositiveDetections: r[i].positives,\n                        DetectionEngines: Object.keys(r[i].scans).length\n                    };\n                }\n            } else {\n                scans_ec = {\n                    SHA256: r[i].sha256,\n                    SHA1: r[i].sha1,\n                    MD5: r[i].md5,\n                    VirusTotal: {\n                        ScanID: r[i].scan_id,\n                        vtLink: r[i].permalink\n                    },\n                    PositiveDetections: r[i].positives,\n                    DetectionEngines: Object.keys(r[i].scans).length\n                };\n                ec[outputPaths.file] = scans_ec;\n            }\n        }\n        md += '\\n';\n        entryList.push(\n            {\n                Type: entryTypes.note,\n                Contents: res.body,\n                ContentsFormat: formats.json,\n                HumanReadable: md,\n                EntryContext: ec\n            }\n        );\n    }\n    return entryList\n}\nfunction calcRecentDownloads(checks) {\n    var badDownloads = 0;\n    var millisec_in_day = 1000 * 60 * 60 * 24;\n    var now = Date.now();\n    for (var c=0; c\u003cchecks.length; c++) {\n        if (checks[c]) {\n            for (var ci=0; ci\u003cchecks[c].length; ci++) {\n                if (checks[c][ci].date) {\n                    var d = new Date(checks[c][ci].date.replace(' ', 'T'));\n                    if (((now - d.getTime()) / millisec_in_day \u003c 30) \u0026\u0026 (checks[c][ci].positives \u003e 0)) {\n                        badDownloads++;\n                    }\n                }\n            }\n        }\n    }\n    return badDownloads;\n}\nfunction doIP(ip, longFormat, threshold, sampleSize, waitForRateLimit, retries, fullResponse) {\n\n    var ipList = argToList(ip);\n    var entryList = [];\n    for (z = 0; z \u003c ipList.length; z++) {\n        ip = ipList[z];\n        if (!isValidIP(ip)) {\n            entryList.push({Type: entryTypes.error, Contents: 'IP - ' + ip + ' is not valid IP', ContentsFormat: formats.text});\n            continue;\n        }\n        if (!threshold) {\n            threshold = IP_THRESHOLD || 10;\n        }\n        threshold = parseInt(threshold);\n        if (!sampleSize) {\n            sampleSize = 10;\n        }\n        var res = withRetries(waitForRateLimit, retries, function() {return doReq('GET', 'ip-address/report', {ip: ip});});\n        var o = res.obj;\n        var ec = {};\n        if (o.response_code === 0) {\n            ec[DBOTSCORE_KEY]  = {Indicator: ip, Type: 'ip', Vendor: 'VirusTotal', Score: 0, Reliability: reliability};\n            entryList.push({Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, EntryContext: ec,\n                HumanReadable: 'VirusTotal does not have details about ' + ip + ' ,it sent the following response:\\n' + res.obj.verbose_msg});\n            continue;\n        }\n        full_response = FULL_RESPONSE? 'true': fullResponse;\n        if (fullResponse === 'true'){\n            maxLen = 1000;\n        } else {\n            maxLen = 50;\n        }\n        // Calculate score based on recently found downloads\n        var badDownloads = calcRecentDownloads([o.detected_downloaded_samples, o.undetected_downloaded_samples]);\n        var dbotScore = 0;\n        if (badDownloads \u003e= threshold) {\n            dbotScore = 3;\n            addMalicious(ec, outputPaths.ip,{\n                Address: ip,\n                ASN: o.asn,\n                Geo: {Country: o.country},\n                Malicious: {Vendor: 'VirusTotal', Description: 'Recent malicious downloads: ' + badDownloads}\n            });\n        } else if (badDownloads \u003e= threshold / 2) {\n            dbotScore = 2;\n        } else {\n            dbotScore = 1;\n        }\n        ec[DBOTSCORE_KEY] = {Indicator: ip, Type: 'ip', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability};\n        var md = '## VirusTotal IP Reputation for: ' + ip + '\\n';\n        md += (o.asn) ? 'ASN: **' + o.asn + ' (' + o.as_owner + ')**\\n' : 'ASN: N/A\\n';\n        md += 'Country: **' + o.country + '**\\n';\n        md += 'VT Link: [' + ip + '](https://www.virustotal.com/gui/ip-address/' + encodeURIComponent(ip) + '/detection)\\n';\n        var detectedUrls = o.detected_urls || [];\n        var detectedDownloadedSamples = o.detected_downloaded_samples || [];\n        var undetectedDownloadedSamples = o.undetected_downloaded_samples || [];\n        var detectedCommunicatingSamples = o.detected_communicating_samples || [];\n        var undetectedCommunicatingSamples = o.undetected_communicating_samples || [];\n        var detectedReferrerSamples = o.detected_referrer_samples || [];\n        var undetectedReferrerSamples = o.undetected_referrer_samples || [];\n        var resolutions = o.resolutions || [];\n        var arrTitle = [{a: detectedUrls, t: 'Detected URL'}, {a: detectedDownloadedSamples, t: 'Detected downloaded sample'},\n            {a: undetectedDownloadedSamples, t: 'Undetected downloaded sample'}, {a: detectedCommunicatingSamples, t: 'Detected communicating sample'},\n            {a: undetectedCommunicatingSamples, t: 'Undetected communicating sample'},{a: detectedReferrerSamples, t: 'Detected referrer sample'},\n            {a: undetectedReferrerSamples, t: 'Undetected referrer sample'}, {a: resolutions, t: 'Resolutions'}];\n        for (var i = 0; i\u003carrTitle.length; i++) {\n            if (arrTitle[i].a) {\n                md += arrTitle[i].t + ' count: **' + arrTitle[i].a.length + '**\\n';\n            }\n        }\n        if (ec[outputPaths.ip]){ // malicious\n            ec[outputPaths.ip]['VirusTotal'] = {\n                'DownloadedHashes': detectedDownloadedSamples.slice(0,maxLen),\n                'UnAVDetectedDownloadedHashes': undetectedDownloadedSamples.slice(0,maxLen),\n                \"DetectedURLs\": detectedUrls.slice(0,maxLen),\n                'CommunicatingHashes': detectedCommunicatingSamples.slice(0,maxLen),\n                'UnAVDetectedCommunicatingHashes': undetectedCommunicatingSamples.slice(0,maxLen),\n                'Resolutions': resolutions.slice(0,maxLen),\n                'ReferrerHashes': detectedReferrerSamples.slice(0,maxLen),\n                'UnAVDetectedReferrerHashes': undetectedReferrerSamples.slice(0,maxLen)\n            };\n        } else { // not malicious\n            ec[outputPaths.ip] = {\n                \"Address\": ip,\n                \"VirusTotal\": {\n                    'DownloadedHashes': detectedDownloadedSamples.slice(0,maxLen),\n                    'UnAVDetectedDownloadedHashes': undetectedDownloadedSamples.slice(0,maxLen),\n                    \"DetectedURLs\": detectedUrls.slice(0,maxLen),\n                    'CommunicatingHashes': detectedCommunicatingSamples.slice(0,maxLen),\n                    'UnAVDetectedCommunicatingHashes': undetectedCommunicatingSamples.slice(0,maxLen),\n                    'Resolutions': resolutions.slice(0,maxLen),\n                    'ReferrerHashes': detectedReferrerSamples.slice(0,maxLen),\n                    'UnAVDetectedReferrerHashes': undetectedReferrerSamples.slice(0,maxLen)\n                },\n                'ASN': o.asn,\n                'Geo': {Country: o.country}\n            };\n        }\n        longFormat = FULL_RESPONSE? 'true': longFormat;\n        if (longFormat === 'true') {\n            for (var j=0; j\u003carrTitle.length; j++) {\n                if (arrTitle[j].a) {\n                    md += '### ' + arrTitle[j].t + '\\n';\n                    // Print only the first 10 rows\n                    var curr = [];\n                    for (var k=0; k\u003cMath.min(arrTitle[j].a.length, sampleSize); k++) {\n                        curr.push(arrTitle[j].a[k]);\n                    }\n                    md += arrToMd(curr) + '\\n';\n                }\n            }\n        }\n        entryList.push({\n            Type: entryTypes.note,\n            Contents: res.body,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: ec\n        });\n    }\n    return entryList;\n}\nfunction getURLs(url) {\n    var urls = [];\n    var nonUrls = []\n    var urlList = argToList(url);\n    for (z = urlList.length - 1; z \u003e= 0; z--) {\n        var isURL = urlList[z].match(/(?:(?:https?|ftp|hxxps?):\\/\\/|www\\[?\\.\\]?|ftp\\[?\\.\\]?)(?:[-\\w\\d]+\\[?\\.\\]?)+[-\\w\\d]+(?::\\d+)?(?:(?:\\/|\\?)[-\\w\\d+\u0026@#\\/%=~_$?!\\-:,.\\(\\);]*[\\w\\d+\u0026@#\\/%=~_$\\(\\);])?/);\n        if (isURL == null){\n            nonUrls.push(urlList[z])\n        }\n        else {\n            urls.push(urlList[z]);\n        }\n    }\n    return {'validURLs': urls, 'invalidURLs': nonUrls};\n\n}\nfunction doURL(url, threshold, longFormat, sampleSize, submitWait, waitForRateLimit, retries) {\n    //lowercase the URL protocol\n    //Example: https://www.demisto.com --\u003e https://www.demisto.com, Http://www.demisto.com --\u003e http://www.demisto.com, www.demisto.com --\u003e www.demisto.com\n    var urls = getURLs(url);\n    var urlList = urls.validURLs;\n    var entryList = [];\n    for (z = 0; z \u003c urlList.length; z++) {\n        url = urlList[z];\n        var protocol = url.match(/\\b^[^:]+(?=:\\/\\/)\\b/);\n        if (protocol !== null) { // if url doesn't start with a protocol, ignore\n          protocol = protocol[0].toLowerCase();\n          var not_protocol = url.replace(/(^\\w+:|^)\\/\\//, '');\n          url = protocol + '://' + not_protocol;\n        }\n        if (!submitWait) {\n            submitWait = 0;\n        }\n        if (!sampleSize) {\n            sampleSize = 10;\n        }\n        if (!threshold) {\n            threshold = URL_THRESHOLD || 10;\n        }\n        threshold = parseInt(threshold);\n        var res = withRetries(waitForRateLimit, retries, function() {return doReq('POST', 'url/report', {resource: url, scan:1});});\n        var o = res.obj;\n        var ec = {};\n        if (o.response_code === 0) {\n            ec[DBOTSCORE_KEY] = {Indicator: url, Type: 'url', Vendor: 'VirusTotal', Score: 0, Reliability: reliability};\n            entryList({Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, EntryContext: ec,\n                HumanReadable: 'VirusTotal does not have details about ' + url + '\\n' + res.obj.verbose_msg});\n            continue;\n        }\n        var md = '## VirusTotal URL Reputation for: ' + url + '\\n';\n        if (!o.scans \u0026\u0026 submitWait\u003e0) {\n            wait(parseInt(submitWait));\n            res = doReq('GET', 'url/report', {resource: url});\n            o = res.obj;\n        }\n        if (!o.scans) { // URL doesn't exist in VT\n            md += 'URL submitted for scan. Please retry command later\\n';\n            ec[outputPaths.url] = {\n                Data: url,\n                VirusTotal: {\n                    ScanID: o.scan_id\n                },\n                DetectionEngines: 0,\n                PositiveDetections: 0\n            };\n        } else {\n            md += 'Last scan date: *' + o.scan_date + '*\\n';\n            md += 'Total scans: **' + o.total + '**\\n';\n            md += 'Positive scans: **' + o.positives + '**\\n';\n            md += 'VT Link: [' + url + '](' + o.permalink + ')\\n';\n            var dbotScore = 0;\n            if (o.positives \u003e= threshold  || isEnoughPreferredVendors(o)) {\n                dbotScore = 3;\n                addMalicious(ec, outputPaths.url, {\n                    Data: url,\n                    Malicious: {Vendor: 'VirusTotal', Description: 'Positives / Total: ' + o.positives + ' / ' + o.total},\n                    DetectionEngines: Object.keys(o.scans).length,\n                    PositiveDetections: o.positives\n                });\n            } else if (o.positives \u003e= threshold / 2) {\n                dbotScore = 2;\n            } else {\n                dbotScore = 1;\n            }\n            ec[DBOTSCORE_KEY] = {Indicator: url, Type: 'url', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability};\n            longFormat = FULL_RESPONSE? 'true': longFormat;\n            if (longFormat === 'true') { // add scans table\n                scansTable = createScansTable(o.scans);\n                md += tableToMarkdown('Scans', scansTable);\n                if (ec[outputPaths.url]){ // malicious\n                    scans_ec = {\n                        Scans: scansTable,\n                        ScanID: o.scan_id,\n                        vtLink: o.permalink\n                    };\n                    ec[outputPaths.url].VirusTotal = scans_ec;\n                } else { // not malicious\n                    scans_ec = {\n                        Data: url,\n                        \"VirusTotal\": {\n                            Scans: scansTable,\n                            ScanID: o.scan_id,\n                            vtLink: o.permalink\n                        },\n                        DetectionEngines: Object.keys(o.scans).length,\n                        PositiveDetections: o.positives\n                    };\n                    ec[outputPaths.url] = scans_ec;\n                }\n            } else { // short format\n                if (ec[outputPaths.url]){ // malicious\n                    ec[outputPaths.url]['VirusTotal'] = {\n                        ScanID: o.scan_id,\n                        vtLink: o.permalink\n                    };\n                } else { // not malicious\n                    ec[outputPaths.url] = {\n                        Data: url,\n                        VirusTotal: {\n                            ScanID: o.scan_id,\n                            vtLink: o.permalink\n                        },\n                        DetectionEngines: Object.keys(o.scans).length,\n                        PositiveDetections: o.positives\n                    };\n                }\n            }\n        }\n\n        entryList.push({\n            Type: entryTypes.note,\n            Contents: res.body,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: ec\n        });\n    }\n\n    invalidURLsList = urls.invalidURLs\n    if (invalidURLsList.length !== 0) {\n        var invalidURLsMd = \"### The following indicators were not scanned since they are not valid URLs: \\n\" + invalidURLsList\n        entryList.push({\n            Type: entryTypes.note,\n            Contents: {},\n            ContentsFormat: formats.json,\n            HumanReadable: invalidURLsMd,\n            EntryContext: {}\n        });\n    }\n    return entryList;\n}\nfunction doDomain(domain, threshold, longFormat, sampleSize, waitForRateLimit, retries, fullResponse) {\n    if (!sampleSize) {\n        sampleSize = 10;\n    }\n    if (!threshold) {\n        threshold = DOMAIN_THRESHOLD || 10;\n    }\n    threshold = parseInt(threshold);\n    var domainList = argToList(domain);\n    var entryList = [];\n    for (z = 0; z \u003c domainList.length; z++) {\n        domain = domainList[z];\n        var res = withRetries(waitForRateLimit, retries, function() {return doReq('GET', 'domain/report', {domain: domain});});\n        var o = res.obj;\n        var ec = {};\n        if (o.response_code === 0) {\n            ec[DBOTSCORE_KEY] = {Indicator: domain, Type: 'domain', Vendor: 'VirusTotal', Score: 0, Reliability: reliability};\n            entryList.push({Type: entryTypes.note, Contents: res.body, ContentsFormat: formats.json, EntryContext: ec,\n                HumanReadable: 'VirusTotal does not have details about ' + domain + '\\n' + res.obj.verbose_msg});\n            continue;\n        }\n        full_response = FULL_RESPONSE? 'true': fullResponse;\n        if (fullResponse === 'true') {\n            maxLen = 1000;\n        } else {\n            maxLen = 50;\n        }\n        // Calculate score based on recently found downloads\n        var badDownloads = calcRecentDownloads([o.detected_downloaded_samples, o.undetected_downloaded_samples]);\n        var dbotScore = 0;\n        if (badDownloads \u003e= threshold) {\n            dbotScore = 3;\n            addMalicious(ec, outputPaths.domain, {Name: domain,\n                Malicious: {Vendor: 'VirusTotal', Description: 'Recent malicious downloads: ' + badDownloads}});\n        } else if (badDownloads \u003e= threshold / 2) {\n            dbotScore = 2;\n        } else {\n            dbotScore = 1;\n        }\n        ec[DBOTSCORE_KEY] = {Indicator: domain, Type: 'domain', Vendor: 'VirusTotal', Score: dbotScore, Reliability: reliability};\n        var md = '## VirusTotal Domain Reputation for: ' + domain + '\\n';\n        md += '#### Domain categories: *' + o.categories + \"*\\n\";\n        md += 'VT Link: [' + domain + '](https://www.virustotal.com/gui/domain/' + encodeURIComponent(domain) + '/detection)\\n';\n        var detectedUrls = o.detected_urls || [];\n        var detectedDownloadedSamples = o.detected_downloaded_samples || [];\n        var undetectedDownloadedSamples = o.undetected_downloaded_samples || [];\n        var detectedCommunicatingSamples = o.detected_communicating_samples || [];\n        var undetectedCommunicatingSamples = o.undetected_communicating_samples || [];\n        var detectedReferrerSamples = o.detected_referrer_samples || [];\n        var undetectedReferrerSamples = o.undetected_referrer_samples || [];\n        var resolutions = o.resolutions || [];\n        var arrTitle = [{a: detectedUrls, t: 'Detected URL'}, {a: detectedDownloadedSamples, t: 'Detected downloaded sample'},\n            {a: undetectedDownloadedSamples, t: 'Undetected downloaded sample'}, {a: detectedCommunicatingSamples, t: 'Detected communicating sample'},\n            {a: undetectedCommunicatingSamples, t: 'Undetected communicating sample'},{a: detectedReferrerSamples, t: 'Detected referrer sample'},\n            {a: undetectedReferrerSamples, t: 'Undetected referrer sample'}, {a: resolutions, t: 'Resolutions'}];\n        for (var i = 0; i\u003carrTitle.length; i++) {\n            if (arrTitle[i].a) {\n                md += arrTitle[i].t + ' count: **' + arrTitle[i].a.length + '**\\n';\n            }\n        }\n        longFormat = FULL_RESPONSE? 'true': longFormat;\n        if (longFormat === 'true') {\n            for (var j = 0; j\u003carrTitle.length; j++) {\n                if (arrTitle[j].a) {\n                    md += '### ' + arrTitle[j].t + '\\n';\n                    // Print only the first 10 rows\n                    var curr = [];\n                    for (var k = 0; k\u003cMath.min(arrTitle[j].a.length, sampleSize); k++) {\n                        curr.push(arrTitle[j].a[k]);\n                    }\n                    md += arrToMd(curr) + '\\n';\n                }\n            }\n        }\n        if (o.domain_siblings \u0026\u0026 o.domain_siblings.length \u003e 0) {\n            md += \"### Observed subdomains\\n\";\n            for (i = 0; i \u003c o.domain_siblings.length; i++) {\n                md += \"- \" + o.domain_siblings[i] + \"\\n\";\n            }\n        }\n        if (o.whois) {\n            var whoIs = o.whois.trim();\n            var lines = whoIs ? whoIs.split(\"\\n\") : [];\n            md += '### Whois Lookup\\n';\n            for (i = 0; i \u003c lines.length; i++) {\n                var parts = lines[i].split(': ');\n                if (parts[0] \u0026\u0026 parts[1]) {\n                    md += \"**\" + parts[0].trim() + \"**: \" + parts[1] + \"\\n\";\n                }\n            }\n        }\n        var detected_downloaded_samples = o.detected_downloaded_samples;\n        if (detected_downloaded_samples === undefined) {\n            detected_downloaded_samples = [];\n        } else {\n            detected_downloaded_samples = detected_downloaded_samples.slice(0,maxLen);\n        }\n        var undetected_downloaded_samples = o.undetected_downloaded_samples;\n        if (undetected_downloaded_samples === undefined) {\n            undetected_downloaded_samples = [];\n        } else {\n            undetected_downloaded_samples = undetected_downloaded_samples.slice(0,maxLen);\n        }\n        var detected_urls = o.detected_urls;\n        if (detected_urls === undefined) {\n            detected_urls = [];\n        } else {\n            detected_urls = detected_urls.slice(0,maxLen);\n        }\n        var detected_communicating_samples = o.detected_communicating_samples;\n        if (detected_communicating_samples === undefined) {\n            detected_communicating_samples = [];\n        } else {\n            detected_communicating_samples = detected_communicating_samples.slice(0,maxLen);\n        }\n        var undetected_communicating_samples = o.undetected_communicating_samples;\n        if (undetected_communicating_samples === undefined) {\n            undetected_communicating_samples = [];\n        } else {\n            undetected_communicating_samples = undetected_communicating_samples.slice(0,maxLen);\n        }\n        resolutions = o.resolutions;\n        if (resolutions === undefined) {\n            resolutions = [];\n        } else {\n            resolutions = resolutions.slice(0,maxLen);\n        }\n        var detected_referrer_samples = o.detected_referrer_samples;\n        if (detected_referrer_samples === undefined) {\n            detected_referrer_samples = [];\n        } else {\n            detected_referrer_samples = detected_referrer_samples.slice(0,maxLen);\n        }\n        var undetected_referrer_samples = o.undetected_referrer_samples;\n        if (undetected_referrer_samples === undefined) {\n            undetected_referrer_samples = [];\n        } else {\n            undetected_referrer_samples = undetected_referrer_samples.slice(0,maxLen);\n        }\n        var domain_siblings = o.domain_siblings;\n        if (domain_siblings === undefined) {\n            domain_siblings = [];\n        } else {\n            domain_siblings = domain_siblings.slice(0,maxLen);\n        }\n        domain_ec = {\n            \"Name\": domain,\n            \"VirusTotal\": {\n                'DownloadedHashes': detected_downloaded_samples,\n                'UnAVDetectedDownloadedHashes': undetected_downloaded_samples,\n                \"DetectedURLs\": detected_urls,\n                'CommunicatingHashes': detected_communicating_samples,\n                'UnAVDetectedCommunicatingHashes': undetected_communicating_samples,\n                'Resolutions': resolutions,\n                'ReferrerHashes': detected_referrer_samples,\n                'UnAVDetectedReferrerHashes': undetected_referrer_samples,\n                'Whois': o.whois,\n                'Subdomains': domain_siblings,\n            }\n        };\n        if (ec[outputPaths.domain]){ // malicious\n            ec[outputPaths.domain].VirusTotal = {\n                'DownloadedHashes': detected_downloaded_samples,\n                'UnAVDetectedDownloadedHashes': undetected_downloaded_samples,\n                \"DetectedURLs\": detected_urls,\n                'CommunicatingHashes': detected_communicating_samples,\n                'UnAVDetectedCommunicatingHashes': undetected_communicating_samples,\n                'Resolutions': resolutions,\n                'ReferrerHashes': detected_referrer_samples,\n                'UnAVDetectedReferrerHashes': undetected_referrer_samples,\n                'Whois': o.whois,\n                'Subdomains': domain_siblings,\n            };\n        } else { // not malicious\n            ec[outputPaths.domain] = domain_ec;\n        }\n\n        entryList.push({\n            Type: entryTypes.note,\n            Contents: res.body,\n            ContentsFormat: formats.json,\n            HumanReadable: md,\n            EntryContext: ec\n        });\n    }\n    return entryList;\n}\nfunction scanURL(url) {\n    var res = doReq('POST', 'url/scan', {url: url});\n    var r = [];\n    if (Array.isArray(res.obj)) { // Got multiple URLs so need to nicely iterate\n        r = res.obj;\n    } else {\n        r = [res.obj];\n    }\n    var md = '';\n    var ec = {vtScanID: [], vtLink: []};\n    for (var i=0; i\u003cr.length; i++) {\n        md += '## VirusTotal URL scan for: [' + r[i].url + '](' + r[i].permalink + ')\\n';\n        md += 'Scan ID: **' + r[i].scan_id + '**\\n';\n        ec.vtScanID.push(r[i].scan_id);\n        ec.vtLink.push(r[i].permalink);\n        md += 'Scan Date: **' + r[i].scan_date + '**\\n\\n';\n    }\n    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n}\nfunction scanFile(entry, uploadURL) {\n    var url = uploadURL ? uploadURL : serverUrl + 'file/scan';\n    var fileName = dq(invContext, \"File(val.EntryID == '\" + entry + \"').Name\");\n    if (Array.isArray(fileName)) {\n        if (fileName.length \u003e 0) {\n            fileName = fileName[0];\n        } else {\n            fileName = undefined;\n        }\n    }\n    var result = httpMultipart(url, entry, {Method: 'POST', Headers: {'Accept': ['application/json']}}, {apikey: params.APIKey},\n        params.insecure, params.proxy, undefined, 'file', fileName);\n    if (result.StatusCode \u003c 200 || result.StatusCode \u003e 299) {\n        throw 'Failed to perform request ' + url + ', request status code: ' + result.StatusCode;\n    }\n    if (result.Body === '' \u0026\u0026 result.StatusCode == 204) {\n        throw 'No content recieved. Possible API rate limit reached.';\n    }\n    if (result.Body === '') {\n        throw 'No content recieved. Maybe you tried a private API?.';\n    }\n    var obj;\n    try {\n        obj = JSON.parse(result.Body);\n    } catch (ex) {\n        throw 'Error parsing reply - ' + result.Body + ' - ' + ex;\n    }\n    if (obj.response_code !== 1) {\n        throw 'Response code: ' + obj.response_code + ', message: ' + obj.verbose_msg;\n    }\n    var ec = {};\n    ec.vtScanID = obj.scan_id;\n    ec.vtLink = obj.permalink;\n    var md = '## VirusTotal scan file for [' + entry + '](' + obj.permalink + ')\\n';\n    md += 'Resource: **' + obj.resource + '**\\n';\n    md += 'MD5 / SHA1 / SHA256: **' + obj.md5 + ' / ' + obj.sha1 + ' / ' + obj.sha256 + '**\\n';\n    return {\n        Type: entryTypes.note,\n        Contents: result.Body,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n}\nfunction rescanFile(hash) {\n    var res = doReq('POST', 'file/rescan', {resource: hash});\n    var r = [];\n    if (Array.isArray(res.obj)) { // Got multiple hashes so need to nicely iterate\n        r = res.obj;\n    } else {\n        r = [res.obj];\n    }\n    var md = '';\n    var ec = {vtScanID: [], vtLink: []};\n    for (var i=0; i\u003cr.length; i++) {\n        md += '## VirusTotal File Rescan for: [' + r[i].resource + '](' + r[i].permalink + ')\\n';\n        md += 'Scan ID: **' + r[i].scan_id + '**\\n';\n        ec.vtScanID.push(r[i].scan_id);\n        ec.vtLink.push(r[i].permalink);\n        md += 'MD5 / SHA1 / SHA256: **' + r[i].md5 + ' / ' + r[i].sha1 + ' / ' + r[i].sha256 + '**\\n\\n';\n    }\n    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n}\nfunction doComments(resource, comment) {\n    var res = doReq('POST', 'comments/put', {resource: resource, comment: comment});\n    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: res.obj.verbose_msg\n    };\n}\nfunction getComments(resource, before) {\n    var params = {resource: resource};\n    if (before) {\n        params.before = before;\n    }\n    var res = doReq('GET', 'comments/get', params);\n    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: arrToMd(res.obj.comments)\n    };\n}\nfunction fileScanUploadURL() {\n    var res = doReq('GET', 'file/scan/upload_url');\n    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: res.obj.upload_url,\n        EntryContext: {vtUploadURL: res.obj.upload_url}\n    };\n}\nfunction test() {\n    // if getting \"No content received. Possible API rate limit reached.\" it's means that the api key use not usable right now, but it's working\n    try\n    {\n        doFile('7657fcb7d772448a6d8504e4b20168b8'); // Check sample file - it will throw an error if not successful\n    } catch(err)\n    {\n        if (err == \"No content received. Possible API rate limit reached.\"){\n            return true;\n        }\n        return String(err);\n    }\n    return true;\n}\ntry {\n    switch (command) {\n        case 'test-module':\n            return test();\n        case 'file':\n            return doFile(args.file, args.long, args.threshold, args.wait, args.retries);\n        case 'ip':\n            return doIP(args.ip, args.long, args.threshold, args.sampleSize, args.wait, args.retries, args.fullResponse);\n        case 'url':\n            return doURL(args.url, args.threshold, args.long, args.sampleSize, args.submitWait, args.wait, args.retries);\n        case 'domain':\n            return doDomain(args.domain, args.threshold, args.long, args.sampleSize, args.wait, args.retries);\n        case 'file-scan':\n            return scanFile(args.entryID, args.uploadURL);\n        case 'file-rescan':\n            return rescanFile(args.file);\n        case 'url-scan':\n            return scanURL(args.url);\n        case 'vt-comments-add':\n            return doComments(args.resource, args.comment);\n        case 'vt-comments-get':\n            return getComments(args.resource, args.before);\n        case 'vt-file-scan-upload-url':\n            return fileScanUploadURL();\n        default:\n            throw 'Unknown command - ' + command;\n    }\n} catch (err) {\n    return {\n        'Type' : entryTypes.error,\n        'ContentsFormat' : formats.text,\n        'Contents': err,\n        'EntryContext': {'Error': err}\n    };\n}","subtype":"","type":"javascript"},"itemVersion":"2.1.7","modified":"2021-08-25T15:12:04.568808+03:00","name":"VirusTotal","packID":"VirusTotal","packPropagationLabels":["all"],"prevName":"VirusTotal","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"API Key (leave empty. Fill in the API key in the password field.)","displayPassword":"API Key","hidden":false,"hiddenPassword":false,"hiddenUsername":true,"info":"","name":"credentials","options":null,"required":true,"type":9},{"defaultValue":"C - Fairly reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data","name":"feedReliability","options":["A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":false,"type":15},{"defaultValue":"false","display":"Premium Subscription","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"is_premium_api","options":null,"required":false,"type":8},{"defaultValue":"10","display":"File Threshold. Minimum number of positive results from VT scanners to consider the file malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fileThreshold","options":null,"required":false,"type":0},{"defaultValue":"10","display":"IP Threshold. Minimum number of positive results from VT scanners to consider the IP malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ipThreshold","options":null,"required":false,"type":0},{"defaultValue":"10","display":"URL Threshold. Minimum number of positive results from VT scanners to consider the URL malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"urlThreshold","options":null,"required":false,"type":0},{"defaultValue":"10","display":"Domain Threshold. Minimum number of positive results from VT scanners to consider the domain malicious.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"domainThreshold","options":null,"required":false,"type":0},{"defaultValue":"","display":"Preferred Vendors List. CSV list of vendors who are considered more trustworthy.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"preferredVendors","options":null,"required":false,"type":12},{"defaultValue":"5","display":"Preferred Vendor Threshold. The minimum number of highly trusted vendors required to consider a domain, IP address, URL, or file as malicious. ","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"preferredVendorsThreshold","options":null,"required":false,"type":0},{"defaultValue":"true","display":"Enable score analyzing by Crowdsourced Yara Rules, Sigma, and IDS","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"crowdsourced_yara_rules_enabled","options":null,"required":false,"type":8},{"defaultValue":"1","display":"Crowdsourced Yara Rules Threshold","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"yaraRulesThreshold","options":null,"required":false,"type":0},{"defaultValue":"5","display":"Sigma and Intrusion Detection Rules Threshold","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"SigmaIDSThreshold","options":null,"required":false,"type":0},{"defaultValue":"10000","display":"Domain Popularity Ranking Threshold","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"domain_popularity_ranking","options":null,"required":false,"type":0},{"defaultValue":"3","display":"Premium Subscription Only: Relationship Files Threshold","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"relationship_threshold","options":null,"required":false,"type":0},{"defaultValue":"communicating files,* downloaded files,referrer files,* urls","display":"IP Relationships","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Select the list of relationships to retrieve from the API. Note that relationships that are signed with * key are available only for the VirusTotal premium API key.","name":"ip_relationships","options":["communicating files","* downloaded files","referrer files","* urls"],"required":false,"type":16},{"defaultValue":"* cname records,* caa records,communicating files,* downloaded files,immediate parent,* mx records,* ns records,parent,referrer files,siblings,* soa records,subdomains,* urls","display":"Domain Relationships","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Select the list of relationships to retrieve from the API. Note that relationships that are signed with * key are available only for the VirusTotal premium API key.","name":"domain_relationships","options":["* cname records","* caa records","communicating files","* downloaded files","immediate parent","* mx records","* ns records","parent","referrer files","siblings","* soa records","subdomains","* urls"],"required":false,"type":16},{"defaultValue":"communicating files,* contacted domains,* contacted ips,* downloaded files,last serving ip address,network location,* redirecting urls,* redirects to,* referrer files,* referrer urls","display":"URL Relationships","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Select the list of relationships to retrieve from the API. Note that relationships that are signed with * key are available only for the VirusTotal premium API key.","name":"url_relationships","options":["communicating files","* contacted domains","* contacted ips","* downloaded files","last serving ip address","network location","* redirecting urls","* redirects to","* referrer files","* referrer urls"],"required":false,"type":16},{"defaultValue":"* carbonblack children,* carbonblack parents,* compressed parents,contacted domains,contacted ips,contacted urls,dropped files,* email attachments,* email parents,* embedded domains,* embedded ips,* embedded urls,execution parents,* itw domains,* itw ips,* overlay children,* overlay parents,* pcap children,* pcap parents,pe resource children,pe resource parents,* similar files","display":"File Relationships","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Select the list of relationships to retrieve from the API. Note that relationships that are signed with * key are available only for the VirusTotal premium API key.","name":"file_relationships","options":["* carbonblack children","* carbonblack parents","* compressed parents","contacted domains","contacted ips","contacted urls","dropped files","* email attachments","* email parents","* embedded domains","* embedded ips","* embedded urls","execution parents","* itw domains","* itw ips","* overlay children","* overlay parents","* pcap children","* pcap parents","pe resource children","pe resource parents","* similar files"],"required":false,"type":16},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8}],"definitionId":"","description":"Analyzes suspicious hashes, URLs, domains, and IP addresses.","detailedDescription":"### Authorization:\nYour API key can be found in your VirusTotal account user menu.\nYour API key carries all your privileges, so keep it secure and don't share it with anyone.\n\n### Cortex XSOAR version 6.0.0 and below:\nFill anything in the \"Username\" fill box. Use you API key in the password fill box.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/virus-total-api-v3)","display":"VirusTotal (API v3)","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"VirusTotal (API v3)","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"Hash of the file to query. Supports MD5, SHA1, and SHA256.","isArray":true,"name":"file","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return extended data (last_analysis_results).","name":"extended_data","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the file reputation of the specified hash.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file","outputs":[{"contentPath":"","contextPath":"File.MD5","description":"Bad MD5 hash.","type":""},{"contentPath":"","contextPath":"File.SHA1","description":"Bad SHA1 hash.","type":""},{"contentPath":"","contextPath":"File.SHA256","description":"Bad SHA256 hash.","type":""},{"contentPath":"","contextPath":"File.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"File.Malicious.Vendor","description":"For malicious files, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"File.Malicious.Detections","description":"For malicious files, the total number of detections.","type":""},{"contentPath":"","contextPath":"File.Malicious.TotalEngines","description":"For malicious files, the total number of engines that checked the file hash.","type":""},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":""},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":""},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the DBot score.","type":""},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.type_description","description":"Description of the type of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.tlsh","description":"The locality-sensitive hashing.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.MIMEType","description":"MIME type of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.names","description":"Names of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.javascript_info.tags","description":"Tags of the JavaScript.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.FileType","description":"The file type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.WordCount","description":"Total number of words in the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.LineCount","description":"Total number of lines in file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_ids_stats.info","description":"Number of IDS that marked the file as \"info\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_ids_stats.high","description":"Number of IDS that marked the file as \"high\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_ids_stats.medium","description":"Number of IDS that marked the file as \"medium\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_ids_stats.low","description":"Number of IDS that marked the file as \"low\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.sigma_analysis_stats.critical","description":"Number of Sigma analysis that marked the file as \"critical\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.sigma_analysis_stats.high","description":"Number of Sigma analysis that marked the file as \"high\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.sigma_analysis_stats.medium","description":"Number of Sigma analysis that marked the file as \"medium\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.sigma_analysis_stats.low","description":"Number of Sigma analysis that marked the file as \"low\".","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.MIMEEncoding","description":"The MIME encoding.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.FileTypeExtension","description":"The file type extension.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.exiftool.Newlines","description":"Number of newlines signs.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.trid.file_type","description":"The TrID file type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.trid.probability","description":"The TrID probability.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_yara_results.description","description":"Description of the YARA rule.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_yara_results.source","description":"Source of the YARA rule.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_yara_results.author","description":"Author of the YARA rule.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_yara_results.ruleset_name","description":"Rule set name of the YARA rule.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_yara_results.rule_name","description":"Name of the YARA rule.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.crowdsourced_yara_results.ruleset_id","description":"ID of the YARA rule.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.names","description":"Name of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_modification_date","description":"The last modification date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.type_tag","description":"Tag of the type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.total_votes.harmless","description":"Total number of harmless votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.total_votes.malicious","description":"Total number of malicious votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.size","description":"Size of the file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.popular_threat_classification.suggested_threat_label","description":"Suggested thread label.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.popular_threat_classification.popular_threat_name","description":"The popular thread name.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.times_submitted","description":"Number of times the file was submitted.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_submission_date","description":"Last submission date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.downloadable","description":"Whether the file is downloadable.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.sha256","description":"SHA-256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.type_extension","description":"Extension of the type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.tags","description":"File tags.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_date","description":"Last analysis date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.unique_sources","description":"Unique sources.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.first_submission_date","description":"First submission date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.ssdeep","description":"SSDeep hash of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.md5","description":"MD5 hash of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.sha1","description":"SHA-1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.magic","description":"Identification of file by the magic number.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.harmless","description":"The number of engines that found the indicator to be harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.type-unsupported","description":"The number of engines that found the indicator to be of type unsupported.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.suspicious","description":"The number of engines that found the indicator to be suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.confirmed-timeout","description":"The number of engines that confirmed the timeout of the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.timeout","description":"The number of engines that timed out for the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.failure","description":"The number of failed analysis engines.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.malicious","description":"The number of engines that found the indicator to be malicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.last_analysis_stats.undetected","description":"The number of engines that could not detect the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.meaningful_name","description":"Meaningful name of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.attributes.reputation","description":"The reputation of the file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.File.type","description":"Type of the indicator (file).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.id","description":"Type ID of the indicator.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.File.links.self","description":"Link to the response.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"IP address to check.","isArray":true,"name":"ip","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return extended data (last_analysis_results).","name":"extended_data","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of an IP address.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ip","outputs":[{"contentPath":"","contextPath":"IP.Address","description":"Bad IP address.","type":""},{"contentPath":"","contextPath":"IP.ASN","description":"Bad IP ASN.","type":""},{"contentPath":"","contextPath":"IP.Geo.Country","description":"Bad IP country.","type":""},{"contentPath":"","contextPath":"IP.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"IP.Malicious.Vendor","description":"For malicious IPs, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"IP.Malicious.Description","description":"For malicious IPs, the reason that the vendor made the decision.","type":""},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":""},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":""},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the DBot score.","type":""},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":""},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.regional_internet_registry","description":"Regional internet registry (RIR).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.jarm","description":"JARM data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.network","description":"Network data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.country","description":"The country where the IP is located.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.as_owner","description":"IP owner.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.last_analysis_stats.harmless","description":"The number of engines that found the domain to be harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.last_analysis_stats.malicious","description":"The number of engines that found the indicator to be malicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.last_analysis_stats.suspicious","description":"The number of engines that found the indicator to be suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.last_analysis_stats.undetected","description":"The number of engines that could not detect the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.last_analysis_stats.timeout","description":"The number of engines that timed out for the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.asn","description":"ASN data.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.whois_date","description":"Date of the last update of the whois record.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.reputation","description":"IP reputation.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.last_modification_date","description":"Last modification date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.total_votes.harmless","description":"Total number of harmless votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.total_votes.malicious","description":"Total number of malicious votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.continent","description":"The continent where the IP is located.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.attributes.whois","description":"whois data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.type","description":"Indicator IP type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IP.id","description":"ID of the IP.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"URL to check.","isArray":true,"name":"url","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return extended data (last_analysis_results).","name":"extended_data","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a URL.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"url","outputs":[{"contentPath":"","contextPath":"URL.Data","description":"Bad URLs found.","type":""},{"contentPath":"","contextPath":"URL.Malicious.Vendor","description":"For malicious URLs, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"URL.Malicious.Description","description":"For malicious URLs, the reason that the vendor made the decision.","type":""},{"contentPath":"","contextPath":"URL.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"URL.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":""},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":""},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the DBot score.","type":""},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":""},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.favicon.raw_md5","description":"The MD5 hash of the URL.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.favicon.dhash","description":"Difference hash.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_modification_date","description":"Last modification date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.times_submitted","description":"The number of times the url has been submitted.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.total_votes.harmless","description":"Total number of harmless votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.total_votes.malicious","description":"Total number of malicious votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.threat_names","description":"Name of the threats found.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_submission_date","description":"The last submission date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_content_length","description":"The last HTTPS response length.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_headers.date","description":"The last response header date.","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_headers.x-sinkhole","description":"DNS sinkhole from last response.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_headers.content-length","description":"The content length of the last response.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_headers.content-type","description":"The content type of the last response.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.reputation","description":"Reputation of the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_analysis_date","description":"The date of the last analysis in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.has_content","description":"Whether the url has content in it.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.first_submission_date","description":"The first submission date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_content_sha256","description":"The SHA-256 hash of the content of the last response.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_http_response_code","description":"Last response status code.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_final_url","description":"Last final URL.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.url","description":"The URL itself.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.title","description":"Title of the page.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_analysis_stats.harmless","description":"The number of engines that found the domain to be harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_analysis_stats.malicious","description":"The number of engines that found the indicator to be malicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_analysis_stats.suspicious","description":"The number of engines that found the indicator to be suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_analysis_stats.undetected","description":"The number of engines that could not detect the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.last_analysis_stats.timeout","description":"The number of engines that timed out for the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.URL.attributes.outgoing_links","description":"Outgoing links of the URL page.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.type","description":"Type of the indicator (url).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.id","description":"ID of the indicator.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.URL.links.self","description":"Link to the response.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Domain name to check.","isArray":true,"name":"domain","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return extended data (last_analysis_results).","name":"extended_data","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Checks the reputation of a domain.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"domain","outputs":[{"contentPath":"","contextPath":"Domain.Name","description":"Bad domain found.","type":""},{"contentPath":"","contextPath":"Domain.Malicious.Vendor","description":"For malicious domains, the vendor that made the decision.","type":""},{"contentPath":"","contextPath":"Domain.Malicious.Description","description":"For malicious domains, the reason that the vendor made the decision.","type":""},{"contentPath":"","contextPath":"Domain.Relationships.EntityA","description":"The source of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.EntityB","description":"The destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.Relationship","description":"The name of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.EntityAType","description":"The type of the source of the relationship.","type":"string"},{"contentPath":"","contextPath":"Domain.Relationships.EntityBType","description":"The type of the destination of the relationship.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":""},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":""},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":""},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual DBot score.","type":""},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_dns_records.type","description":"The type of the last DNS records.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_dns_records.value","description":"The value of the last DNS records.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_dns_records.ttl","description":"The time To live (ttl) of the last DNS records.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.jarm","description":"JARM data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.whois","description":"whois data.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_dns_records_date","description":"The last DNS records date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_analysis_stats.harmless","description":"The number of engines that found the domain to be harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_analysis_stats.malicious","description":"The number of engines that found the indicator to be malicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_analysis_stats.suspicious","description":"The number of engines that found the indicator to be suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_analysis_stats.undetected","description":"The number of engines that could not detect the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_analysis_stats.timeout","description":"The number of engines that timed out for the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.favicon.raw_md5","description":"MD5 hash of the domain.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.favicon.dhash","description":"Difference hash.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.reputation","description":"Reputation of the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.registrar","description":"Registrar information.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_update_date","description":"Last updated date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.last_modification_date","description":"Last modification date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.creation_date","description":"Creation date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.total_votes.harmless","description":"Total number of harmless votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.attributes.total_votes.malicious","description":"Total number of malicious votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Domain.type","description":"Type of indicator (domain).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.id","description":"ID of the domain.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Domain.links.self","description":"Link to the domain investigation.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The file entry ID to submit.","isArray":true,"name":"entryID","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Premium API extension. Special upload URL for files larger than 32 MB. Can be acquired from the vt-file-scan-upload-url command.","name":"uploadURL","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Submits a file for scanning. Use the vt-analysis-get command to get the scan results.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file-scan","outputs":[{"contentPath":"","contextPath":"VirusTotal.Submission.type","description":"The submission type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.id","description":"The ID of the submission.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.EntryID","description":"The entry ID of the file detonated.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.Extension","description":"File extension.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.Info","description":"File info.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.MD5","description":"MD5 hash of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.Name","description":"Name of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.SHA1","description":"SHA-1 hash of the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.SHA256","description":"SHA-256 of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.SHA512","description":"SHA-512 of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.SSDeep","description":"SSDeep of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.Size","description":"Size of the file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Submission.Type","description":"The type of the submission (analysis).","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Hash of the file to rescan. Supports MD5, SHA1, and SHA256.","name":"file","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Rescans an already submitted file. This avoids having to upload the file again. Use the vt-analysis-get command to get the scan results.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"file-rescan","outputs":[{"contentPath":"","contextPath":"VirusTotal.Submission.Type","description":"The type of the submission (analysis).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.id","description":"The ID of the submission","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.hash","description":"The indicator sent to rescan.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The URL to scan.","name":"url","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Scans a specified URL. Use the vt-analysis-get command to get the scan results.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"url-scan","outputs":[{"contentPath":"","contextPath":"VirusTotal.Submission.Type","description":"The type of the submission (analysis).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.id","description":"The ID of the submission.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Submission.hash","description":"The indicator sent to rescan.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The file hash (MD5, SHA1, orSHA256), Domain, URL or IP on which you're commenting on. If not supplied, will try to determine if it's a hash or a url.","name":"resource","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The type of the resource on which you're commenting.","name":"resource_type","predefined":["ip","url","domain","hash"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"The actual review that you can tag by using the \"#\" twitter-like syntax, for example, #disinfection #zbot, and reference users using the \"@\" syntax, for example, @VirusTotalTeam.","name":"comment","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Adds comments to files and URLs.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-comments-add","outputs":[{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.date","description":"The date of the comment in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.text","description":"The text of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.positive","description":"Number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.abuse","description":"Number of abuse votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.negative","description":"Number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.html","description":"The HTML content.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.type","description":"The type of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.id","description":"ID of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.links.self","description":"Link to the request.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":null,"cartesian":false,"deprecated":false,"description":"Premium API. Get a special URL for files larger than 32 MB.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-file-scan-upload-url","outputs":[{"contentPath":"","contextPath":"VirusTotal.FileUploadURL","description":"The special upload URL for large files.","type":""}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Comment ID","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete a comment.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-comments-delete","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The file hash (MD5, SHA1, orSHA256), Domain, URL or IP on which you're commenting on. If not supplied, will try to determine if it's a hash or a url.","name":"resource","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"The type of the resource on which you're commenting. If not supplied, will determine if it's a url or a file.","name":"resource_type","predefined":["ip","url","domain","file"],"required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum comments to fetch.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Fetch only comments before the given time.","name":"before","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves comments for a given resource.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-comments-get","outputs":[{"contentPath":"","contextPath":"VirusTotal.Comments.id","description":"ID that contains the comment (the given hash, domain, url, or ip).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.date","description":"The date of the comment in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.text","description":"The text of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.positive","description":"Number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.abuse","description":"Number of abuse votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.negative","description":"Number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.html","description":"The HTML content.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.type","description":"The type of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.id","description":"ID of the commented.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.links.self","description":"Link to the request","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The comment's ID. Can be retrieved using the vt-comments-get command.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves a comment by comment ID.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-comments-get-by-id","outputs":[{"contentPath":"","contextPath":"VirusTotal.Comments.comments.id","description":"ID of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.date","description":"The date of the comment in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.text","description":"The text of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.positive","description":"Number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.abuse","description":"Number of abuse votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.votes.negative","description":"Number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.attributes.html","description":"The HTML content.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.type","description":"The type of the comment.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Comments.comments.links.self","description":"Link to the request.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"This endpoint searches any of the following: A file hash, URL, domain, IP address, tag comments.","name":"query","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return extended data (last_analysis_results).","name":"extended_data","predefined":["true","false"],"required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of results to fetch.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search for an indicator in Virus Total.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-search","outputs":[{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.last_analysis_stats.harmless","description":"Number of engines that found the indicator to be harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.last_analysis_stats.malicious","description":"Number of engines that found the indicator to be malicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.last_analysis_stats.suspicious","description":"Number of engines that found the indicator to be suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.last_analysis_stats.undetected","description":"Number of engines that could not detect the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.last_analysis_stats.timeout","description":"Number of engines that timed out.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.reputation","description":"The indicator's reputation","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.last_modification_date","description":"The last modification date in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.total_votes.harmless","description":"Total number of harmless votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.attributes.total_votes.malicious","description":"Total number of malicious votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.type","description":"The type of the indicator (ip, domain, url, file).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.id","description":"ID of the indicator.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.SearchResults.links.self","description":"Link to the response.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Hash of the file to query. Supports MD5, SHA1, and SHA256.","name":"file","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of results to fetch.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves a behavioral relationship of the given file hash.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-file-sandbox-report","outputs":[{"contentPath":"","contextPath":"SandboxReport.attributes.analysis_date","description":"The date of the analysis in epoch format.","type":"Number"},{"contentPath":"","contextPath":"SandboxReport.attributes.behash","description":"Behash of the attribute.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.command_executions","description":"Which command were executed.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.dns_lookups.hostname","description":"Host names found in the lookup.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.dns_lookups.resolved_ips","description":"The IPs that were resolved.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_attribute_changed","description":"The file attributes that were changed.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.has_html_report","description":"Whether there is an HTML report.","type":"Boolean"},{"contentPath":"","contextPath":"SandboxReport.attributes.has_pcap","description":"Whether the IP has a PCAP file.","type":"Boolean"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.request_method","description":"The request method of the HTTP conversation.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Cache-Control","description":"The cache-control method of the response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Connection","description":"The connection of the response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Content-Length","description":"THe Content-Length of the response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Content-Type","description":"The Content-Type of the response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Pragma","description":"The pragma of the  response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Server","description":"The server of the response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_headers.Status-Line","description":"The Status-Line of the response header.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.response_status_code","description":"The response status code.","type":"Number"},{"contentPath":"","contextPath":"SandboxReport.attributes.http_conversations.url","description":"The conversation URL.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.last_modification_date","description":"Last modified data in epoch format.","type":"Number"},{"contentPath":"","contextPath":"SandboxReport.attributes.modules_loaded","description":"Loaded modules.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.mutexes_created","description":"The mutexes that were created.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.mutexes_opened","description":"The mutexes that were opened.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_created","description":"The processes that were created.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_tree.name","description":"The name of the process tree.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_tree.process_id","description":"The ID of the process.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.registry_keys_deleted","description":"Deleted registry keys.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.registry_keys_set.key","description":"Key of the registry key.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.registry_keys_set.value","description":"Value of the registry key.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.sandbox_name","description":"The name of the sandbox.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.services_started","description":"The services that were started.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.verdicts","description":"The verdicts.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.id","description":"The IP analyzed.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.links.self","description":"Link to the response.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_dropped.path","description":"Path of the file dropped.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_dropped.sha256","description":"SHA-256 hash of the dropped files.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_opened","description":"The files that were opened.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_written","description":"The files that were written.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.ip_traffic.destination_ip","description":"Destination IP in the traffic.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.ip_traffic.destination_port","description":"Destination port in the traffic.","type":"Number"},{"contentPath":"","contextPath":"SandboxReport.attributes.ip_traffic.transport_layer_protocol","description":"Transport layer protocol in the traffic.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.registry_keys_opened","description":"The registry keys that were opened.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.tags","description":"The tags of the DNS data.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_copied.destination","description":"Destination of the files copied.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.files_copied.source","description":"Source of the files copied.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.permissions_requested","description":"The permissions that where requested.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_injected","description":"The processes that were injected.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_terminated","description":"The processes that were terminated.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_tree.children.name","description":"The name of the children of the process.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_tree.children.process_id","description":"The ID of the children of the process.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.services_opened","description":"The services that were opened.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.text_highlighted","description":"The text that was highlighted.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.calls_highlighted","description":"The calls that were highlighted.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.attributes.processes_tree.children.time_offset","description":"The time offset of the children in the process.","type":"Number"},{"contentPath":"","contextPath":"SandboxReport.links.self","description":"The link to the response.","type":"String"},{"contentPath":"","contextPath":"SandboxReport.meta.count","description":"The number of objects that were found in the attributes.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"IP for which to get its DNS data.","name":"ip","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of results to fetch.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Returns passive DNS records by indicator.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-passive-dns-data","outputs":[{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.attributes.date","description":"Date of the DNS analysis in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.attributes.host_name","description":"The DNS host name.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.attributes.ip_address","description":"The DNS IP address.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.attributes.resolver","description":"The name of the resolver.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.id","description":"The ID of the resolution.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.links.self","description":"The link to the resolution.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.PassiveDNS.type","description":"The type of the resolution.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"ID of the analysis (from file-scan, file-rescan, or url-scan)","name":"id","required":true,"secret":false},{"default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return extended data (last_analysis_results).","name":"extended_data","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieves resolutions of the given IP.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-analysis-get","outputs":[{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.date","description":"Date of the analysis in epoch format.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.stats.harmless","description":"Number of engines that found the indicator to be harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.stats.malicious","description":"Number of engines that found the indicator to be malicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.stats.suspicious","description":"Number of engines that found the indicator to be suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.stats.timeout","description":"he number of engines that timed out for the indicator.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.stats.undetected","description":"Number of engines the found the indicator to be undetected.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.attributes.status","description":"Status of the analysis.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.id","description":"ID of the analysis.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.data.type","description":"Type of object (analysis).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.file_info.sha256","description":"SHA-256 hash of the file (if it is a file).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.file_info.sha1","description":"SHA-1 hash of the file (if it is a file).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.file_info.md5","description":"MD5 hash of the file (if it is a file).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.file_info.name","description":"Name of the file (if it is a file).","type":""},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.file_info.size","description":"Size of the file (if it is a file).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.url_info.id","description":"ID of the url (if it is a URL).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.meta.url_info.url","description":"The URL (if it is a URL).","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Analysis.id","description":"The analysis ID.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\"\"\"\nAn integration module for the Virus Total v3 API.\nAPI Documentation:\n    https://developers.virustotal.com/v3.0/reference\n\"\"\"\nfrom collections import defaultdict\nfrom typing import Callable\n\nfrom dateparser import parse\n\n\n\nINTEGRATION_NAME = \"VirusTotal\"\nCOMMAND_PREFIX = \"vt\"\nINTEGRATION_ENTRY_CONTEXT = \"VirusTotal\"\n\nINDICATOR_TYPE = {\n    'ip': FeedIndicatorType.IP,\n    'ip_address': FeedIndicatorType.IP,\n    'domain': FeedIndicatorType.Domain,\n    'file': FeedIndicatorType.File,\n    'url': FeedIndicatorType.URL\n}\n\n\n\"\"\" RELATIONSHIP TYPE\"\"\"\nRELATIONSHIP_TYPE = {\n    'file': {\n        'carbonblack_children': EntityRelationship.Relationships.CREATES,\n        'carbonblack_parents': EntityRelationship.Relationships.CREATED_BY,\n        'compressed_parents': EntityRelationship.Relationships.BUNDLED_IN,\n        'contacted_domains': EntityRelationship.Relationships.COMMUNICATES_WITH,\n        'contacted_ips': EntityRelationship.Relationships.COMMUNICATES_WITH,\n        'contacted_urls': EntityRelationship.Relationships.COMMUNICATES_WITH,\n        'dropped_files': EntityRelationship.Relationships.DROPPED_BY,\n        'email_attachments': EntityRelationship.Relationships.ATTACHES,\n        'email_parents': EntityRelationship.Relationships.ATTACHMENT_OF,\n        'embedded_domains': EntityRelationship.Relationships.EMBEDDED_IN,\n        'embedded_ips': EntityRelationship.Relationships.EMBEDDED_IN,\n        'embedded_urls': EntityRelationship.Relationships.EMBEDDED_IN,\n        'execution_parents': EntityRelationship.Relationships.EXECUTED_BY,\n        'itw_domains': EntityRelationship.Relationships.DOWNLOADS_FROM,\n        'itw_ips': EntityRelationship.Relationships.DOWNLOADS_FROM,\n        'overlay_children': EntityRelationship.Relationships.BUNDLES,\n        'overlay_parents': EntityRelationship.Relationships.BUNDLED_IN,\n        'pcap_children': EntityRelationship.Relationships.BUNDLES,\n        'pcap_parents': EntityRelationship.Relationships.BUNDLED_IN,\n        'pe_resource_children': EntityRelationship.Relationships.EXECUTED,\n        'pe_resource_parents': EntityRelationship.Relationships.EXECUTED_BY,\n        'similar_files': EntityRelationship.Relationships.SIMILAR_TO,\n    },\n    'domain': {\n        'cname_records': EntityRelationship.Relationships.IS_ALSO,\n        'caa_records': EntityRelationship.Relationships.RELATED_TO,\n        'communicating_files': EntityRelationship.Relationships.DROPS,\n        'downloaded_files': EntityRelationship.Relationships.DROPS,\n        'immediate_parent': EntityRelationship.Relationships.SUB_DOMAIN_OF,\n        'mx_records': EntityRelationship.Relationships.RELATED_TO,\n        'ns_records': EntityRelationship.Relationships.DROPS,\n        'parent': EntityRelationship.Relationships.SUB_DOMAIN_OF,\n        'referrer_files': EntityRelationship.Relationships.RELATED_TO,\n        'resolutions': EntityRelationship.Relationships.RESOLVED_FROM,\n        'siblings': EntityRelationship.Relationships.SUPRA_DOMAIN_OF,\n        'soa_records': EntityRelationship.Relationships.IS_ALSO,\n        'subdomains': EntityRelationship.Relationships.SUPRA_DOMAIN_OF,\n        'urls': EntityRelationship.Relationships.HOSTS,\n    }, 'ip': {\n        'communicating_files': EntityRelationship.Relationships.COMMUNICATES_WITH,\n        'downloaded_files': EntityRelationship.Relationships.DROPS,\n        'referrer_files': EntityRelationship.Relationships.RELATED_TO,\n        'resolutions': EntityRelationship.Relationships.RESOLVES_TO,\n        'urls': EntityRelationship.Relationships.RELATED_TO,\n    }, 'url': {\n        'contacted_domains': EntityRelationship.Relationships.RELATED_TO,\n        'contacted_ips': EntityRelationship.Relationships.RELATED_TO,\n        'downloaded_files': EntityRelationship.Relationships.DROPS,\n        'last_serving_ip_address': EntityRelationship.Relationships.RESOLVED_FROM,\n        'network_location': EntityRelationship.Relationships.RESOLVED_FROM,\n        'redirecting_urls': EntityRelationship.Relationships.DUPLICATE_OF,\n        'redirects_to': EntityRelationship.Relationships.DUPLICATE_OF,\n        'referrer_files': EntityRelationship.Relationships.EMBEDDED_IN,\n        'referrer_urls': EntityRelationship.Relationships.RELATED_TO,\n    }\n}\n\n\nclass Client(BaseClient):\n    \"\"\"\n    Attributes:\n        is_premium: Shall use the premium api (mostly for reputation commands)\n    \"\"\"\n    is_premium: bool\n    reliability: DBotScoreReliability\n\n    def __init__(self, params: dict):\n        self.is_premium = argToBoolean(params['is_premium_api'])\n        self.reliability = DBotScoreReliability.get_dbot_score_reliability_from_str(params['feedReliability'])\n        super().__init__(\n            'https://www.virustotal.com/api/v3/',\n            verify=not argToBoolean(params.get('insecure')),\n            proxy=argToBoolean(params.get('proxy')),\n            headers={'x-apikey': params['credentials']['password']}\n        )\n\n    # region Reputation calls\n\n    def ip(self, ip: str, relationships: str = '') -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#ip-info\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'ip_addresses/{ip}?relationships={relationships}'\n        )\n\n    def file(self, file: str, relationships: str = '') -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#file\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'files/{file}?relationships={relationships}'\n        )\n\n    def url(self, url: str, relationships: str = ''):\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#url\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'urls/{encode_url_to_base64(url)}?relationships={relationships}'\n        )\n\n    def domain(self, domain: str, relationships: str = '') -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#domain-info\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'domains/{domain}?relationships={relationships}'\n        )\n\n    # endregion\n\n    # region Comments call\n    def delete_comment(self, id_: str):\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#comment-id-delete\n        \"\"\"\n        self._http_request(\n            'DELETE',\n            f'comments/{id_}',\n            resp_type='response'\n        )\n\n    def get_ip_comments(self, ip: str, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#ip-comments-get\n        \"\"\"\n\n        return self._http_request(\n            'GET',\n            f'ip_addresses/{ip}/comments',\n            params={'limit': limit}\n        )\n\n    def get_url_comments(self, url: str, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#urls-comments-get\n\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'urls/{encode_url_to_base64(url)}/comments',\n            params={'limit': limit}\n        )\n\n    def get_hash_comments(self, file_hash: str, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-comments-get\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'files/{file_hash}/comments',\n            params={'limit': limit}\n        )\n\n    def get_domain_comments(self, domain: str, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#domains-comments-get\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'domains/{domain}/comments',\n            params={'limit': limit}\n        )\n\n    def get_comment_by_id(self, comment_id: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-comment\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'comments/{comment_id}'\n        )\n\n    def add_comment(self, suffix: str, comment: str) -\u003e dict:\n        \"\"\"Sending POST HTTP request to comment\n\n        Args:\n            suffix: suffix of the comment\n            comment: the comment itself\n\n        Returns:\n            json of response\n        \"\"\"\n        return self._http_request(\n            'POST',\n            suffix,\n            json_data={'data': {'type': 'comment', 'attributes': {'text': comment}}}\n        )\n\n    def add_comment_to_ip(self, ip: str, comment: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#ip-comments-post\n        \"\"\"\n        return self.add_comment(f'ip_addresses/{ip}/comments', comment)\n\n    def add_comment_to_url(self, url: str, comment: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#urls-comments-post\n        \"\"\"\n        return self.add_comment(f'urls/{encode_url_to_base64(url)}/comments', comment)\n\n    def add_comment_to_domain(self, domain: str, comment: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#domains-comments-post\n        \"\"\"\n        return self.add_comment(f'domains/{domain}/comments', comment)\n\n    def add_comment_to_file(self, resource: str, comment: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-comments-post\n        \"\"\"\n        return self.add_comment(f'files/{resource}/comments', comment)\n\n    # endregion\n\n    # region Scan calls\n    def file_rescan(self, file_hash: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-analyse\n        \"\"\"\n        return self._http_request(\n            'POST',\n            f'/files/{file_hash}/analyse'\n        )\n\n    def file_scan(self, file_path: str, /, upload_url: Optional[str]) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-scan\n        \"\"\"\n        response: requests.Response\n        with open(file_path, 'rb') as file:\n            if upload_url:\n                response = self._http_request(\n                    'POST',\n                    full_url=upload_url,\n                    files={'file': file},\n                    resp_type='response'\n                )\n            else:\n                response = self._http_request(\n                    'POST',\n                    url_suffix='/files',\n                    files={'file': file},\n                    resp_type='response'\n                )\n        demisto.debug(\n            f'scan_file response:\\n'\n            f'{str(response.status_code)=}, {str(response.headers)=}, {str(response.content)}'\n        )\n        return response.json()\n\n    def get_upload_url(self) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-upload-url\n        \"\"\"\n        return self._http_request(\n            'GET',\n            'files/upload_url'\n        )\n\n    def url_scan(self, url: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#urls\n        \"\"\"\n        return self._http_request(\n            'POST',\n            'urls',\n            data={'url': url}\n        )\n\n    # endregion\n\n    def file_sandbox_report(self, file_hash: dict, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-relationships\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'files/{file_hash}/behaviours',\n            params={'limit': limit}\n        )\n\n    def passive_dns_data(self, ip: str, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#ip-relationships\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'ip_addresses/{ip}/resolutions',\n            params={'limit': limit}\n        )\n\n    def search(self, query: str, limit: int) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#search-1\n        \"\"\"\n        return self._http_request(\n            'GET',\n            'search',\n            params={'query': query, 'limit': limit}\n        )\n\n    def get_analysis(self, analysis_id: str) -\u003e dict:\n        \"\"\"\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#analysis\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'/analyses/{analysis_id}'\n        )\n\n    # region Premium commands\n    def get_relationship(self, indicator: str, indicator_type: str, relationship: str) -\u003e dict:\n        \"\"\"\n        Args:\n            indicator: a url encoded in base64 or domain.\n            indicator_type: urls or domains\n            relationship: a relationship to search for\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#urls-relationships\n            https://developers.virustotal.com/v3.0/reference#domains-relationships\n            https://developers.virustotal.com/v3.0/reference#ip-relationships\n        \"\"\"\n\n        return self._http_request(\n            'GET',\n            urljoin(urljoin(indicator_type, indicator), relationship)\n        )\n\n    def get_domain_relationships(self, domain: str, relationship: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_relationship\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#domains-relationships\n        \"\"\"\n        return self.get_relationship(domain, 'domains', relationship)\n\n    def get_domain_communicating_files(self, domain: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_domain_relationships\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#domains-relationships\n        \"\"\"\n        return self.get_domain_relationships(\n            domain,\n            'communicating_files'\n        )\n\n    def get_domain_downloaded_files(self, domain: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_domain_relationships\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#domains-relationships\n        \"\"\"\n        return self.get_domain_relationships(\n            domain,\n            'downloaded_files'\n        )\n\n    def get_domain_referrer_files(self, domain: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_domain_relationships\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#domains-relationships\n        \"\"\"\n        return self.get_domain_relationships(\n            domain,\n            'referrer_files'\n        )\n\n    def get_url_relationships(self, url: str, relationship: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_relationship\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_relationship(encode_url_to_base64(url), 'urls', relationship)\n\n    def get_url_communicating_files(self, url: str) -\u003e dict:\n        \"\"\"\n        Wrapper of url_relationships\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_url_relationships(\n            url,\n            'communicating_files'\n        )\n\n    def get_url_downloaded_files(self, url: str) -\u003e dict:\n        \"\"\"\n        Wrapper of url_relationships\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_url_relationships(\n            url,\n            'downloaded_files'\n        )\n\n    def get_url_referrer_files(self, url: str) -\u003e dict:\n        \"\"\"\n        Wrapper of url_relationships\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_url_relationships(\n            url,\n            'referrer_files'\n        )\n\n    def get_ip_relationships(self, ip: str, relationship: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_relationship\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_relationship(ip, 'ip_addresses', relationship)\n\n    def get_ip_communicating_files(self, ip: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_ip_relationships\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_ip_relationships(\n            ip,\n            'communicating_files'\n        )\n\n    def get_ip_downloaded_files(self, ip: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_ip_relationships\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_ip_relationships(\n            ip,\n            'downloaded_files'\n        )\n\n    def get_ip_referrer_files(self, ip: str) -\u003e dict:\n        \"\"\"\n        Wrapper of get_ip_relationships\n\n        See Also:\n                https://developers.virustotal.com/v3.0/reference#urls-relationships\n        \"\"\"\n        return self.get_ip_relationships(\n            ip,\n            'referrer_files'\n        )\n    # endregion\n\n\nclass ScoreCalculator:\n    \"\"\"\n    Calculating DBotScore of files, ip, etc.\n    \"\"\"\n    logs: List[str]\n\n    # General\n    trusted_vendors_threshold: int\n    trusted_vendors: List[str]\n\n    # IP\n    ip_threshold: int\n    url_threshold: int\n\n    # Domain\n    domain_threshold: int\n    domain_popularity_ranking: int\n\n    # File\n    file_threshold: int\n    sigma_ids_threshold: int\n    crowdsourced_yara_rules_enabled: bool\n    crowdsourced_yara_rules_threshold: int\n    relationship_threshold: int\n\n    def __init__(self, params: dict):\n        self.trusted_vendors = argToList(params['preferredVendors'])\n        trusted_vendors_threshold = arg_to_number_must_int(\n            params['preferredVendorsThreshold'],\n            arg_name='Preferred Vendor Threshold',\n            required=True\n        )\n        assert isinstance(trusted_vendors_threshold, int)\n        self.trusted_vendors_threshold = arg_to_number_must_int(\n            params['preferredVendorsThreshold'],\n            arg_name='Preferred Vendor Threshold',\n            required=True\n        )\n        self.file_threshold = arg_to_number_must_int(\n            params['fileThreshold'],\n            arg_name='File Threshold',\n            required=True\n        )\n        self.ip_threshold = arg_to_number_must_int(\n            params['ipThreshold'],\n            arg_name='IP Threshold',\n            required=True\n        )\n        self.url_threshold = arg_to_number_must_int(\n            params['urlThreshold'],\n            arg_name='URL Threshold',\n            required=True\n        )\n        self.domain_threshold = arg_to_number_must_int(\n            params['domainThreshold'],\n            arg_name='Domain Threshold',\n            required=True\n        )\n        self.crowdsourced_yara_rules_enabled = argToBoolean(params['crowdsourced_yara_rules_enabled'])\n        self.crowdsourced_yara_rules_threshold = arg_to_number_must_int(params['yaraRulesThreshold'])\n        self.sigma_ids_threshold = arg_to_number_must_int(\n            params['SigmaIDSThreshold'],\n            arg_name='Sigma and Intrusion Detection Rules Threshold',\n            required=True\n        )\n        self.domain_popularity_ranking = arg_to_number_must_int(\n            params['domain_popularity_ranking'],\n            arg_name='Domain Popularity Ranking Threshold',\n            required=True\n        )\n        self.relationship_threshold = arg_to_number_must_int(\n            params['relationship_threshold'],\n            arg_name='Relationship Files Threshold',\n            required=True\n        )\n        self.logs = list()\n\n    def get_logs(self) -\u003e str:\n        \"\"\"Returns the log string\n        \"\"\"\n        return '\\n'.join(self.logs)\n\n    def is_suspicious_by_threshold(self, analysis_stats: dict, threshold: int) -\u003e bool:\n        \"\"\"Determines whatever the indicator suspicious by threshold.\n        if number of malicious \u003e= threshold /2 ||\n        number of suspicious \u003e= threshold -\u003e Suspicious\n\n        Args:\n            analysis_stats: the analysis stats from the response\n            threshold: the threshold of the indicator type.\n\n        Returns:\n            Whatever the indicator is suspicious by threshold.\n        \"\"\"\n        if analysis_stats.get('malicious', 0) \u003e= threshold / 2:\n            self.logs.append(\n                f'Found at least suspicious by {(analysis_stats.get(\"malicious\", 0) \u003e= threshold / 2)=}. '\n            )\n            return True\n        elif analysis_stats.get('suspicious', 0) \u003e= threshold:\n            self.logs.append(\n                f'Found at least suspicious by {(analysis_stats.get(\"suspicious\", 0) \u003e= threshold)=}. '\n            )\n            return True\n        return False\n\n    def is_good_by_popularity_ranks(self, popularity_ranks: dict) -\u003e Optional[bool]:\n        \"\"\"Analyzing popularity ranks.\n        if popularity ranks exist and average rank is \u003c threshold -\u003e Good\n        Args:\n            popularity_ranks: the popularity ranks object from response\n\n        Returns:\n            Whatever the indicator is good or not by popularity rank.\n        \"\"\"\n        if popularity_ranks:\n            self.logs.append(\n                'Found popularity ranks. Analyzing. '\n            )\n            average = sum(rank.get('rank', 0) for rank in popularity_ranks.values()) / len(popularity_ranks)\n            self.logs.append(\n                f'The average of the ranks is {average} and the threshold is {self.domain_popularity_ranking}'\n            )\n            if average \u003c= self.domain_popularity_ranking:\n                self.logs.append('Indicator is good by popularity ranks.')\n                return True\n            else:\n                self.logs.append('Indicator might not be good by it\\'s popularity ranks.')\n                return False\n        self.logs.append('Could not determine rank by popularity, No popularity ranks data.')\n        return None\n\n    def is_suspicious_by_rules(self, file_response: dict) -\u003e bool:\n        \"\"\"Check if indicator is suspicious by rules analysis.\n\n        crowdsourced_yara_results \u003e= yara_rules_threshold ||\n        sigma_analysis_stats.high + critical \u003e= sigma_id_threshold ||\n         crowdsourced_ids_stats.high + critical \u003e= sigma_id_threshold -\u003e suspicious\n\n        Args:\n            file_response: the file response\n\n        Returns:\n            Whatever the file is suspicious by rules analysis.\n        \"\"\"\n        data = file_response.get('data', {})\n        if self.crowdsourced_yara_rules_enabled:\n            self.logs.append(\n                'Crowdsourced Yara Rules analyzing enabled. '\n            )\n            if (total_yara_rules := len(\n                    data.get('crowdsourced_yara_results', []))) \u003e= self.crowdsourced_yara_rules_threshold:\n                self.logs.append(\n                    'Found malicious by finding more Crowdsourced Yara Rules than threshold. \\n'\n                    f'{total_yara_rules=} \u003e= {self.crowdsourced_yara_rules_threshold=}'\n                )\n                return True\n            if sigma_rules := data.get('sigma_analysis_stats'):\n                self.logs.append(\n                    'Found sigma rules, analyzing. '\n                )\n                sigma_high, sigma_critical = sigma_rules.get('high', 0), sigma_rules.get('critical', 0)\n                if (sigma_high + sigma_critical) \u003e= self.sigma_ids_threshold:\n                    self.logs.append(\n                        f'Found malicious, {(sigma_high + sigma_critical)=} \u003e= {self.sigma_ids_threshold=}. '\n                    )\n                    return True\n                else:\n                    self.logs.append(\n                        'Not found malicious by sigma. '\n                    )\n            else:\n                self.logs.append(\n                    'Not found sigma analysis. Skipping. '\n                )\n            if crowdsourced_ids_stats := data.get('crowdsourced_ids_stats'):\n                self.logs.append(\n                    'Found crowdsourced IDS analysis, analyzing. '\n                )\n                ids_high, ids_critical = crowdsourced_ids_stats.get('high'), crowdsourced_ids_stats.get('critical')\n                if (ids_high + ids_critical) \u003e= self.sigma_ids_threshold:\n                    self.logs.append(\n                        f'Found malicious, {((ids_high + ids_critical) \u003e= self.sigma_ids_threshold)=}. '\n                    )\n                    return True\n                else:\n                    self.logs.append(\n                        'Not found malicious by sigma. '\n                    )\n            else:\n                self.logs.append(\n                    'Not found crowdsourced IDS analysis. Skipping. '\n                )\n        else:\n            self.logs.append(\n                'Crowdsourced Yara Rules analyzing is not enabled. Skipping. '\n            )\n        return False\n\n    def is_preferred_vendors_pass_malicious(self, analysis_results: dict) -\u003e bool:\n        \"\"\"Is the indicator counts as malicious by predefined malicious vendors.\n        trusted_vendors.malicious \u003e= trusted_vendors_threshold -\u003e Malicious\n        The function takes only the latest 20 results.\n\n        Args:\n            analysis_results: The results of the analysis.\n\n        Returns:\n            Whatever the indicator is malicious or not by preferred vendors.\n        \"\"\"\n        recent = {key: analysis_results[key] for key in list(analysis_results.keys())[:20]}\n        preferred_vendor_scores = {\n            vendor: recent[vendor] for vendor in self.trusted_vendors if vendor in recent\n        }\n        malicious_trusted_vendors = [\n            item for item in preferred_vendor_scores.values() if item.get('category') == 'malicious'\n        ]\n        if len(malicious_trusted_vendors) \u003e= self.trusted_vendors_threshold:\n            self.logs.append(\n                f'{len(malicious_trusted_vendors)} trusted vendors found the hash malicious. \\n'\n                f'The trusted vendors threshold is {self.trusted_vendors_threshold}. \\n'\n                f'Malicious check: {(len(malicious_trusted_vendors) \u003e= self.trusted_vendors_threshold)=}. '\n            )\n            return True\n        else:\n            self.logs.append(\n                f'Those preferred vendors found the hash malicious: {malicious_trusted_vendors}. '\n                f'They do not pass the threshold {self.trusted_vendors_threshold}. '\n            )\n            return False\n\n    def is_malicious_by_threshold(self, analysis_stats: dict, threshold: int) -\u003e bool:\n        \"\"\"Determines whatever the indicator malicious by threshold.\n        if number of malicious \u003e= threshold -\u003c Malicious\n\n        Args:\n            analysis_stats: the analysis stats from the response\n            threshold: the threshold of the indicator type.\n\n        Returns:\n            Whatever the indicator is malicious by threshold.\n        \"\"\"\n        total_malicious = analysis_stats.get('malicious', 0)\n        self.logs.append(\n            f'{total_malicious} vendors found malicious. \\n'\n            f'The malicious threshold is {threshold}. '\n        )\n        if total_malicious \u003e= threshold:\n            self.logs.append(f'Found as malicious: {total_malicious=} \u003e= {threshold=}. ')\n            return True\n        self.logs.append(f'Not found malicious by threshold: {total_malicious=} \u003e= {threshold=}. ')\n        return False\n\n    def score_by_threshold(self, analysis_stats: dict, threshold: int) -\u003e int:\n        \"\"\"Determines the DBOTSCORE of the indicator by threshold only.\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        if self.is_malicious_by_threshold(analysis_stats, threshold):\n            return Common.DBotScore.BAD\n        if self.is_suspicious_by_threshold(analysis_stats, threshold):\n            return Common.DBotScore.SUSPICIOUS\n        return Common.DBotScore.GOOD\n\n    def score_by_results_and_stats(self, indicator: str, raw_response: dict, threshold: int) -\u003e int:\n        \"\"\"Determines indicator score by popularity preferred vendors and threshold.\n\n        Args:\n            indicator: The indicator we analyzing.\n            raw_response: The raw response from API.\n            threshold: Threshold of the indicator.\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        self.logs.append(f'Basic analyzing of \"{indicator}\"')\n        data = raw_response.get('data', {})\n        attributes = data['attributes']\n        popularity_ranks = attributes.get('popularity_ranks')\n        last_analysis_results = attributes['last_analysis_results']\n        last_analysis_stats = attributes['last_analysis_stats']\n        if self.is_good_by_popularity_ranks(popularity_ranks):\n            return Common.DBotScore.GOOD\n        if self.is_preferred_vendors_pass_malicious(last_analysis_results):\n            return Common.DBotScore.BAD\n        return self.score_by_threshold(last_analysis_stats, threshold)\n\n    def file_score(self, given_hash: str, raw_response: dict) -\u003e int:\n        \"\"\"Analyzing file score.\n        The next parameters are analyzed:\n            Preferred vendors\n            Score by threshold\n            Score by rules analysis (YARA, IDS and Sigma, if presents)\n\n        Args:\n            given_hash: The hash we're analyzing\n            raw_response: The response from the API\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        self.logs.append(f'Analysing file hash {given_hash}. ')\n        data = raw_response.get('data', {})\n        attributes = data.get('attributes', {})\n        analysis_results = attributes.get('last_analysis_results', {})\n        analysis_stats = attributes.get('last_analysis_stats', {})\n\n        # Trusted vendors\n        if self.is_preferred_vendors_pass_malicious(analysis_results):\n            return Common.DBotScore.BAD\n\n        score = self.score_by_threshold(analysis_stats, self.file_threshold)\n        if score == Common.DBotScore.BAD:\n            return Common.DBotScore.BAD\n\n        suspicious_by_rules = self.is_suspicious_by_rules(raw_response)\n        if score == Common.DBotScore.SUSPICIOUS and suspicious_by_rules:\n            self.logs.append(\n                f'Hash: \"{given_hash}\" was found malicious as the hash is suspicious both by threshold and rules '\n                f'analysis.'\n            )\n            return Common.DBotScore.BAD\n        elif suspicious_by_rules:\n            self.logs.append(\n                f'Hash: \"{given_hash}\" was found suspicious by rules analysis.'\n            )\n            return Common.DBotScore.SUSPICIOUS\n        elif score == Common.DBotScore.SUSPICIOUS:\n            self.logs.append(\n                f'Hash: \"{given_hash}\" was found suspicious by passing the threshold analysis.'\n            )\n            return Common.DBotScore.SUSPICIOUS\n        self.logs.append(\n            f'Hash: \"{given_hash}\" was found good'\n        )\n        return Common.DBotScore.GOOD  # Nothing caught\n\n    def ip_score(self, ip: str, raw_response: dict) -\u003e int:\n        \"\"\"Analyzing IP score.\n        The next parameters are analyzed:\n            Preferred vendors\n            Score by threshold\n            Score by rules analysis (YARA, IDS and Sigma, if presents)\n\n        Args:\n            ip: The hash we're analyzing\n            raw_response: The response from the API\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        return self.score_by_results_and_stats(\n            ip, raw_response, self.ip_threshold\n        )\n\n    def url_score(self, indicator: str, raw_response: dict) -\u003e int:\n        \"\"\"Determines indicator score by popularity preferred vendors and threshold.\n\n        Args:\n            indicator: The indicator we analyzing.\n            raw_response: The raw response from API.\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        return self.score_by_results_and_stats(indicator, raw_response, self.url_threshold)\n\n    def domain_score(self, indicator: str, raw_response: dict) -\u003e int:\n        \"\"\"Determines indicator score by popularity preferred vendors and threshold.\n\n        Args:\n            indicator: The indicator we analyzing.\n            raw_response: The raw response from API.\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        return self.score_by_results_and_stats(indicator, raw_response, self.domain_threshold)\n\n    # region Premium analysis\n    def is_malicious_or_suspicious_by_relationship_files(self, relationship_files_response: dict, lookback=20) -\u003e int:\n        \"\"\"Checks maliciousness of indicator on relationship files. Look on the recent 20 results returned.\n            if (number of relationship files that are malicious \u003e threshold) -\u003e Bad\n            if (number of relationship files that are malicious \u003e threshold / 2) -\u003e suspicious\n            else good\n        Args:\n            relationship_files_response: The raw_response of the relationship call\n            lookback: analysing only the latest results. Defualt is 20\n\n        Returns:\n            DBotScore of the indicator. Can by Common.DBotScore.BAD, Common.DBotScore.SUSPICIOUS or\n            Common.DBotScore.GOOD\n        \"\"\"\n        files = relationship_files_response.get('data', [])[:lookback]  # lookback on recent 20 results. By design\n        total_malicious = 0\n        for file in files:\n            if file_hash := file.get('sha256', file.get('sha1', file.get('md5', file.get('ssdeep')))):\n                if self.file_score(file_hash, files) == Common.DBotScore.BAD:\n                    total_malicious += 1\n\n        if total_malicious \u003e= self.url_threshold:\n            self.logs.append(\n                f'Found malicious by relationship files. {total_malicious=} \u003e= {self.relationship_threshold}'\n            )\n            return Common.DBotScore.BAD\n        if total_malicious \u003e= self.url_threshold / 2:\n            self.logs.append(\n                f'Found suspicious by relationship files. {total_malicious=} \u003e= {self.relationship_threshold}'\n            )\n            return Common.DBotScore.SUSPICIOUS\n        self.logs.append(\n            f'Found safe by relationship files. {total_malicious=} \u003e= {self.relationship_threshold}'\n        )\n        return Common.DBotScore.GOOD\n\n    def analyze_premium_scores(\n            self,\n            indicator: str,\n            base_score: int,\n            relationship_functions: List[Callable[[str], dict]]\n    ) -\u003e int:\n        \"\"\"Analyzing with premium subscription.\n\n        Args:\n            indicator: The indicator to check\n            base_score: DBotScore got by base check\n            relationship_functions: function to get relationship from (found in client)\n\n        Returns:\n            DBOT Score:\n            If one of the relationship files is Bad, returns Bad\n            if one of the relationship files is suspicious and the base_score is suspicious, returns BAD\n            If one of the relationship files is suspicious and base_score is not, returns Suspicious\n            else return GOOD\n        \"\"\"\n        is_suspicious = False\n        for func in relationship_functions:\n            self.logs.append(f'Analyzing by {func.__name__}')\n            premium_score = self.is_malicious_or_suspicious_by_relationship_files(\n                func(indicator)\n            )\n            if premium_score == Common.DBotScore.BAD:\n                return premium_score\n            if premium_score == Common.DBotScore.SUSPICIOUS and base_score == Common.DBotScore.SUSPICIOUS:\n                self.logs.append('Found malicious!')\n                return premium_score\n            if premium_score == Common.DBotScore.SUSPICIOUS:\n                self.logs.append('Found Suspicious entry, keep searching for malicious')\n                is_suspicious = True\n        if is_suspicious or base_score == Common.DBotScore.SUSPICIOUS:\n            self.logs.append('Found Suspicious')\n            return Common.DBotScore.SUSPICIOUS\n        return Common.DBotScore.GOOD\n\n    def analyze_premium_url_score(self, client: Client, url: str, base_score: int) -\u003e int:\n        \"\"\"Analyzing premium subscription.\n\n        Args:\n            client: a client with relationship commands.\n            url: the url to check\n            base_score: the base score from basic analysis\n\n        Returns:\n            score calculated by relationship.\n\n        \"\"\"\n        return self.analyze_premium_scores(\n            url,\n            base_score,\n            [\n                client.get_url_communicating_files,\n                client.get_url_downloaded_files,\n                client.get_url_referrer_files\n            ]\n        )\n\n    def analyze_premium_domain_score(self, client: Client, domain: str, base_score: int) -\u003e int:\n        \"\"\"Analyzing premium subscription.\n\n        Args:\n            client: a client with relationship commands.\n            domain: the domain to check\n            base_score: the base score from basic analysis\n\n        Returns:\n            score calculated by relationship.\n\n        \"\"\"\n        return self.analyze_premium_scores(\n            domain,\n            base_score,\n            [\n                client.get_domain_communicating_files,\n                client.get_url_downloaded_files,\n                client.get_url_referrer_files\n            ]\n        )\n\n    def analyze_premium_ip_score(self, client: Client, ip: str, base_score: int) -\u003e int:\n        \"\"\"Analyzing premium subscription.\n\n        Args:\n            client: a client with relationship commands.\n            ip: the ip to check\n            base_score: the base score from basic analysis\n\n        Returns:\n            score calculated by relationship.\n\n        \"\"\"\n        return self.analyze_premium_scores(\n            ip,\n            base_score,\n            [\n                client.get_ip_communicating_files,\n                client.get_ip_downloaded_files,\n                client.get_ip_referrer_files\n            ]\n        )\n    # endregion\n\n\n# region Helper functions\n\ndef create_relationships(entity_a: str, entity_a_type: str, relationships_response: dict, reliability):\n    \"\"\"\n    Create a list of entityRelationship object from the api result\n    entity_a: (str) - source of the relationship\n    entity_a_type: (str) - type of the source of the relationship\n    relationships_response: (dict) - the relationship response from the api\n    reliability: The reliability of the source.\n\n    Returns a list of EntityRelationship objects.\n    \"\"\"\n    relationships_list: List[EntityRelationship] = []\n    for relationship_type, relationship_type_raw in relationships_response.items():\n\n        relationships_data = relationship_type_raw.get('data', [])\n        if relationships_data:\n            if isinstance(relationships_data, dict):\n                relationships_data = [relationships_data]\n\n            for relation in relationships_data:\n                name = RELATIONSHIP_TYPE.get(entity_a_type.lower(), {}).get(relationship_type)\n                entity_b = relation.get('id', '')\n                entity_b_type = INDICATOR_TYPE.get(relation.get('type', '').lower())\n                if entity_b and entity_b_type and name:\n                    if entity_b_type == FeedIndicatorType.URL:\n                        entity_b = dict_safe_get(relation, ['context_attributes', 'url'])\n                    relationships_list.append(\n                        EntityRelationship(entity_a=entity_a, entity_a_type=entity_a_type, name=name,\n                                           entity_b=entity_b, entity_b_type=entity_b_type, source_reliability=reliability,\n                                           brand=INTEGRATION_NAME))\n                else:\n                    demisto.info(\n                        f\"WARNING: Relationships will not be created to entity A {entity_a} with relationship name {name}\")\n    return relationships_list\n\n\ndef arg_to_number_must_int(arg: Any, arg_name: Optional[str] = None, required: bool = False):\n    \"\"\"Wrapper of arg_to_number that must return int\n    For mypy fixes.\n    \"\"\"\n    arg_num = arg_to_number(arg, arg_name, required)\n    assert isinstance(arg_num, int)\n    return arg_num\n\n\ndef epoch_to_timestamp(epoch: Union[int, str]) -\u003e Optional[str]:\n    \"\"\"Converts epoch timestamp to a string.\n\n    Args:\n        epoch: Time to convert\n\n    Returns:\n        A formatted string if succeeded. if not, returns None.\n    \"\"\"\n    try:\n        return datetime.utcfromtimestamp(int(epoch)).strftime(\"%Y-%m-%d %H:%M:%SZ\")\n    except (TypeError, OSError, ValueError):\n        return None\n\n\ndef decrease_data_size(data: Union[dict, list]) -\u003e Union[dict, list]:\n    \"\"\" Minifying data size.\n\n    Args:\n        data: the data object from raw response\n\n    Returns:\n        the same data without:\n            data['attributes']['last_analysis_results']\n            data['attributes']['pe_info']\n            data['attributes']['crowdsourced_ids_results']\n            data['attributes']['autostart_locations']\n            data['attributes']['sandbox_verdicts']\n            data['attributes']['sigma_analysis_summary']\n    \"\"\"\n    attributes_to_remove = [\n        'last_analysis_results', 'pe_info', 'crowdsourced_ids_results', 'autostart_locations', 'sandbox_verdicts',\n        'sigma_analysis_summary'\n    ]\n    if isinstance(data, list):\n        data = [decrease_data_size(item) for item in data]\n    else:\n        for attribute in attributes_to_remove:\n            try:\n                del data['attributes'][attribute]\n            except KeyError:\n                pass\n    return data\n\n\ndef build_domain_output(\n        client: Client,\n        score_calculator: ScoreCalculator,\n        domain: str,\n        raw_response: dict,\n        extended_data: bool):\n    data = raw_response.get('data', {})\n    attributes = data.get('attributes', {})\n    relationships_response = data.get('relationships', {})\n    whois: defaultdict = get_whois(attributes.get('whois', ''))\n    score = score_calculator.domain_score(domain, raw_response)\n    if score != Common.DBotScore.BAD and client.is_premium:\n        score = score_calculator.analyze_premium_domain_score(client, domain, score)\n    logs = score_calculator.get_logs()\n    demisto.debug(logs)\n    relationships_list = create_relationships(entity_a=domain, entity_a_type=FeedIndicatorType.Domain,\n                                              relationships_response=relationships_response,\n                                              reliability=client.reliability)\n    domain_indicator = Common.Domain(\n        domain=domain,\n        name_servers=whois['Name Server'],\n        creation_date=whois['Creation Date'],\n        updated_date=whois['Updated Date'],\n        expiration_date=whois['Registry Expiry Date'],\n        admin_name=whois['Admin Organization'],\n        admin_email=whois['Admin Email'],\n        admin_country=whois['Admin Country'],\n        registrant_email=whois['Registrant Email'],\n        registrant_country=whois['Registrant Country'],\n        registrar_name=whois['Registrar'],\n        registrar_abuse_email=whois['Registrar Abuse Contact Email'],\n        registrar_abuse_phone=whois['Registrar Abuse Contact Phone'],\n        dbot_score=Common.DBotScore(\n            domain,\n            DBotScoreType.DOMAIN,\n            INTEGRATION_NAME,\n            score=score,\n            malicious_description=logs,\n            reliability=client.reliability\n        ),\n        relationships=relationships_list\n    )\n    if not extended_data:\n        data = decrease_data_size(data)\n\n    attributes = data.get('attributes', {})\n    return CommandResults(\n        outputs_prefix=f'{INTEGRATION_ENTRY_CONTEXT}.Domain',\n        outputs_key_field='id',\n        indicator=domain_indicator,\n        readable_output=tableToMarkdown(\n            f'Domain data of {domain}',\n            {\n                'last_modified': epoch_to_timestamp(attributes.get('last_modification_date')),\n                **data,\n                **whois,\n                **attributes\n            },\n            headers=[\n                'id',\n                'Registrant Country',\n                'last_modified',\n                'last_analysis_stats'\n            ],\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response,\n        relationships=relationships_list\n    )\n\n\ndef build_url_output(\n        client: Client,\n        score_calculator: ScoreCalculator,\n        url: str,\n        raw_response: dict,\n        extended_data: bool\n) -\u003e CommandResults:\n    data = raw_response.get('data', {})\n    score = score_calculator.url_score(url, raw_response)\n    if score != Common.DBotScore.BAD and client.is_premium:\n        score = score_calculator.analyze_premium_url_score(client, url, score)\n    logs = score_calculator.get_logs()\n    demisto.debug(logs)\n    # creating readable output\n    attributes = data.get('attributes', {})\n    last_analysis_stats = attributes.get('last_analysis_stats', {})\n    relationships_response = data.get('relationships', {})\n    positive_detections = last_analysis_stats.get('malicious', 0)\n    detection_engines = sum(last_analysis_stats.values())\n    relationships_list = create_relationships(entity_a=url, entity_a_type=FeedIndicatorType.URL,\n                                              relationships_response=relationships_response,\n                                              reliability=client.reliability)\n    url_indicator = Common.URL(\n        url,\n        category=attributes.get('categories'),\n        detection_engines=detection_engines,\n        positive_detections=positive_detections,\n        relationships=relationships_list,\n        dbot_score=Common.DBotScore(\n            url,\n            DBotScoreType.URL,\n            INTEGRATION_NAME,\n            score=score,\n            reliability=client.reliability,\n            malicious_description=logs\n        )\n    )\n    if not extended_data:\n        data = decrease_data_size(data)\n    return CommandResults(\n        outputs_prefix=f'{INTEGRATION_ENTRY_CONTEXT}.URL',\n        outputs_key_field='id',\n        indicator=url_indicator,\n        readable_output=tableToMarkdown(\n            f'URL data of \"{url}\"',\n            {\n                **data,\n                **data.get('attributes', {}),\n                'url': url,\n                'positives': f'{positive_detections}/{detection_engines}',\n                'last_modified': epoch_to_timestamp(attributes.get('last_modification_date'))\n            },\n            headers=[\n                'url',\n                'title',\n                'last_modified',\n                'has_content',\n                'last_http_response_content_sha256',\n                'positives',\n                'reputation'\n            ],\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response,\n        relationships=relationships_list\n    )\n\n\ndef build_ip_output(client: Client, score_calculator: ScoreCalculator, ip: str, raw_response: dict,\n                    extended_data: bool) -\u003e CommandResults:\n    score = score_calculator.ip_score(ip, raw_response)\n    if score != Common.DBotScore.BAD and client.is_premium:\n        score = score_calculator.analyze_premium_ip_score(client, ip, score)\n    logs = score_calculator.get_logs()\n    demisto.debug(logs)\n    data = raw_response.get('data', {})\n    attributes = data.get('attributes', {})\n    relationships_response = data.get('relationships', {})\n    last_analysis_stats = attributes.get('last_analysis_stats')\n    positive_engines = last_analysis_stats.get('malicious', 0)\n    detection_engines = sum(last_analysis_stats.values())\n    relationships_list = create_relationships(entity_a=ip, entity_a_type=FeedIndicatorType.IP,\n                                              relationships_response=relationships_response,\n                                              reliability=client.reliability)\n    ip_indicator = Common.IP(\n        ip,\n        asn=attributes.get('asn'),\n        geo_country=attributes.get('country'),\n        detection_engines=detection_engines,\n        positive_engines=positive_engines,\n        relationships=relationships_list,\n        dbot_score=Common.DBotScore(\n            ip,\n            DBotScoreType.IP,\n            INTEGRATION_NAME,\n            score=score,\n            malicious_description=logs,\n            reliability=client.reliability\n        )\n    )\n    if not extended_data:\n        data = decrease_data_size(data)\n    return CommandResults(\n        outputs_prefix=f'{INTEGRATION_ENTRY_CONTEXT}.IP',\n        outputs_key_field='id',\n        indicator=ip_indicator,\n        readable_output=tableToMarkdown(\n            f'IP reputation of {ip}:',\n            {\n                **data,\n                **attributes,\n                'last_modified': epoch_to_timestamp(attributes.get('last_modification_date')),\n                'positives': f'{positive_engines}/{detection_engines}'\n            },\n            headers=['id', 'network', 'country', 'last_modified', 'reputation', 'positives'],\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response,\n        relationships=relationships_list\n    )\n\n\ndef build_file_output(\n        client: Client,\n        score_calculator: ScoreCalculator,\n        file_hash: str,\n        raw_response: dict,\n        extended_data: bool\n) -\u003e CommandResults:\n    data = raw_response.get('data', {})\n    attributes = data.get('attributes')\n    relationships_response = data.get('relationships', {})\n    score = score_calculator.file_score(file_hash, raw_response)\n    logs = score_calculator.get_logs()\n    demisto.debug(logs)\n    signature_info = attributes.get('signature_info', {})\n    exiftool = attributes.get('exiftool', {})\n    relationships_list = create_relationships(entity_a=file_hash, entity_a_type=FeedIndicatorType.File,\n                                              relationships_response=relationships_response,\n                                              reliability=client.reliability)\n    file_indicator = Common.File(\n        dbot_score=Common.DBotScore(\n            file_hash,\n            DBotScoreType.FILE,\n            integration_name=INTEGRATION_NAME,\n            score=score,\n            malicious_description=logs,\n            reliability=client.reliability\n        ),\n        name=exiftool.get('OriginalFileName'),\n        size=attributes.get('size'),\n        sha1=attributes.get('sha1'),\n        sha256=attributes.get('sha256'),\n        file_type=exiftool.get('MIMEType'),\n        md5=attributes.get('md5'),\n        ssdeep=attributes.get('ssdeep'),\n        extension=exiftool.get('FileTypeExtension'),\n        company=exiftool.get('CompanyName'),\n        product_name=exiftool.get('ProductName'),\n        tags=attributes.get('tags'),\n        signature=Common.FileSignature(\n            authentihash=attributes.get('authentihash'),\n            copyright=signature_info.get('copyright'),\n            file_version=signature_info.get('file version'),\n            description=signature_info.get('description'),\n            internal_name=signature_info.get('internal name'),\n            original_name=signature_info.get('original name')\n        ),\n        relationships=relationships_list\n    )\n    if not extended_data:\n        data = decrease_data_size(data)\n    last_analysis_stats = attributes.get(\"last_analysis_stats\", {})\n    malicious = last_analysis_stats.get('malicious', 0)\n    total = sum(last_analysis_stats.values())\n    return CommandResults(\n        outputs_prefix=f'{INTEGRATION_ENTRY_CONTEXT}.File',\n        outputs_key_field='id',\n        indicator=file_indicator,\n        readable_output=tableToMarkdown(\n            f'Results of file hash {file_hash}',\n            {\n                **data,\n                **attributes,\n                'positives': f'{malicious}/{total}',\n                'creation date': epoch_to_timestamp(attributes.get('creation_date')),\n                'last modified': epoch_to_timestamp(attributes.get('last_modification_date', 0))\n            },\n            headers=[\n                'sha1', 'sha256', 'md5',\n                'meaningful_name', 'type_extension', 'creation date',\n                'last modified', 'reputation', 'positives'\n            ],\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response,\n        relationships=relationships_list\n    )\n\n\ndef get_whois(whois_string: str) -\u003e defaultdict:\n    \"\"\"Gets a WHOIS string and returns a parsed dict of the WHOIS String.\n\n    Args:\n        whois_string: whois from domain api call\n\n    Returns:\n        A parsed whois\n\n    Examples:\n        \u003e\u003e\u003e get_whois('key1:value\\\\nkey2:value2')\n        defaultdict({'key1': 'value', 'key2': 'value2'})\n    \"\"\"\n    whois: defaultdict = defaultdict(lambda: None)\n    for line in whois_string.splitlines():\n        key: str\n        value: str\n        try:\n            key, value = line.split(sep=':', maxsplit=1)\n        except ValueError:\n            demisto.debug(f'Could not unpack Whois string: {line}. Skipping')\n            continue\n        key = key.strip()\n        value = value.strip()\n        if key in whois:\n            if not isinstance(whois[key], list):\n                whois[key] = [whois[key]]\n            whois[key].append(value)\n        else:\n            whois[key] = value\n    return whois\n\n\ndef get_file_context(entry_id: str) -\u003e dict:\n    \"\"\"Gets a File object from context.\n\n    Args:\n        entry_id: The entry ID of the file\n\n    Returns:\n        File object contains Name, Hashes and more information\n    \"\"\"\n    context = demisto.dt(demisto.context(), f'File(val.EntryID === \"{entry_id}\")')\n    if not context:\n        return {}\n    if isinstance(context, list):\n        return context[0]\n    return context\n\n\ndef raise_if_ip_not_valid(ip: str):\n    \"\"\"Raises an error if ip is not valid\n\n    Args:\n        ip: ip address\n\n    Raises:\n        ValueError: If IP is not valid\n\n    Examples:\n        \u003e\u003e\u003e raise_if_ip_not_valid('not ip at all')\n        Traceback (most recent call last):\n         ...\n        ValueError: IP \"not ip at all\" is not valid\n        \u003e\u003e\u003e raise_if_ip_not_valid('8.8.8.8')\n    \"\"\"\n    if not is_ip_valid(ip, accept_v6_ips=True):\n        raise ValueError(f'IP \"{ip}\" is not valid')\n\n\ndef raise_if_hash_not_valid(file_hash: str):\n    \"\"\"Raises an error if file_hash is not valid\n\n    Args:\n        file_hash: file hash\n\n    Raises:\n        ValueError: if hash is not of type SHA-256, SHA-1 or MD5\n\n    Examples:\n        \u003e\u003e\u003e raise_if_hash_not_valid('not a hash')\n        Traceback (most recent call last):\n         ...\n        ValueError: Hash \"not a hash\" is not of type SHA-256, SHA-1 or MD5\n        \u003e\u003e\u003e raise_if_hash_not_valid('7e641f6b9706d860baf09fe418b6cc87')\n    \"\"\"\n    if get_hash_type(file_hash) not in ('sha256', 'sha1', 'md5'):\n        raise ValueError(f'Hash \"{file_hash}\" is not of type SHA-256, SHA-1 or MD5')\n\n\ndef encode_url_to_base64(url: str) -\u003e str:\n    \"\"\"Gets a string (in this case, url but it can not be) and return it as base64 without padding ('=')\n\n    Args:\n         url: A string to encode\n\n    Returns:\n         Base64 encoded string with no padding\n\n    Examples:\n        \u003e\u003e\u003e encode_url_to_base64('https://example.com')\n        'aHR0cHM6Ly9leGFtcGxlLmNvbQ'\n    \"\"\"\n    return base64.urlsafe_b64encode(url.encode()).decode().strip('=')\n\n\n# endregion\n\n# region Reputation commands\n\n\ndef ip_command(client: Client, score_calculator: ScoreCalculator, args: dict, relationships: str) -\u003e List[CommandResults]:\n    \"\"\"\n    1 API Call for regular\n    1-4 API Calls for premium subscriptions\n    \"\"\"\n    ips = argToList(args['ip'])\n    results: List[CommandResults] = list()\n    for ip in ips:\n        raise_if_ip_not_valid(ip)\n        try:\n            raw_response = client.ip(ip, relationships)\n        except Exception as exception:\n            # If anything happens, just keep going\n            demisto.debug(f'Could not process IP: \"{ip}\"\\n {str(exception)}')\n            continue\n        results.append(\n            build_ip_output(client, score_calculator, ip, raw_response, argToBoolean(args.get('extended_data')))\n        )\n    return results\n\n\ndef file_command(client: Client, score_calculator: ScoreCalculator, args: dict, relationships: str) -\u003e List[CommandResults]:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    files = argToList(args['file'])\n    extended_data = argToBoolean(args.get('extended_data'))\n    results: List[CommandResults] = list()\n    for file in files:\n        raise_if_hash_not_valid(file)\n        try:\n            raw_response = client.file(file, relationships)\n            results.append(build_file_output(client, score_calculator, file, raw_response, extended_data))\n        except Exception as exc:\n            # If anything happens, just keep going\n            results.append(CommandResults(readable_output=f'Could not process file: \"{file}\"\\n {str(exc)}'))\n\n    return results\n\n\ndef url_command(client: Client, score_calculator: ScoreCalculator, args: dict, relationships: str) -\u003e List[CommandResults]:\n    \"\"\"\n    1 API Call for regular\n    1-4 API Calls for premium subscriptions\n    \"\"\"\n    urls = argToList(args['url'])\n    extended_data = argToBoolean(args.get('extended_data'))\n    results: List[CommandResults] = list()\n    for url in urls:\n        try:\n            raw_response = client.url(\n                url, relationships\n            )\n        except Exception as exception:\n            # If anything happens, just keep going\n            demisto.debug(f'Could not process URL: \"{url}\".\\n {str(exception)}')\n            continue\n        results.append(build_url_output(client, score_calculator, url, raw_response, extended_data))\n    return results\n\n\ndef domain_command(client: Client, score_calculator: ScoreCalculator, args: dict, relationships: str) -\u003e List[CommandResults]:\n    \"\"\"\n    1 API Call for regular\n    1-4 API Calls for premium subscriptions\n    \"\"\"\n    domains = argToList(args['domain'])\n    results: List[CommandResults] = list()\n    for domain in domains:\n        try:\n            raw_response = client.domain(domain, relationships)\n        except Exception as exception:\n            # If anything happens, just keep going\n            demisto.debug(f'Could not process domain: \"{domain}\"\\n {str(exception)}')\n            continue\n        results.append(\n            build_domain_output(client, score_calculator, domain, raw_response, argToBoolean(args.get('extended_data')))\n        )\n    return results\n\n\n# endregion\n\n# region Scan commands\ndef file_rescan_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    file_hash = args['file']\n    raise_if_hash_not_valid(file_hash)\n    raw_response = client.file_rescan(file_hash)\n    data = raw_response['data']\n    data['hash'] = file_hash\n    context = {\n        f'{INTEGRATION_ENTRY_CONTEXT}.Submission(val.id \u0026\u0026 val.id === obj.id)': data,\n        'vtScanID': data.get('id')  # BC preservation\n    }\n    return CommandResults(\n        readable_output=tableToMarkdown(\n            f'File \"{file_hash}\" resubmitted.',\n            data,\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=context,\n        raw_response=raw_response\n    )\n\n\ndef get_md5_by_entry_id(entry_id: str) -\u003e str:\n    \"\"\"Gets an MD5 from context using entry ID\"\"\"\n    md5 = demisto.dt(demisto.context(), f'File(val.EntryID === \"{entry_id}\").MD5')\n    if not md5:\n        raise DemistoException('Could not find MD5')\n    return md5\n\n\ndef encode_to_base64(md5: str, id_: Union[str, int]) -\u003e str:\n    \"\"\"Sometime the API returns the id as number only. Need to join the id with md5 in base64.\n\n    Args:\n        md5: The MD5 of the file sent to scan\n        id_: The id returned from the file scan\n\n    Returns:\n        base64 encoded of md5:id_\n    \"\"\"\n    return base64.b64encode(f'{md5}:{id_}'.encode('utf-8')).decode('utf-8')\n\n\ndef get_working_id(id_: str, entry_id: str) -\u003e str:\n    \"\"\"Sometimes new scanned files ID will be only a number. Should connect them with base64(MD5:_id).\n    Fixes bug in VirusTotal API.\n\n    Args:\n        entry_id: the entry id connected to the file\n        id_: id given from the API\n\n    Returns:\n        A working ID that we can use in other commands.\n    \"\"\"\n    if isinstance(id_, str) and id_.isnumeric() or (isinstance(id_, int)):\n        demisto.debug(f'Got an integer id from file-scan. {id_=}, {entry_id=}\\n')\n        raise DemistoException(\n            f'Got an int {id_=} as analysis report. This is a bug in VirusTotal v3 API.\\n'\n            f'While VirusTotal team is fixing the problem, try to resend the file.'\n        )\n    return id_\n\n\ndef file_scan(client: Client, args: dict) -\u003e List[CommandResults]:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    entry_ids = argToList(args['entryID'])\n    upload_url = args.get('uploadURL')\n    if len(entry_ids) \u003e 1 and upload_url:\n        raise DemistoException('You can supply only one entry ID with an upload URL.')\n    results = list()\n    for entry_id in entry_ids:\n        try:\n            file_obj = demisto.getFilePath(entry_id)\n            file_path = file_obj['path']\n            raw_response = client.file_scan(file_path, upload_url=upload_url)\n            data = raw_response.get('data', {})\n            # add current file as identifiers\n            data.update(\n                get_file_context(entry_id)\n            )\n            id_ = data.get('id')\n            demisto.debug(f'Result from vt-scan-file {entry_id=} {id_=} {data.get(\"type\")=}')\n            id_ = get_working_id(id_, entry_id)\n            data['id'] = id_\n            context = {\n                f'{INTEGRATION_ENTRY_CONTEXT}.Submission(val.id \u0026\u0026 val.id === obj.id)': data,\n                'vtScanID': id_  # BC preservation\n            }\n            results.append(CommandResults(\n                readable_output=tableToMarkdown(\n                    f'The file has been submitted \"{file_obj[\"name\"]}\"',\n                    data,\n                    headers=['id', 'EntryID', 'MD5', 'SHA1', 'SHA256'],\n                ),\n                outputs=context,\n                raw_response=raw_response\n            ))\n        except Exception as exc:\n            err = f'Could not process {entry_id=}.\\n{str(exc)}'\n            demisto.debug(err)\n            demisto.results({\n                'Type': entryTypes['error'],\n                'ContentsFormat': formats['text'],\n                'Contents': err\n            })\n    return results\n\n\ndef get_upload_url(client: Client) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    raw_response = client.get_upload_url()\n    upload_url = raw_response['data']\n    context = {\n        f'{INTEGRATION_ENTRY_CONTEXT}.FileUploadURL': upload_url,\n        'vtUploadURL': upload_url  # BC preservation\n\n    }\n    return CommandResults(\n        readable_output=tableToMarkdown(\n            'New upload url acquired!',\n            {'Upload url': upload_url}\n        ),\n        outputs=context,\n        raw_response=raw_response\n    )\n\n\ndef scan_url_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    url = args['url']\n    raw_response = client.url_scan(url)\n    data = raw_response['data']\n    data['url'] = url\n    context = {\n        f'{INTEGRATION_ENTRY_CONTEXT}.Submission(val.id \u0026\u0026 val.id === obj.id)': data,\n        'vtScanID': data.get('id')  # BC preservation\n    }\n    return CommandResults(\n        readable_output=tableToMarkdown(\n            'New url submission:',\n            data,\n            headers=['id', 'url']\n        ),\n        outputs=context,\n        raw_response=raw_response\n    )\n\n\n# endregion\n\n# region Comments commands\ndef get_comments_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n\n    BC Break - No NotBefore argument\n    added limit\n    \"\"\"\n    limit = arg_to_number_must_int(\n        args.get('limit'),\n        arg_name='limit',\n        required=True\n    )\n    resource = args['resource']\n    if before := args.get('before'):\n        before = parse(before)\n        assert before is not None, f'Could not parse the before date \"{before}\"'\n        before = before.replace(tzinfo=None)\n\n    resource_type = args.get('resource_type')\n    if not resource_type:\n        try:\n            raise_if_hash_not_valid(resource)\n            resource_type = 'file'\n        except ValueError:\n            resource_type = 'url'\n    resource_type = resource_type.lower()\n    # Will find if there's one and only one True in the list.\n    if resource_type == 'ip':\n        raise_if_ip_not_valid(resource)\n        raw_response = client.get_ip_comments(resource, limit)\n    elif resource_type == 'url':\n        raw_response = client.get_url_comments(resource, limit)\n    elif resource_type == 'hash':\n        raise_if_hash_not_valid(resource)\n        raw_response = client.get_hash_comments(resource, limit)\n    elif resource_type == 'domain':\n        raw_response = client.get_domain_comments(resource, limit)\n    else:\n        raise DemistoException(f'Could not find resource type of \"{resource_type}\"')\n\n    data = raw_response.get('data', {})\n    context = {\n        'indicator': resource,\n        'comments': data\n    }\n    comments = []\n    for comment in data:\n        attributes = comment.get('attributes', {})\n        votes = attributes.get('votes', {})\n\n        if date := parse(str(attributes.get('date'))):\n            date = date.replace(tzinfo=None)\n\n        if date and before and date \u003e before:\n            continue\n        comments.append({\n            'Date': epoch_to_timestamp(attributes.get('date')),\n            'Text': attributes.get('text'),\n            'Positive Votes': votes.get('positive'),\n            'Abuse Votes': votes.get('abuse'),\n            'Negative Votes': votes.get('negative')\n        })\n\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.Comments',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Virus Total comments of {resource_type}: \"{resource}\"',\n            comments,\n            headers=['Date', 'Text', 'Positive Votes', 'Abuse Votes', 'Negative Votes']\n        ),\n        outputs=context,\n        raw_response=raw_response\n    )\n\n\ndef add_comments_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    resource = args['resource']\n    comment = args['comment']\n    resource_type = args.get('resource_type')\n    if not resource_type:\n        try:\n            raise_if_hash_not_valid(resource)\n            resource_type = 'file'\n        except ValueError:\n            resource_type = 'url'\n    resource_type = resource_type.lower()\n    if resource_type == 'ip':\n        raise_if_ip_not_valid(resource)\n        raw_response = client.add_comment_to_ip(resource, comment)\n    elif resource_type == 'url':\n        raw_response = client.add_comment_to_url(resource, comment)\n    elif resource_type == 'domain':\n        raw_response = client.add_comment_to_domain(resource, comment)\n    elif resource_type == 'file':\n        raise_if_hash_not_valid(resource)\n        raw_response = client.add_comment_to_file(resource, comment)\n    else:\n        raise DemistoException(f'Could not find resource type of \"{resource_type}\"')\n    data = raw_response['data']\n    attributes = data.get('attributes', {})\n    votes = attributes.get('votes', {})\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.Comments.comments',\n        'id',\n        readable_output=tableToMarkdown(\n            'Comment has been added!',\n            {\n                'Date': epoch_to_timestamp(attributes.get('date')),\n                'Text': attributes.get('text'),\n                'Positive Votes': votes.get('positive'),\n                'Abuse Votes': votes.get('abuse'),\n                'Negative Votes': votes.get('negative')\n            },\n            headers=['Date', 'Text', 'Positive Votes', 'Abuse Votes', 'Negative Votes']\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef get_comments_by_id_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    comment_id = args['id']\n    raw_response = client.get_comment_by_id(comment_id)\n    data = raw_response['data']\n    attributes = data.get('attributes', {})\n    votes = attributes.get('votes', {})\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.Comments.comments',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Comment of ID {comment_id}',\n            {\n                'Date': epoch_to_timestamp(attributes.get('date')),\n                'Text': attributes.get('text'),\n                'Positive Votes': votes.get('positive'),\n                'Abuse Votes': votes.get('abuse'),\n                'Negative Votes': votes.get('negative')\n            },\n            headers=['Date', 'Text', 'Positive Votes', 'Abuse Votes', 'Negative Votes']\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\n# endregion\n\ndef file_sandbox_report_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    file_hash = args['file']\n    limit = arg_to_number(\n        args['limit'],\n        'limit',\n        required=True\n    )\n    assert isinstance(limit, int)  # mypy fix\n    raise_if_hash_not_valid(file_hash)\n    raw_response = client.file_sandbox_report(file_hash, limit)\n    data = raw_response['data']\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.SandboxReport',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Sandbox Reports for file hash: {file_hash}',\n            [\n                {\n                    'id': item['id'],\n                    **item['attributes'],\n                    'link': item['links']['self']\n                } for item in data\n            ],\n            headers=['analysis_date', 'last_modification_date', 'sandbox_name', 'link'],\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef passive_dns_data(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    ip = args['ip']\n    limit = arg_to_number_must_int(\n        args['limit'],\n        arg_name='limit',\n        required=True\n    )\n    raw_response = client.passive_dns_data(ip, limit)\n    data = raw_response['data']\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.PassiveDNS',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Passive DNS data for IP {ip}',\n            [\n                {\n                    'id': item['id'],\n                    **item['attributes']\n                } for item in data\n            ],\n            headers=['id', 'date', 'host_name', 'ip_address', 'resolver'],\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef search_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    query = args['query']\n    limit = arg_to_number_must_int(args.get('limit'), 'limit', required=True)\n    raw_response = client.search(query, limit)\n    data = raw_response.get('data', [])\n    if not argToBoolean(args.get('extended_data')):\n        data = decrease_data_size(data)\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.SearchResults',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Search result of query {query}',\n            [item.get('attributes') for item in data],\n            removeNull=True,\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef get_analysis_command(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    analysis_id = args['id']\n    raw_response = client.get_analysis(analysis_id)\n    data = raw_response.get('data', {})\n    if not argToBoolean(args.get('extended_data', False)):\n        data = decrease_data_size(data)\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.Analysis',\n        'id',\n        readable_output=tableToMarkdown(\n            'Analysis results:',\n            {\n                **data.get('attributes', {}),\n                'id': analysis_id\n\n            },\n            headers=['id', 'stats', 'status'],\n            headerTransform=underscoreToCamelCase\n        ),\n        outputs={\n            **raw_response,\n            'id': analysis_id\n        },\n        raw_response=raw_response\n    )\n\n\ndef check_module(client: Client) -\u003e str:\n    \"\"\"\n    1 API Call\n    \"\"\"\n    client.get_ip_comments('8.8.8.8', 1)\n    return 'ok'\n\n\ndef delete_comment(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Delete a comments\"\"\"\n    id_ = args['id']\n    client.delete_comment(id_)\n    return CommandResults(readable_output=f'Comment {id_} has been deleted!')\n\n\ndef main(params: dict, args: dict, command: str):\n    results: Union[CommandResults, str, List[CommandResults]]\n    handle_proxy()\n    client = Client(params)\n    score_calculator = ScoreCalculator(params)\n\n    ip_relationships = (','.join(argToList(params.get('ip_relationships')))).replace('* ', '').replace(\" \", \"_\")\n    url_relationships = (','.join(argToList(params.get('url_relationships')))).replace('* ', '').replace(\" \", \"_\")\n    domain_relationships = (','.join(argToList(params.get('domain_relationships')))).replace('* ', '').replace(\" \", \"_\")\n    file_relationships = (','.join(argToList(params.get('file_relationships')))).replace('* ', '').replace(\" \", \"_\")\n\n    demisto.debug(f'Command called {command}')\n    if command == 'test-module':\n        results = check_module(client)\n    elif command == 'file':\n        results = file_command(client, score_calculator, args, file_relationships)\n    elif command == 'ip':\n        results = ip_command(client, score_calculator, args, ip_relationships)\n    elif command == 'url':\n        results = url_command(client, score_calculator, args, url_relationships)\n    elif command == 'domain':\n        results = domain_command(client, score_calculator, args, domain_relationships)\n    elif command == f'{COMMAND_PREFIX}-file-sandbox-report':\n        results = file_sandbox_report_command(client, args)\n    elif command == f'{COMMAND_PREFIX}-passive-dns-data':\n        results = passive_dns_data(client, args)\n    elif command == f'{COMMAND_PREFIX}-comments-get':\n        results = get_comments_command(client, args)\n    elif command == f'{COMMAND_PREFIX}-comments-add':\n        results = add_comments_command(client, args)\n    elif command == f'{COMMAND_PREFIX}-comments-get-by-id':\n        results = get_comments_by_id_command(client, args)\n    elif command == f'{COMMAND_PREFIX}-comments-delete':\n        results = delete_comment(client, args)\n    elif command == 'url-scan':\n        results = scan_url_command(client, args)\n    elif command == 'file-scan':\n        results = file_scan(client, args)\n    elif command == 'file-rescan':\n        results = file_rescan_command(client, args)\n    elif command == f'{COMMAND_PREFIX}-file-scan-upload-url':\n        results = get_upload_url(client)\n    elif command == f'{COMMAND_PREFIX}-search':\n        results = search_command(client, args)\n    elif command == f'{COMMAND_PREFIX}-analysis-get':\n        results = get_analysis_command(client, args)\n    else:\n        raise NotImplementedError(f'Command {command} not implemented')\n    return_results(results)\n\n\nif __name__ in ('builtins', '__builtin__', '__main__'):\n    try:\n        main(demisto.params(), demisto.args(), demisto.command())\n    except Exception as exception:\n        return_error(exception)\n","subtype":"python3","type":"python"},"itemVersion":"2.1.7","modified":"2021-08-25T15:12:04.569698+03:00","name":"VirusTotal (API v3)","packID":"VirusTotal","packPropagationLabels":["all"],"prevName":"VirusTotal (API v3)","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"API Key (leave empty. Fill in the API key in the password field.)","displayPassword":"API Key","hidden":false,"hiddenPassword":false,"hiddenUsername":true,"info":"","name":"credentials","options":null,"required":true,"type":9},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8},{"defaultValue":"VirusTotal Intelligence LiveHunt Notification","display":"Incident type","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13},{"defaultValue":"40","display":"Maximum number of incidents per fetch","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"max_fetch","options":null,"required":false,"type":0},{"defaultValue":"3 days","display":"First fetch timestamp (\u003cnumber\u003e \u003ctime unit\u003e, e.g., 12 hours, 7 days) or a date or epoch timestamp.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"first_fetch","options":null,"required":false,"type":0},{"defaultValue":"","display":"Tag: The ruleset's name or the identifier for the YARA rule matching the file to fetch its notifications. Leave blank to fetch all.","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"tag","options":null,"required":false,"type":0},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19}],"defaultMapperIn":"VirusTotal Intelligence LiveHunt Notification","definitionId":"","description":"Analyse retro hunts, read live hunt notifications and download files from VirusTotal.","detailedDescription":"## VirusTotal - Premium API - V3\nAnalyze retro hunts, read live hunt notification,s and download files from VirusTotal.\nThe premium API is a component of VirusTotal's [advanced services for professionals](https://www.virustotal.com/gui/services-overview).\n\n## Authorization:\nYour API key can be found in your VirusTotal account user menu.\nYour API key carries all your privileges, so keep it secure and don't share it with anyone.\n\n### Cortex XSOAR version 6.0.0 and below:\nFill anything in the \"Username\" fill box. Use you API key in the password fill box.\n\n## Fetch Incidents:\nThe generated incidents are notifications from vt-private-livehunt-notifications-list.\nUse \"Tag\" to filter which notification tag to get. \nFor example, using the \"malicious_executables\" will fetch only notifications caught by malicious_executables ruleset.\nThe scope of the rule-set should be narrowed to catch only indicators that you want to analyze by a playbook.\nDefining a broad rule-set will cause the integration to create multiple redundant incidents.  \n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/virus-total---premium-api-v3)","display":"VirusTotal - Premium (API v3)","fromServerVersion":"5.5.0","hidden":false,"icon":"","id":"VirusTotal - Premium (API v3)","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"SHA-256, SHA-1 or MD5 identifying the file.","name":"hash","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Downloads file from VirusTotal","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-download-file","outputs":[{"contentPath":"","contextPath":"File","description":"The file details command results.","type":"Unknown"},{"contentPath":"","contextPath":"File.Name","description":"The full file name (including the file extension).","type":"String"},{"contentPath":"","contextPath":"File.EntryID","description":"The ID for locating the file in the War Room.","type":"String"},{"contentPath":"","contextPath":"File.Size","description":"The size of the file in bytes.","type":"Number"},{"contentPath":"","contextPath":"File.MD5","description":"The MD5 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA512","description":"The SHA512 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.Extension","description":"The file extension. For example: \"xls\".","type":"String"},{"contentPath":"","contextPath":"File.Type","description":"The file type, as determined by libmagic (same as displayed in file entries).","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A commma separated list of hashes (SHA-256, SHA-1, or MD5) for the files included in the ZIP.","isArray":true,"name":"file","required":true,"secret":false},{"default":false,"deprecated":false,"description":"A password to protect the zip.","isArray":true,"name":"password","required":false,"secret":true}],"cartesian":false,"deprecated":false,"description":"Creates a password-protected ZIP file containing files from VirusTotal.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-zip-create","outputs":[{"contentPath":"","contextPath":"VirusTotal.Zip.id","description":"ID of the zip","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Zip.type","description":"Type of the ID (zip_file)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Zip.links.self","description":"Self link to file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.files_error","description":"The number of files resulted in error","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.files_ok","description":"The number of files resulted in success zipped.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.progress","description":"Progress of the zipping command in percentage.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.status","description":"The status of the zip process. \"finished\" is the state when finished.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A zip ID. Can be retrieved from the output of vt-private-zip-create.","name":"zip_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve information about a ZIP file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-zip-get","outputs":[{"contentPath":"","contextPath":"VirusTotal.Zip.id","description":"ID of the zip","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Zip.type","description":"Type of the ID (zip_file)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Zip.links.self","description":"Self link to file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.files_error","description":"The number of files resulted in error","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.files_ok","description":"The number of files resulted in success zipped.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.progress","description":"Progress of the zipping command in percentage.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.Zip.attributes.status","description":"The status of the zip process. \"finished\" is the state when finished.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"A zip ID. Can be retrieved from the output of vt-private-zip-create.","name":"zip_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Download a ZIP file.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-zip-download","outputs":[{"contentPath":"","contextPath":"File","description":"The file details command results.","type":"Unknown"},{"contentPath":"","contextPath":"File.Name","description":"The full file name (including the file extension).","type":"String"},{"contentPath":"","contextPath":"File.EntryID","description":"The ID for locating the file in the War Room.","type":"String"},{"contentPath":"","contextPath":"File.Size","description":"The size of the file in bytes.","type":"Number"},{"contentPath":"","contextPath":"File.MD5","description":"The MD5 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA512","description":"The SHA512 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.Extension","description":"The file extension. For example: \"xls\".","type":"String"},{"contentPath":"","contextPath":"File.Type","description":"The file type, as determined by libmagic (same as displayed in file entries).","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Sandbox report ID. Can be aquired from vt-file-sandbox-report in VirusTotal (API v3) integration.","name":"report_id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Extracted PCAP from a sandbox analysis.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-file-sandbox-pcap","outputs":[{"contentPath":"","contextPath":"File","description":"The file details command results.","type":"Unknown"},{"contentPath":"","contextPath":"File.Name","description":"The full file name (including the file extension).","type":"String"},{"contentPath":"","contextPath":"File.EntryID","description":"The ID for locating the file in the War Room.","type":"String"},{"contentPath":"","contextPath":"File.Size","description":"The size of the file in bytes.","type":"Number"},{"contentPath":"","contextPath":"File.MD5","description":"The MD5 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA1","description":"The SHA1 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA256","description":"The SHA256 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.SHA512","description":"The SHA512 hash of the file.","type":"String"},{"contentPath":"","contextPath":"File.Extension","description":"The file extension. For example: \"xls\".","type":"String"},{"contentPath":"","contextPath":"File.Type","description":"The file type, as determined by libmagic (same as displayed in file entries).","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Search query.","name":"query","required":true,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of results.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"The order value can be sorted depends on the query type. See documentation. https://developers.virustotal.com/v3.0/reference#intelligence-search","name":"order","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return full object information or just object descriptors.","name":"descriptors_only","predefined":["true","false"],"required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return full data information.","name":"extended_data","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search for files.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-intelligence-search","outputs":[{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.last_analysis_stats.harmless","description":"number of reports saying that is harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.last_analysis_stats.malicious","description":"number of reports saying that is malicious","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.last_analysis_stats.suspicious","description":"number of reports saying that is suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.last_analysis_stats.undetected","description":"number of reports saying that is undetected.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.last_analysis_stats.timeout","description":"number of timeouts when analysing this URL/file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.reputation","description":"file's score calculated from all votes posted by the VirusTotal community.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.last_modification_date","description":"date when the object itself was last modified. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.total_votes.harmless","description":"number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.attributes.total_votes.malicious","description":"number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.type","description":"The type of the indicator (ip_address, domain, url, file)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.id","description":"ID of the indicator","type":"String"},{"contentPath":"","contextPath":"VirusTotal.IntelligenceSearch.links.self","description":"Link to the response","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"File search query. For example, query=\"type:peexe size:90kb+ positives:5+ behaviour:'taskkill'\"","name":"query","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Return all of the results, note that it can be thousands of results. Prefer not to use in playbooks. The default value is \"false\"","name":"fullResponse","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Search for files.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-search-file","outputs":[{"contentPath":"","contextPath":"VirusTotal.SearchFile.SearchResult","description":"The hashes of files that fit the query","type":"string"},{"contentPath":"","contextPath":"VirusTotal.SearchFile.Query","description":"Original search query","type":"string"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Ruleset identifier. Can be retreived from the vt-private-livehunt-rules-list command.","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve VT Hunting livehunt rulesets.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-rules-get-by-id","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.name","description":"The rule's name","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.modification_date","description":"last modification date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rules","description":"rule file contents","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.enabled","description":"whether it's enabled or not","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.creation_date","description":"Creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rule_names","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.limit","description":"max number of notifications that will be generated by the ruleset in a 24h period. If a match is found, number of generated hunting notifications in the last 24h is looked up and if it's greater than this limit, that match is ignored.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.number_of_rules","description":"Number of rules presented in the set","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.type","description":"The type of the entry (hunting_ruleset)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.id","description":"ID of the ruleset","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.links.self","description":"Link to the ruleset","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Return the rulesets matching the given criteria only.","name":"filter","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of results.","name":"limit","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Sort order.","name":"order","predefined":["name-","creation_date-","modification_date-","name+","creation_date+","modification_date+"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"deprecated":false,"description":"Should list only enabled or disabled rules.","name":"enabled","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve VT Hunting livehunt rulesets.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-rules-list","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.name","description":"The rule's name","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.modification_date","description":"last modification date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rules","description":"rule file contents","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.enabled","description":"whether it's enabled or not","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.creation_date","description":"creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rule_names","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.limit","description":"max number of notifications that will be generated by the ruleset in a 24h period. If a match is found, number of generated hunting notifications in the last 24h is looked up and if it's greater than this limit, that match is ignored.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.number_of_rules","description":"Number of rules presented in the set","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.type","description":"The type of the entry (hunting_ruleset)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.id","description":"ID of the ruleset","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.links.self","description":"Link to the ruleset","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Name of the rule.","name":"name","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The rule itself.","name":"yara_rule","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whatever to enable the rule.","name":"enabled","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of emails to notify.","name":"notification_emails","required":false,"secret":false},{"default":false,"deprecated":false,"description":"max number of notifications that will be generated by the ruleset in a 24h period. If a match is found, number of generated hunting notifications in the last 24h is looked up and if it's greater than this limit, that match is ignored.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a new VT Hunting Livehunt ruleset.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-rules-create","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.name","description":"The rule's name","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.modification_date","description":"last modification date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rules","description":"rule file contents","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.enabled","description":"whether it's enabled or not","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.creation_date","description":"creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rule_names","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.limit","description":"max number of notifications that will be generated by the ruleset in a 24h period. If a match is found, number of generated hunting notifications in the last 24h is looked up and if it's greater than this limit, that match is ignored.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.number_of_rules","description":"Number of rules presented in the set","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.type","description":"The type of the entry (hunting_ruleset)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.id","description":"ID of the ruleset","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.links.self","description":"Link to the ruleset","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Rule identifier. Can be retrieved from the vt-private-livehunt-rules-list command.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"The rule itself.","name":"yara_rule","required":false,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whatever to enable the rule.","name":"enabled","predefined":["true","false"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of emails to notify.","name":"notification_emails","required":false,"secret":false},{"default":false,"deprecated":false,"description":"max number of notifications that will be generated by the ruleset in a 24h period. If a match is found, number of generated hunting notifications in the last 24h is looked up and if it's greater than this limit, that match is ignored.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Update a VT Hunting Livehunt ruleset.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-rules-update","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.name","description":"The rule's name","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.modification_date","description":"last modification date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rules","description":"rule file contents","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.enabled","description":"whether it's enabled or not","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.creation_date","description":"creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.rule_names","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.limit","description":"max number of notifications that will be generated by the ruleset in a 24h period. If a match is found, number of generated hunting notifications in the last 24h is looked up and if it's greater than this limit, that match is ignored.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.attributes.number_of_rules","description":"Number of rules presented in the set","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.type","description":"The type of the entry (hunting_ruleset)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.id","description":"ID of the ruleset","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntRule.links.self","description":"Link to the ruleset","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Ruleset identifier. Can be retreived from the vt-private-livehunt-rules-list","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Delete a VT Hunting Livehunt ruleset.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-rules-delete","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of notifications to retrieve. Maximum can be up to 40.","name":"limit","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Fetch notification from given time. Can be epoch time, a date or time range (3 days, 1 year)","name":"from_time","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Fetch notification from given time. Can be epoch time or a date.","name":"to_time","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Filter notifications by tag.","name":"tag","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve VT Hunting Livehunt notifications.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-notifications-list","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.meta.count","description":"Notification count","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.meta.cursor","description":"The cursor of the list","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.tags","description":"notification tags.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.source_country","description":"Source country of the notification","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.source_key","description":"Source key of the notificaton","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.snippet","description":"The snippet ID (if exists)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.rule_name","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.date","description":"The date of the notification in epoch","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.attributes.match_in_subfile","description":"whether the match was in a subfile or not.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.type","description":"Type of the notification (hunting_notification)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.id","description":"The ID of the notification","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.data.links.self","description":"The link to the notificaton","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.links.self","description":"The link to the current page","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntNotification.links.next","description":"The link to the next page","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"String to search within the hunting notification tags.","name":"filter","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of notifications to retrieve.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve file objects for VT Hunting Livehunt notifications.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-notifications-files-list","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.meta.count","description":"Total file's count.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.meta.cursor","description":"Cursor of the call","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.type_description","description":"describes the file type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.tlsh","description":"Trend Micro's TLSH hash","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.vhash","description":"in-house similarity clustering algorithm value, based on a simple structural feature hash allows you to find similar files.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.exiftool","description":"exiftool is a program for extracting Exif metadata from different file formats. Metadata shown may vary depending on the file type, and given the nature of Exif metadata, some fields may appear or not.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.trid.file_type","description":"TrID is a utility designed to identify file types from their binary signatures.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.trid.probability","description":"probability of file format identification (given as percentage).","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.creation_date","description":"extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.reputation","description":"file's score calculated from all votes posted by the VirusTotal community.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.names","description":"all file names associated with the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_modification_date","description":"date when the object itself was last modified. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.type_tag","description":"tag representing the file type. Can be used in vt-private-intelligence-search","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.times_submitted","description":"number of times the file has been posted to VirusTotal.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.total_votes.harmless","description":"number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.total_votes.malicious","description":"number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.size","description":"file size in bytes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.type_extension","description":"specifies file extension.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_submission_date","description":"most recent date the file was posted to VirusTotal. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.downloadable","description":"true if the file can be downloaded, false otherwise. (use vt-private-download-file) to download the file)","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.sha256","description":"SHA-256 of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.tags","description":"The file's tags.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_date","description":"most recent scan date. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.unique_sources","description":"indicates from how many different sources the file has been posted from.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.first_submission_date","description":"date when the file was first seen in VirusTotal. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.ssdeep","description":"SSDeep of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.md5","description":"MD5 of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.sha1","description":"SHA-1 if the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.magic","description":"magic identifier of this app in hex format.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.main_icon.raw_md5","description":"MD5 of the file's icon.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.main_icon.dhash","description":"The dhash of the file's icon","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.harmless","description":"number of reports saying that is harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.type-unsupported","description":"number of AV engines that don't support that type of file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.suspicious","description":"number of reports saying that is suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.confirmed-timeout","description":"number of AV engines that reach a timeout when analysing that file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.timeout","description":"number of timeouts when analysing this URL/file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.failure","description":"number of AV engines that fail when analysing that file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.malicious","description":"number of reports saying that is malicious","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.undetected","description":"number of reports saying that is undetected.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.meaningful_name","description":"the most interesting name out of all file's names.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.type","description":"Type of the entry (file)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.id","description":"file ID","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.links.self","description":"link to the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_id","description":"The notification ID the file is connected to","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_source_key","description":"The notification's source key","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_tags","description":"notification tags.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.ruleset_name","description":"matched rule's ruleset name.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_source_country","description":"The notification's source country of the notification","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.rule_name","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_snippet","description":"The notification snippet ID","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.ruleset_id","description":"VirusTotal's ruleset ID.","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_date","description":"The notification date in epch.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.match_in_subfile","description":"whether the match was in a subfile or not.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.links.self","description":"Link to the current apge","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.links.next","description":"Link to the next page","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Hashes to search within VirusTotal. Will search only hashes and will ignore any other value.","isArray":true,"name":"hash","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve file objects for VT Hunting Livehunt notifications.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-notifications-files-get-by-hash","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.meta.count","description":"Total file's count.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.meta.cursor","description":"Cursor of the call","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.type_description","description":"describes the file type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.tlsh","description":"Trend Micro's TLSH hash","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.vhash","description":"in-house similarity clustering algorithm value, based on a simple structural feature hash allows you to find similar files.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.exiftool","description":"exiftool is a program for extracting Exif metadata from different file formats. Metadata shown may vary depending on the file type, and given the nature of Exif metadata, some fields may appear or not.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.trid.file_type","description":"TrID is a utility designed to identify file types from their binary signatures.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.trid.probability","description":"probability of file format identification (given as percentage).","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.creation_date","description":"extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.reputation","description":"file's score calculated from all votes posted by the VirusTotal community.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.names","description":"all file names associated with the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_modification_date","description":"date when the object itself was last modified. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.type_tag","description":"tag representing the file type. Can be used in vt-private-intelligence-search","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.times_submitted","description":"number of times the file has been posted to VirusTotal.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.total_votes.harmless","description":"number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.total_votes.malicious","description":"number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.size","description":"file size in bytes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.type_extension","description":"specifies file extension.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_submission_date","description":"most recent date the file was posted to VirusTotal. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.downloadable","description":"true if the file can be downloaded, false otherwise. (use vt-private-download-file) to download the file)","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.sha256","description":"SHA-256 of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.tags","description":"The file's tags.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_date","description":"most recent scan date. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.unique_sources","description":"indicates from how many different sources the file has been posted from.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.first_submission_date","description":"date when the file was first seen in VirusTotal. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.ssdeep","description":"SSDeep of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.md5","description":"MD5 of the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.sha1","description":"SHA-1 if the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.magic","description":"magic identifier of this app in hex format.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.main_icon.raw_md5","description":"MD5 of the file's icon.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.main_icon.dhash","description":"The dhash of the file's icon","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.harmless","description":"number of reports saying that is harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.type-unsupported","description":"number of AV engines that don't support that type of file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.suspicious","description":"number of reports saying that is suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.confirmed-timeout","description":"number of AV engines that reach a timeout when analysing that file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.timeout","description":"number of timeouts when analysing this URL/file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.failure","description":"number of AV engines that fail when analysing that file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.malicious","description":"number of reports saying that is malicious","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.last_analysis_stats.undetected","description":"number of reports saying that is undetected.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.attributes.meaningful_name","description":"the most interesting name out of all file's names.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.type","description":"Type of the entry (file)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.id","description":"file ID","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.links.self","description":"link to the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_id","description":"The notification ID the file is connected to","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_source_key","description":"The notification's source key","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_tags","description":"notification tags.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.ruleset_name","description":"matched rule's ruleset name.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_source_country","description":"The notification's source country of the notification","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.rule_name","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_snippet","description":"The notification snippet ID","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.ruleset_id","description":"VirusTotal's ruleset ID.","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.notification_date","description":"The notification date in epch.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.data.context_attributes.match_in_subfile","description":"whether the match was in a subfile or not.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.links.self","description":"Link to the current apge","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.links.next","description":"Link to the next page","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Rule identifier. Can be retrieved from the vt-private-livehunt-rules-list command.","name":"id","required":true,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number of notifications to retrieve.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a VT Hunting Livehunt ruleset by hunting notification files relationship.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-livehunt-rule-list-files","outputs":[{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.id","description":"ID of the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.LiveHuntFiles.type","description":"Type of the entry (file)","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"Return the jobs matching the given criteria only.","name":"filter","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Continuation cursor.","name":"cursor","required":false,"secret":false},{"default":false,"defaultValue":"10","deprecated":false,"description":"Maximum number jobs to retrieve.","name":"limit","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Get a VT Hunting Livehunt ruleset by hunting notification files relationship.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-retrohunt-jobs-list","outputs":[{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.status","description":"can be either \"starting\", \"running\", \"aborting\", \"aborted\" or \"finished\".","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.finish_date","description":"date when the Retrohunt job finished","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.rules","description":"The ruleset in the job","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.num_matches_outside_time_range","description":"Matches outside time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.scanned_bytes","description":"Total scanned bytes","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.time_range.start","description":"Start of job's time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.time_range.end","description":"End of job's time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.num_matches","description":"Number of matches.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.progress","description":"The progress in percentage","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.corpus","description":"Corpus of the job (main/goodware)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.creation_date","description":"Job's creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.start_date","description":"The start date of the job in epch.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.type","description":"Type of the entry (retrohunt_job)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.id","description":"ID of the retro job.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.links.self","description":"Link to the entry","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Job identifier. Can be acquired from vt-private-retrohunt-jobs-list","name":"id","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve a retrohunt job.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-retrohunt-jobs-get-by-id","outputs":[{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.status","description":"can be either \"starting\", \"running\", \"aborting\", \"aborted\" or \"finished\".","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.finish_date","description":"date when the Retrohunt job finished","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.rules","description":"The ruleset in the job","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.num_matches_outside_time_range","description":"Matches outside time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.scanned_bytes","description":"Total scanned bytes","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.time_range.start","description":"Start of job's time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.time_range.end","description":"End of job's time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.num_matches","description":"Number of matches.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.progress","description":"The progress in percentage","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.corpus","description":"Corpus of the job (main/goodware)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.creation_date","description":"Job's creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.start_date","description":"The start date of the job in epch.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.type","description":"Type of the entry (retrohunt_job)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.id","description":"ID of the retro job.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.links.self","description":"Link to the entry","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"Job identifier. Can be acquired from vt-private-retrohunt-jobs-list","name":"id","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"false","deprecated":false,"description":"Whether to return full data information.","name":"extended_data","predefined":["true","false"],"required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Retrieve matches for a retrohunt job matching file relationship.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-retrohunt-jobs-get-matching-files","outputs":[{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.type_description","description":"describes the file type.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.tlsh","description":"Trend Micro's TLSH hash","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.vhash","description":"in-house similarity clustering algorithm value, based on a simple structural feature hash allows you to find similar files.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.exiftool","description":"exiftool is a program for extracting Exif metadata from different file formats. Metadata shown may vary depending on the file type, and given the nature of Exif metadata, some fields may appear or not.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.trid.file_type","description":"TrID is a utility designed to identify file types from their binary signatures.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.trid.probability","description":"probability of file format identification (given as percentage).","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.rule_name","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.description","description":"matched rule description.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.author","description":"rule author.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.ruleset_id","description":"VirusTotal's ruleset ID.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.ruleset_name","description":"matched rule's ruleset name.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.match_in_subfile","description":"whether the match was in a subfile or not.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.crowdsourced_yara_results.source","description":"ruleset source.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.creation_date","description":"extracted when possible from the file's metadata. Indicates when it was built or compiled. It can also be faked by malware creators. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.names","description":"all file names associated with the file.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_modification_date","description":"date when the object itself was last modified. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.type_tag","description":"tag representing the file type. Can be used in vt-private-intelligence-search","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.capabilities_tags","description":"list of representative tags related to the file's capabilities","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.total_votes.harmless","description":"number of positive votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.total_votes.malicious","description":"number of negative votes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.size","description":"file size in bytes.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.authentihash","description":"sha256 hash used by Microsoft to verify that the relevant sections of a PE image file have not been altered. This specific type of hash is used by Microsoft AppLocker.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.times_submitted","description":"number of times the file has been posted to VirusTotal.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_submission_date","description":"most recent date the file was posted to VirusTotal. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.meaningful_name","description":"the most interesting name out of all file's names.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.downloadable","description":"true if the file can be downloaded, false otherwise.","type":"Boolean"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.sha256","description":"SHA-256 of the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.type_extension","description":"specifies file extension.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.tags","description":"list of representative tags related to the file's capabilities","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_date","description":"Most recent scan date. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.unique_sources","description":"indicates from how many different sources the file has been posted from.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.first_submission_date","description":"date when the file was first seen in VirusTotal. UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.sha1","description":"SHA-1 of the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.magic","description":"magic identifier of this app in hex format.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.ssdeep","description":"SSDeep of the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.md5","description":"MD5 of the file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.harmless","description":"number of reports saying that is harmless.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.type-unsupported","description":"number of AV engines that don't support that type of file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.suspicious","description":"number of reports saying that is suspicious.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.confirmed-timeout","description":"number of AV engines that reach a timeout when analysing that file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.timeout","description":"number of timeouts when analysing this URL/file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.failure","description":"number of AV engines that fail when analysing that file.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.malicious","description":"number of reports saying that is malicious","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.last_analysis_stats.undetected","description":"number of reports saying that is undetected.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.reputation","description":"file's score calculated from all votes posted by the VirusTotal community.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.sigma_analysis_stats.high","description":"number of matched high severity rules.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.sigma_analysis_stats.medium","description":"number of matched medium severity rules.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.sigma_analysis_stats.critical","description":"number of matched critical severity rules.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.attributes.sigma_analysis_stats.low","description":"number of matched low severity rules.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.type","description":"The type of the entry (file)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.id","description":"ID of file","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.links.self","description":"A link to the entry","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.context_attributes.rule_name","description":"contains the names of all rules in the ruleset.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJobFiles.context_attributes.match_in_subfile","description":"whether the match was in a subfile or not.","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":false,"deprecated":false,"description":"The rules to create. https://yara.readthedocs.io/en/stable/","name":"rules","required":true,"secret":false},{"auto":"PREDEFINED","default":false,"defaultValue":"main","deprecated":false,"description":"The \"main\" corpus is a composition of files sent to VirusTotal during the last few months. The \"goodware\" corpus is a random selection of ~1.000.000 files from the NSRL that are not detected by any antivirus engine.","name":"corpus","predefined":["main","goodware"],"required":false,"secret":false},{"default":false,"deprecated":false,"description":"A comma-separated list of emails to notify.","name":"notification_email","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Fetch retrohunt jobs from given time. Can be epoch time, a date or time range (3 days, 1 year)","name":"start_time","required":false,"secret":false},{"default":false,"deprecated":false,"description":"Fetch retrohunt jobs to given time. Can be epoch time, a date or time range. If start_time supplied and not end_time, end_time will be the current time.","name":"end_time","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"Create a new retrohunt job.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-retrohunt-jobs-create","outputs":[{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.status","description":"can be either \"starting\", \"running\", \"aborting\", \"aborted\" or \"finished\".","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.finish_date","description":"date when the Retrohunt job finished","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.rules","description":"The ruleset in the job","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.num_matches_outside_time_range","description":"Matches outside time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.scanned_bytes","description":"Total scanned bytes","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.time_range.start","description":"Start of job's time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.time_range.end","description":"End of job's time range","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.num_matches","description":"Number of matches.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.progress","description":"The progress in percentage","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.corpus","description":"Corpus of the job (main/goodware)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.creation_date","description":"Job's creation date as UTC timestamp.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.attributes.start_date","description":"The start date of the job in epch.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.type","description":"Type of the entry (retrohunt_job)","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.id","description":"ID of the retro job.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.RetroHuntJob.links.self","description":"Link to the entry","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"User ID or API key. If not supplied, will use the API Key configured in the integration.","name":"id","required":false,"secret":true}],"cartesian":false,"deprecated":false,"description":"Retrieve user's API usage.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"vt-private-quota-limits-list","outputs":[{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.cases_creation_monthly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.cases_creation_monthly.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_vtdiff_creation_monthly.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_vtdiff_creation_monthly.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_vtdiff_creation_monthly.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_vtdiff_creation_monthly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_vtdiff_creation_monthly.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_uploaded_files.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_uploaded_files.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_uploaded_bytes.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_uploaded_bytes.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_storage_files.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_storage_files.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_monthly.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_monthly.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_monthly.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_monthly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_monthly.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_downloads_monthly.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_downloads_monthly.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_downloads_monthly.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_downloads_monthly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_downloads_monthly.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_hourly.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_hourly.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_hourly.group.allowed","description":"hourly api requests group's quota limit","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_hourly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_hourly.user.allowed","description":"hourly api requests user's quota limit","type":"Date"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_hunting_rules.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_hunting_rules.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_hunting_rules.group.allowed","description":"intelligence_hunting_rules group's quota limit","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_hunting_rules.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_hunting_rules.user.allowed","description":"intelligence_hunting_rules user's quota limit","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_graphs_private.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_graphs_private.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_graphs_private.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_graphs_private.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_graphs_private.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_daily.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_daily.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_daily.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_daily.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.api_requests_daily.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_storage_bytes.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.monitor_storage_bytes.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_retrohunt_jobs_monthly.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_retrohunt_jobs_monthly.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_retrohunt_jobs_monthly.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_retrohunt_jobs_monthly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_retrohunt_jobs_monthly.user.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_searches_monthly.group.inherited_from","description":"group from which the quota is inherited.","type":"String"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_searches_monthly.group.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_searches_monthly.group.allowed","description":"quota limit.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_searches_monthly.user.group.used","description":"quota has been used.","type":"Number"},{"contentPath":"","contextPath":"VirusTotal.QuotaLimits.intelligence_searches_monthly.user.allowed","description":"quota limit.","type":"Number"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/python3:3.9.6.22912","feed":false,"isFetch":true,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\"\"\"\nVirusTotal V3 - Premium API\nDifference: https://developers.virustotal.com/v3.0/reference#public-vs-premium-api\n\"\"\"\nimport copy\nfrom typing import Tuple, Iterable\n\nimport urllib3\nfrom dateparser import parse\n\n\n\n# Disable insecure warnings\n\nurllib3.disable_warnings()  # pylint: disable=no-member\n\n# region Globals\n\nINTEGRATION_NAME = \"VirusTotal\"\nCOMMAND_PREFIX = \"vt-private\"\nINTEGRATION_ENTRY_CONTEXT = \"VirusTotal\"\n\n\n# endregion\n\n# region Helper functions\ndef convert_epoch_to_readable(\n        readable_inputs: dict,\n        keys: Iterable[str] = ('start_date', 'creation_date', 'finish_date')\n) -\u003e dict:\n    \"\"\"Gets the readable input from a function and converts it times to readable outputs\n\n    Args:\n        readable_inputs: a readable output with epoch times in it\n        keys: keys to convert\n\n    Returns:\n        epoch time in readable output\n    \"\"\"\n    for date_ in keys:\n        if creation_date := readable_inputs.get(date_):\n            if creation_date := parse(str(creation_date)):\n                readable_inputs[date_] = creation_date.replace(microsecond=0).isoformat()\n    return readable_inputs\n\n\ndef decrease_data_size(data: Union[dict, list]) -\u003e Union[dict, list]:\n    \"\"\" Minifying data size.\n    Args:\n        data: the data object from raw response\n    Returns:\n        the same data without:\n            data['attributes']['last_analysis_results']\n            data['attributes']['pe_info']\n            data['attributes']['crowdsourced_ids_results']\n            data['attributes']['autostart_locations']\n            data['attributes']['sandbox_verdicts']\n            data['attributes']['sigma_analysis_summary']\n            data['attributes']['popular_threat_classification']\n            data['attributes']['packers']\n            data['attributes']['malware_config']\n    \"\"\"\n    attributes_to_remove = [\n        'last_analysis_results', 'pe_info', 'crowdsourced_ids_results', 'autostart_locations', 'sandbox_verdicts',\n        'sigma_analysis_summary', 'popular_threat_classification', 'packers', 'malware_config'\n    ]\n    if isinstance(data, list):\n        data = [decrease_data_size(item) for item in data]\n    else:\n        for attribute in attributes_to_remove:\n            try:\n                del data['attributes'][attribute]\n            except KeyError:\n                pass\n    return data\n\n\ndef arg_to_boolean_can_be_none(arg: Optional[Union[bool, str]]) -\u003e Optional[bool]:\n    \"\"\"A wrapper of argToBool that can return None if arg is None or an empty string\"\"\"\n    if arg in (None, ''):\n        return None\n    else:\n        return argToBoolean(arg)\n\n\ndef get_last_run_time(params: Optional[dict] = None, last_run: Optional[dict] = None) -\u003e datetime:\n    \"\"\"getting the last run time.\n    Args:\n        params: Demisto params. Must contain the `first_fetch` key.\n        last_run: if exists, should contain the `date` key.\n\n    Returns:\n        A datetime object of the fetch time\n    \"\"\"\n    if last_run is None:\n        last_run = demisto.getLastRun()\n    if params is None:\n        params = demisto.params()\n    if last_run:\n        last_run_date = parse(last_run.get('date'))\n    else:  # first run\n        first_fetch = params.get('first_fetch')\n        try:\n            last_run_date = parse(first_fetch)\n            if not last_run_date:\n                raise TypeError\n        except TypeError:\n            raise DemistoException(f'The first fetch time is invalid \"{first_fetch=}\"')\n\n    return last_run_date\n\n\ndef get_time_range_object(start_time: Optional[str] = None, end_time: Optional[str] = None) -\u003e Dict[str, int]:\n    \"\"\"Gets start and/or end times and converts them to time_range object.\n\n    Args:\n        start_time: A string represents time or date range (2018-01-01-18:00Z or 3 days)\n        end_time: A string represents time (2018-01-01-18:00Z). if not supplied, will use the current time.\n\n    Returns:\n        A dictionary with start and end time.\n\n    Examples:\n        \u003e\u003e\u003e get_time_range_object('3 days')\n        {'start': 1615199101, 'end': 1615458301}\n        \u003e\u003e\u003e get_time_range_object('2018-01-01')\n        {'start': 1514757600, 'end': 1615465632}\n        \u003e\u003e\u003e get_time_range_object('2018-01-01', '2020-01-01T15:00Z')\n    \"\"\"\n    time_range = {}\n    start_date: datetime\n    end_date: datetime\n    if start_time and end_time:\n        start_date = parse(start_time)\n        assert start_date, f'Could not parse start_date argument. {start_time=}'\n        end_date = parse(end_time)\n        assert end_date, f'Could not parse end_time argument. {end_time=}'\n\n        time_range = {\n            'start': int(start_date.timestamp()),\n            'end': int(end_date.timestamp())\n        }\n    elif start_time:\n        start_date, end_date = parse(start_time), datetime.now()\n        assert start_date, f'Could not parse start_date argument. {start_time=}'\n        assert end_date, f'Could not parse end_time argument. {end_time=}'\n\n        time_range = {\n            'start': int(start_date.timestamp()),\n            'end': int(end_date.timestamp())\n        }\n    elif end_time:\n        raise AssertionError('Found end_time argument without start_time.')\n    return time_range\n\n\ndef arg_to_number_must_int(arg: Any, arg_name: Optional[str] = None, required: bool = False):\n    \"\"\"Wrapper of arg_to_number that must return int\n    For mypy fixes.\n    \"\"\"\n    arg_num = arg_to_number(arg, arg_name, required)\n    assert isinstance(arg_num, int)\n    return arg_num\n\n\ndef raise_if_hash_not_valid(\n        file_hash: str,\n        valid_hashes: Union[tuple, str] = ('sha256', 'sha1', 'md5')\n):\n    \"\"\"Raises an error if file_hash is not valid\n    Args:\n        file_hash: file hash\n        valid_hashes: Valid hashes to not raise if file_hash is of its type\n    Raises:\n        ValueError: if hash is not sha256, sha1, md5\n    Examples:\n        \u003e\u003e\u003e raise_if_hash_not_valid('not a hash')\n        Traceback (most recent call last):\n         ...\n        ValueError: Hash \"not a hash\" is not of type sha256, sha1, md5\n        \u003e\u003e\u003e raise_if_hash_not_valid('not a hash', valid_hashes='sha1')\n        Traceback (most recent call last):\n         ...\n        ValueError: Hash \"not a hash\" is not of type sha1\n        \u003e\u003e\u003e raise_if_hash_not_valid('7e641f6b9706d860baf09fe418b6cc87')\n    \"\"\"\n    if isinstance(valid_hashes, str):\n        valid_hashes = tuple([valid_hashes])\n    if get_hash_type(file_hash) not in valid_hashes:\n        raise ValueError(f'Hash \"{file_hash}\" is not of type {\", \".join(valid_hashes)}')\n\n\ndef get_file_name(content_disposition: str, ) -\u003e str:\n    \"\"\"Content-Disposition has the filename between the `\"`. get it.\n\n    Args:\n        content_disposition: the content disposition from download header\n\n    Returns:\n        the file name\n    \"\"\"\n    if match := re.search(r'\"(.*?)\"', content_disposition):\n        file_name = match.group(1)\n    else:\n        file_name = demisto.uniqueFile()\n    return file_name\n\n\n# endregion\n\nclass Client(BaseClient):\n    def __init__(self, params: dict):\n        self.api_key = params['credentials']['password']\n        super().__init__(\n            'https://www.virustotal.com/api/v3/',\n            verify=not params.get('insecure'),\n            proxy=params.get('proxy'),\n            headers={'x-apikey': self.api_key}\n        )\n\n    def download_file(self, file: str) -\u003e requests.Response:\n        \"\"\"Download a file.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#files-download\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'files/{file}/download',\n            allow_redirects=True,\n            resp_type='response'\n        )\n\n    def create_zip(self, hashes: list, password: Optional[str] = None) -\u003e dict:\n        \"\"\"Creates a password-protected ZIP file containing files from VirusTotal.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#zip_files\n        \"\"\"\n        body: dict = {\n            'hashes': hashes\n        }\n        if password:\n            body['password'] = password\n        return self._http_request(\n            'POST',\n            'intelligence/zip_files',\n            json_data={'data': body}\n        )\n\n    def get_zip(self, zip_id: str) -\u003e dict:\n        \"\"\"Retrieve information about a ZIP file\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-zip-file\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'intelligence/zip_files/{zip_id}'\n        )\n\n    def download_zip(self, zip_id: str) -\u003e requests.Response:\n        \"\"\"Download a ZIP file.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#zip-files-download\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'intelligence/zip_files/{zip_id}/download',\n            allow_redirects=True,\n            resp_type='request'\n        )\n\n    def get_pcap_beaviour(self, report_id) -\u003e dict:\n        \"\"\"Extracted PCAP from a sandbox analysis.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#file_behaviours_pcap\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'file_behaviours/{report_id}/pcap',\n            resp_type='content'\n        )\n\n    def search_intelligence(\n            self,\n            query: str,\n            order: Optional[str] = None,\n            limit: Optional[int] = None,\n            cursor: Optional[str] = None,\n            descriptors_only: Optional[bool] = None\n    ):\n        \"\"\"Search for files.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#intelligence-search\n        \"\"\"\n        return self._http_request(\n            'GET',\n            'intelligence/search',\n            params=assign_params(\n                query=query,\n                cursor=cursor,\n                order=order,\n                limit=limit,\n                descriptors_only=descriptors_only\n            )\n        )\n\n    def get_livehunt_rule_by_id(self, id_: str):\n        \"\"\"Retrieve a VT Hunting Livehunt ruleset.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-hunting-ruleset.\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'intelligence/hunting_rulesets/{id_}'\n        )\n\n    def list_livehunt_rules(\n            self,\n            /,\n            limit: int,\n            order: Optional[str] = None,\n            name: Optional[str] = None,\n            enabled: Optional[bool] = None,\n            rule_content: Optional[str] = None,\n    ) -\u003e dict:\n        \"\"\"Retrieve a VT Hunting Livehunt rulesets.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#list-hunting-rulesets\n        \"\"\"\n        filter_ = ''\n        if name:\n            filter_ += f'{name} '\n        if rule_content:\n            filter_ += f'rules:{rule_content} '\n        if enabled is not None:\n            filter_ += f'enabled:{enabled} '\n        return self._http_request(\n            'GET',\n            'intelligence/hunting_rulesets',\n            params=assign_params(\n                filter=filter_,\n                limit=limit,\n                order=order\n            )\n        )\n\n    def create_livehunt_rule(\n            self,\n            name: str,\n            yara_rule: str,\n            enabled: Optional[bool],\n            limit: Optional[int],\n            notification_emails: Optional[List[str]]\n    ) -\u003e dict:\n        \"\"\"Create a new VT Hunting Livehunt ruleset.\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#create-hunting-ruleset\n        \"\"\"\n        return self._http_request(\n            'POST',\n            'intelligence/hunting_rulesets',\n            json_data={\n                'data': {\n                    'type': 'hunting_ruleset',\n                    'attributes': assign_params(\n                        name=name,\n                        enabled=enabled,\n                        rules=yara_rule,\n                        limit=limit,\n                        notification_emails=notification_emails\n                    )\n                }\n            }\n        )\n\n    def update_livehunt_rule(\n            self,\n            id_: str,\n            yara_rule: Optional[str],\n            enabled: Optional[bool],\n            limit: Optional[int],\n            notification_emails: Optional[List[str]]\n    ) -\u003e dict:\n        \"\"\"Update a VT Hunting Livehunt ruleset.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#create-hunting-ruleset\n        \"\"\"\n        params = assign_params(\n            enabled=enabled,\n            rules=yara_rule,\n            limit=limit,\n            notification_emails=notification_emails\n        )\n        assert params, 'Found nothing to update'\n        return self._http_request(\n            'PATCH',\n            f'intelligence/hunting_rulesets/{id_}',\n            json_data={\n                'data': {\n                    'type': 'hunting_ruleset',\n                    'id': id_,\n                    'attributes': params\n                }\n            }\n        )\n\n    def delete_livehunt_rule(self, id_: str):\n        \"\"\"Delete a VT Hunting Livehunt ruleset.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#delete-hunting-ruleset\n        \"\"\"\n        self._http_request(\n            'DELETE',\n            f'intelligence/hunting_rulesets/{id_}',\n            resp_type='text'\n        )\n\n    def list_notifications(\n            self,\n            from_time: Optional[datetime] = None,\n            to_time: Optional[datetime] = None,\n            tag: Optional[str] = None,\n            cursor: Optional[str] = None,\n            limit: Optional[int] = None\n    ) -\u003e dict:\n        \"\"\"Retrieve VT Hunting Livehunt notifications.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#list-hunting-notifications\n        \"\"\"\n        time_format = \"%Y-%m-%dT%H:%M:%S\"\n        filter_ = ''\n        if tag:\n            filter_ += f'{tag} '\n        if from_time:\n            filter_ += f'date:{from_time.strftime(time_format)}+ '\n        if to_time:\n            filter_ += f'date:{to_time.strftime(time_format)}- '\n        return self._http_request(\n            'GET',\n            'intelligence/hunting_notifications',\n            params=assign_params(\n                filter=filter_,\n                limit=limit,\n                cursor=cursor\n            )\n        )\n\n    def list_notifications_files(self, filter_: Optional[str], cursor: Optional[str] = None,\n                                 limit: Optional[int] = None):\n        \"\"\"Retrieve file objects for VT Hunting Livehunt notifications.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#hunting_notification_files\n        \"\"\"\n        return self._http_request(\n            'GET',\n            'intelligence/hunting_notification_files',\n            params=assign_params(\n                filter=filter_,\n                limit=limit,\n                cursor=cursor\n            )\n        )\n\n    def list_files_by_rule(self, id_: str, cursor: Optional[str] = None, limit: Optional[int] = None) -\u003e dict:\n        \"\"\"Get a VT Hunting Livehunt ruleset by hunting notification files relationship.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-hunting-ruleset-relationship\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'intelligence/hunting_rulesets/{id_}/relationships/hunting_notification_files',\n            params=assign_params(\n                cursor=cursor,\n                limit=limit\n            )\n        )\n\n    def list_retrohunt_jobs(\n            self,\n            filter_: Optional[str] = None,\n            cursor: Optional[str] = None,\n            limit: Optional[int] = None\n    ) -\u003e dict:\n        \"\"\"Retrieve retrohunt jobs.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-retrohunt-jobs\n        \"\"\"\n        return self._http_request(\n            'GET',\n            'intelligence/retrohunt_jobs',\n            params=assign_params(\n                filter=filter_,\n                limit=limit,\n                cursor=cursor\n            )\n        )\n\n    def create_retrohunt_job(\n            self,\n            rules: str,\n            notification_email: Optional[List[str]] = None,\n            corpus: Optional[str] = None,\n            time_range: Optional[Dict[str, int]] = None\n    ) -\u003e dict:\n        \"\"\"Create a new retrohunt job.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#create-retrohunt-job\n        \"\"\"\n        return self._http_request(\n            'POST',\n            'intelligence/retrohunt_jobs',\n            json_data={\n                \"data\": {\n                    \"type\": \"retrohunt_job\",\n                    \"attributes\": assign_params(\n                        rules=rules,\n                        notification_email=notification_email,\n                        corpus=corpus,\n                        time_range=time_range\n                    )\n                }\n            }\n        )\n\n    def get_retrohunt_job_by_id(self, id_: str) -\u003e dict:\n        \"\"\"Retrieve a retrohunt job.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-retrohunt-job\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'intelligence/retrohunt_jobs/{id_}'\n        )\n\n    def get_retrohunt_job_matching_files(self, id_: str) -\u003e dict:\n        \"\"\"Retrieve matches for a retrohunt job matching file relationship..\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#get-retrohunt-jobs-relationships\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'intelligence/retrohunt_jobs/{id_}/matching_files'\n        )\n\n    def get_quota_limits(self, id_: str) -\u003e dict:\n        \"\"\"Retrieve user's API usage.\n\n        See Also:\n            https://developers.virustotal.com/v3.0/reference#user-api-usage\n        \"\"\"\n        return self._http_request(\n            'GET',\n            f'users/{id_}/overall_quotas'\n        )\n\n\ndef test_module(client: Client, params: dict) -\u003e str:\n    \"\"\"Tests API connectivity and authentication'\n    A simple call to list_livehunt_rules\n\n    Returns:\n        'ok' if test passed, anything else will fail the test.\n    \"\"\"\n    if argToBoolean(params.get('isFetch')):\n        fetch_incidents(client, params, get_last_run_time(last_run={}))\n    else:\n        client.list_livehunt_rules(limit=1)\n    return 'ok'\n\n\ndef download_file(client: Client, args: dict) -\u003e dict:\n    \"\"\"Download a file.\"\"\"\n    file = args['hash']\n    raise_if_hash_not_valid(file)\n    response = client.download_file(file)\n    content = response.content\n    content_disposition = response.headers.get('Content-Disposition', '')\n    file_name = f'{get_file_name(content_disposition)}-vt-file'\n    return fileResult(file_name, content)\n\n\ndef create_zip(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Creates a password-protected ZIP file containing files from VirusTotal.\"\"\"\n    hashes = argToList(args['file'])\n    for hash_ in hashes:\n        raise_if_hash_not_valid(hash_)\n    password = args.get('password')\n    raw_response = client.create_zip(hashes, password)\n    data = raw_response.get('data', {})\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.Zip',\n        'id',\n        outputs=data,\n        readable_output=tableToMarkdown(\n            'The request to create the ZIP was submitted successfully!',\n            {\n                **data,\n                **data.get('attributes', {})\n            },\n            headers=['id', 'status']\n        )\n    )\n\n\ndef get_zip(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve information about a ZIP file\"\"\"\n    zip_id = args['zip_id']\n    raw_response = client.get_zip(zip_id)\n    data = raw_response['data']\n    status = data.get('attributes', {}).get('status')\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.Zip',\n        'id',\n        outputs=data,\n        readable_output=f'ZIP creation status is \"{status}\"',\n        raw_response=raw_response\n    )\n\n\ndef download_zip(client: Client, args: dict) -\u003e dict:\n    \"\"\"Download a ZIP file.\"\"\"\n    zip_id = args['zip_id']\n    response = client.download_zip(zip_id)\n    content = response.content\n    file_name = get_file_name(response.headers.get('Content-Disposition', ''))\n    return fileResult(file_name, content)\n\n\ndef get_pcap_behaviour(client: Client, args: dict) -\u003e dict:\n    \"\"\"Extracted PCAP from a sandbox analysis\"\"\"\n    report_id = args['report_id']\n    content = client.get_pcap_beaviour(report_id)\n    assert isinstance(content, (bytes, str)), 'Response from PCAP Behavior is not a bytes-like object.'\n    return fileResult(f'{report_id}.pcap', content)\n\n\ndef search_intelligence(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Search for files.\"\"\"\n    query = args['query']\n    limit = arg_to_number(args.get('limit'))\n    order = args.get('order')\n    cursor = args.get('cursor')\n    descriptors_only = arg_to_boolean_can_be_none(args.get('descriptors_only'))\n    raw_response = client.search_intelligence(query, order, limit, cursor, descriptors_only)\n    if not arg_to_boolean_can_be_none(args.get('extended_data')):\n        raw_response['data'] = decrease_data_size(raw_response.get('data', []))\n    data = raw_response['data']\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.IntelligenceSearch',\n        'id',\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef get_livehunt_rule(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve a VT Hunting Livehunt ruleset.\"\"\"\n    id_ = args['id']\n    raw_response = client.get_livehunt_rule_by_id(id_)\n    data = raw_response.get('data', {})\n    readable_output = data.get('attributes')\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.LiveHuntRule',\n        'id',\n        outputs=data,\n        raw_response=raw_response,\n        readable_output=tableToMarkdown(\n            f'Livehunt Ruleset {id_}',\n            readable_output,\n            headers=['name', 'enabled', 'rule_names']\n        )\n    )\n\n\ndef list_livehunt_rules(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve a VT Hunting Livehunt rulesets.\"\"\"\n    enabled = None if not args.get('enabled') else arg_to_boolean_can_be_none(args.get('enabled'))\n    rule_content = args.get('rule_content')\n    name = args.get('name')\n    order = args.get('order')\n    limit = arg_to_number_must_int(args.get('limit'))\n    raw_response = client.list_livehunt_rules(\n        limit=limit, name=name, enabled=enabled, rule_content=rule_content, order=order\n    )\n    data = raw_response.get('data', [])\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.LiveHuntRule',\n        'id',\n        outputs=data,\n        raw_response=raw_response,\n        readable_output=tableToMarkdown(\n            'VT Hunting Livehunt rulesets',\n            [{\n                **item.get('attributes', {}),\n                'id': item.get('id')\n            } for item in data],\n            headers=['id', 'name', 'enabled', 'rule_names']\n        )\n    )\n\n\ndef create_livehunt_rule(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Create a new VT Hunting Livehunt ruleset\"\"\"\n    name = args['name']\n    yara_rule = stringUnEscape(args['yara_rule'])\n    # optional\n    enabled = None if args.get('enabled') == \"None\" else arg_to_boolean_can_be_none(args.get('enabled'))\n    notification_emails = argToList(args.get('notification_emails'))\n    limit = arg_to_number(args.get('limit'))\n    raw_response = client.create_livehunt_rule(name, yara_rule, enabled, limit, notification_emails)\n    outputs = raw_response.get('data', {})\n    return CommandResults(\n        'VirusTotal.LiveHuntRule',\n        'id',\n        outputs=outputs,\n        raw_response=raw_response,\n        readable_output=tableToMarkdown(\n            f'New rule \"{name}\" was created successfully',\n            {\n                **outputs,\n                **outputs.get('attributes', {})\n            },\n            headers=['id', 'name', 'number_of_rules']\n        )\n    )\n\n\ndef update_livehunt_rules(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Create a new VT Hunting Livehunt ruleset\"\"\"\n    id_ = args['id']\n    yara_rule = args.get('yara_rule')\n    enabled = arg_to_boolean_can_be_none(args.get('enabled'))\n    notification_emails = argToList(args.get('notification_emails'))\n    limit = arg_to_number(args.get('limit'))\n    raw_response = client.update_livehunt_rule(id_, yara_rule, enabled, limit, notification_emails)\n    outputs = raw_response.get('data', {})\n    return CommandResults(\n        'VirusTotal.LiveHuntRule',\n        'id',\n        outputs=outputs,\n        raw_response=raw_response,\n        readable_output=tableToMarkdown(\n            f'Rule \"{id_}\" has been updated!',\n            {\n                **outputs,\n                **outputs.get('attributes', {})\n            },\n            headers=['id', 'name', 'number_of_rules']\n        )\n    )\n\n\ndef delete_livehunt_rules(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Delete a VT Hunting Livehunt ruleset.\"\"\"\n    id_ = args['id']\n    client.delete_livehunt_rule(id_)\n    return CommandResults(\n        readable_output=f'Rule \"{id_}\" was deleted successfully'\n    )\n\n\ndef list_notifications(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve VT Hunting Livehunt notifications.\"\"\"\n    limit = arg_to_number_must_int(args.get('limit'))\n    assert limit \u003c= 40, 'limit can\\'t be above 40'\n    if to_time := args.get('to_time'):\n        to_time = parse(to_time)\n    if from_time := args.get('from_time'):\n        from_time = parse(from_time)\n    if from_time and to_time:\n        if from_time \u003e to_time:\n            raise DemistoException(f'The from_time argument is later then to_time. {from_time} \u003e {to_time}')\n    cursor = args.get('cursor')\n    tag = args.get('tag')\n    outputs = raw_response = client.list_notifications(from_time, to_time, tag, cursor, limit)\n    if not arg_to_boolean_can_be_none(args.get('extended_data')):\n        outputs = copy.deepcopy(raw_response)\n        outputs['data'] = decrease_data_size(outputs.get('data', []))\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.LiveHuntNotification',\n        'id',\n        readable_output=tableToMarkdown(\n            'Notifications found:',\n            outputs.get('data', {}),\n            headers=['id']\n        ),\n        outputs=outputs,\n        raw_response=raw_response\n    )\n\n\ndef list_notifications_files_list(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve file objects for VT Hunting Livehunt notifications\"\"\"\n    filter_ = args.get('filter')\n    limit = arg_to_number(args.get('limit'))\n    cursor = args.get('cursor')\n    outputs = raw_response = client.list_notifications_files(filter_, cursor, limit)\n    if not arg_to_boolean_can_be_none(args.get('extended_data')):\n        outputs = copy.deepcopy(raw_response)\n        outputs['data'] = decrease_data_size(outputs.get('data', []))\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.LiveHuntFiles',\n        'id',\n        readable_output=tableToMarkdown(\n            'Notifications file listed:',\n            [\n                {**item.get('attributes', {}), 'id': item.get('id')} for item in raw_response.get('data', [])\n            ],\n            headers=['id', 'meaningful_name', 'last_analysis_stats']\n        ),\n        outputs=outputs,\n        raw_response=raw_response\n    )\n\n\ndef list_notifications_files_list_by_hash(client: Client, args: dict) -\u003e List[CommandResults]:\n    \"\"\"Retrieve file objects for VT Hunting Livehunt notifications by hash.\"\"\"\n    hashes_only = [hash_ for hash_ in argToList(args.get('hash')) if get_hash_type(hash_) != 'Unknown']\n    cursor = args.get('cursor')\n    results = list()\n    for hash_ in hashes_only:\n        try:\n            outputs = raw_response = client.list_notifications_files(hash_, cursor, limit=1)\n            if not arg_to_boolean_can_be_none(args.get('extended_data')):\n                outputs = copy.deepcopy(raw_response)\n                outputs['data'] = decrease_data_size(outputs.get('data', []))\n            results.append(CommandResults(\n                f'{INTEGRATION_ENTRY_CONTEXT}.LiveHuntFiles',\n                'id',\n                readable_output=tableToMarkdown(\n                    'Notifications file listed:',\n                    [\n                        {**item.get('attributes', {}), 'id': item.get('id')} for item in raw_response.get('data', [])\n                    ],\n                    headers=['id', 'meaningful_name', 'last_analysis_stats']\n                ),\n                outputs=outputs,\n                raw_response=raw_response\n            ))\n        except Exception as exc:\n            err = f'Could not process hash \"{hash_}\"'\n            demisto.debug(f'{err}\\n{exc}')\n            results.append(CommandResults(readable_output=err))\n    return results\n\n\ndef list_files_by_rule(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Get a VT Hunting Livehunt ruleset by hunting notification files relationship.\"\"\"\n    id_ = args['id']\n    limit = arg_to_number(args.get('limit'))\n    cursor = args.get(args.get('cursor'))\n    raw_response = client.list_files_by_rule(id_, cursor, limit)\n    data = raw_response.get('data', [])\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.LiveHuntFiles',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Files found by rule {id_}',\n            data\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef list_retrohunt_jobs(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve retrohunt jobs\"\"\"\n    limit = arg_to_number(args.get('limit'))\n    cursor = args.get('cursor')\n    filter_ = args.get('filter')\n    raw_response = client.list_retrohunt_jobs(filter_, cursor, limit)\n    data = raw_response.get('data', [])\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.RetroHuntJob',\n        'id',\n        readable_output=tableToMarkdown(\n            'Retrohunt jobs listed:',\n            [\n                {\n                    **item.get('attributes', {}),\n                    'id': item.get('id')\n                } for item in data\n            ],\n            headers=['id', 'corpus', 'status', 'rules']\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef create_retrohunt_jobs(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Create a new retrohunt job.\"\"\"\n    rules = stringUnEscape(args.get('rules'))\n    notification_email = argToList(args.get('notification_email'))\n    corpus = args.get('corpus')  # main / goodware\n    start_time, end_time = args.get('start_time'), args.get('end_time')\n    time_range = get_time_range_object(start_time, end_time)\n    raw_response = client.create_retrohunt_job(rules, notification_email, corpus, time_range)\n    data = raw_response.get('data', {})\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.RetroHuntJob',\n        'id',\n        readable_output=tableToMarkdown(\n            'Retrohunt job has been successfully created',\n            {\n                **data,\n                **data.get('attributes', {})\n            },\n            headers=['id', 'corpus', 'status', 'rules']\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef get_retrohunt_job_by_id(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve a retrohunt job.\"\"\"\n    id_ = args['id']\n    raw_response = client.get_retrohunt_job_by_id(id_)\n    data = raw_response.get('data', {})\n    readable_inputs = {\n        **data,\n        **data.get('attributes', {})\n    }\n\n    readable_inputs.pop('attributes', None)\n    readable_inputs = convert_epoch_to_readable(readable_inputs)\n\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.RetroHuntJob',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Retrohunt job: {id_}',\n            readable_inputs\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef get_retrohunt_job_matching_files(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve matches for a retrohunt job matching file relationship.\"\"\"\n    id_ = args['id']\n    raw_response = client.get_retrohunt_job_matching_files(id_)\n    if not arg_to_boolean_can_be_none(args.get('extended_data')):\n        raw_response['data'] = decrease_data_size(raw_response['data'])\n    data = raw_response.get('data', [])\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.RetroHuntJobFiles',\n        'id',\n        readable_output=tableToMarkdown(\n            f'Files matching id \"{id_}\"',\n            [\n                {\n                    **item.get('attributes', {}),\n                    'id': item.get('id')\n                } for item in data\n            ],\n            headers=['sha256', 'popular_threat_classification', 'reputation']\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef get_quota_limits(client: Client, args: dict) -\u003e CommandResults:\n    \"\"\"Retrieve user's API usage.\"\"\"\n    id_ = args.get('id', client.api_key)\n    raw_response = client.get_quota_limits(id_)\n    data = raw_response.get('data', {})\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.QuotaLimits',\n        readable_output=tableToMarkdown(\n            'Monthly quota data: More data can be found in the Context.',\n            {key: value for key, value in data.items() if 'monthly' in key}\n        ),\n        outputs=data,\n        raw_response=raw_response\n    )\n\n\ndef fetch_incidents(client: Client, params: dict, last_run_date: datetime) -\u003e Tuple[List[dict], datetime]:\n    tag = params.get('tag')\n    max_fetch = arg_to_number_must_int(params.get('max_fetch', 10))\n    raw_response = client.list_notifications(from_time=last_run_date, tag=tag, limit=max_fetch)\n    incidents = list()\n    for notification in raw_response.get('data', []):\n        attributes = notification.get('attributes', {})\n        date = parse(str(attributes.get('date')))  # epoch int to str\n        if not date:\n            date = last_run_date\n        elif date \u003e last_run_date:\n            last_run_date = date\n        incidents.append(\n            {\n                'name': f'VirusTotal Intelligence LiveHunt Notification: {notification.get(\"id\")}',\n                'occurred': f'{date.replace(microsecond=0).isoformat()}Z',\n                'rawJSON': json.dumps(notification)\n            }\n        )\n    if incidents:\n        # To not fetch duplicate notifications. If not incidents - Nothing found. keep going\n        last_run_date += timedelta(seconds=1)\n    return incidents, last_run_date\n\n\ndef search_file(client: Client, args: dict) -\u003e CommandResults:\n    query = args['query']\n    limit = 1000 if argToBoolean(args.get('fullResponse')) else 50\n    raw_response = client.search_intelligence(query, limit=limit, descriptors_only=True)\n    hashes = [item['id'] for item in raw_response.get('data', []) if item.get('id')]\n    return CommandResults(\n        f'{INTEGRATION_ENTRY_CONTEXT}.SearchFile',\n        'Query',\n        readable_output=tableToMarkdown(\n            f'Found hashes for query: \"{query}\"',\n            hashes,\n            headers=['Found hashes']\n        ),\n        outputs={\n            'Query': query,\n            'SearchResult': hashes\n        },\n        raw_response=raw_response\n    )\n\n\ndef main():\n    \"\"\"main function, parses params and runs command functions\n    \"\"\"\n    results: Union[str, CommandResults, dict, List[CommandResults]]\n    command = demisto.command()\n    args = demisto.args()\n    demisto.debug(f'Command being called is {command}')\n    try:\n        params = demisto.params()\n        handle_proxy()\n        client = Client(params)\n        if command == 'fetch-incidents':\n            incidents, new_run_date = fetch_incidents(client, params, get_last_run_time())\n            demisto.setLastRun({'date': new_run_date.isoformat()})\n            demisto.incidents(incidents)\n        else:\n            if command == 'test-module':\n                results = test_module(client, params)\n            elif command == f'{COMMAND_PREFIX}-download-file':\n                results = download_file(client, args)\n            elif command == f'{COMMAND_PREFIX}-zip-create':\n                results = create_zip(client, args)\n            elif command == f'{COMMAND_PREFIX}-zip-get':\n                results = get_zip(client, args)\n            elif command == f'{COMMAND_PREFIX}-zip-download':\n                results = download_zip(client, args)\n            elif command == f'{COMMAND_PREFIX}-file-sandbox-pcap':\n                results = get_pcap_behaviour(client, args)\n            elif command == f'{COMMAND_PREFIX}-intelligence-search':\n                results = search_intelligence(client, args)\n            elif command in (f'{COMMAND_PREFIX}-search-file', 'vt-private-search-file'):\n                results = search_file(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-rules-list':\n                results = list_livehunt_rules(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-rules-get-by-id':\n                results = get_livehunt_rule(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-rules-create':\n                results = create_livehunt_rule(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-rules-update':\n                results = update_livehunt_rules(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-rules-delete':\n                results = delete_livehunt_rules(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-notifications-list':\n                results = list_notifications(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-notifications-files-list':\n                results = list_notifications_files_list(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-notifications-files-get-by-hash':\n                results = list_notifications_files_list_by_hash(client, args)\n            elif command == f'{COMMAND_PREFIX}-livehunt-rule-list-files':\n                results = list_files_by_rule(client, args)\n            elif command == f'{COMMAND_PREFIX}-retrohunt-jobs-list':\n                results = list_retrohunt_jobs(client, args)\n            elif command == f'{COMMAND_PREFIX}-retrohunt-jobs-get-by-id':\n                results = get_retrohunt_job_by_id(client, args)\n            elif command == f'{COMMAND_PREFIX}-retrohunt-jobs-create':\n                results = create_retrohunt_jobs(client, args)\n            elif command == f'{COMMAND_PREFIX}-retrohunt-jobs-get-matching-files':\n                results = get_retrohunt_job_matching_files(client, args)\n            elif command == f'{COMMAND_PREFIX}-quota-limits-list':\n                results = get_quota_limits(client, args)\n            else:\n                raise NotImplementedError(f'Command \"{command}\" is not implemented')\n            return_results(results)\n    # Log exceptions and return errors\n    except Exception as e:\n        demisto.error(traceback.format_exc())  # print the traceback\n        return_error(f'Failed to execute {demisto.command()} command.\\nError:\\n{str(e)}')\n\n\n''' ENTRY POINT '''\n\nif __name__ in ('__main__', '__builtin__', 'builtins'):\n    main()\n","subtype":"python3","type":"python"},"itemVersion":"2.1.7","modified":"2021-08-25T15:12:04.569161+03:00","name":"VirusTotal - Premium (API v3)","packID":"VirusTotal","packPropagationLabels":["all"],"prevName":"VirusTotal - Premium (API v3)","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3},{"brand":"","canGetSamples":false,"category":"Forensics \u0026 Malware Analysis","commitMessage":"","configuration":null,"definitionId":"","description":"Volatility","display":"Volatility","fromServerVersion":"","hidden":false,"icon":"volatility.png","id":"volatility","image":"data:image/png;base64,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","integrationScript":null,"itemVersion":"","modified":"2021-09-08T08:30:28.244672+03:00","name":"volatility","packID":"","prevName":"volatility","readonly":true,"shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":6},{"brand":"","canGetSamples":true,"category":"Utilities","commitMessage":"","configuration":null,"definitionId":"","description":"Don't ask, just try.","display":"Where is the egg?","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Where is the egg?","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":true,"deprecated":false,"description":"yep","name":"magic-word","required":false,"secret":false}],"cartesian":false,"deprecated":false,"description":"try me","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"clue","outputs":null,"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"switch (command) {\n    case 'test-module':\n        return 'ok';\n    case 'clue':\n        var res = '';\n        switch ((args['magic-word'] || '').toLowerCase()) {\n            case '':\n                res = 'Finally! You found me. Although Demisto demystifies, we still have so many secrets waiting to be discovered. Let\\'s play a little game. Try the same command, but now with a dash of \\'mystery\\'…';\n                break;\n            case 'mystery':\n                res = 'We\\'re full of mysteries, but you\\'re on your way to uncovering them! It\\'s not going to be easy. Say, what\\'s the name of the icon we have for automated tasks? I remembered it a second ago, but then it was gone in a flash… \\n\\n---\\n\\n ![mystery](https://media.giphy.com/media/3ohhwg3O1TGRXHQYh2/source.gif)';\n                break;\n            case 'lightning':\n                res = 'Wow, you\\'re good! Is your name Lightning McAnalyst? Because that was fast. The lightning icon does represent automated tasks. Why? Some questions are best left unanswered (which is mystery-speak for \\'nobody knows\\').  \\nTime for your next question. As you know, DBot speaks tons of languages. One such special language (and a personal favorite of mine) is denoted by M↓. Remind me what it\\'s called again? \\n\\n---\\n\\n ![lightning](https://media.giphy.com/media/FZzbTJyRTwPuw/source.gif)';\n                break;\n            case 'markdown':\n                res = 'That\\'s a markdown touchdown! A follow-up language question. Another one of DBot\\'s many languages (some would say the most important one) begins with an \\'h\\', I think. Any guesses?';\n                break;\n            case 'html':\n                res = 'You\\'re on fire! Sorry my memory\\'s not so good today. Perhaps I need 16GB (or SSD?) to be faster, what with things changing so quickly around here...   \\nNow for a tricky one. Find the answer to this riddle:  \\nDemisto content updates are constantly shipped\\nPlaybooks, widgets, integrations, scripts,\\nWill you be a dear and tell me please,\\nThe frequency of this content release?';\n                break;\n            case 'twice a month':\n            case 'every fortnight':\n            case 'every two weeks':\n            case 'every-two-weeks':\n            case 'everytwoweeks':\n            case 'two weeks':\n            case 'two-weeks':\n            case 'twoweeks':\n            case 'every 2 weeks':\n            case 'every-2-weeks':\n            case 'every2weeks':\n            case '2 weeks':\n            case '2-weeks':\n            case '2weeks':\n            case 'biweekly':\n            case 'fortnightly':\n                res = 'I can\\'t believe it! Everyone else is just pretending, you\\'re the real legend in this town. Congratulations for conquering my little game. As a treat, run /demisto and sit back.\\n\\n---\\n\\By the way, there are many more Easter eggs to find within these digital walls. Just use the magic words \"dbot I love you\" and we can have a rematch.';\n                break;\n            case 'dbot i love you':\n                res = 'oh, that\\'s nice... but try in another time... [meanwhile...](https://www.youtube.com/watch?v=dQw4w9WgXcQ)';\n                break;\n            default:\n                res = 'no no...';\n        }\n        return { Contents: res, ContentsFormat: 'markdown', Type: 1 };\n    default:\n}\n","subtype":"","type":"javascript"},"itemVersion":"1.0.0","modified":"2021-08-24T18:47:07.457808+03:00","name":"Where is the egg?","packID":"WhereIsTheEgg","packPropagationLabels":["all"],"prevName":"Where is the egg?","propagationLabels":[],"scriptNotVisible":true,"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":1},{"brand":"","canGetSamples":true,"category":"Data Enrichment \u0026 Threat Intelligence","commitMessage":"","configuration":[{"defaultValue":"","display":"Return Errors","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"with_error","options":null,"required":false,"type":8},{"defaultValue":"","display":"Proxy URL","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Supports socks4/socks5/http connect proxies (e.g. socks5h://host:1080). Will effect all commands except for the `ip` command.","name":"proxy_url","options":null,"required":false,"type":0},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Effect the `ip` command and the other commands only if the Proxy URL is not set.","name":"proxy","options":null,"required":false,"type":8},{"defaultValue":"B - Usually reliable","display":"Source Reliability","displayPassword":"","hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data.","name":"integrationReliability","options":["A+ - 3rd party enrichment","A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15}],"definitionId":"","description":"Provides data enrichment for domains.","detailedDescription":"## Whois\n\nUse the Whois integration to get enriched data for domains and ips.\n\n### Configuration Options\n- **Return Errors**: If selected, Whois will return errors for unsupported domains, or domains for which the lookup failed.\n\n**For the domain and whois commands:**\n- **Proxy URL**: Specify a proxy to be used. The URL should in the format: scheme://host:port. If the scheme is omitted, the default socks5h scheme will be used. To use the system HTTP proxy, you can also specify the value: **system_http** or sign the **Use system proxy settings**. The following schemes are supported:\n  * **socks5h**: SOCKS version 5 protocol with remote DNS resolving.\n  * **socks5**: SOCKS version 5 protocol with local DNS resolving.\n  * **socks4a**: SOCKS version 4 with remote DNS resolving.\n  * **socks4**: SOCKS version 4 with local DNS resolving.\n  * **http**: HTTP proxy with support for CONNECT method on port 43 (default Whois port). Note that most HTTP proxies block the CONNECT method to non-HTTP/HTTPS standard ports (such as the default Whois port 43).\n  \n**For the IP command:**\n- **Use system proxy settings**: Use the system proxy settings for the `ip` command.\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/whois)","display":"Whois","fromServerVersion":"5.0.0","hidden":false,"icon":"","id":"Whois","image":"data:image/png;base64,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","integrationScript":{"commands":[{"arguments":[{"default":false,"deprecated":false,"description":"The domain to enrich.","name":"query","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Provides data enrichment for domains.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"whois","outputs":[{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"string"},{"contentPath":"","contextPath":"Domain.Name","description":"The domain name.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Name","description":"The domain name.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.DomainStatus","description":"The domain status.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.DNSSec","description":"The domain name system security extension (DNSSEC).","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.NameServers","description":"The name servers.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.CreationDate","description":"The date that the domain was created.","type":"date"},{"contentPath":"","contextPath":"Domain.Whois.UpdatedDate","description":"The date that the domain was last updated.","type":"date"},{"contentPath":"","contextPath":"Domain.Whois.ExpirationDate","description":"The date that the domain expires.","type":"date"},{"contentPath":"","contextPath":"Domain.Whois.Registrar.Name","description":"The name of the registrar.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Emails","description":"The abuse emails.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrar.AbuseEmail","description":"The email address of the contact for reporting abuse.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.name","description":"The name of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.email","description":"The email address of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Raw","description":"The raw output.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.country","description":"The country of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.name","description":"The name of domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.state","description":"The state of domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.email","description":"The email address of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.organization","description":"The organization of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.postalcode","description":"The postal code of the domain administrator","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.street","description":"The street of the domain admin","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.phone","description":"The phone number of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.city","description":"The city of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.country","description":"The country of tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.name","description":"The name of tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.state","description":"The state of tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.email","description":"The email address of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.organization","description":"The organization of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.postalcode","description":"The postal code of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.street","description":"The street of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.phone","description":"The phone number of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.city","description":"The city of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.country","description":"The country of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.state","description":"The state of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.organization","description":"The organization of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.postalcode","description":"The postal code of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.street","description":"The street of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.phone","description":"The phone number of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.city","description":"The city of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.ID","description":"The ID of the domain.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.QueryStatus","description":"The result of the command (\"Success\" or \"Failed\").","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.QueryValue","description":"The query requested by the user.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.QueryResult","description":"Whether the query found a matching result.","type":"Boolean"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The domain to enrich.","isArray":true,"name":"domain","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Provides data enrichment for domains.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"domain","outputs":[{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"string"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"string"},{"contentPath":"","contextPath":"Domain.Name","description":"The domain name.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Name","description":"The domain name.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.DomainStatus","description":"The domain status.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.DNSSec","description":"The domain name system security extension (DNSSEC).","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.NameServers","description":"The name servers.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.CreationDate","description":"The date that the domain was created.","type":"date"},{"contentPath":"","contextPath":"Domain.Whois.UpdatedDate","description":"The date that the domain was last updated.","type":"date"},{"contentPath":"","contextPath":"Domain.Whois.ExpirationDate","description":"The date that the domain expires.","type":"date"},{"contentPath":"","contextPath":"Domain.Whois.Registrar.Name","description":"The name of the registrar.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Emails","description":"The abuse emails.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrar.AbuseEmail","description":"The email address of the contact for reporting abuse.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.name","description":"The name of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.email","description":"The email address of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Raw","description":"The raw output.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.country","description":"The country of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.name","description":"The name of domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.state","description":"The state of domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.email","description":"The email address of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.organization","description":"The organization of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.postalcode","description":"The postal code of the domain administrator","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.street","description":"The street of the domain admin","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.phone","description":"The phone number of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Administrator.city","description":"The city of the domain administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.country","description":"The country of tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.name","description":"The name of tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.state","description":"The state of tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.email","description":"The email address of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.organization","description":"The organization of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.postalcode","description":"The postal code of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.street","description":"The street of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.phone","description":"The phone number of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.TechAdmin.city","description":"The city of the tech administrator.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.country","description":"The country of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.state","description":"The state of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.organization","description":"The organization of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.postalcode","description":"The postal code of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.street","description":"The street of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.phone","description":"The phone number of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.Registrant.city","description":"The city of the registrant.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.ID","description":"The ID of the domain.","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.QueryStatus","description":"The result of the command (\"Success\" or \"Failed\").","type":"string"},{"contentPath":"","contextPath":"Domain.Whois.QueryResult","description":"Whether the query found a matching result.","type":"Boolean"},{"contentPath":"","contextPath":"Domain.Admin.Country","description":"The country of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.Name","description":"The name of domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.State","description":"The state of domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.country","description":"The country of the domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.name","description":"The name of domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Admin.state","description":"The state of domain administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.CreationDate","description":"The date that the domain was created.","type":"Date"},{"contentPath":"","contextPath":"Domain.DomainStatus","description":"The domain status.","type":"String"},{"contentPath":"","contextPath":"Domain.ExpirationDate","description":"The date that the domain expires.","type":"Date"},{"contentPath":"","contextPath":"Domain.FeedRelatedIndicators.type","description":"Indicators that are associated with the Domain.","type":"String"},{"contentPath":"","contextPath":"Domain.FeedRelatedIndicators.value","description":"The type of the indicators that are associated with the Domain.","type":"String"},{"contentPath":"","contextPath":"Domain.Name","description":"The domain name.","type":"String"},{"contentPath":"","contextPath":"Domain.NameServers","description":"The name servers.","type":"String"},{"contentPath":"","contextPath":"Domain.Organization","description":"The organization name.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.Country","description":"The country of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.Organization","description":"The organization of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.State","description":"The state of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.country","description":"The country of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.organization","description":"The organization of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrant.state","description":"The state of the registrant.","type":"String"},{"contentPath":"","contextPath":"Domain.Registrar.Name","description":"The name of the registrar.","type":"String"},{"contentPath":"","contextPath":"Domain.Tech.Country","description":"The country of tech administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.Tech.Organization","description":"The organization of the tech administrator.","type":"String"},{"contentPath":"","contextPath":"Domain.UpdatedDate","description":"The date that the domain was last updated.","type":"Date"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0},{"arguments":[{"default":true,"deprecated":false,"description":"The IP to enrich.","isArray":true,"name":"ip","required":true,"secret":false}],"cartesian":false,"deprecated":false,"description":"Provides data enrichment for ips.","docsHidden":false,"execution":false,"hidden":false,"important":null,"indicatorAction":false,"name":"ip","outputs":[{"contentPath":"","contextPath":"Whois.IP.asn","description":"Globally unique identifier used for routing information exchange with Autonomous Systems.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.asn_cidr","description":"Network routing block assigned to an ASN.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.asn_country_code","description":"ASN assigned country code in ISO 3166-1 format.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.asn_date","description":"ASN allocation date in ISO 8601 format.","type":"Date"},{"contentPath":"","contextPath":"Whois.IP.asn_description","description":"The ASN description","type":"string"},{"contentPath":"","contextPath":"Whois.IP.asn_registry","description":"ASN assigned regional internet registry.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.entities","description":"list of object names referenced by an RIR network. Map these to the objects dictionary keys.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.cidr","description":"Network routing block an IP address belongs to.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.country","description":"Country code registered with the RIR in ISO 3166-1 format.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.end_address","description":"The last IP address in a network block.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.events.action","description":"The reason for an event.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.events.actor","description":"The identifier for an event initiator (if any).","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.events.timestamp","description":"The date an event occurred in ISO 8601 format.","type":"Date"},{"contentPath":"","contextPath":"Whois.IP.network.handle","description":"Unique identifier for a registered object.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.ip_version","description":"IP protocol version (v4 or v6) of an IP address.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.links","description":"HTTP/HTTPS links provided for an RIR object.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.name","description":"The identifier assigned to the network registration for an IP address.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.notices.description","description":"The description/body of a notice.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.notices.links","description":"list of HTTP/HTTPS links provided for a notice.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.notices.title","description":"The title/header for a notice.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.parent_handle","description":"Unique identifier for the parent network of a registered network.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.remarks","description":"List of remark (notice) dictionaries.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.start_address","description":"The first IP address in a network block.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.status","description":"List indicating the state of a registered object.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.network.type","description":"The RIR classification of a registered network.","type":"string"},{"contentPath":"","contextPath":"Whois.IP.query","description":"The IP address","type":"string"},{"contentPath":"","contextPath":"IP.Address","description":"IP address","type":"string"},{"contentPath":"","contextPath":"IP.ASN","description":"The autonomous system name for the IP address, for example: \"AS8948\".","type":"string"},{"contentPath":"","contextPath":"IP.Geo.Country","description":"The country in which the IP address is located.","type":"string"},{"contentPath":"","contextPath":"IP.Organization.Name","description":"The organization name.","type":"string"},{"contentPath":"","contextPath":"IP.feed_related_indicators.value","description":"Indicators that are associated with the IP.","type":"string"},{"contentPath":"","contextPath":"IP.feed_related_indicators.type","description":"The type of the indicators that are associated with the IP","type":"string"},{"contentPath":"","contextPath":"DBotScore.Indicator","description":"The indicator that was tested.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Type","description":"The indicator type.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Vendor","description":"The vendor used to calculate the score.","type":"String"},{"contentPath":"","contextPath":"DBotScore.Score","description":"The actual score.","type":"Number"},{"contentPath":"","contextPath":"DBotScore.Reliability","description":"Reliability of the source providing the intelligence data.","type":"String"}],"permitted":false,"polling":false,"sensitive":false,"timeout":0}],"dockerImage":"demisto/ippysocks:1.0.0.23955","feed":false,"isFetch":false,"isFetchCredentials":false,"isFetchSamples":false,"isMappable":false,"isRemoteSyncIn":false,"isRemoteSyncOut":false,"longRunning":false,"longRunningPortMapping":false,"resetContext":false,"runOnce":false,"script":"\n\n\nimport re\nimport socket\nimport sys\nfrom codecs import encode, decode\nimport socks\nimport errno\n\nSHOULD_ERROR = demisto.params().get('with_error', False)\n\n# flake8: noqa\n\n\"\"\"\n    This integration is built using the joepie91 \"Whois\" module. For more information regarding this package please see\n    the following - https://github.com/joepie91/python-whois\n\"\"\"\n\n''' HELPER FUNCTIONS '''\n# About the drop some mean regex right now disable-secrets-detection-start\ntlds = {\n    \"_\": {\n        \"schema\": \"2\",\n        \"updated\": \"2018-10-05 11:43:46 UTC\"\n    },\n    \"aaa\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"aarp\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.aarp\"\n    },\n    \"abarth\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"abb\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"abbott\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"abbvie\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"abc\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.abc\"\n    },\n    \"able\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"abogado\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.abogado\"\n    },\n    \"abudhabi\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.abudhabi\"\n    },\n    \"ac\": {\n        \"host\": \"whois.nic.ac\"\n    },\n    \"academy\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.academy\"\n    },\n    \"accenture\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"accountant\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.accountant\"\n    },\n    \"accountants\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.accountants\"\n    },\n    \"aco\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"active\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"actor\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.actor\"\n    },\n    \"ad\": {\n        \"adapter\": \"none\"\n    },\n    \"adac\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ads\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"adult\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"ae\": {\n        \"host\": \"whois.aeda.net.ae\"\n    },\n    \"aeg\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.aeg\"\n    },\n    \"aero\": {\n        \"host\": \"whois.aero\"\n    },\n    \"aetna\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"af\": {\n        \"host\": \"whois.nic.af\"\n    },\n    \"afamilycompany\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.afamilycompany\"\n    },\n    \"afl\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.afl\"\n    },\n    \"africa\": {\n        \"_group\": \"zaregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"africa-whois.registry.net.za\"\n    },\n    \"ag\": {\n        \"host\": \"whois.nic.ag\"\n    },\n    \"agakhan\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"agency\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.agency\"\n    },\n    \"ai\": {\n        \"host\": \"whois.nic.ai\"\n    },\n    \"aig\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"aigo\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"airbus\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.airbus\"\n    },\n    \"airforce\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.airforce\"\n    },\n    \"airtel\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.airtel\"\n    },\n    \"akdn\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"al\": {\n        \"adapter\": \"none\"\n    },\n    \"alfaromeo\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"alibaba\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.alibaba\"\n    },\n    \"alipay\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.alipay\"\n    },\n    \"allfinanz\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"allstate\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"ally\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ally\"\n    },\n    \"alsace\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-alsace.nic.fr\"\n    },\n    \"alstom\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.alstom\"\n    },\n    \"am\": {\n        \"host\": \"whois.amnic.net\"\n    },\n    \"americanexpress\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"americanfamily\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.americanfamily\"\n    },\n    \"amex\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"amfam\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.amfam\"\n    },\n    \"amica\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"amsterdam\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.amsterdam\"\n    },\n    \"analytics\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"android\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"anquan\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"anz\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.anz\"\n    },\n    \"ao\": {\n        \"adapter\": \"none\"\n    },\n    \"aol\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.aol\"\n    },\n    \"apartments\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.apartments\"\n    },\n    \"app\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"apple\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"aq\": {\n        \"adapter\": \"none\"\n    },\n    \"aquarelle\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-aquarelle.nic.fr\"\n    },\n    \"ar\": {\n        \"host\": \"whois.nic.ar\"\n    },\n    \"aramco\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"archi\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"army\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.army\"\n    },\n    \"arpa\": {\n        \"host\": \"whois.iana.org\"\n    },\n    \"e164.arpa\": {\n        \"host\": \"whois.ripe.net\"\n    },\n    \"in-addr.arpa\": {\n        \"adapter\": \"arpa\"\n    },\n    \"art\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.art\"\n    },\n    \"arte\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.arte\"\n    },\n    \"as\": {\n        \"host\": \"whois.nic.as\"\n    },\n    \"asda\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.asda\"\n    },\n    \"asia\": {\n        \"host\": \"whois.nic.asia\"\n    },\n    \"associates\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.associates\"\n    },\n    \"at\": {\n        \"host\": \"whois.nic.at\"\n    },\n    \"priv.at\": {\n        \"host\": \"whois.nic.priv.at\"\n    },\n    \"athleta\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"attorney\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.attorney\"\n    },\n    \"au\": {\n        \"host\": \"whois.auda.org.au\"\n    },\n    \"auction\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.auction\"\n    },\n    \"audi\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"audible\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"audio\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"auspost\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.auspost\"\n    },\n    \"author\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"auto\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"autos\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"avianca\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"aw\": {\n        \"host\": \"whois.nic.aw\"\n    },\n    \"aws\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ax\": {\n        \"host\": \"whois.ax\"\n    },\n    \"axa\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"az\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.az/\"\n    },\n    \"azure\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ba\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://nic.ba/lat/menu/view/13\"\n    },\n    \"baby\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"baidu\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"banamex\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"bananarepublic\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"band\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.band\"\n    },\n    \"bank\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bank\"\n    },\n    \"bar\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bar\"\n    },\n    \"barcelona\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.barcelona\"\n    },\n    \"barclaycard\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.barclaycard\"\n    },\n    \"barclays\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.barclays\"\n    },\n    \"barefoot\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.barefoot\"\n    },\n    \"bargains\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bargains\"\n    },\n    \"baseball\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"basketball\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.basketball\"\n    },\n    \"bauhaus\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bauhaus\"\n    },\n    \"bayern\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bayern\"\n    },\n    \"bb\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://whois.telecoms.gov.bb/search_domain.php\"\n    },\n    \"bbc\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bbc\"\n    },\n    \"bbt\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bbt\"\n    },\n    \"bbva\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bbva\"\n    },\n    \"bcg\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bcg\"\n    },\n    \"bcn\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bcn\"\n    },\n    \"bd\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://whois.btcl.net.bd/\"\n    },\n    \"be\": {\n        \"host\": \"whois.dns.be\"\n    },\n    \"beats\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"beauty\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.beauty\"\n    },\n    \"beer\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.beer\"\n    },\n    \"bentley\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bentley\"\n    },\n    \"berlin\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.berlin\"\n    },\n    \"best\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.best\"\n    },\n    \"bestbuy\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bestbuy\"\n    },\n    \"bet\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"bf\": {\n        \"adapter\": \"none\"\n    },\n    \"bg\": {\n        \"host\": \"whois.register.bg\"\n    },\n    \"bh\": {\n        \"adapter\": \"none\"\n    },\n    \"bharti\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"bi\": {\n        \"host\": \"whois1.nic.bi\"\n    },\n    \"bible\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bible\"\n    },\n    \"bid\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bid\"\n    },\n    \"bike\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bike\"\n    },\n    \"bing\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"bingo\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bingo\"\n    },\n    \"bio\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"biz\": {\n        \"host\": \"whois.biz\"\n    },\n    \"bj\": {\n        \"host\": \"whois.nic.bj\"\n    },\n    \"black\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"blackfriday\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"blanco\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.blanco\"\n    },\n    \"blockbuster\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.blockbuster\"\n    },\n    \"blog\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.blog\"\n    },\n    \"bloomberg\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"blue\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"bm\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.bermudanic.bm/cgi-bin/lansaweb?procfun+BMWHO+BMWHO2+WHO\"\n    },\n    \"bms\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bms\"\n    },\n    \"bmw\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"bn\": {\n        \"host\": \"whois.bnnic.bn\"\n    },\n    \"bnl\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bnl\"\n    },\n    \"bnpparibas\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"bo\": {\n        \"host\": \"whois.nic.bo\"\n    },\n    \"boats\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"boehringer\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"bofa\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bofa\"\n    },\n    \"bom\": {\n        \"_group\": \"nicbr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtlds.nic.br\"\n    },\n    \"bond\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bond\"\n    },\n    \"boo\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"book\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"booking\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"bosch\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bosch\"\n    },\n    \"bostik\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-bostik.nic.fr\"\n    },\n    \"boston\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.boston\"\n    },\n    \"bot\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"boutique\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.boutique\"\n    },\n    \"box\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"br\": {\n        \"host\": \"whois.registro.br\"\n    },\n    \"bradesco\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bradesco\"\n    },\n    \"bridgestone\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bridgestone\"\n    },\n    \"broadway\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.broadway\"\n    },\n    \"broker\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.broker\"\n    },\n    \"brother\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.brother\"\n    },\n    \"brussels\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.brussels\"\n    },\n    \"bs\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.bs/cgi-bin/search.pl\"\n    },\n    \"bt\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.bt/\"\n    },\n    \"budapest\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-dub.mm-registry.com\"\n    },\n    \"bugatti\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"build\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.build\"\n    },\n    \"builders\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.builders\"\n    },\n    \"business\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.business\"\n    },\n    \"buy\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"buzz\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.buzz\"\n    },\n    \"bv\": {\n        \"adapter\": \"none\"\n    },\n    \"bw\": {\n        \"host\": \"whois.nic.net.bw\"\n    },\n    \"by\": {\n        \"host\": \"whois.cctld.by\"\n    },\n    \"bz\": {\n        \"host\": \"whois.afilias-grs.info\",\n        \"adapter\": \"afilias\"\n    },\n    \"za.bz\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"bzh\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.bzh\"\n    },\n    \"ca\": {\n        \"host\": \"whois.cira.ca\"\n    },\n    \"co.ca\": {\n        \"host\": \"whois.co.ca\"\n    },\n    \"cab\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cab\"\n    },\n    \"cafe\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cafe\"\n    },\n    \"cal\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"call\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"calvinklein\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"cam\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"camera\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.camera\"\n    },\n    \"camp\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.camp\"\n    },\n    \"cancerresearch\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cancerresearch\"\n    },\n    \"canon\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.canon\"\n    },\n    \"capetown\": {\n        \"_group\": \"zaregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"capetown-whois.registry.net.za\"\n    },\n    \"capital\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.capital\"\n    },\n    \"capitalone\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.capitalone\"\n    },\n    \"car\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"caravan\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"cards\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cards\"\n    },\n    \"care\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.care\"\n    },\n    \"career\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.career\"\n    },\n    \"careers\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.careers\"\n    },\n    \"cars\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"cartier\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"casa\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.casa\"\n    },\n    \"case\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.case\"\n    },\n    \"caseih\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.caseih\"\n    },\n    \"cash\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cash\"\n    },\n    \"casino\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.casino\"\n    },\n    \"cat\": {\n        \"host\": \"whois.nic.cat\",\n        \"adapter\": \"formatted\",\n        \"format\": \"-C US-ASCII ace %s\"\n    },\n    \"catering\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.catering\"\n    },\n    \"catholic\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"cba\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cba\"\n    },\n    \"cbn\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"cbre\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"cbs\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"cc\": {\n        \"host\": \"ccwhois.verisign-grs.com\",\n        \"adapter\": \"verisign\"\n    },\n    \"cd\": {\n        \"host\": \"whois.nic.cd\"\n    },\n    \"ceb\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"center\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.center\"\n    },\n    \"ceo\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ceo\"\n    },\n    \"cern\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"cf\": {\n        \"host\": \"whois.dot.cf\"\n    },\n    \"cfa\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cfa\"\n    },\n    \"cfd\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cfd\"\n    },\n    \"cg\": {\n        \"adapter\": \"none\"\n    },\n    \"ch\": {\n        \"host\": \"whois.nic.ch\"\n    },\n    \"chanel\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.chanel\"\n    },\n    \"channel\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"charity\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.charity\"\n    },\n    \"chase\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"chat\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.chat\"\n    },\n    \"cheap\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cheap\"\n    },\n    \"chintai\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.chintai\"\n    },\n    \"christmas\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"chrome\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"chrysler\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"church\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.church\"\n    },\n    \"ci\": {\n        \"host\": \"whois.nic.ci\"\n    },\n    \"cipriani\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"circle\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"cisco\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"citadel\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"citi\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"citic\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"city\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.city\"\n    },\n    \"cityeats\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cityeats\"\n    },\n    \"ck\": {\n        \"adapter\": \"none\"\n    },\n    \"cl\": {\n        \"host\": \"whois.nic.cl\"\n    },\n    \"claims\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.claims\"\n    },\n    \"cleaning\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cleaning\"\n    },\n    \"click\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"clinic\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.clinic\"\n    },\n    \"clinique\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.clinique\"\n    },\n    \"clothing\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.clothing\"\n    },\n    \"cloud\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cloud\"\n    },\n    \"club\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.club\"\n    },\n    \"clubmed\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.clubmed\"\n    },\n    \"cm\": {\n        \"host\": \"whois.netcom.cm\"\n    },\n    \"cn\": {\n        \"host\": \"whois.cnnic.cn\"\n    },\n    \"edu.cn\": {\n        \"adapter\": \"none\"\n    },\n    \"co\": {\n        \"host\": \"whois.nic.co\"\n    },\n    \"coach\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.coach\"\n    },\n    \"codes\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.codes\"\n    },\n    \"coffee\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.coffee\"\n    },\n    \"college\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.college\"\n    },\n    \"cologne\": {\n        \"_group\": \"knipp\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ryce-rsp.com\"\n    },\n    \"com\": {\n        \"host\": \"whois.verisign-grs.com\",\n        \"adapter\": \"verisign\"\n    },\n    \"africa.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"ar.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"br.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"cn.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"co.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.net\"\n    },\n    \"de.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"eu.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"gb.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"gr.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"hk.com\": {\n        \"_group\": \"udrregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.registry.hk.com\"\n    },\n    \"hu.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"jpn.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"kr.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"no.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"qc.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"ru.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"sa.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"se.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"uk.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"us.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"uy.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"za.com\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"comcast\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.comcast\"\n    },\n    \"commbank\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.commbank\"\n    },\n    \"community\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.community\"\n    },\n    \"company\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.company\"\n    },\n    \"compare\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.compare\"\n    },\n    \"computer\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.computer\"\n    },\n    \"comsec\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.comsec\"\n    },\n    \"condos\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.condos\"\n    },\n    \"construction\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.construction\"\n    },\n    \"consulting\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.consulting\"\n    },\n    \"contact\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.contact\"\n    },\n    \"contractors\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.contractors\"\n    },\n    \"cooking\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cooking\"\n    },\n    \"cookingchannel\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cookingchannel\"\n    },\n    \"cool\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cool\"\n    },\n    \"coop\": {\n        \"host\": \"whois.nic.coop\"\n    },\n    \"corsica\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-corsica.nic.fr\"\n    },\n    \"country\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-dub.mm-registry.com\"\n    },\n    \"coupon\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"coupons\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.coupons\"\n    },\n    \"courses\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"cr\": {\n        \"host\": \"whois.nic.cr\"\n    },\n    \"credit\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.credit\"\n    },\n    \"creditcard\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.creditcard\"\n    },\n    \"creditunion\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"cricket\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cricket\"\n    },\n    \"crown\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"crs\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"cruise\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cruise\"\n    },\n    \"cruises\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cruises\"\n    },\n    \"csc\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.csc\"\n    },\n    \"cu\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.cu/\"\n    },\n    \"cuisinella\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cuisinella\"\n    },\n    \"cv\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.dns.cv/\"\n    },\n    \"cw\": {\n        \"adapter\": \"none\"\n    },\n    \"cx\": {\n        \"host\": \"whois.nic.cx\"\n    },\n    \"cy\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.cy/nslookup/online_database.php\"\n    },\n    \"cymru\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cymru\"\n    },\n    \"cyou\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.cyou\"\n    },\n    \"cz\": {\n        \"host\": \"whois.nic.cz\"\n    },\n    \"dabur\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"dad\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"dance\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dance\"\n    },\n    \"data\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.data\"\n    },\n    \"date\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.date\"\n    },\n    \"dating\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dating\"\n    },\n    \"datsun\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"day\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"dclk\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"dds\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dds\"\n    },\n    \"de\": {\n        \"host\": \"whois.denic.de\",\n        \"adapter\": \"formatted\",\n        \"format\": \"-T dn,ace %s\"\n    },\n    \"com.de\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"deal\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"dealer\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"deals\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.deals\"\n    },\n    \"degree\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.degree\"\n    },\n    \"delivery\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.delivery\"\n    },\n    \"dell\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"deloitte\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.deloitte\"\n    },\n    \"delta\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.delta\"\n    },\n    \"democrat\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.democrat\"\n    },\n    \"dental\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dental\"\n    },\n    \"dentist\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dentist\"\n    },\n    \"desi\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"design\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.design\"\n    },\n    \"dev\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"dhl\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"diamonds\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.diamonds\"\n    },\n    \"diet\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"digital\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.digital\"\n    },\n    \"direct\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.direct\"\n    },\n    \"directory\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.directory\"\n    },\n    \"discount\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.discount\"\n    },\n    \"discover\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"dish\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dish\"\n    },\n    \"diy\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.diy\"\n    },\n    \"dj\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.dj/whois.php\"\n    },\n    \"dk\": {\n        \"host\": \"whois.dk-hostmaster.dk\",\n        \"adapter\": \"formatted\",\n        \"format\": \"--show-handles %s\"\n    },\n    \"dm\": {\n        \"host\": \"whois.nic.dm\"\n    },\n    \"dnp\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"do\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.do/whois-h.php3\"\n    },\n    \"docs\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"doctor\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.doctor\"\n    },\n    \"dodge\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"dog\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dog\"\n    },\n    \"doha\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.doha\"\n    },\n    \"domains\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.domains\"\n    },\n    \"doosan\": {\n        \"host\": \"whois.nic.xn--cg4bki\"\n    },\n    \"dot\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dot\"\n    },\n    \"download\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.download\"\n    },\n    \"drive\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"dtv\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dtv\"\n    },\n    \"dubai\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dubai\"\n    },\n    \"duck\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.duck\"\n    },\n    \"dunlop\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.dunlop\"\n    },\n    \"duns\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"dupont\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"durban\": {\n        \"_group\": \"zaregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"durban-whois.registry.net.za\"\n    },\n    \"dvag\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"dvr\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"dz\": {\n        \"host\": \"whois.nic.dz\"\n    },\n    \"earth\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"eat\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"ec\": {\n        \"host\": \"whois.nic.ec\"\n    },\n    \"eco\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"edeka\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"edu\": {\n        \"host\": \"whois.educause.edu\"\n    },\n    \"education\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.education\"\n    },\n    \"ee\": {\n        \"host\": \"whois.tld.ee\"\n    },\n    \"eg\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://lookup.egregistry.eg/english.aspx\"\n    },\n    \"email\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.email\"\n    },\n    \"emerck\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"energy\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.energy\"\n    },\n    \"engineer\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.engineer\"\n    },\n    \"engineering\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.engineering\"\n    },\n    \"enterprises\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.enterprises\"\n    },\n    \"epost\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"epson\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"equipment\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.equipment\"\n    },\n    \"er\": {\n        \"adapter\": \"none\"\n    },\n    \"ericsson\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ericsson\"\n    },\n    \"erni\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.erni\"\n    },\n    \"es\": {\n        \"host\": \"whois.nic.es\"\n    },\n    \"esq\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"estate\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.estate\"\n    },\n    \"esurance\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"et\": {\n        \"adapter\": \"none\"\n    },\n    \"etisalat\": {\n        \"_group\": \"centralnic\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"eu\": {\n        \"host\": \"whois.eu\"\n    },\n    \"eurovision\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.eurovision\"\n    },\n    \"eus\": {\n        \"_group\": \"coreregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.eus\"\n    },\n    \"events\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.events\"\n    },\n    \"everbank\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.everbank\"\n    },\n    \"exchange\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.exchange\"\n    },\n    \"expert\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.expert\"\n    },\n    \"exposed\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.exposed\"\n    },\n    \"express\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.express\"\n    },\n    \"extraspace\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"fage\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"fail\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fail\"\n    },\n    \"fairwinds\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fairwinds\"\n    },\n    \"faith\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.faith\"\n    },\n    \"family\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.family\"\n    },\n    \"fan\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fan\"\n    },\n    \"fans\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fans\"\n    },\n    \"farm\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.farm\"\n    },\n    \"farmers\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"fashion\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fashion\"\n    },\n    \"fast\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"fedex\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fedex\"\n    },\n    \"feedback\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.feedback\"\n    },\n    \"ferrari\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ferrari\"\n    },\n    \"ferrero\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"fi\": {\n        \"host\": \"whois.fi\"\n    },\n    \"fiat\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"fidelity\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fidelity\"\n    },\n    \"fido\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"film\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.film\"\n    },\n    \"final\": {\n        \"_group\": \"nicbr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtlds.nic.br\"\n    },\n    \"finance\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.finance\"\n    },\n    \"financial\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.financial\"\n    },\n    \"fire\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"firestone\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.firestone\"\n    },\n    \"firmdale\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.firmdale\"\n    },\n    \"fish\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fish\"\n    },\n    \"fishing\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fishing\"\n    },\n    \"fit\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fit\"\n    },\n    \"fitness\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fitness\"\n    },\n    \"fj\": {\n        \"host\": \"whois.usp.ac.fj\"\n    },\n    \"fk\": {\n        \"adapter\": \"none\"\n    },\n    \"flickr\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"flights\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.flights\"\n    },\n    \"flir\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"florist\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.florist\"\n    },\n    \"flowers\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"fly\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"fm\": {\n        \"host\": \"whois.nic.fm\"\n    },\n    \"fo\": {\n        \"host\": \"whois.nic.fo\"\n    },\n    \"foo\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"food\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"foodnetwork\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.foodnetwork\"\n    },\n    \"football\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.football\"\n    },\n    \"ford\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"forex\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.forex\"\n    },\n    \"forsale\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.forsale\"\n    },\n    \"forum\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.forum\"\n    },\n    \"foundation\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.foundation\"\n    },\n    \"fox\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"fr\": {\n        \"host\": \"whois.nic.fr\"\n    },\n    \"aeroport.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"avocat.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"chambagri.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"chirurgiens-dentistes.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"experts-comptables.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"geometre-expert.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"medecin.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"notaires.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"pharmacien.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"port.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"veterinaire.fr\": {\n        \"_group\": \"smallregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.smallregistry.net\"\n    },\n    \"free\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"fresenius\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"frl\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.frl\"\n    },\n    \"frogans\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.frogans\"\n    },\n    \"frontdoor\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.frontdoor\"\n    },\n    \"frontier\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ftr\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"fujitsu\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"fujixerox\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fujixerox\"\n    },\n    \"fun\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fun\"\n    },\n    \"fund\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fund\"\n    },\n    \"furniture\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.furniture\"\n    },\n    \"futbol\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.futbol\"\n    },\n    \"fyi\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.fyi\"\n    },\n    \"ga\": {\n        \"host\": \"whois.dot.ga\"\n    },\n    \"gal\": {\n        \"_group\": \"coreregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gal\"\n    },\n    \"gallery\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gallery\"\n    },\n    \"gallo\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gallo\"\n    },\n    \"gallup\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gallup\"\n    },\n    \"game\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"games\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.games\"\n    },\n    \"gap\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"garden\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.garden\"\n    },\n    \"gb\": {\n        \"adapter\": \"none\"\n    },\n    \"gbiz\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"gd\": {\n        \"host\": \"whois.nic.gd\"\n    },\n    \"gdn\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gdn\"\n    },\n    \"ge\": {\n        \"host\": \"whois.registration.ge\"\n    },\n    \"gea\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"gent\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gent\"\n    },\n    \"genting\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.genting\"\n    },\n    \"george\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.george\"\n    },\n    \"gf\": {\n        \"host\": \"whois.mediaserv.net\"\n    },\n    \"gg\": {\n        \"host\": \"whois.gg\"\n    },\n    \"ggee\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ggee\"\n    },\n    \"gh\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.gh/customer/search_c.htm\"\n    },\n    \"gi\": {\n        \"host\": \"whois.afilias-grs.info\",\n        \"adapter\": \"afilias\"\n    },\n    \"gift\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"gifts\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gifts\"\n    },\n    \"gives\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gives\"\n    },\n    \"giving\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.giving\"\n    },\n    \"gl\": {\n        \"host\": \"whois.nic.gl\"\n    },\n    \"glade\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.glade\"\n    },\n    \"glass\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.glass\"\n    },\n    \"gle\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"global\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.global\"\n    },\n    \"globo\": {\n        \"_group\": \"nicbr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtlds.nic.br\"\n    },\n    \"gm\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.gm/htmlpages/whois.htm\"\n    },\n    \"gmail\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"gmbh\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmbh\"\n    },\n    \"gmoregistry\": {\n        \"_group\": \"gmo\",\n        \"adapter\": \"none\"\n    },\n    \"gmx\": {\n        \"_group\": \"knipp\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-fe1.gmx.tango.knipp.de\"\n    },\n    \"gn\": {\n        \"adapter\": \"none\"\n    },\n    \"godaddy\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"gold\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gold\"\n    },\n    \"goldpoint\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.goldpoint\"\n    },\n    \"golf\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.golf\"\n    },\n    \"goo\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"goodyear\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.goodyear\"\n    },\n    \"goog\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"google\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"gop\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gop\"\n    },\n    \"got\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"gov\": {\n        \"host\": \"whois.dotgov.gov\"\n    },\n    \"gp\": {\n        \"adapter\": \"web\",\n        \"url\": \"https://www.dom-enic.com/whois.html\"\n    },\n    \"gq\": {\n        \"host\": \"whois.dominio.gq\"\n    },\n    \"gr\": {\n        \"adapter\": \"web\",\n        \"url\": \"https://grweb.ics.forth.gr/Whois?lang=en\"\n    },\n    \"grainger\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"graphics\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.graphics\"\n    },\n    \"gratis\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gratis\"\n    },\n    \"green\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"gripe\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gripe\"\n    },\n    \"grocery\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"group\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.group\"\n    },\n    \"gs\": {\n        \"host\": \"whois.nic.gs\"\n    },\n    \"gt\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.gt/\"\n    },\n    \"gu\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://gadao.gov.gu/domainsearch.htm\"\n    },\n    \"guardian\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"gucci\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"guge\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"guide\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.guide\"\n    },\n    \"guitars\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"guru\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.guru\"\n    },\n    \"gw\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://nic.gw/en/whois/\"\n    },\n    \"gy\": {\n        \"host\": \"whois.registry.gy\"\n    },\n    \"hair\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"hamburg\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hamburg\"\n    },\n    \"hangout\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"haus\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.haus\"\n    },\n    \"hbo\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"hdfc\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hdfc\"\n    },\n    \"hdfcbank\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hdfcbank\"\n    },\n    \"health\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"healthcare\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.healthcare\"\n    },\n    \"help\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"helsinki\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.helsinki\"\n    },\n    \"here\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"hermes\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"hgtv\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hgtv\"\n    },\n    \"hiphop\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"hisamitsu\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"hitachi\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"hiv\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"hk\": {\n        \"host\": \"whois.hkirc.hk\"\n    },\n    \"inc.hk\": {\n        \"_group\": \"udrregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.registry.hk.com\"\n    },\n    \"ltd.hk\": {\n        \"_group\": \"udrregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.registry.hk.com\"\n    },\n    \"hkt\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hkt\"\n    },\n    \"hm\": {\n        \"host\": \"whois.registry.hm\"\n    },\n    \"hn\": {\n        \"host\": \"whois.nic.hn\"\n    },\n    \"hockey\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hockey\"\n    },\n    \"holdings\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.holdings\"\n    },\n    \"holiday\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.holiday\"\n    },\n    \"homedepot\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.homedepot\"\n    },\n    \"homegoods\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"homes\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"homesense\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"honda\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.honda\"\n    },\n    \"honeywell\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"horse\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.horse\"\n    },\n    \"hospital\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hospital\"\n    },\n    \"host\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.host\"\n    },\n    \"hosting\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"hot\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"hoteles\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"hotels\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"hotmail\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"house\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.house\"\n    },\n    \"how\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"hr\": {\n        \"host\": \"whois.dns.hr\"\n    },\n    \"hsbc\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ht\": {\n        \"host\": \"whois.nic.ht\"\n    },\n    \"hu\": {\n        \"host\": \"whois.nic.hu\"\n    },\n    \"hughes\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hughes\"\n    },\n    \"hyatt\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"hyundai\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.hyundai\"\n    },\n    \"ibm\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ibm\"\n    },\n    \"icbc\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.icbc\"\n    },\n    \"ice\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ice\"\n    },\n    \"icu\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.icu\"\n    },\n    \"id\": {\n        \"host\": \"whois.id\"\n    },\n    \"ie\": {\n        \"host\": \"whois.iedr.ie\"\n    },\n    \"ieee\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ifm\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ifm\"\n    },\n    \"ikano\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ikano.tld-box.at\"\n    },\n    \"il\": {\n        \"host\": \"whois.isoc.org.il\"\n    },\n    \"co.il\": {\n        \"host\": \"whois.isoc.org.il\"\n    },\n    \"im\": {\n        \"host\": \"whois.nic.im\"\n    },\n    \"imamat\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"imdb\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"immo\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.immo\"\n    },\n    \"immobilien\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.immobilien\"\n    },\n    \"in\": {\n        \"host\": \"in.whois-servers.net\"\n    },\n    \"inc\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.inc\"\n    },\n    \"industries\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.industries\"\n    },\n    \"infiniti\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"info\": {\n        \"host\": \"whois.afilias.net\"\n    },\n    \"ing\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"ink\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ink\"\n    },\n    \"institute\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.institute\"\n    },\n    \"insurance\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.insurance\"\n    },\n    \"insure\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.insure\"\n    },\n    \"int\": {\n        \"host\": \"whois.iana.org\"\n    },\n    \"intel\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"international\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.international\"\n    },\n    \"intuit\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"investments\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.investments\"\n    },\n    \"io\": {\n        \"host\": \"whois.nic.io\"\n    },\n    \"ipiranga\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"iq\": {\n        \"host\": \"whois.cmc.iq\"\n    },\n    \"ir\": {\n        \"host\": \"whois.nic.ir\"\n    },\n    \"irish\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.irish\"\n    },\n    \"is\": {\n        \"host\": \"whois.isnic.is\"\n    },\n    \"iselect\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.iselect\"\n    },\n    \"ismaili\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"ist\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"istanbul\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"it\": {\n        \"host\": \"whois.nic.it\"\n    },\n    \"itau\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"itv\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"iveco\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.iveco\"\n    },\n    \"jaguar\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.jaguar\"\n    },\n    \"java\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.java\"\n    },\n    \"jcb\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"jcp\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"je\": {\n        \"host\": \"whois.je\"\n    },\n    \"jeep\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"jetzt\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\",\n        \"host\": \"whois.nic.jetzt\"\n    },\n    \"jewelry\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.jewelry\"\n    },\n    \"jio\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.jio\"\n    },\n    \"jll\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"jm\": {\n        \"adapter\": \"none\"\n    },\n    \"jmp\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"jnj\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"jo\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.dns.jo/Whois.aspx\"\n    },\n    \"jobs\": {\n        \"host\": \"whois.nic.jobs\",\n        \"adapter\": \"verisign\"\n    },\n    \"joburg\": {\n        \"_group\": \"zaregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"joburg-whois.registry.net.za\"\n    },\n    \"jot\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"joy\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"jp\": {\n        \"host\": \"whois.jprs.jp\",\n        \"adapter\": \"formatted\",\n        \"format\": \"%s/e\"\n    },\n    \"jpmorgan\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"jprs\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"juegos\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"juniper\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.juniper\"\n    },\n    \"kaufen\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kaufen\"\n    },\n    \"kddi\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kddi\"\n    },\n    \"ke\": {\n        \"host\": \"whois.kenic.or.ke\"\n    },\n    \"kerryhotels\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kerryhotels\"\n    },\n    \"kerrylogistics\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kerrylogistics\"\n    },\n    \"kerryproperties\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kerryproperties\"\n    },\n    \"kfh\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kfh\"\n    },\n    \"kg\": {\n        \"host\": \"whois.kg\"\n    },\n    \"kh\": {\n        \"adapter\": \"none\"\n    },\n    \"ki\": {\n        \"host\": \"whois.nic.ki\"\n    },\n    \"kia\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kia\"\n    },\n    \"kim\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"kinder\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"kindle\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"kitchen\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kitchen\"\n    },\n    \"kiwi\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kiwi\"\n    },\n    \"km\": {\n        \"adapter\": \"none\"\n    },\n    \"kn\": {\n        \"host\": \"whois.nic.kn\"\n    },\n    \"koeln\": {\n        \"_group\": \"knipp\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ryce-rsp.com\"\n    },\n    \"komatsu\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.komatsu\"\n    },\n    \"kosher\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kosher\"\n    },\n    \"kp\": {\n        \"adapter\": \"none\"\n    },\n    \"kpmg\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"kpn\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"kr\": {\n        \"host\": \"whois.kr\"\n    },\n    \"krd\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"kred\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"kuokgroup\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kuokgroup\"\n    },\n    \"kw\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.kw/\"\n    },\n    \"ky\": {\n        \"host\": \"whois.kyregistry.ky\"\n    },\n    \"kyoto\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.kyoto\"\n    },\n    \"kz\": {\n        \"host\": \"whois.nic.kz\"\n    },\n    \"la\": {\n        \"host\": \"whois.nic.la\"\n    },\n    \"lacaixa\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lacaixa\"\n    },\n    \"ladbrokes\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ladbrokes\"\n    },\n    \"lamborghini\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"lamer\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lamer\"\n    },\n    \"lancaster\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-lancaster.nic.fr\"\n    },\n    \"lancia\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"lancome\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lancome\"\n    },\n    \"land\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.land\"\n    },\n    \"landrover\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.landrover\"\n    },\n    \"lanxess\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"lasalle\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"lat\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lat\"\n    },\n    \"latino\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.latino\"\n    },\n    \"latrobe\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.latrobe\"\n    },\n    \"law\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.law\"\n    },\n    \"lawyer\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lawyer\"\n    },\n    \"lb\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.aub.edu.lb/lbdr/\"\n    },\n    \"lc\": {\n        \"host\": \"whois.afilias-grs.info\",\n        \"adapter\": \"afilias\"\n    },\n    \"lds\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lds\"\n    },\n    \"lease\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lease\"\n    },\n    \"leclerc\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-leclerc.nic.fr\"\n    },\n    \"lefrak\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lefrak\"\n    },\n    \"legal\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.legal\"\n    },\n    \"lego\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lego\"\n    },\n    \"lexus\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lexus\"\n    },\n    \"lgbt\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"li\": {\n        \"host\": \"whois.nic.li\"\n    },\n    \"liaison\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.liaison\"\n    },\n    \"lidl\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lidl\"\n    },\n    \"life\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.life\"\n    },\n    \"lifeinsurance\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"lifestyle\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lifestyle\"\n    },\n    \"lighting\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lighting\"\n    },\n    \"like\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"lilly\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"limited\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.limited\"\n    },\n    \"limo\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.limo\"\n    },\n    \"lincoln\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"linde\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.linde\"\n    },\n    \"link\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"lipsy\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lipsy\"\n    },\n    \"live\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.live\"\n    },\n    \"living\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"lixil\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lixil\"\n    },\n    \"lk\": {\n        \"host\": \"whois.nic.lk\"\n    },\n    \"llc\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"loan\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.loan\"\n    },\n    \"loans\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.loans\"\n    },\n    \"locker\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.locker\"\n    },\n    \"locus\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.locus\"\n    },\n    \"loft\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"lol\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"london\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.london\"\n    },\n    \"lotte\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lotte\"\n    },\n    \"lotto\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"love\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.love\"\n    },\n    \"lpl\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lpl\"\n    },\n    \"lplfinancial\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lplfinancial\"\n    },\n    \"lr\": {\n        \"adapter\": \"none\"\n    },\n    \"ls\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.co.ls/co.asp\"\n    },\n    \"lt\": {\n        \"host\": \"whois.domreg.lt\"\n    },\n    \"ltd\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ltd\"\n    },\n    \"ltda\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"lu\": {\n        \"host\": \"whois.dns.lu\"\n    },\n    \"lundbeck\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.lundbeck\"\n    },\n    \"lupin\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"luxe\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.luxe\"\n    },\n    \"luxury\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.luxury\"\n    },\n    \"lv\": {\n        \"host\": \"whois.nic.lv\"\n    },\n    \"ly\": {\n        \"host\": \"whois.nic.ly\"\n    },\n    \"ma\": {\n        \"host\": \"whois.registre.ma\"\n    },\n    \"macys\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.macys\"\n    },\n    \"madrid\": {\n        \"_group\": \"corenic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.madrid.rs.corenic.net\"\n    },\n    \"maif\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"maison\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.maison\"\n    },\n    \"makeup\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.makeup\"\n    },\n    \"man\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.man\"\n    },\n    \"management\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.management\"\n    },\n    \"mango\": {\n        \"_group\": \"coreregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mango\"\n    },\n    \"map\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"market\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.market\"\n    },\n    \"marketing\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.marketing\"\n    },\n    \"markets\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.markets\"\n    },\n    \"marriott\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"marshalls\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"maserati\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.maserati\"\n    },\n    \"mattel\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mba\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mba\"\n    },\n    \"mc\": {\n        \"adapter\": \"none\"\n    },\n    \"mckinsey\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mckinsey\"\n    },\n    \"md\": {\n        \"host\": \"whois.nic.md\"\n    },\n    \"me\": {\n        \"host\": \"whois.nic.me\"\n    },\n    \"med\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.med\"\n    },\n    \"media\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.media\"\n    },\n    \"meet\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"melbourne\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"meme\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"memorial\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.memorial\"\n    },\n    \"men\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.men\"\n    },\n    \"menu\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.menu\"\n    },\n    \"merckmsd\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"metlife\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.metlife\"\n    },\n    \"mg\": {\n        \"host\": \"whois.nic.mg\"\n    },\n    \"mh\": {\n        \"adapter\": \"none\"\n    },\n    \"miami\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.miami\"\n    },\n    \"microsoft\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mil\": {\n        \"adapter\": \"none\"\n    },\n    \"mini\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"mint\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mit\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"mitsubishi\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"mk\": {\n        \"host\": \"whois.marnet.mk\"\n    },\n    \"ml\": {\n        \"host\": \"whois.dot.ml\"\n    },\n    \"mlb\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mls\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mls\"\n    },\n    \"mm\": {\n        \"adapter\": \"none\"\n    },\n    \"mma\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-mma.nic.fr\"\n    },\n    \"mn\": {\n        \"host\": \"whois.nic.mn\"\n    },\n    \"mo\": {\n        \"host\": \"whois.monic.mo\"\n    },\n    \"mobi\": {\n        \"_group\": \"afilias\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"mobile\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mobile\"\n    },\n    \"mobily\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"moda\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.moda\"\n    },\n    \"moe\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.moe\"\n    },\n    \"moi\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mom\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"monash\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.monash\"\n    },\n    \"money\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.money\"\n    },\n    \"monster\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.monster\"\n    },\n    \"montblanc\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mopar\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"mormon\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mormon\"\n    },\n    \"mortgage\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mortgage\"\n    },\n    \"moscow\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.moscow\"\n    },\n    \"moto\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"motorcycles\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"mov\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"movie\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.movie\"\n    },\n    \"movistar\": {\n        \"_group\": \"knipp\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-fe.movistar.tango.knipp.de\"\n    },\n    \"mp\": {\n        \"adapter\": \"none\"\n    },\n    \"mq\": {\n        \"host\": \"whois.mediaserv.net\"\n    },\n    \"mr\": {\n        \"adapter\": \"none\",\n        \"host\": \"whois.nic.mr\"\n    },\n    \"ms\": {\n        \"host\": \"whois.nic.ms\"\n    },\n    \"msd\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mt\": {\n        \"adapter\": \"web\",\n        \"url\": \"https://www.nic.org.mt/dotmt/\"\n    },\n    \"mtn\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mtn\"\n    },\n    \"mtr\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.mtr\"\n    },\n    \"mu\": {\n        \"host\": \"whois.nic.mu\"\n    },\n    \"museum\": {\n        \"host\": \"whois.nic.museum\"\n    },\n    \"mutual\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"mv\": {\n        \"adapter\": \"none\"\n    },\n    \"mw\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.registrar.mw/\"\n    },\n    \"mx\": {\n        \"host\": \"whois.nic.mx\"\n    },\n    \"my\": {\n        \"host\": \"whois.mynic.my\"\n    },\n    \"mz\": {\n        \"host\": \"whois.nic.mz\"\n    },\n    \"na\": {\n        \"host\": \"whois.na-nic.com.na\"\n    },\n    \"nab\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nab\"\n    },\n    \"nadex\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nadex\"\n    },\n    \"nagoya\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nagoya\"\n    },\n    \"name\": {\n        \"host\": \"whois.nic.name\",\n        \"adapter\": \"formatted\",\n        \"format\": \"domain=%s\"\n    },\n    \"nationwide\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nationwide\"\n    },\n    \"natura\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"navy\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.navy\"\n    },\n    \"nba\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"nc\": {\n        \"host\": \"whois.nc\"\n    },\n    \"ne\": {\n        \"adapter\": \"none\"\n    },\n    \"nec\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nec\"\n    },\n    \"net\": {\n        \"host\": \"whois.verisign-grs.com\",\n        \"adapter\": \"verisign\"\n    },\n    \"gb.net\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"hu.net\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"in.net\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"jp.net\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"se.net\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"uk.net\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"za.net\": {\n        \"host\": \"whois.za.net\"\n    },\n    \"netbank\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.netbank\"\n    },\n    \"netflix\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"network\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.network\"\n    },\n    \"neustar\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"new\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"newholland\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.newholland\"\n    },\n    \"news\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.news\"\n    },\n    \"next\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.next\"\n    },\n    \"nextdirect\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nextdirect\"\n    },\n    \"nexus\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"nf\": {\n        \"host\": \"whois.nic.nf\"\n    },\n    \"nfl\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ng\": {\n        \"host\": \"whois.nic.net.ng\"\n    },\n    \"ngo\": {\n        \"_group\": \"publicinterestregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.publicinterestregistry.net\"\n    },\n    \"nhk\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ni\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.ni/\"\n    },\n    \"nico\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nico\"\n    },\n    \"nike\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"nikon\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nikon\"\n    },\n    \"ninja\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ninja\"\n    },\n    \"nissan\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"nissay\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nissay\"\n    },\n    \"nl\": {\n        \"host\": \"whois.domain-registry.nl\"\n    },\n    \"no\": {\n        \"host\": \"whois.norid.no\"\n    },\n    \"nokia\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"northwesternmutual\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"norton\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.norton\"\n    },\n    \"now\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"nowruz\": {\n        \"_group\": \"agitsys\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.agitsys.net\"\n    },\n    \"nowtv\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nowtv\"\n    },\n    \"np\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://register.mos.com.np/np-whois-lookup\"\n    },\n    \"nr\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.cenpac.net.nr/dns/whois.html\"\n    },\n    \"nra\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"nrw\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nrw\"\n    },\n    \"ntt\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"nu\": {\n        \"host\": \"whois.iis.nu\"\n    },\n    \"nyc\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.nyc\"\n    },\n    \"nz\": {\n        \"host\": \"whois.srs.net.nz\"\n    },\n    \"obi\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.obi\"\n    },\n    \"observer\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.observer\"\n    },\n    \"off\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.off\"\n    },\n    \"office\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"okinawa\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.okinawa\"\n    },\n    \"olayan\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.olayan\"\n    },\n    \"olayangroup\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.olayangroup\"\n    },\n    \"oldnavy\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ollo\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ollo\"\n    },\n    \"om\": {\n        \"host\": \"whois.registry.om\"\n    },\n    \"omega\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.omega\"\n    },\n    \"one\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.one\"\n    },\n    \"ong\": {\n        \"_group\": \"publicinterestregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.publicinterestregistry.net\"\n    },\n    \"onl\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"online\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.online\"\n    },\n    \"onyourside\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.onyourside\"\n    },\n    \"ooo\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ooo\"\n    },\n    \"open\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"oracle\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.oracle\"\n    },\n    \"orange\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.orange\"\n    },\n    \"org\": {\n        \"host\": \"whois.pir.org\"\n    },\n    \"ae.org\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"eu.org\": {\n        \"host\": \"whois.eu.org\"\n    },\n    \"hk.org\": {\n        \"_group\": \"udrregistry\",\n        \"_type\": \"private\",\n        \"host\": \"whois.registry.hk.com\"\n    },\n    \"us.org\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"za.org\": {\n        \"host\": \"whois.za.org\"\n    },\n    \"organic\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"orientexpress\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"origin\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"origins\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.origins\"\n    },\n    \"osaka\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.osaka\"\n    },\n    \"otsuka\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ott\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ott\"\n    },\n    \"ovh\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-ovh.nic.fr\"\n    },\n    \"pa\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.pa/\"\n    },\n    \"page\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"panasonic\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"paris\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-paris.nic.fr\"\n    },\n    \"pars\": {\n        \"_group\": \"agitsys\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.agitsys.net\"\n    },\n    \"partners\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.partners\"\n    },\n    \"parts\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.parts\"\n    },\n    \"party\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.party\"\n    },\n    \"passagens\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pay\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pccw\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.pccw\"\n    },\n    \"pe\": {\n        \"host\": \"kero.yachay.pe\"\n    },\n    \"pet\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"pf\": {\n        \"host\": \"whois.registry.pf\"\n    },\n    \"pfizer\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pg\": {\n        \"adapter\": \"none\"\n    },\n    \"ph\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.dot.ph/whois\"\n    },\n    \"pharmacy\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"phd\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"philips\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.philips\"\n    },\n    \"phone\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.phone\"\n    },\n    \"photo\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"photography\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.photography\"\n    },\n    \"photos\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.photos\"\n    },\n    \"physio\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.physio\"\n    },\n    \"piaget\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pics\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"pictet\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pictures\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.pictures\"\n    },\n    \"pid\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.pid\"\n    },\n    \"pin\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ping\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pink\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"pioneer\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"pizza\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.pizza\"\n    },\n    \"pk\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.pknic.net.pk/\"\n    },\n    \"pl\": {\n        \"host\": \"whois.dns.pl\"\n    },\n    \"co.pl\": {\n        \"host\": \"whois.co.pl\"\n    },\n    \"place\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.place\"\n    },\n    \"play\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"playstation\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.playstation\"\n    },\n    \"plumbing\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.plumbing\"\n    },\n    \"plus\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.plus\"\n    },\n    \"pm\": {\n        \"host\": \"whois.nic.pm\"\n    },\n    \"pn\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.pitcairn.pn/PnRegistry/\"\n    },\n    \"pnc\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.pnc\"\n    },\n    \"pohl\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"poker\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"politie\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nicpolitie\"\n    },\n    \"porn\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"post\": {\n        \"host\": \"whois.dotpostregistry.net\"\n    },\n    \"pr\": {\n        \"_group\": \"afiliassrs\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"pramerica\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"praxi\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"press\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.press\"\n    },\n    \"prime\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"pro\": {\n        \"host\": \"whois.afilias.net\"\n    },\n    \"prod\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"productions\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.productions\"\n    },\n    \"prof\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"progressive\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"promo\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"properties\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.properties\"\n    },\n    \"property\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"protection\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"pru\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"prudential\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ps\": {\n        \"host\": \"whois.pnina.ps\"\n    },\n    \"pt\": {\n        \"host\": \"whois.dns.pt\"\n    },\n    \"pub\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.pub\"\n    },\n    \"pw\": {\n        \"host\": \"whois.nic.pw\"\n    },\n    \"pwc\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"py\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.py/consulta-datos.php\"\n    },\n    \"qa\": {\n        \"host\": \"whois.registry.qa\"\n    },\n    \"qpon\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"quebec\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.quebec\"\n    },\n    \"quest\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.quest\"\n    },\n    \"qvc\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"racing\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.racing\"\n    },\n    \"radio\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.radio\"\n    },\n    \"raid\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.raid\"\n    },\n    \"re\": {\n        \"host\": \"whois.nic.re\"\n    },\n    \"read\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"realestate\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.realestate\"\n    },\n    \"realtor\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"realty\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.realty\"\n    },\n    \"recipes\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.recipes\"\n    },\n    \"red\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"redstone\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.redstone\"\n    },\n    \"redumbrella\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"rehab\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rehab\"\n    },\n    \"reise\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.reise\"\n    },\n    \"reisen\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.reisen\"\n    },\n    \"reit\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.reit\"\n    },\n    \"reliance\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.reliance\"\n    },\n    \"ren\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"rent\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rent\"\n    },\n    \"rentals\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rentals\"\n    },\n    \"repair\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.repair\"\n    },\n    \"report\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.report\"\n    },\n    \"republican\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.republican\"\n    },\n    \"rest\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rest\"\n    },\n    \"restaurant\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.restaurant\"\n    },\n    \"review\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.review\"\n    },\n    \"reviews\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.reviews\"\n    },\n    \"rexroth\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rexroth\"\n    },\n    \"rich\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"richardli\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.richardli\"\n    },\n    \"ricoh\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ricoh\"\n    },\n    \"rightathome\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rightathome\"\n    },\n    \"ril\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ril\"\n    },\n    \"rio\": {\n        \"_group\": \"nicbr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtlds.nic.br\"\n    },\n    \"rip\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rip\"\n    },\n    \"rmit\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"ro\": {\n        \"host\": \"whois.rotld.ro\"\n    },\n    \"rocher\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"rocks\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rocks\"\n    },\n    \"rodeo\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rodeo\"\n    },\n    \"rogers\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"room\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"rs\": {\n        \"host\": \"whois.rnids.rs\"\n    },\n    \"rsvp\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"ru\": {\n        \"host\": \"whois.tcinet.ru\"\n    },\n    \"edu.ru\": {\n        \"host\": \"whois.informika.ru\"\n    },\n    \"rugby\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"ruhr\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ruhr\"\n    },\n    \"run\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.run\"\n    },\n    \"rw\": {\n        \"host\": \"whois.ricta.org.rw\"\n    },\n    \"rwe\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.rwe\"\n    },\n    \"ryukyu\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ryukyu\"\n    },\n    \"sa\": {\n        \"host\": \"whois.nic.net.sa\"\n    },\n    \"saarland\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"safe\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"safety\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sakura\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sale\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sale\"\n    },\n    \"salon\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.salon\"\n    },\n    \"samsclub\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.samsclub\"\n    },\n    \"samsung\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--cg4bki\"\n    },\n    \"sandvik\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sandvik\"\n    },\n    \"sandvikcoromant\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sandvikcoromant\"\n    },\n    \"sanofi\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sanofi\"\n    },\n    \"sap\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sap\"\n    },\n    \"sarl\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sarl\"\n    },\n    \"sas\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"save\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"saxo\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"sb\": {\n        \"host\": \"whois.nic.net.sb\"\n    },\n    \"sbi\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sbi\"\n    },\n    \"sbs\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sbs\"\n    },\n    \"sc\": {\n        \"host\": \"whois.afilias-grs.info\",\n        \"adapter\": \"afilias\"\n    },\n    \"sca\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sca\"\n    },\n    \"scb\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.scb\"\n    },\n    \"schaeffler\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"schmidt\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.schmidt\"\n    },\n    \"scholarships\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.scholarships\"\n    },\n    \"school\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.school\"\n    },\n    \"schule\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.schule\"\n    },\n    \"schwarz\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.schwarz\"\n    },\n    \"science\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.science\"\n    },\n    \"scjohnson\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.scjohnson\"\n    },\n    \"scor\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.scor\"\n    },\n    \"scot\": {\n        \"_group\": \"coreregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.scot\"\n    },\n    \"sd\": {\n        \"adapter\": \"none\"\n    },\n    \"se\": {\n        \"host\": \"whois.iis.se\"\n    },\n    \"com.se\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"private\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"search\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"seat\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.seat\"\n    },\n    \"secure\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"security\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.security\"\n    },\n    \"seek\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.seek\"\n    },\n    \"select\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.select\"\n    },\n    \"sener\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"services\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.services\"\n    },\n    \"ses\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ses\"\n    },\n    \"seven\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.seven\"\n    },\n    \"sew\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"sex\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"sexy\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"sfr\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sfr\"\n    },\n    \"sg\": {\n        \"host\": \"whois.sgnic.sg\"\n    },\n    \"sh\": {\n        \"host\": \"whois.nic.sh\"\n    },\n    \"shangrila\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.shangrila\"\n    },\n    \"sharp\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"shaw\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"shell\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.shell\"\n    },\n    \"shia\": {\n        \"_group\": \"agitsys\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.agitsys.net\"\n    },\n    \"shiksha\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"shoes\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.shoes\"\n    },\n    \"shop\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.shop\"\n    },\n    \"shopping\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.shopping\"\n    },\n    \"shouji\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"show\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.show\"\n    },\n    \"showtime\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"shriram\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"si\": {\n        \"host\": \"whois.register.si\"\n    },\n    \"silk\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sina\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sina\"\n    },\n    \"singles\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.singles\"\n    },\n    \"site\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.site\"\n    },\n    \"sj\": {\n        \"adapter\": \"none\"\n    },\n    \"sk\": {\n        \"host\": \"whois.sk-nic.sk\"\n    },\n    \"ski\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"skin\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.skin\"\n    },\n    \"sky\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sky\"\n    },\n    \"skype\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sl\": {\n        \"host\": \"whois.nic.sl\"\n    },\n    \"sling\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sling\"\n    },\n    \"sm\": {\n        \"host\": \"whois.nic.sm\"\n    },\n    \"smart\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.smart\"\n    },\n    \"smile\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sn\": {\n        \"host\": \"whois.nic.sn\"\n    },\n    \"sncf\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-sncf.nic.fr\"\n    },\n    \"so\": {\n        \"host\": \"whois.nic.so\"\n    },\n    \"soccer\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.soccer\"\n    },\n    \"social\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.social\"\n    },\n    \"softbank\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.softbank\"\n    },\n    \"software\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.software\"\n    },\n    \"sohu\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"solar\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.solar\"\n    },\n    \"solutions\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.solutions\"\n    },\n    \"song\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sony\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sony\"\n    },\n    \"soy\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"space\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.space\"\n    },\n    \"spiegel\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"sport\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sport\"\n    },\n    \"spot\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"spreadbetting\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.spreadbetting\"\n    },\n    \"sr\": {\n        \"adapter\": \"none\"\n    },\n    \"srl\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"srt\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"st\": {\n        \"host\": \"whois.nic.st\"\n    },\n    \"stada\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"staples\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"star\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.star\"\n    },\n    \"starhub\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.starhub\"\n    },\n    \"statebank\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.statebank\"\n    },\n    \"statefarm\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"stc\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.stc\"\n    },\n    \"stcgroup\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.stcgroup\"\n    },\n    \"stockholm\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"storage\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.storage\"\n    },\n    \"store\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.store\"\n    },\n    \"stream\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"studio\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.studio\"\n    },\n    \"study\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.study\"\n    },\n    \"style\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.style\"\n    },\n    \"su\": {\n        \"host\": \"whois.tcinet.ru\"\n    },\n    \"sucks\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sucks\"\n    },\n    \"supplies\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.supplies\"\n    },\n    \"supply\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.supply\"\n    },\n    \"support\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.support\"\n    },\n    \"surf\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.surf\"\n    },\n    \"surgery\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.surgery\"\n    },\n    \"suzuki\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"sv\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.svnet.org.sv/\"\n    },\n    \"swatch\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.swatch\"\n    },\n    \"swiftcover\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"swiss\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.swiss\"\n    },\n    \"sx\": {\n        \"host\": \"whois.sx\"\n    },\n    \"sy\": {\n        \"host\": \"whois.tld.sy\"\n    },\n    \"sydney\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.sydney\"\n    },\n    \"symantec\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.symantec\"\n    },\n    \"systems\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.systems\"\n    },\n    \"sz\": {\n        \"adapter\": \"none\"\n    },\n    \"tab\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tab\"\n    },\n    \"taipei\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.taipei\"\n    },\n    \"talk\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"taobao\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"target\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tatamotors\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tatamotors\"\n    },\n    \"tatar\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tatar\"\n    },\n    \"tattoo\": {\n        \"_group\": \"uniregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.uniregistry.net\"\n    },\n    \"tax\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tax\"\n    },\n    \"taxi\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.taxi\"\n    },\n    \"tc\": {\n        \"host\": \"whois.nic.tc\"\n    },\n    \"tci\": {\n        \"_group\": \"agitsys\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.agitsys.net\"\n    },\n    \"td\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.td/\"\n    },\n    \"tdk\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"team\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.team\"\n    },\n    \"tech\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tech\"\n    },\n    \"technology\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.technology\"\n    },\n    \"tel\": {\n        \"host\": \"whois.nic.tel\"\n    },\n    \"telefonica\": {\n        \"_group\": \"knipp\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-fe.telefonica.tango.knipp.de\"\n    },\n    \"temasek\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"tennis\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tennis\"\n    },\n    \"teva\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.teva\"\n    },\n    \"tf\": {\n        \"host\": \"whois.nic.fr\"\n    },\n    \"tg\": {\n        \"host\": \"whois.nic.tg\"\n    },\n    \"th\": {\n        \"host\": \"whois.thnic.co.th\"\n    },\n    \"thd\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.thd\"\n    },\n    \"theater\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.theater\"\n    },\n    \"theatre\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.theatre\"\n    },\n    \"tiaa\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tiaa\"\n    },\n    \"tickets\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tickets\"\n    },\n    \"tienda\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tienda\"\n    },\n    \"tiffany\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tiffany\"\n    },\n    \"tiia\": {\n        \"host\": \"whois.nic.tiia\"\n    },\n    \"tips\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tips\"\n    },\n    \"tires\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tires\"\n    },\n    \"tirol\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tirol\"\n    },\n    \"tj\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.tj/whois.html\"\n    },\n    \"tjmaxx\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tjx\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tk\": {\n        \"host\": \"whois.dot.tk\"\n    },\n    \"tkmaxx\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tl\": {\n        \"host\": \"whois.nic.tl\"\n    },\n    \"tm\": {\n        \"host\": \"whois.nic.tm\"\n    },\n    \"tmall\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tn\": {\n        \"host\": \"whois.ati.tn\"\n    },\n    \"to\": {\n        \"host\": \"whois.tonic.to\"\n    },\n    \"today\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.today\"\n    },\n    \"tokyo\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tokyo\"\n    },\n    \"tools\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tools\"\n    },\n    \"top\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.top\"\n    },\n    \"toray\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.toray\"\n    },\n    \"toshiba\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.toshiba\"\n    },\n    \"total\": {\n        \"_group\": \"nicfr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois-total.nic.fr\"\n    },\n    \"tours\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tours\"\n    },\n    \"town\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.town\"\n    },\n    \"toyota\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.toyota\"\n    },\n    \"toys\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.toys\"\n    },\n    \"tr\": {\n        \"host\": \"whois.nic.tr\"\n    },\n    \"trade\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.trade\"\n    },\n    \"trading\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.trading\"\n    },\n    \"training\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.training\"\n    },\n    \"travel\": {\n        \"host\": \"whois.nic.travel\"\n    },\n    \"travelchannel\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.travelchannel\"\n    },\n    \"travelers\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"travelersinsurance\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"trust\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.trust\"\n    },\n    \"trv\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"tt\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.nic.tt/cgi-bin/search.pl\"\n    },\n    \"tube\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tui\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"tunes\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tushu\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"tv\": {\n        \"host\": \"tvwhois.verisign-grs.com\",\n        \"adapter\": \"verisign\"\n    },\n    \"tvs\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.tvs\"\n    },\n    \"tw\": {\n        \"host\": \"whois.twnic.net.tw\"\n    },\n    \"tz\": {\n        \"host\": \"whois.tznic.or.tz\"\n    },\n    \"ua\": {\n        \"host\": \"whois.ua\"\n    },\n    \"in.ua\": {\n        \"host\": \"whois.in.ua\"\n    },\n    \"ubank\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ubank\"\n    },\n    \"ubs\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ubs\"\n    },\n    \"uconnect\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"ug\": {\n        \"host\": \"whois.co.ug\"\n    },\n    \"uk\": {\n        \"host\": \"whois.nic.uk\"\n    },\n    \"ac.uk\": {\n        \"host\": \"whois.ja.net\"\n    },\n    \"bl.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"british-library.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"gov.uk\": {\n        \"host\": \"whois.ja.net\"\n    },\n    \"icnet.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"jet.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"mod.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"nhs.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"nls.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"parliament.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"police.uk\": {\n        \"adapter\": \"none\"\n    },\n    \"unicom\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"university\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.university\"\n    },\n    \"uno\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"uol\": {\n        \"_group\": \"nicbr\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtlds.nic.br\"\n    },\n    \"ups\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ups\"\n    },\n    \"us\": {\n        \"host\": \"whois.nic.us\"\n    },\n    \"uy\": {\n        \"host\": \"whois.nic.org.uy\"\n    },\n    \"com.uy\": {\n        \"adapter\": \"web\",\n        \"url\": \"https://nic.anteldata.com.uy/dns/consultaWhois/whois.action\"\n    },\n    \"uz\": {\n        \"host\": \"whois.cctld.uz\"\n    },\n    \"va\": {\n        \"adapter\": \"none\"\n    },\n    \"vacations\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vacations\"\n    },\n    \"vana\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vana\"\n    },\n    \"vanguard\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vanguard\"\n    },\n    \"vc\": {\n        \"host\": \"whois.afilias-grs.info\",\n        \"adapter\": \"afilias\"\n    },\n    \"ve\": {\n        \"host\": \"whois.nic.ve\"\n    },\n    \"vegas\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"ventures\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.ventures\"\n    },\n    \"verisign\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.verisign\"\n    },\n    \"versicherung\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.versicherung\"\n    },\n    \"vet\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vet\"\n    },\n    \"vg\": {\n        \"host\": \"whois.nic.vg\"\n    },\n    \"vi\": {\n        \"adapter\": \"web\",\n        \"url\": \"https://secure.nic.vi/whois-lookup/\"\n    },\n    \"viajes\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.viajes\"\n    },\n    \"video\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.video\"\n    },\n    \"vig\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"viking\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"villas\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.villas\"\n    },\n    \"vin\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vin\"\n    },\n    \"vip\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vip\"\n    },\n    \"virgin\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.virgin\"\n    },\n    \"visa\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.visa\"\n    },\n    \"vision\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vision\"\n    },\n    \"vistaprint\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vistaprint\"\n    },\n    \"viva\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.viva\"\n    },\n    \"vivo\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"vlaanderen\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vlaanderen\"\n    },\n    \"vn\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://www.vnnic.vn/en/domain\"\n    },\n    \"vodka\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.vodka\"\n    },\n    \"volkswagen\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"volvo\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.volvo\"\n    },\n    \"vote\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"voting\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.voting.tld-box.at\"\n    },\n    \"voto\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"voyage\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.voyage\"\n    },\n    \"vu\": {\n        \"host\": \"vunic.vu\"\n    },\n    \"vuelos\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"wales\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wales\"\n    },\n    \"walmart\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.walmart\"\n    },\n    \"walter\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.walter\"\n    },\n    \"wang\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"wanggou\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"warman\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.warman\"\n    },\n    \"watch\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.watch\"\n    },\n    \"watches\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"weather\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"weatherchannel\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"webcam\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.webcam\"\n    },\n    \"weber\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.weber\"\n    },\n    \"website\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.website\"\n    },\n    \"wed\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wed\"\n    },\n    \"wedding\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wedding\"\n    },\n    \"weibo\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.weibo\"\n    },\n    \"weir\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"wf\": {\n        \"host\": \"whois.nic.wf\"\n    },\n    \"whoswho\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.whoswho\"\n    },\n    \"wien\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wien\"\n    },\n    \"wiki\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wiki\"\n    },\n    \"williamhill\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"win\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.win\"\n    },\n    \"windows\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"wine\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wine\"\n    },\n    \"winners\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"wme\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wme\"\n    },\n    \"wolterskluwer\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wolterskluwer\"\n    },\n    \"woodside\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.woodside\"\n    },\n    \"work\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.work\"\n    },\n    \"works\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.works\"\n    },\n    \"world\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.world\"\n    },\n    \"wow\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ws\": {\n        \"host\": \"whois.website.ws\"\n    },\n    \"wtc\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wtc\"\n    },\n    \"wtf\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.wtf\"\n    },\n    \"xbox\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xerox\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xerox\"\n    },\n    \"xfinity\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xfinity\"\n    },\n    \"xihuan\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"xin\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xin\"\n    },\n    \"xn--11b4c3d\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--11b4c3d\"\n    },\n    \"xn--1ck2e1b\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--1qqw23a\": {\n        \"_group\": \"ngtld\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ngtld.cn\"\n    },\n    \"xn--2scrj9c\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--30rr7y\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"xn--3bst00m\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"xn--3ds443g\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"xn--3e0b707e\": {\n        \"host\": \"whois.kr\"\n    },\n    \"xn--3oq18vl8pn36a\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--3oq18vl8pn36a\"\n    },\n    \"xn--3pxu8k\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--3pxu8k\"\n    },\n    \"xn--42c2d9a\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--42c2d9a\"\n    },\n    \"xn--45br5cyl\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--45brj9c\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--45q11c\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--4gbrim\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"xn--54b7fta0cc\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--55qw42g\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.conac.cn\"\n    },\n    \"xn--55qx5d\": {\n        \"_group\": \"ngtld\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ngtld.cn\"\n    },\n    \"xn--5su34j936bgsg\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--5su34j936bgsg\"\n    },\n    \"xn--5tzm5g\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\",\n        \"host\": \"whois.nic.xn--5tzm5g\"\n    },\n    \"xn--6frz82g\": {\n        \"_group\": \"afilias\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias.net\"\n    },\n    \"xn--6qq986b3xl\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"xn--80adxhks\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--80adxhks\"\n    },\n    \"xn--80ao21a\": {\n        \"host\": \"whois.nic.kz\"\n    },\n    \"xn--80aqecdr1a\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"xn--80asehdb\": {\n        \"_group\": \"corenic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.online.rs.corenic.net\"\n    },\n    \"xn--80aswg\": {\n        \"_group\": \"corenic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.online.rs.corenic.net\"\n    },\n    \"xn--8y0a063a\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.imena.bg\"\n    },\n    \"xn--90a3ac\": {\n        \"host\": \"whois.rnids.rs\"\n    },\n    \"xn--90ae\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--90ais\": {\n        \"host\": \"whois.cctld.by\"\n    },\n    \"xn--9dbq2a\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--9dbq2a\"\n    },\n    \"xn--9et52u\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"xn--9krt00a\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--9krt00a\"\n    },\n    \"xn--b4w605ferd\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"xn--bck1b9a5dre4c\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--c1avg\": {\n        \"_group\": \"publicinterestregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.publicinterestregistry.net\"\n    },\n    \"xn--c2br7g\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--c2br7g\"\n    },\n    \"xn--cck2b3b\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--cg4bki\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.kr\"\n    },\n    \"xn--clchc0ea0b2g2a9gcd\": {\n        \"host\": \"whois.sgnic.sg\"\n    },\n    \"xn--czrs0t\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--czrs0t\"\n    },\n    \"xn--czru2d\": {\n        \"_group\": \"knet\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"xn--d1acj3b\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--d1acj3b\"\n    },\n    \"xn--d1alf\": {\n        \"host\": \"whois.marnet.mk\"\n    },\n    \"xn--e1a4c\": {\n        \"host\": \"whois.eu\"\n    },\n    \"xn--eckvdtc9d\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--efvy88h\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--efvy88h\"\n    },\n    \"xn--estv75g\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--estv75g\"\n    },\n    \"xn--fct429k\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--fhbei\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--fhbei\"\n    },\n    \"xn--fiq228c5hs\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"xn--fiq64b\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.gtld.knet.cn\"\n    },\n    \"xn--fiqs8s\": {\n        \"host\": \"cwhois.cnnic.cn\"\n    },\n    \"xn--fiqz9s\": {\n        \"host\": \"cwhois.cnnic.cn\"\n    },\n    \"xn--fjq720a\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--fjq720a\"\n    },\n    \"xn--flw351e\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"xn--fpcrj9c3d\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--fzc2c9e2c\": {\n        \"host\": \"whois.nic.lk\"\n    },\n    \"xn--fzys8d69uvgm\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--fzys8d69uvgm\"\n    },\n    \"xn--g2xx48c\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"xn--gckr3f0f\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--gecrj9c\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--gk3at1e\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--h2breg3eve\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--h2brj9c\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--h2brj9c8c\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--hxt814e\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--hxt814e\"\n    },\n    \"xn--i1b6b1a6a2e\": {\n        \"_group\": \"publicinterestregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.publicinterestregistry.net\"\n    },\n    \"xn--imr513n\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--io0a7i\": {\n        \"_group\": \"ngtld\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ngtld.cn\"\n    },\n    \"xn--j1aef\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--j1aef\"\n    },\n    \"xn--j1amh\": {\n        \"host\": \"whois.dotukr.com\"\n    },\n    \"xn--j6w193g\": {\n        \"host\": \"whois.hkirc.hk\"\n    },\n    \"xn--jlq61u9w7b\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--jlq61u9w7b\"\n    },\n    \"xn--jvr189m\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--kcrx77d1x4a\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--kcrx77d1x4a\"\n    },\n    \"xn--kprw13d\": {\n        \"host\": \"whois.twnic.net.tw\"\n    },\n    \"xn--kpry57d\": {\n        \"host\": \"whois.twnic.net.tw\"\n    },\n    \"xn--kpu716f\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--kput3i\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--kput3i\"\n    },\n    \"xn--l1acc\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--lgbbat1ad8j\": {\n        \"host\": \"whois.nic.dz\"\n    },\n    \"xn--mgb9awbf\": {\n        \"host\": \"whois.registry.om\"\n    },\n    \"xn--mgba3a3ejt\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--mgba3a4f16a\": {\n        \"host\": \"whois.nic.ir\"\n    },\n    \"xn--mgba7c0bbn0a\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--mgba7c0bbn0a\"\n    },\n    \"xn--mgbaakc7dvf\": {\n        \"_group\": \"centralnic\",\n        \"host\": \"whois.centralnic.com\"\n    },\n    \"xn--mgbaam7a8h\": {\n        \"host\": \"whois.aeda.net.ae\"\n    },\n    \"xn--mgbab2bd\": {\n        \"_group\": \"coreregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.bazaar.coreregistry.net\"\n    },\n    \"xn--mgbai9azgqp6j\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--mgbayh7gpa\": {\n        \"adapter\": \"web\",\n        \"url\": \"http://idn.jo/whois_a.aspx\"\n    },\n    \"xn--mgbb9fbpob\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--mgbbh1a\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--mgbbh1a71e\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--mgbc0a9azcg\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--mgbca7dzdo\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"xn--mgberp4a5d4ar\": {\n        \"host\": \"whois.nic.net.sa\"\n    },\n    \"xn--mgbgu82a\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--mgbi4ecexp\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"xn--mgbpl2fh\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--mgbt3dhd\": {\n        \"_group\": \"agitsys\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.agitsys.net\"\n    },\n    \"xn--mgbtx2b\": {\n        \"host\": \"whois.cmc.iq\"\n    },\n    \"xn--mgbx4cd0ab\": {\n        \"host\": \"whois.mynic.my\"\n    },\n    \"xn--mix891f\": {\n        \"host\": \"whois.monic.mo\"\n    },\n    \"xn--mk1bu44c\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--mk1bu44c\"\n    },\n    \"xn--mxtq1m\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--mxtq1m\"\n    },\n    \"xn--ngbc5azd\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--ngbc5azd\"\n    },\n    \"xn--ngbe9e0a\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--ngbe9e0a\"\n    },\n    \"xn--node\": {\n        \"host\": \"whois.itdc.ge\"\n    },\n    \"xn--nqv7f\": {\n        \"_group\": \"publicinterestregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.publicinterestregistry.net\"\n    },\n    \"xn--nqv7fs00ema\": {\n        \"_group\": \"publicinterestregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--nqv7fs00ema\"\n    },\n    \"xn--nyqy26a\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--o3cw4h\": {\n        \"host\": \"whois.thnic.co.th\"\n    },\n    \"xn--ogbpf8fl\": {\n        \"host\": \"whois.tld.sy\"\n    },\n    \"xn--otu796d\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--p1acf\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--p1acf\"\n    },\n    \"xn--p1ai\": {\n        \"host\": \"whois.tcinet.ru\"\n    },\n    \"xn--pbt977c\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--pgbs0dh\": {\n        \"adapter\": \"none\"\n    },\n    \"xn--pssy2u\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--pssy2u\"\n    },\n    \"xn--q9jyb4c\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"xn--qcka1pmc\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"xn--qxam\": {\n        \"adapter\": \"web\",\n        \"url\": \"https://grweb.ics.forth.gr/public/whois.jsp?lang=en\"\n    },\n    \"xn--rhqv96g\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--rovu88b\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--rvc1e0am3e\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"xn--s9brj9c\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--ses554g\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.registry.knet.cn\"\n    },\n    \"xn--t60b56a\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--t60b56a\"\n    },\n    \"xn--tckwe\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--tckwe\"\n    },\n    \"xn--tiq49xqyj\": {\n        \"_group\": \"aridnrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.aridnrs.net.au\"\n    },\n    \"xn--unup4y\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--unup4y\"\n    },\n    \"xn--vermgensberater-ctb\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"xn--vermgensberatung-pwb\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"xn--vhquv\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--vhquv\"\n    },\n    \"xn--vuq861b\": {\n        \"_group\": \"ngtld\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"xn--w4r85el8fhu5dnra\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--w4r85el8fhu5dnra\"\n    },\n    \"xn--w4rs40l\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xn--w4rs40l\"\n    },\n    \"xn--wgbh1c\": {\n        \"host\": \"whois.dotmasr.eg\"\n    },\n    \"xn--wgbl6a\": {\n        \"host\": \"whois.registry.qa\"\n    },\n    \"xn--xhq521b\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"xn--xkc2al3hye2a\": {\n        \"host\": \"whois.nic.lk\"\n    },\n    \"xn--xkc2dl3a5ee0h\": {\n        \"host\": \"whois.inregistry.net\"\n    },\n    \"xn--y9a3aq\": {\n        \"host\": \"whois.amnic.net\"\n    },\n    \"xn--yfro4i67o\": {\n        \"host\": \"whois.sgnic.sg\"\n    },\n    \"xn--ygbi2ammx\": {\n        \"host\": \"whois.pnina.ps\"\n    },\n    \"xn--zfr164b\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.conac.cn\"\n    },\n    \"xxx\": {\n        \"host\": \"whois.nic.xxx\"\n    },\n    \"xyz\": {\n        \"_group\": \"centralnic\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.xyz\"\n    },\n    \"yachts\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"yahoo\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"yamaxun\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"yandex\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"ye\": {\n        \"adapter\": \"none\"\n    },\n    \"yodobashi\": {\n        \"_group\": \"gmo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.gmo\"\n    },\n    \"yoga\": {\n        \"_group\": \"mmregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.yoga\"\n    },\n    \"yokohama\": {\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.yokohama\"\n    },\n    \"you\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"youtube\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"yt\": {\n        \"host\": \"whois.nic.yt\"\n    },\n    \"yun\": {\n        \"_group\": \"teleinfo\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.teleinfo.cn\"\n    },\n    \"za\": {\n        \"adapter\": \"none\"\n    },\n    \"ac.za\": {\n        \"host\": \"whois.ac.za\"\n    },\n    \"alt.za\": {\n        \"host\": \"whois.alt.za\"\n    },\n    \"co.za\": {\n        \"host\": \"coza-whois.registry.net.za\"\n    },\n    \"gov.za\": {\n        \"host\": \"whois.gov.za\"\n    },\n    \"net.za\": {\n        \"host\": \"net-whois.registry.net.za\"\n    },\n    \"org.za\": {\n        \"host\": \"org-whois.registry.net.za\"\n    },\n    \"web.za\": {\n        \"host\": \"web-whois.registry.net.za\"\n    },\n    \"zappos\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"zara\": {\n        \"_group\": \"afiliassrs\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.afilias-srs.net\"\n    },\n    \"zero\": {\n        \"_group\": \"amazonregistry\",\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"zip\": {\n        \"_group\": \"google\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.google\"\n    },\n    \"zippo\": {\n        \"_type\": \"newgtld\",\n        \"adapter\": \"none\"\n    },\n    \"zm\": {\n        \"host\": \"whois.nic.zm\"\n    },\n    \"zone\": {\n        \"_group\": \"donuts\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.nic.zone\"\n    },\n    \"zuerich\": {\n        \"_group\": \"ksregistry\",\n        \"_type\": \"newgtld\",\n        \"host\": \"whois.ksregistry.net\"\n    },\n    \"zw\": {\n        \"adapter\": \"none\"\n    }\n}\n\ngrammar = {\n    \"_data\": {\n        'id': ['Domain ID:[ ]*(?P\u003cval\u003e.+)'],\n        'status': ['\\[Status\\]\\s*(?P\u003cval\u003e.+)',\n                   'Status\\s*:\\s?(?P\u003cval\u003e.+)',\n                   '\\[State\\]\\s*(?P\u003cval\u003e.+)',\n                   '^state:\\s*(?P\u003cval\u003e.+)'],\n        'creation_date': ['\\[Created on\\]\\s*(?P\u003cval\u003e.+)',\n                          'Created on[.]*: [a-zA-Z]+, (?P\u003cval\u003e.+)',\n                          'Creation Date:\\s?(?P\u003cval\u003e.+)',\n                          'Creation date\\s*:\\s?(?P\u003cval\u003e.+)',\n                          'Registration Date:\\s?(?P\u003cval\u003e.+)',\n                          'Created Date:\\s?(?P\u003cval\u003e.+)',\n                          'Created on:\\s?(?P\u003cval\u003e.+)',\n                          'Created on\\s?[.]*:\\s?(?P\u003cval\u003e.+)\\.',\n                          'Date Registered\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                          'Domain Created\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                          'Domain registered\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                          'Domain record activated\\s?[.]*:\\s*?(?P\u003cval\u003e.+)',\n                          'Record created on\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'Record created\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'Created\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'Registered on\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'Registered\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'Domain Create Date\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'Domain Registration Date\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                          'created:\\s*(?P\u003cval\u003e.+)',\n                          '\\[Registered Date\\]\\s*(?P\u003cval\u003e.+)',\n                          'created-date:\\s*(?P\u003cval\u003e.+)',\n                          'Domain Name Commencement Date: (?P\u003cval\u003e.+)',\n                          'registered:\\s*(?P\u003cval\u003e.+)',\n                          'registration:\\s*(?P\u003cval\u003e.+)'],\n        'expiration_date': ['\\[Expires on\\]\\s*(?P\u003cval\u003e.+)',\n                            'Registrar Registration Expiration Date:[ ]*(?P\u003cval\u003e.+)-[0-9]{4}',\n                            'Expires on[.]*: [a-zA-Z]+, (?P\u003cval\u003e.+)',\n                            'Expiration Date:\\s?(?P\u003cval\u003e.+)',\n                            'Expiration date\\s*:\\s?(?P\u003cval\u003e.+)',\n                            'Expires on:\\s?(?P\u003cval\u003e.+)',\n                            'Expires on\\s?[.]*:\\s?(?P\u003cval\u003e.+)\\.',\n                            'Exp(?:iry)? Date\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                            'Expiry\\s*:\\s?(?P\u003cval\u003e.+)',\n                            'Domain Currently Expires\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                            'Record will expire on\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                            'Domain expires\\s?[.]*:\\s*?(?P\u003cval\u003e.+)',\n                            'Record expires on\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                            'Record expires\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                            'Expires\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                            'Expire Date\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                            'Expired\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                            'Domain Expiration Date\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)',\n                            'paid-till:\\s*(?P\u003cval\u003e.+)',\n                            'expiration_date:\\s*(?P\u003cval\u003e.+)',\n                            'expire-date:\\s*(?P\u003cval\u003e.+)',\n                            'renewal:\\s*(?P\u003cval\u003e.+)',\n                            'expire:\\s*(?P\u003cval\u003e.+)'],\n        'updated_date': ['\\[Last Updated\\]\\s*(?P\u003cval\u003e.+)',\n                         'Record modified on[.]*: (?P\u003cval\u003e.+) [a-zA-Z]+',\n                         'Record last updated on[.]*: [a-zA-Z]+, (?P\u003cval\u003e.+)',\n                         'Updated Date:\\s?(?P\u003cval\u003e.+)',\n                         'Updated date\\s*:\\s?(?P\u003cval\u003e.+)',\n                         # 'Database last updated on\\s?[.]*:?\\s*?(?P\u003cval\u003e.+)\\s[a-z]+\\.?',\n                         'Record last updated on\\s?[.]*:?\\s?(?P\u003cval\u003e.+)\\.',\n                         'Domain record last updated\\s?[.]*:\\s*?(?P\u003cval\u003e.+)',\n                         'Domain Last Updated\\s?[.]*:\\s*?(?P\u003cval\u003e.+)',\n                         'Last updated on:\\s?(?P\u003cval\u003e.+)',\n                         'Date Modified\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                         'Last Modified\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                         'Domain Last Updated Date\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                         'Record last updated\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                         'Modified\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                         '(C|c)hanged:\\s*(?P\u003cval\u003e.+)',\n                         'last_update:\\s*(?P\u003cval\u003e.+)',\n                         'Last Update\\s?[.]*:\\s?(?P\u003cval\u003e.+)',\n                         'Last updated on (?P\u003cval\u003e.+) [a-z]{3,4}',\n                         'Last updated:\\s*(?P\u003cval\u003e.+)',\n                         'last-updated:\\s*(?P\u003cval\u003e.+)',\n                         '\\[Last Update\\]\\s*(?P\u003cval\u003e.+) \\([A-Z]+\\)',\n                         'Last update of whois database:\\s?[a-z]{3}, (?P\u003cval\u003e.+) [a-z]{3,4}'],\n        'registrar': ['registrar:\\s*(?P\u003cval\u003e.+)',\n                      'Registrar:\\s*(?P\u003cval\u003e.+)',\n                      'Sponsoring Registrar Organization:\\s*(?P\u003cval\u003e.+)',\n                      'Registered through:\\s?(?P\u003cval\u003e.+)',\n                      'Registrar Name[.]*:\\s?(?P\u003cval\u003e.+)',\n                      'Record maintained by:\\s?(?P\u003cval\u003e.+)',\n                      'Registration Service Provided By:\\s?(?P\u003cval\u003e.+)',\n                      'Registrar of Record:\\s?(?P\u003cval\u003e.+)',\n                      'Domain Registrar :\\s?(?P\u003cval\u003e.+)',\n                      'Registration Service Provider: (?P\u003cval\u003e.+)',\n                      '\\tName:\\t\\s(?P\u003cval\u003e.+)'],\n        'whois_server': ['Whois Server:\\s?(?P\u003cval\u003e.+)',\n                         'Registrar Whois:\\s?(?P\u003cval\u003e.+)'],\n        'nameservers': ['Name Server:[ ]*(?P\u003cval\u003e[^ ]+)',\n                        'Nameservers:[ ]*(?P\u003cval\u003e[^ ]+)',\n                        '(?\u003c=[ .]{2})(?P\u003cval\u003e([a-z0-9-]+\\.)+[a-z0-9]+)(\\s+([0-9]{1,3}\\.){3}[0-9]{1,3})',\n                        'nameserver:\\s*(?P\u003cval\u003e.+)',\n                        'nserver:\\s*(?P\u003cval\u003e[^[\\s]+)',\n                        'Name Server[.]+ (?P\u003cval\u003e[^[\\s]+)',\n                        'Hostname:\\s*(?P\u003cval\u003e[^\\s]+)',\n                        'DNS[0-9]+:\\s*(?P\u003cval\u003e.+)',\n                        '   DNS:\\s*(?P\u003cval\u003e.+)',\n                        'ns[0-9]+:\\s*(?P\u003cval\u003e.+)',\n                        'NS [0-9]+\\s*:\\s*(?P\u003cval\u003e.+)',\n                        '\\[Name Server\\]\\s*(?P\u003cval\u003e.+)',\n                        '(?\u003c=[ .]{2})(?P\u003cval\u003e[a-z0-9-]+\\.d?ns[0-9]*\\.([a-z0-9-]+\\.)+[a-z0-9]+)',\n                        '(?\u003c=[ .]{2})(?P\u003cval\u003e([a-z0-9-]+\\.)+[a-z0-9]+)(\\s+([0-9]{1,3}\\.){3}[0-9]{1,3})',\n                        '(?\u003c=[ .]{2})[^a-z0-9.-](?P\u003cval\u003ed?ns\\.([a-z0-9-]+\\.)+[a-z0-9]+)',\n                        'Nserver:\\s*(?P\u003cval\u003e.+)'],\n        'emails': ['(?P\u003cval\u003e[\\w.-]+@[\\w.-]+\\.[\\w]{2,6})',  # Really need to fix this, much longer TLDs now exist...\n                   '(?P\u003cval\u003e[\\w.-]+\\sAT\\s[\\w.-]+\\sDOT\\s[\\w]{2,6})']\n    },\n    \"_dateformats\": (\n        '(?P\u003cday\u003e[0-9]{1,2})[./ -](?P\u003cmonth\u003eJan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[./ -](?P\u003cyear\u003e[0-9]{4}|[0-9]{2})'\n        '(\\s+(?P\u003chour\u003e[0-9]{1,2})[:.](?P\u003cminute\u003e[0-9]{1,2})[:.](?P\u003csecond\u003e[0-9]{1,2}))?',\n        '[a-z]{3}\\s(?P\u003cmonth\u003eJan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)[./ -](?P\u003cday\u003e[0-9]{1,2})(\\s+(?P\u003chour\u003e[0-9]{1,2})[:.](?P\u003cminute\u003e[0-9]{1,2})[:.](?P\u003csecond\u003e[0-9]{1,2}))?\\s[a-z]{3}\\s(?P\u003cyear\u003e[0-9]{4}|[0-9]{2})',\n        '[a-zA-Z]+\\s(?P\u003cday\u003e[0-9]{1,2})(?:st|nd|rd|th)\\s(?P\u003cmonth\u003eJan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec|January|February|March|April|May|June|July|August|September|October|November|December)\\s(?P\u003cyear\u003e[0-9]{4})',\n        '(?P\u003cyear\u003e[0-9]{4})[./-]?(?P\u003cmonth\u003e[0-9]{2})[./-]?(?P\u003cday\u003e[0-9]{2})(\\s|T|/)((?P\u003chour\u003e[0-9]{1,2})[:.-](?P\u003cminute\u003e[0-9]{1,2})[:.-](?P\u003csecond\u003e[0-9]{1,2}))',\n        '(?P\u003cyear\u003e[0-9]{4})[./-](?P\u003cmonth\u003e[0-9]{1,2})[./-](?P\u003cday\u003e[0-9]{1,2})',\n        '(?P\u003cday\u003e[0-9]{1,2})[./ -](?P\u003cmonth\u003e[0-9]{1,2})[./ -](?P\u003cyear\u003e[0-9]{4}|[0-9]{2})',\n        '(?P\u003cmonth\u003eJan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (?P\u003cday\u003e[0-9]{1,2}),? (?P\u003cyear\u003e[0-9]{4})',\n        '(?P\u003cday\u003e[0-9]{1,2})-(?P\u003cmonth\u003eJanuary|February|March|April|May|June|July|August|September|October|November|December)-(?P\u003cyear\u003e[0-9]{4})',\n    ),\n    \"_months\": {\n        'jan': 1,\n        'january': 1,\n        'feb': 2,\n        'february': 2,\n        'mar': 3,\n        'march': 3,\n        'apr': 4,\n        'april': 4,\n        'may': 5,\n        'jun': 6,\n        'june': 6,\n        'jul': 7,\n        'july': 7,\n        'aug': 8,\n        'august': 8,\n        'sep': 9,\n        'sept': 9,\n        'september': 9,\n        'oct': 10,\n        'october': 10,\n        'nov': 11,\n        'november': 11,\n        'dec': 12,\n        'december': 12\n    }\n}\n\ndble_ext_str = \"chirurgiens-dentistes.fr,in-addr.arpa,uk.net,za.org,mod.uk,org.za,za.com,de.com,us.com,hk.org,co.ca,\" \\\n               \"avocat.fr,com.uy,gr.com,e164.arpa,hu.net,us.org,com.se,aeroport.fr,gov.uk,ru.com,alt.za,africa.com,\" \\\n               \"geometre-expert.fr,in.net,co.com,kr.com,bl.uk,uk.com,port.fr,police.uk,gov.za,eu.com,eu.org,br.com,\" \\\n               \"web.za,net.za,co.za,hk.com,ae.org,edu.ru,ar.com,jet.uk,icnet.uk,com.de,inc.hk,ltd.hk,parliament.uk,\" \\\n               \"jp.net,gb.com,veterinaire.fr,edu.cn,qc.com,pharmacien.fr,ac.za,sa.com,medecin.fr,uy.com,se.net,co.pl,\" \\\n               \"cn.com,hu.com,no.com,ac.uk,jpn.com,priv.at,za.net,nls.uk,nhs.uk,za.bz,experts-comptables.fr,\" \\\n               \"chambagri.fr,gb.net,in.ua,notaires.fr,se.com,british-library.uk \"\ndble_ext = dble_ext_str.split(\",\")\n\n\ndef get_whois_raw(domain, server=\"\", previous=None, rfc3490=True, never_cut=False, with_server_list=False,\n                  server_list=None):\n    previous = previous or []\n    server_list = server_list or []\n    # Sometimes IANA simply won't give us the right root WHOIS server\n    exceptions = {\n        \".ac.uk\": \"whois.ja.net\",\n        \".ps\": \"whois.pnina.ps\",\n        \".buzz\": \"whois.nic.buzz\",\n        \".moe\": \"whois.nic.moe\",\n        # The following is a bit hacky, but IANA won't return the right answer for example.com because it's a direct\n        # registration.\n        \"example.com\": \"whois.verisign-grs.com\"\n    }\n\n    if rfc3490:\n        if sys.version_info \u003c (3, 0):\n            domain = encode(domain if type(domain) is unicode else decode(domain, \"utf8\"), \"idna\")\n        else:\n            domain = encode(domain, \"idna\").decode(\"ascii\")\n\n    if len(previous) == 0 and server == \"\":\n        # Root query\n        is_exception = False\n        for exception, exc_serv in exceptions.items():\n            if domain.endswith(exception):\n                is_exception = True\n                target_server = exc_serv\n                break\n        if not is_exception:\n            target_server = get_root_server(domain)\n    else:\n        target_server = server\n    if target_server == \"whois.jprs.jp\":\n        request_domain = \"%s/e\" % domain  # Suppress Japanese output\n    elif domain.endswith(\".de\") and (target_server == \"whois.denic.de\" or target_server == \"de.whois-servers.net\"):\n        request_domain = \"-T dn,ace %s\" % domain  # regional specific stuff\n    elif target_server == \"whois.verisign-grs.com\":\n        request_domain = \"=%s\" % domain  # Avoid partial matches\n    else:\n        request_domain = domain\n    # The following loop handles errno 104 - \"connection reset by peer\" by retry whois_request with the same arguments.\n    # If the request fails due to other cause - there will not be another try\n    for i in range(0, 3):\n        try:\n            response = whois_request(request_domain, target_server)\n        except socket.error as err:\n            if err.errno == errno.ECONNRESET:\n                continue\n            else:\n                raise\n        break\n    # Executed only if the for loop ran to the full\n    # (3 tries led to errno.ECONNRESET)\n    else:\n        raise WhoisException('(104) Connection Reset By Peer')\n\n    if never_cut:\n        # If the caller has requested to 'never cut' responses, he will get the original response from the server (\n        # this is useful for callers that are only interested in the raw data). Otherwise, if the target is\n        # verisign-grs, we will select the data relevant to the requested domain, and discard the rest, so that in a\n        # multiple-option response the parsing code will only touch the information relevant to the requested domain.\n        # The side-effect of this is that when `never_cut` is set to False, any verisign-grs responses in the raw data\n        # will be missing header, footer, and alternative domain options (this is handled a few lines below,\n        # after the verisign-grs processing).\n        new_list = [response] + previous\n    if target_server == \"whois.verisign-grs.com\":\n        # VeriSign is a little... special. As it may return multiple full records and there's no way to do an exact query,\n        # we need to actually find the correct record in the list.\n        for record in response.split(\"\\n\\n\"):\n            if re.search(\"Domain Name: %s\\n\" % domain.upper(), record):\n                response = record\n                break\n    if never_cut == False:\n        new_list = [response] + previous\n    server_list.append(target_server)\n    for line in [x.strip() for x in response.splitlines()]:\n        match = re.match(\"(refer|whois server|referral url|registrar whois(?: server)?):\\s*([^\\s]+\\.[^\\s]+)\", line,\n                         re.IGNORECASE)\n        if match is not None:\n            referal_server = match.group(2)\n            if referal_server != server and \"://\" not in referal_server:  # We want to ignore anything non-WHOIS (eg. HTTP) for now.\n                # Referal to another WHOIS server...\n                return get_whois_raw(domain, referal_server, new_list, server_list=server_list,\n                                     with_server_list=with_server_list)\n    if with_server_list:\n        return new_list, server_list\n    else:\n        return new_list\n\n\ndef get_root_server(domain):\n    ext = domain.split(\".\")[-1]\n    for dble in dble_ext:\n        if domain.endswith(dble):\n            ext = dble\n\n    if ext in tlds.keys():\n        entry = tlds[ext]\n        try:\n            host = entry[\"host\"]\n        except KeyError:\n            context = ({\n                outputPaths['domain']: {\n                    'Name': domain,\n                    'Whois': {\n                        'QueryStatus': 'Failed'\n                    }\n                },\n            })\n            if SHOULD_ERROR:\n                return_error('The domain - {} - is not supported by the Whois service'.format(domain),\n                             outputs=context)\n            else:\n                return_warning('The domain - {} - is not supported by the Whois service'.format(domain),\n                               exit=True, outputs=context)\n\n        return host\n\n    else:\n        raise WhoisException(\"No root WHOIS server found for domain.\")\n\n\ndef whois_request(domain, server, port=43):\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    try:\n        sock.connect((server, port))\n    except Exception as msg:\n        context = ({\n            outputPaths['domain']: {\n                'Name': domain,\n                'Whois': {\n                    'QueryStatus': 'Failed'\n                }\n            },\n        })\n\n        if SHOULD_ERROR:\n            return_error(\"Whois returned - Couldn't connect with the socket-server: {}\".format(msg), outputs=context)\n        else:\n            return_warning(\"Whois returned - Couldn't connect with the socket-server: {}\".format(msg),\n                           exit=True, outputs=context)\n\n    else:\n        sock.send((\"%s\\r\\n\" % domain).encode(\"utf-8\"))\n        buff = b\"\"\n        while True:\n            data = sock.recv(1024)\n            if len(data) == 0:\n                break\n            buff += data\n        sock.close()\n        try:\n            d = buff.decode(\"utf-8\")\n        except UnicodeDecodeError:\n            d = buff.decode(\"latin-1\")\n\n        return d\n    finally:\n        sock.close()\n\n\nairports = {}  # type: dict\ncountries = {}  # type: dict\nstates_au = {}  # type: dict\nstates_us = {}  # type: dict\nstates_ca = {}  # type: dict\n\n\nclass WhoisException(Exception):\n    pass\n\n\ndef precompile_regexes(source, flags=0):\n    return [re.compile(regex, flags) for regex in source]\n\n\ndef preprocess_regex(regex):\n    # Fix for #2; prevents a ridiculous amount of varying size permutations.\n    regex = re.sub(r\"\\\\s\\*\\(\\?P\u003c([^\u003e]+)\u003e\\.\\+\\)\", r\"\\s*(?P\u003c\\1\u003e\\S.*)\", regex)\n    # Experimental fix for #18; removes unnecessary variable-size whitespace\n    # matching, since we're stripping results anyway.\n    regex = re.sub(r\"\\[ \\]\\*\\(\\?P\u003c([^\u003e]+)\u003e\\.\\*\\)\", r\"(?P\u003c\\1\u003e.*)\", regex)\n    return regex\n\n\nregistrant_regexes = [\n    \"   Registrant:[ ]*\\n      (?P\u003corganization\u003e.*)\\n      (?P\u003cname\u003e.*)\\n      (?P\u003cstreet\u003e.*)\\n      (?P\u003ccity\u003e.*), (?P\u003cstate\u003e.*) (?P\u003cpostalcode\u003e.*)\\n      (?P\u003ccountry\u003e.*)\\n(?:      Phone: (?P\u003cphone\u003e.*)\\n)?      Email: (?P\u003cemail\u003e.*)\\n\",\n    # Corporate Domains, Inc.\n    \"Registrant:\\n  (?P\u003cname\u003e.+)\\n  (?P\u003cstreet1\u003e.+)\\n(?:  (?P\u003cstreet2\u003e.*)\\n)?(?:  (?P\u003cstreet3\u003e.*)\\n)?  (?P\u003cpostalcode\u003e.+), (?P\u003ccity\u003e.+)\\n  (?P\u003ccountry\u003e.+)\\n  (?P\u003cphone\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n\\n\",\n    # OVH\n    \"(?:Registrant ID:(?P\u003chandle\u003e.+)\\n)?Registrant Name:(?P\u003cname\u003e.*)\\n(?:Registrant Organization:(?P\u003corganization\u003e.*)\\n)?Registrant Street1?:(?P\u003cstreet1\u003e.*)\\n(?:Registrant Street2:(?P\u003cstreet2\u003e.*)\\n)?(?:Registrant Street3:(?P\u003cstreet3\u003e.*)\\n)?Registrant City:(?P\u003ccity\u003e.*)\\nRegistrant State/Province:(?P\u003cstate\u003e.*)\\nRegistrant Postal Code:(?P\u003cpostalcode\u003e.*)\\nRegistrant Country:(?P\u003ccountry\u003e.*)\\nRegistrant Phone:(?P\u003cphone\u003e.*)\\n(?:Registrant Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Registrant FAX:(?P\u003cfax\u003e.*)\\n)?(?:Registrant FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Registrant Email:(?P\u003cemail\u003e.*)\",\n    # Public Interest Registry (.org), nic.pw, No-IP.com\n    \"Registrant ID:(?P\u003chandle\u003e.+)\\nRegistrant Name:(?P\u003cname\u003e.*)\\n(?:Registrant Organization:(?P\u003corganization\u003e.*)\\n)?Registrant Address1?:(?P\u003cstreet1\u003e.*)\\n(?:Registrant Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Registrant Address3:(?P\u003cstreet3\u003e.*)\\n)?Registrant City:(?P\u003ccity\u003e.*)\\nRegistrant State/Province:(?P\u003cstate\u003e.*)\\nRegistrant Country/Economy:(?P\u003ccountry\u003e.*)\\nRegistrant Postal Code:(?P\u003cpostalcode\u003e.*)\\nRegistrant Phone:(?P\u003cphone\u003e.*)\\n(?:Registrant Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Registrant FAX:(?P\u003cfax\u003e.*)\\n)?(?:Registrant FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Registrant E-mail:(?P\u003cemail\u003e.*)\",\n    # .ME, DotAsia\n    \"Registrant ID:\\s*(?P\u003chandle\u003e.+)\\nRegistrant Name:\\s*(?P\u003cname\u003e.+)\\nRegistrant Organization:\\s*(?P\u003corganization\u003e.*)\\nRegistrant Address1:\\s*(?P\u003cstreet1\u003e.+)\\nRegistrant Address2:\\s*(?P\u003cstreet2\u003e.*)\\nRegistrant City:\\s*(?P\u003ccity\u003e.+)\\nRegistrant State/Province:\\s*(?P\u003cstate\u003e.+)\\nRegistrant Postal Code:\\s*(?P\u003cpostalcode\u003e.+)\\nRegistrant Country:\\s*(?P\u003ccountry\u003e.+)\\nRegistrant Country Code:\\s*(?P\u003ccountry_code\u003e.+)\\nRegistrant Phone Number:\\s*(?P\u003cphone\u003e.+)\\nRegistrant Email:\\s*(?P\u003cemail\u003e.+)\\n\",\n    # .CO Internet\n    \"Registrant Contact: (?P\u003chandle\u003e.+)\\nRegistrant Organization: (?P\u003corganization\u003e.+)\\nRegistrant Name: (?P\u003cname\u003e.+)\\nRegistrant Street: (?P\u003cstreet\u003e.+)\\nRegistrant City: (?P\u003ccity\u003e.+)\\nRegistrant Postal Code: (?P\u003cpostalcode\u003e.+)\\nRegistrant State: (?P\u003cstate\u003e.+)\\nRegistrant Country: (?P\u003ccountry\u003e.+)\\nRegistrant Phone: (?P\u003cphone\u003e.*)\\nRegistrant Phone Ext: (?P\u003cphone_ext\u003e.*)\\nRegistrant Fax: (?P\u003cfax\u003e.*)\\nRegistrant Fax Ext: (?P\u003cfax_ext\u003e.*)\\nRegistrant Email: (?P\u003cemail\u003e.*)\\n\",\n    # Key-Systems GmbH\n    \"(?:Registrant ID:[ ]*(?P\u003chandle\u003e.*)\\n)?Registrant Name:[ ]*(?P\u003cname\u003e.*)\\n(?:Registrant Organization:[ ]*(?P\u003corganization\u003e.*)\\n)?Registrant Street:[ ]*(?P\u003cstreet1\u003e.+)\\n(?:Registrant Street:[ ]*(?P\u003cstreet2\u003e.+)\\n)?(?:Registrant Street:[ ]*(?P\u003cstreet3\u003e.+)\\n)?Registrant City:[ ]*(?P\u003ccity\u003e.+)\\nRegistrant State(?:\\/Province)?:[ ]*(?P\u003cstate\u003e.*)\\nRegistrant Postal Code:[ ]*(?P\u003cpostalcode\u003e.+)\\nRegistrant Country:[ ]*(?P\u003ccountry\u003e.+)\\n(?:Registrant Phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:Registrant Phone Ext:[ ]*(?P\u003cphone_ext\u003e.*)\\n)?(?:Registrant Fax:[ ]*(?P\u003cfax\u003e.*)\\n)?(?:Registrant Fax Ext:[ ]*(?P\u003cfax_ext\u003e.*)\\n)?(?:Registrant Email:[ ]*(?P\u003cemail\u003e.+)\\n)?\",\n    # WildWestDomains, GoDaddy, Namecheap/eNom, Ascio, Musedoma (.museum), EuroDNS, nic.ps\n    \"Registrant\\n(?:    (?P\u003corganization\u003e.+)\\n)?    (?P\u003cname\u003e.+)\\n    Email:(?P\u003cemail\u003e.+)\\n    (?P\u003cstreet1\u003e.+)\\n(?:    (?P\u003cstreet2\u003e.+)\\n)?    (?P\u003cpostalcode\u003e.+) (?P\u003ccity\u003e.+)\\n    (?P\u003ccountry\u003e.+)\\n    Tel: (?P\u003cphone\u003e.+)\\n\\n\",\n    # internet.bs\n    \" Registrant Contact Details:[ ]*\\n    (?P\u003corganization\u003e.*)\\n    (?P\u003cname\u003e.*)[ ]{2,}\\((?P\u003cemail\u003e.*)\\)\\n    (?P\u003cstreet1\u003e.*)\\n(?:    (?P\u003cstreet2\u003e.*)\\n)?(?:    (?P\u003cstreet3\u003e.*)\\n)?    (?P\u003ccity\u003e.*)\\n    (?P\u003cstate\u003e.*),(?P\u003cpostalcode\u003e.*)\\n    (?P\u003ccountry\u003e.*)\\n    Tel. (?P\u003cphone\u003e.*)\",\n    # Whois.com\n    \"owner-id:[ ]*(?P\u003chandle\u003e.*)\\n(?:owner-organization:[ ]*(?P\u003corganization\u003e.*)\\n)?owner-name:[ ]*(?P\u003cname\u003e.*)\\nowner-street:[ ]*(?P\u003cstreet\u003e.*)\\nowner-city:[ ]*(?P\u003ccity\u003e.*)\\nowner-zip:[ ]*(?P\u003cpostalcode\u003e.*)\\nowner-country:[ ]*(?P\u003ccountry\u003e.*)\\n(?:owner-phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:owner-fax:[ ]*(?P\u003cfax\u003e.*)\\n)?owner-email:[ ]*(?P\u003cemail\u003e.*)\",\n    # InterNetworX\n    \"Registrant:\\n registrant_org: (?P\u003corganization\u003e.*)\\n registrant_name: (?P\u003cname\u003e.*)\\n registrant_email: (?P\u003cemail\u003e.*)\\n registrant_address: (?P\u003caddress\u003e.*)\\n registrant_city: (?P\u003ccity\u003e.*)\\n registrant_state: (?P\u003cstate\u003e.*)\\n registrant_zip: (?P\u003cpostalcode\u003e.*)\\n registrant_country: (?P\u003ccountry\u003e.*)\\n registrant_phone: (?P\u003cphone\u003e.*)\",\n    # Bellnames\n    \"Holder of domain name:\\n(?P\u003cname\u003e[\\S\\s]+)\\n(?P\u003cstreet\u003e.+)\\n(?P\u003cpostalcode\u003e[A-Z0-9-]+)\\s+(?P\u003ccity\u003e.+)\\n(?P\u003ccountry\u003e.+)\\nContractual Language\",\n    # nic.ch\n    \"\\n\\n(?:Owner)?\\s+: (?P\u003cname\u003e.*)\\n(?:\\s+: (?P\u003corganization\u003e.*)\\n)?\\s+: (?P\u003cstreet\u003e.*)\\n\\s+: (?P\u003ccity\u003e.*)\\n\\s+: (?P\u003cstate\u003e.*)\\n\\s+: (?P\u003ccountry\u003e.*)\\n\",\n    # nic.io\n    \"Contact Information:\\n\\[Name\\]\\s*(?P\u003cname\u003e.*)\\n\\[Email\\]\\s*(?P\u003cemail\u003e.*)\\n\\[Web Page\\]\\s*(?P\u003curl\u003e.*)\\n\\[Postal code\\]\\s*(?P\u003cpostalcode\u003e.*)\\n\\[Postal Address\\]\\s*(?P\u003cstreet1\u003e.*)\\n(?:\\s+(?P\u003cstreet2\u003e.*)\\n)?(?:\\s+(?P\u003cstreet3\u003e.*)\\n)?\\[Phone\\]\\s*(?P\u003cphone\u003e.*)\\n\\[Fax\\]\\s*(?P\u003cfax\u003e.*)\\n\",\n    # jprs.jp\n    \"g\\. \\[Organization\\]               (?P\u003corganization\u003e.+)\\n\",  # .co.jp registrations at jprs.jp\n    \"Registrant ID:(?P\u003chandle\u003e.*)\\nRegistrant Name:(?P\u003cname\u003e.*)\\n(?:Registrant Organization:(?P\u003corganization\u003e.*)\\n)?Registrant Address1:(?P\u003cstreet1\u003e.*)\\n(?:Registrant Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Registrant Address3:(?P\u003cstreet3\u003e.*)\\n)?Registrant City:(?P\u003ccity\u003e.*)\\n(?:Registrant State/Province:(?P\u003cstate\u003e.*)\\n)?(?:Registrant Postal Code:(?P\u003cpostalcode\u003e.*)\\n)?Registrant Country:(?P\u003ccountry\u003e.*)\\nRegistrant Country Code:.*\\nRegistrant Phone Number:(?P\u003cphone\u003e.*)\\n(?:Registrant Facsimile Number:(?P\u003cfacsimile\u003e.*)\\n)?Registrant Email:(?P\u003cemail\u003e.*)\",\n    # .US, .biz (NeuStar), .buzz, .moe (Interlink Co. Ltd.)\n    \"Registrant\\n  Name:             (?P\u003cname\u003e.+)\\n(?:  Organization:     (?P\u003corganization\u003e.+)\\n)?  ContactID:        (?P\u003chandle\u003e.+)\\n(?:  Address:          (?P\u003cstreet1\u003e.+)\\n(?:                    (?P\u003cstreet2\u003e.+)\\n(?:                    (?P\u003cstreet3\u003e.+)\\n)?)?                    (?P\u003ccity\u003e.+)\\n                    (?P\u003cpostalcode\u003e.+)\\n                    (?P\u003cstate\u003e.+)\\n                    (?P\u003ccountry\u003e.+)\\n)?(?:  Created:          (?P\u003ccreationdate\u003e.+)\\n)?(?:  Last Update:      (?P\u003cchangedate\u003e.+)\\n)?\",\n    # nic.it\n    \"  Organisation Name[.]* (?P\u003cname\u003e.*)\\n  Organisation Address[.]* (?P\u003cstreet1\u003e.*)\\n  Organisation Address[.]* (?P\u003cstreet2\u003e.*)\\n(?:  Organisation Address[.]* (?P\u003cstreet3\u003e.*)\\n)?  Organisation Address[.]* (?P\u003ccity\u003e.*)\\n  Organisation Address[.]* (?P\u003cpostalcode\u003e.*)\\n  Organisation Address[.]* (?P\u003cstate\u003e.*)\\n  Organisation Address[.]* (?P\u003ccountry\u003e.*)\",\n    # Melbourne IT (what a horrid format...)\n    \"Registrant:[ ]*(?P\u003cname\u003e.+)\\n[\\s\\S]*Eligibility Name:[ ]*(?P\u003corganization\u003e.+)\\n[\\s\\S]*Registrant Contact ID:[ ]*(?P\u003chandle\u003e.+)\\n\",\n    # .au business\n    \"Eligibility Type:[ ]*Citizen\\/Resident\\n[\\s\\S]*Registrant Contact ID:[ ]*(?P\u003chandle\u003e.+)\\n[\\s\\S]*Registrant Contact Name:[ ]*(?P\u003cname\u003e.+)\\n\",\n    # .au individual\n    \"Registrant:[ ]*(?P\u003corganization\u003e.+)\\n[\\s\\S]*Eligibility Type:[ ]*(Higher Education Institution|Company|Incorporated Association|Other)\\n[\\s\\S]*Registrant Contact ID:[ ]*(?P\u003chandle\u003e.+)\\n[\\s\\S]*Registrant Contact Name:[ ]*(?P\u003cname\u003e.+)\\n\",\n    # .au educational, company, 'incorporated association' (non-profit?), other (spotted for linux.conf.au, unsure if also for others)\n    \"    Registrant:\\n        (?P\u003cname\u003e.+)\\n\\n    Registrant type:\\n        .*\\n\\n    Registrant's address:\\n        The registrant .* opted to have\",\n    # Nominet (.uk) with hidden address\n    \"    Registrant:\\n        (?P\u003cname\u003e.+)\\n\\n[\\s\\S]*    Registrant type:\\n        .*\\n\\n    Registrant's address:\\n        (?P\u003cstreet1\u003e.+)\\n(?:        (?P\u003cstreet2\u003e.+)\\n(?:        (?P\u003cstreet3\u003e.+)\\n)??)??        (?P\u003ccity\u003e[^0-9\\n]+)\\n(?:        (?P\u003cstate\u003e.+)\\n)?        (?P\u003cpostalcode\u003e.+)\\n        (?P\u003ccountry\u003e.+)\\n\\n\",\n    # Nominet (.uk) with visible address\n    \"Domain Owner:\\n\\t(?P\u003corganization\u003e.+)\\n\\n[\\s\\S]*?(?:Registrant Contact:\\n\\t(?P\u003cname\u003e.+))?\\n\\nRegistrant(?:'s)? (?:a|A)ddress:(?:\\n\\t(?P\u003cstreet1\u003e.+)\\n(?:\\t(?P\u003cstreet2\u003e.+)\\n)?(?:\\t(?P\u003cstreet3\u003e.+)\\n)?\\t(?P\u003ccity\u003e.+)\\n\\t(?P\u003cpostalcode\u003e.+))?\\n\\t(?P\u003ccountry\u003e.+)(?:\\n\\t(?P\u003cphone\u003e.+) \\(Phone\\)\\n\\t(?P\u003cfax\u003e.+) \\(FAX\\)\\n\\t(?P\u003cemail\u003e.+))?\\n\\n\",\n    # .ac.uk - what a mess...\n    \"Registrant ID: (?P\u003chandle\u003e.+)\\nRegistrant: (?P\u003cname\u003e.+)\\nRegistrant Contact Email: (?P\u003cemail\u003e.+)\",  # .cn (CNNIC)\n    \"Registrant contact:\\n  (?P\u003cname\u003e.+)\\n  (?P\u003cstreet\u003e.*)\\n  (?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+) (?P\u003cpostalcode\u003e.+) (?P\u003ccountry\u003e.+)\\n\\n\",\n    # Fabulous.com\n    \"registrant-name:\\s*(?P\u003cname\u003e.+)\\nregistrant-type:\\s*(?P\u003ctype\u003e.+)\\nregistrant-address:\\s*(?P\u003cstreet\u003e.+)\\nregistrant-postcode:\\s*(?P\u003cpostalcode\u003e.+)\\nregistrant-city:\\s*(?P\u003ccity\u003e.+)\\nregistrant-country:\\s*(?P\u003ccountry\u003e.+)\\n(?:registrant-phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:registrant-email:\\s*(?P\u003cemail\u003e.+)\\n)?\",\n    # Hetzner\n    \"Registrant Contact Information :[ ]*\\n[ ]+(?P\u003cfirstname\u003e.*)\\n[ ]+(?P\u003clastname\u003e.*)\\n[ ]+(?P\u003corganization\u003e.*)\\n[ ]+(?P\u003cemail\u003e.*)\\n[ ]+(?P\u003cstreet\u003e.*)\\n[ ]+(?P\u003ccity\u003e.*)\\n[ ]+(?P\u003cpostalcode\u003e.*)\\n[ ]+(?P\u003cphone\u003e.*)\\n[ ]+(?P\u003cfax\u003e.*)\\n\\n\",\n    # GAL Communication\n    \"Contact Information : For Customer # [0-9]+[ ]*\\n[ ]+(?P\u003cfirstname\u003e.*)\\n[ ]+(?P\u003clastname\u003e.*)\\n[ ]+(?P\u003corganization\u003e.*)\\n[ ]+(?P\u003cemail\u003e.*)\\n[ ]+(?P\u003cstreet\u003e.*)\\n[ ]+(?P\u003ccity\u003e.*)\\n[ ]+(?P\u003cpostalcode\u003e.*)\\n[ ]+(?P\u003cphone\u003e.*)\\n[ ]+(?P\u003cfax\u003e.*)\\n\\n\",\n    # GAL Communication alternative (private WHOIS) format?\n    \"Registrant:\\n   Name:           (?P\u003cname\u003e.+)\\n   City:           (?P\u003ccity\u003e.+)\\n   State:          (?P\u003cstate\u003e.+)\\n   Country:        (?P\u003ccountry\u003e.+)\\n\",\n    # Akky (.com.mx)\n    \"   Registrant:\\n      (?P\u003cname\u003e.+)\\n      (?P\u003cstreet\u003e.+)\\n      (?P\u003ccity\u003e.+) (?P\u003cstate\u003e\\S+),[ ]+(?P\u003cpostalcode\u003e.+)\\n      (?P\u003ccountry\u003e.+)\",\n    # .am\n    \"Domain Holder: (?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?, (?P\u003ccity\u003e[^.,]+), (?P\u003cdistrict\u003e.+), (?P\u003cstate\u003e.+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 1\n    \"Domain Holder: (?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?, (?P\u003ccity\u003e.+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 2\n    \"Domain Holder: (?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+)\\n(?:(?P\u003cstreet2\u003e.+)\\n)?(?:(?P\u003cstreet3\u003e.+)\\n)?.+?, (?P\u003cdistrict\u003e.+)\\n(?P\u003ccity\u003e.+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 3\n    \"Domain Holder: (?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?\\n(?P\u003ccity\u003e.+),? (?P\u003cstate\u003e[A-Z]{2,3})(?: [A-Z0-9]+)?\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 4\n    \"   Registrant:\\n      (?P\u003corganization\u003e.+)\\n      (?P\u003cname\u003e.+)  (?P\u003cemail\u003e.+)\\n      (?P\u003cphone\u003e.*)\\n      (?P\u003cfax\u003e.*)\\n      (?P\u003cstreet\u003e.*)\\n      (?P\u003ccity\u003e.+), (?P\u003cstate\u003e[^,\\n]*)\\n      (?P\u003ccountry\u003e.+)\\n\",\n    # .com.tw (Western registrars)\n    \"Registrant:\\n(?P\u003corganization1\u003e.+)\\n(?P\u003corganization2\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+(?P\u003cstreet2\u003e.+?)(?:,+(?P\u003cstreet3\u003e.+?)(?:,+(?P\u003cstreet4\u003e.+?)(?:,+(?P\u003cstreet5\u003e.+?)(?:,+(?P\u003cstreet6\u003e.+?)(?:,+(?P\u003cstreet7\u003e.+?))?)?)?)?)?)?,(?P\u003ccity\u003e.+),(?P\u003ccountry\u003e.+)\\n\\n   Contact:\\n      (?P\u003cname\u003e.+)   (?P\u003cemail\u003e.+)\\n      TEL:  (?P\u003cphone\u003e.+?)(?:(?:#|ext.?)(?P\u003cphone_ext\u003e.+))?\\n      FAX:  (?P\u003cfax\u003e.+)(?:(?:#|ext.?)(?P\u003cfax_ext\u003e.+))?\\n\",\n    # .com.tw (TWNIC/SEEDNET, Taiwanese companies only?)\n    \"Registrant Contact Information:\\n\\nCompany English Name \\(It should be the same as the registered/corporation name on your Business Register Certificate or relevant documents\\):(?P\u003corganization1\u003e.+)\\nCompany Chinese name:(?P\u003corganization2\u003e.+)\\nAddress: (?P\u003cstreet\u003e.+)\\nCountry: (?P\u003ccountry\u003e.+)\\nEmail: (?P\u003cemail\u003e.+)\\n\",\n    # HKDNR (.hk)\n    \"Registrant ID:(?P\u003chandle\u003e.+)\\nRegistrant Name:(?P\u003cname\u003e.*)\\n(?:Registrant Organization:(?P\u003corganization\u003e.*)\\n)?Registrant Street1:(?P\u003cstreet1\u003e.+?)\\n(?:Registrant Street2:(?P\u003cstreet2\u003e.+?)\\n(?:Registrant Street3:(?P\u003cstreet3\u003e.+?)\\n)?)?Registrant City:(?P\u003ccity\u003e.+)\\nRegistrant State:(?P\u003cstate\u003e.*)\\nRegistrant Postal Code:(?P\u003cpostalcode\u003e.+)\\nRegistrant Country:(?P\u003ccountry\u003e[A-Z]+)\\nRegistrant Phone:(?P\u003cphone\u003e.*?)\\nRegistrant Fax:(?P\u003cfax\u003e.*)\\nRegistrant Email:(?P\u003cemail\u003e.+)\\n\",\n    # Realtime Register\n    \"owner:\\s+(?P\u003cname\u003e.+)\",  # .br\n    \"person:\\s+(?P\u003cname\u003e.+)\",  # nic.ru (person)\n    \"org:\\s+(?P\u003corganization\u003e.+)\",  # nic.ru (organization)\n    \"Registrant:\\n\\t(?P\u003corganization\u003e.+)\\n\\t(?P\u003corganization2\u003e.+)\\n\\t(?P\u003cstreet\u003e.*)\\n\\t(?P\u003ccity\u003e.+), (?P\u003cstate\u003e.*) (?P\u003cpostalcode\u003e.+)\\n\\t(?P\u003ccountry\u003e.+)\",\n    # EDU domains\n    \"Registrant Organization: (?P\u003corganization\u003e.+)\\nRegistrant State/Province: (?P\u003cstate\u003e.*)\\nRegistrant Country: (?P\u003ccountry\u003e[A-Z]+)\",\n    \"Registrant:\\n\\t(?P\u003corganization\u003e.+)\\n\\t(?P\u003cstreet\u003e.*)\\n\\t(?P\u003ccity\u003e.+), (?P\u003cstate\u003e.*) (?P\u003cpostalcode\u003e.+)\\n\\t(?P\u003ccountry\u003e.+)\"\n]\n\ntech_contact_regexes = [\n    \"   Technical Contact:[ ]*\\n      (?P\u003corganization\u003e.*)\\n      (?P\u003cname\u003e.*)\\n      (?P\u003cstreet\u003e.*)\\n      (?P\u003ccity\u003e.*), (?P\u003cstate\u003e.*) (?P\u003cpostalcode\u003e.*)\\n      (?P\u003ccountry\u003e.*)\\n(?:      Phone: (?P\u003cphone\u003e.*)\\n)?      Email: (?P\u003cemail\u003e.*)\\n\",\n    # Corporate Domains, Inc.\n    \"Technical Contact:\\n  (?P\u003cname\u003e.+)\\n  (?P\u003cstreet1\u003e.+)\\n(?:  (?P\u003cstreet2\u003e.*)\\n)?(?:  (?P\u003cstreet3\u003e.*)\\n)?  (?P\u003cpostalcode\u003e.+), (?P\u003ccity\u003e.+)\\n  (?P\u003ccountry\u003e.+)\\n  (?P\u003cphone\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n\\n\",\n    # OVH\n    \"(?:Tech ID:(?P\u003chandle\u003e.+)\\n)?Tech Name:(?P\u003cname\u003e.*)\\n(:?Tech Organization:(?P\u003corganization\u003e.*)\\n)?Tech Street1?:(?P\u003cstreet1\u003e.*)\\n(?:Tech Street2:(?P\u003cstreet2\u003e.*)\\n)?(?:Tech Street3:(?P\u003cstreet3\u003e.*)\\n)?Tech City:(?P\u003ccity\u003e.*)\\nTech State/Province:(?P\u003cstate\u003e.*)\\nTech Postal Code:(?P\u003cpostalcode\u003e.*)\\nTech Country:(?P\u003ccountry\u003e.*)\\nTech Phone:(?P\u003cphone\u003e.*)\\n(?:Tech Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Tech FAX:(?P\u003cfax\u003e.*)\\n)?(?:Tech FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Tech Email:(?P\u003cemail\u003e.*)\",\n    # Public Interest Registry (.org), nic.pw, No-IP.com\n    \"Tech(?:nical)? ID:(?P\u003chandle\u003e.+)\\nTech(?:nical)? Name:(?P\u003cname\u003e.*)\\n(?:Tech(?:nical)? Organization:(?P\u003corganization\u003e.*)\\n)?Tech(?:nical)? Address1?:(?P\u003cstreet1\u003e.*)\\n(?:Tech(?:nical)? Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Tech(?:nical)? Address3:(?P\u003cstreet3\u003e.*)\\n)?Tech(?:nical)? City:(?P\u003ccity\u003e.*)\\nTech(?:nical)? State/Province:(?P\u003cstate\u003e.*)\\nTech(?:nical)? Country/Economy:(?P\u003ccountry\u003e.*)\\nTech(?:nical)? Postal Code:(?P\u003cpostalcode\u003e.*)\\nTech(?:nical)? Phone:(?P\u003cphone\u003e.*)\\n(?:Tech(?:nical)? Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Tech(?:nical)? FAX:(?P\u003cfax\u003e.*)\\n)?(?:Tech(?:nical)? FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Tech(?:nical)? E-mail:(?P\u003cemail\u003e.*)\",\n    # .ME, DotAsia\n    \"Technical Contact ID:\\s*(?P\u003chandle\u003e.+)\\nTechnical Contact Name:\\s*(?P\u003cname\u003e.+)\\nTechnical Contact Organization:\\s*(?P\u003corganization\u003e.*)\\nTechnical Contact Address1:\\s*(?P\u003cstreet1\u003e.+)\\nTechnical Contact Address2:\\s*(?P\u003cstreet2\u003e.*)\\nTechnical Contact City:\\s*(?P\u003ccity\u003e.+)\\nTechnical Contact State/Province:\\s*(?P\u003cstate\u003e.+)\\nTechnical Contact Postal Code:\\s*(?P\u003cpostalcode\u003e.+)\\nTechnical Contact Country:\\s*(?P\u003ccountry\u003e.+)\\nTechnical Contact Country Code:\\s*(?P\u003ccountry_code\u003e.+)\\nTechnical Contact Phone Number:\\s*(?P\u003cphone\u003e.+)\\nTechnical Contact Email:\\s*(?P\u003cemail\u003e.+)\\n\",\n    # .CO Internet\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\nTech Organization: (?P\u003corganization\u003e.+)\\nTech Name: (?P\u003cname\u003e.+)\\nTech Street: (?P\u003cstreet\u003e.+)\\nTech City: (?P\u003ccity\u003e.+)\\nTech Postal Code: (?P\u003cpostalcode\u003e.+)\\nTech State: (?P\u003cstate\u003e.+)\\nTech Country: (?P\u003ccountry\u003e.+)\\nTech Phone: (?P\u003cphone\u003e.*)\\nTech Phone Ext: (?P\u003cphone_ext\u003e.*)\\nTech Fax: (?P\u003cfax\u003e.*)\\nTech Fax Ext: (?P\u003cfax_ext\u003e.*)\\nTech Email: (?P\u003cemail\u003e.*)\\n\",\n    # Key-Systems GmbH\n    \"(?:Tech ID:[ ]*(?P\u003chandle\u003e.*)\\n)?Tech[ ]*Name:[ ]*(?P\u003cname\u003e.*)\\n(?:Tech[ ]*Organization:[ ]*(?P\u003corganization\u003e.*)\\n)?Tech[ ]*Street:[ ]*(?P\u003cstreet1\u003e.+)\\n(?:Tech[ ]*Street:[ ]*(?P\u003cstreet2\u003e.+)\\n)?(?:Tech[ ]*Street:[ ]*(?P\u003cstreet3\u003e.+)\\n)?Tech[ ]*City:[ ]*(?P\u003ccity\u003e.+)\\nTech[ ]*State(?:\\/Province)?:[ ]*(?P\u003cstate\u003e.*)\\nTech[ ]*Postal[ ]*Code:[ ]*(?P\u003cpostalcode\u003e.+)\\nTech[ ]*Country:[ ]*(?P\u003ccountry\u003e.+)\\n(?:Tech[ ]*Phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:Tech[ ]*Phone[ ]*Ext:[ ]*(?P\u003cphone_ext\u003e.*)\\n)?(?:Tech[ ]*Fax:[ ]*(?P\u003cfax\u003e.*)\\n)?(?:Tech[ ]*Fax[ ]*Ext:\\s*?(?P\u003cfax_ext\u003e.*)\\n)?(?:Tech[ ]*Email:[ ]*(?P\u003cemail\u003e.+)\\n)?\",\n    # WildWestDomains, GoDaddy, Namecheap/eNom, Ascio, Musedoma (.museum), EuroDNS, nic.ps\n    \"Technical Contact\\n(?:    (?P\u003corganization\u003e.+)\\n)?    (?P\u003cname\u003e.+)\\n    Email:(?P\u003cemail\u003e.+)\\n    (?P\u003cstreet1\u003e.+)\\n(?:    (?P\u003cstreet2\u003e.+)\\n)?    (?P\u003cpostalcode\u003e.+) (?P\u003ccity\u003e.+)\\n    (?P\u003ccountry\u003e.+)\\n    Tel: (?P\u003cphone\u003e.+)\\n\\n\",\n    # internet.bs\n    \" Technical Contact Details:[ ]*\\n    (?P\u003corganization\u003e.*)\\n    (?P\u003cname\u003e.*)[ ]{2,}\\((?P\u003cemail\u003e.*)\\)\\n    (?P\u003cstreet1\u003e.*)\\n(?:    (?P\u003cstreet2\u003e.*)\\n)?(?:    (?P\u003cstreet3\u003e.*)\\n)?    (?P\u003ccity\u003e.*)\\n    (?P\u003cstate\u003e.*),(?P\u003cpostalcode\u003e.*)\\n    (?P\u003ccountry\u003e.*)\\n    Tel. (?P\u003cphone\u003e.*)\",\n    # Whois.com\n    \"tech-id:[ ]*(?P\u003chandle\u003e.*)\\n(?:tech-organization:[ ]*(?P\u003corganization\u003e.*)\\n)?tech-name:[ ]*(?P\u003cname\u003e.*)\\ntech-street:[ ]*(?P\u003cstreet\u003e.*)\\ntech-city:[ ]*(?P\u003ccity\u003e.*)\\ntech-zip:[ ]*(?P\u003cpostalcode\u003e.*)\\ntech-country:[ ]*(?P\u003ccountry\u003e.*)\\n(?:tech-phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:tech-fax:[ ]*(?P\u003cfax\u003e.*)\\n)?tech-email:[ ]*(?P\u003cemail\u003e.*)\",\n    # InterNetworX\n    \"Technical Contact:\\n tech_org: (?P\u003corganization\u003e.*)\\n tech_name: (?P\u003cname\u003e.*)\\n tech_email: (?P\u003cemail\u003e.*)\\n tech_address: (?P\u003caddress\u003e.*)\\n tech_city: (?P\u003ccity\u003e.*)\\n tech_state: (?P\u003cstate\u003e.*)\\n tech_zip: (?P\u003cpostalcode\u003e.*)\\n tech_country: (?P\u003ccountry\u003e.*)\\n tech_phone: (?P\u003cphone\u003e.*)\",\n    # Bellnames\n    \"Technical contact:\\n(?P\u003cname\u003e[\\S\\s]+)\\n(?P\u003cstreet\u003e.+)\\n(?P\u003cpostalcode\u003e[A-Z0-9-]+)\\s+(?P\u003ccity\u003e.+)\\n(?P\u003ccountry\u003e.+)\\n\\n\",\n    # nic.ch\n    \"Tech Contact ID:[ ]*(?P\u003chandle\u003e.+)\\nTech Contact Name:[ ]*(?P\u003cname\u003e.+)\",  # .au\n    \"Technical Contact ID:(?P\u003chandle\u003e.*)\\nTechnical Contact Name:(?P\u003cname\u003e.*)\\n(?:Technical Contact Organization:(?P\u003corganization\u003e.*)\\n)?Technical Contact Address1:(?P\u003cstreet1\u003e.*)\\n(?:Technical Contact Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Technical Contact Address3:(?P\u003cstreet3\u003e.*)\\n)?Technical Contact City:(?P\u003ccity\u003e.*)\\n(?:Technical Contact State/Province:(?P\u003cstate\u003e.*)\\n)?(?:Technical Contact Postal Code:(?P\u003cpostalcode\u003e.*)\\n)?Technical Contact Country:(?P\u003ccountry\u003e.*)\\nTechnical Contact Country Code:.*\\nTechnical Contact Phone Number:(?P\u003cphone\u003e.*)\\n(?:Technical Contact Facsimile Number:(?P\u003cfacsimile\u003e.*)\\n)?Technical Contact Email:(?P\u003cemail\u003e.*)\",\n    # .US, .biz (NeuStar), .buzz, .moe (Interlink Co. Ltd.)\n    \"Technical Contacts\\n  Name:             (?P\u003cname\u003e.+)\\n(?:  Organization:     (?P\u003corganization\u003e.+)\\n)?  ContactID:        (?P\u003chandle\u003e.+)\\n(?:  Address:          (?P\u003cstreet1\u003e.+)\\n(?:                    (?P\u003cstreet2\u003e.+)\\n(?:                    (?P\u003cstreet3\u003e.+)\\n)?)?                    (?P\u003ccity\u003e.+)\\n                    (?P\u003cpostalcode\u003e.+)\\n                    (?P\u003cstate\u003e.+)\\n                    (?P\u003ccountry\u003e.+)\\n)?(?:  Created:          (?P\u003ccreationdate\u003e.+)\\n)?(?:  Last Update:      (?P\u003cchangedate\u003e.+)\\n)?\",\n    # nic.it  //  NOTE: Why does this say 'Contacts'? Can it have multiple?\n    \"Tech Name[.]* (?P\u003cname\u003e.*)\\n  Tech Address[.]* (?P\u003cstreet1\u003e.*)\\n  Tech Address[.]* (?P\u003cstreet2\u003e.*)\\n(?:  Tech Address[.]* (?P\u003cstreet3\u003e.*)\\n)?  Tech Address[.]* (?P\u003ccity\u003e.*)\\n  Tech Address[.]* (?P\u003cpostalcode\u003e.*)\\n  Tech Address[.]* (?P\u003cstate\u003e.*)\\n  Tech Address[.]* (?P\u003ccountry\u003e.*)\\n  Tech Email[.]* (?P\u003cemail\u003e.*)\\n  Tech Phone[.]* (?P\u003cphone\u003e.*)\\n  Tech Fax[.]* (?P\u003cfax\u003e.*)\",\n    # Melbourne IT\n    \"Technical contact:\\n(?:  (?P\u003corganization\u003e.+)\\n)?  (?P\u003cname\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n  (?P\u003cstreet\u003e.+)\\n  (?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+) (?P\u003cpostalcode\u003e.+) (?P\u003ccountry\u003e.+)\\n  Phone: (?P\u003cphone\u003e.*)\\n  Fax: (?P\u003cfax\u003e.*)\\n\",\n    # Fabulous.com\n    \"tech-c-name:\\s*(?P\u003cname\u003e.+)\\ntech-c-type:\\s*(?P\u003ctype\u003e.+)\\ntech-c-address:\\s*(?P\u003cstreet\u003e.+)\\ntech-c-postcode:\\s*(?P\u003cpostalcode\u003e.+)\\ntech-c-city:\\s*(?P\u003ccity\u003e.+)\\ntech-c-country:\\s*(?P\u003ccountry\u003e.+)\\n(?:tech-c-phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:tech-c-email:\\s*(?P\u003cemail\u003e.+)\\n)?\",\n    # Hetzner\n    \"Admin Contact Information :[ ]*\\n[ ]+(?P\u003cfirstname\u003e.*)\\n[ ]+(?P\u003clastname\u003e.*)\\n[ ]+(?P\u003corganization\u003e.*)\\n[ ]+(?P\u003cemail\u003e.*)\\n[ ]+(?P\u003cstreet\u003e.*)\\n[ ]+(?P\u003ccity\u003e.*)\\n[ ]+(?P\u003cpostalcode\u003e.*)\\n[ ]+(?P\u003cphone\u003e.*)\\n[ ]+(?P\u003cfax\u003e.*)\\n\\n\",\n    # GAL Communication\n    \"   Technical contact:\\n      (?P\u003cname\u003e.+)\\n      (?P\u003corganization\u003e.*)\\n      (?P\u003cstreet\u003e.+)\\n      (?P\u003ccity\u003e.+) (?P\u003cstate\u003e\\S+),[ ]+(?P\u003cpostalcode\u003e.+)\\n      (?P\u003ccountry\u003e.+)\\n      (?P\u003cemail\u003e.+)\\n      (?P\u003cphone\u003e.*)\\n      (?P\u003cfax\u003e.*)\",\n    # .am\n    \"Technical:\\n\\s*Name:\\s*(?P\u003cname\u003e.*)\\n\\s*Organisation:\\s*(?P\u003corganization\u003e.*)\\n\\s*Language:.*\\n\\s*Phone:\\s*(?P\u003cphone\u003e.*)\\n\\s*Fax:\\s*(?P\u003cfax\u003e.*)\\n\\s*Email:\\s*(?P\u003cemail\u003e.*)\\n\",\n    # EURid\n    \"\\[Zone-C\\]\\nType: (?P\u003ctype\u003e.+)\\nName: (?P\u003cname\u003e.+)\\n(Organisation: (?P\u003corganization\u003e.+)\\n){0,1}(Address: (?P\u003cstreet1\u003e.+)\\n){1}(Address: (?P\u003cstreet2\u003e.+)\\n){0,1}(Address: (?P\u003cstreet3\u003e.+)\\n){0,1}(Address: (?P\u003cstreet4\u003e.+)\\n){0,1}PostalCode: (?P\u003cpostalcode\u003e.+)\\nCity: (?P\u003ccity\u003e.+)\\nCountryCode: (?P\u003ccountry\u003e[A-Za-z]{2})\\nPhone: (?P\u003cphone\u003e.+)\\nFax: (?P\u003cfax\u003e.+)\\nEmail: (?P\u003cemail\u003e.+)\\n(Remarks: (?P\u003cremark\u003e.+)\\n){0,1}Changed: (?P\u003cchanged\u003e.+)\",\n    # DeNIC\n    \"Technical Contact:\\n   Name:           (?P\u003cname\u003e.+)\\n   City:           (?P\u003ccity\u003e.+)\\n   State:          (?P\u003cstate\u003e.+)\\n   Country:        (?P\u003ccountry\u003e.+)\\n\",\n    # Akky (.com.mx)\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\n(?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?\\n(?P\u003ccity\u003e.+),? (?P\u003cstate\u003e[A-Z]{2,3})(?: [A-Z0-9]+)?\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 1\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\n(?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?\\n(?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 2\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\n(?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?, (?P\u003ccity\u003e.+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 3\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\n(?P\u003cstreet1\u003e.+) (?P\u003ccity\u003e[^\\s]+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 4\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\n(?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+)\\n(?P\u003cdistrict\u003e.+) (?P\u003ccity\u003e[^\\s]+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 5\n    \"Tech Contact: (?P\u003chandle\u003e.+)\\n(?P\u003corganization\u003e.+)\\n(?P\u003cstreet1\u003e.+)\\n(?P\u003cstreet2\u003e.+)\\n(?:(?P\u003cstreet3\u003e.+)\\n)?(?P\u003ccity\u003e.+)\\n(?P\u003cpostalcode\u003e.+)\\n(?P\u003ccountry\u003e[A-Z]+)\\n\",\n    # .co.th, format 6\n    \"   Technical Contact:\\n      (?P\u003cname\u003e.+)  (?P\u003cemail\u003e.+)\\n      (?P\u003cphone\u003e.*)\\n      (?P\u003cfax\u003e.*)\\n\",\n    # .com.tw (Western registrars)\n    \"Technical Contact Information:\\n\\n(?:Given name: (?P\u003cfirstname\u003e.+)\\n)?(?:Family name: (?P\u003clastname\u003e.+)\\n)?(?:Company name: (?P\u003corganization\u003e.+)\\n)?Address: (?P\u003cstreet\u003e.+)\\nCountry: (?P\u003ccountry\u003e.+)\\nPhone: (?P\u003cphone\u003e.*)\\nFax: (?P\u003cfax\u003e.*)\\nEmail: (?P\u003cemail\u003e.+)\\n(?:Account Name: (?P\u003chandle\u003e.+)\\n)?\",\n    # HKDNR (.hk)\n    \"TECH ID:(?P\u003chandle\u003e.+)\\nTECH Name:(?P\u003cname\u003e.*)\\n(?:TECH Organization:(?P\u003corganization\u003e.*)\\n)?TECH Street1:(?P\u003cstreet1\u003e.+?)\\n(?:TECH Street2:(?P\u003cstreet2\u003e.+?)\\n(?:TECH Street3:(?P\u003cstreet3\u003e.+?)\\n)?)?TECH City:(?P\u003ccity\u003e.+)\\nTECH State:(?P\u003cstate\u003e.*)\\nTECH Postal Code:(?P\u003cpostalcode\u003e.+)\\nTECH Country:(?P\u003ccountry\u003e[A-Z]+)\\nTECH Phone:(?P\u003cphone\u003e.*?)\\nTECH Fax:(?P\u003cfax\u003e.*)\\nTECH Email:(?P\u003cemail\u003e.+)\\n\",\n    # Realtime Register\n    \"Tech Organization: (?P\u003corganization\u003e.*)\\nTech State/Province: (?P\u003cstate\u003e.+)\\nTech Country: (?P\u003ccountry\u003e.+)\",\n    # EDU registrar\n    \"Technical Contact:\\n\\t \\n\\t(?P\u003corganization\u003e.*)\\n\\t(?P\u003cstreet\u003e.+)\\n\\t(?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+) (?P\u003cpostalcode\u003e.+)\\n\\t(?P\u003ccountry\u003e.+)\\n\\t(?P\u003cphone\u003e.*)\\n\\t(?P\u003cemail\u003e.+)\"\n\n]\n\nadmin_contact_regexes = [\n    \"   Administrative Contact:[ ]*\\n      (?P\u003corganization\u003e.*)\\n      (?P\u003cname\u003e.*)\\n      (?P\u003cstreet\u003e.*)\\n      (?P\u003ccity\u003e.*), (?P\u003cstate\u003e.*) (?P\u003cpostalcode\u003e.*)\\n      (?P\u003ccountry\u003e.*)\\n(?:      Phone: (?P\u003cphone\u003e.*)\\n)?      Email: (?P\u003cemail\u003e.*)\\n\",\n    # Corporate Domains, Inc.\n    \"Administrative Contact:\\n  (?P\u003cname\u003e.+)\\n  (?P\u003cstreet1\u003e.+)\\n(?:  (?P\u003cstreet2\u003e.*)\\n)?(?:  (?P\u003cstreet3\u003e.*)\\n)?  (?P\u003cpostalcode\u003e.+), (?P\u003ccity\u003e.+)\\n  (?P\u003ccountry\u003e.+)\\n  (?P\u003cphone\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n\\n\",\n    # OVH\n    \"(?:Admin ID:(?P\u003chandle\u003e.+)\\n)?Admin Name:(?P\u003cname\u003e.*)\\n(?:Admin Organization:(?P\u003corganization\u003e.*)\\n)?Admin Street1?:(?P\u003cstreet1\u003e.*)\\n(?:Admin Street2:(?P\u003cstreet2\u003e.*)\\n)?(?:Admin Street3:(?P\u003cstreet3\u003e.*)\\n)?Admin City:(?P\u003ccity\u003e.*)\\nAdmin State/Province:(?P\u003cstate\u003e.*)\\nAdmin Postal Code:(?P\u003cpostalcode\u003e.*)\\nAdmin Country:(?P\u003ccountry\u003e.*)\\nAdmin Phone:(?P\u003cphone\u003e.*)\\n(?:Admin Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Admin FAX:(?P\u003cfax\u003e.*)\\n)?(?:Admin FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Admin Email:(?P\u003cemail\u003e.*)\",\n    # Public Interest Registry (.org), nic.pw, No-IP.com\n    \"Admin(?:istrative)? ID:(?P\u003chandle\u003e.+)\\nAdmin(?:istrative)? Name:(?P\u003cname\u003e.*)\\n(?:Admin(?:istrative)? Organization:(?P\u003corganization\u003e.*)\\n)?Admin(?:istrative)? Address1?:(?P\u003cstreet1\u003e.*)\\n(?:Admin(?:istrative)? Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Admin(?:istrative)? Address3:(?P\u003cstreet3\u003e.*)\\n)?Admin(?:istrative)? City:(?P\u003ccity\u003e.*)\\nAdmin(?:istrative)? State/Province:(?P\u003cstate\u003e.*)\\nAdmin(?:istrative)? Country/Economy:(?P\u003ccountry\u003e.*)\\nAdmin(?:istrative)? Postal Code:(?P\u003cpostalcode\u003e.*)\\nAdmin(?:istrative)? Phone:(?P\u003cphone\u003e.*)\\n(?:Admin(?:istrative)? Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Admin(?:istrative)? FAX:(?P\u003cfax\u003e.*)\\n)?(?:Admin(?:istrative)? FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Admin(?:istrative)? E-mail:(?P\u003cemail\u003e.*)\",\n    # .ME, DotAsia\n    \"Administrative Contact ID:\\s*(?P\u003chandle\u003e.+)\\nAdministrative Contact Name:\\s*(?P\u003cname\u003e.+)\\nAdministrative Contact Organization:\\s*(?P\u003corganization\u003e.*)\\nAdministrative Contact Address1:\\s*(?P\u003cstreet1\u003e.+)\\nAdministrative Contact Address2:\\s*(?P\u003cstreet2\u003e.*)\\nAdministrative Contact City:\\s*(?P\u003ccity\u003e.+)\\nAdministrative Contact State/Province:\\s*(?P\u003cstate\u003e.+)\\nAdministrative Contact Postal Code:\\s*(?P\u003cpostalcode\u003e.+)\\nAdministrative Contact Country:\\s*(?P\u003ccountry\u003e.+)\\nAdministrative Contact Country Code:\\s*(?P\u003ccountry_code\u003e.+)\\nAdministrative Contact Phone Number:\\s*(?P\u003cphone\u003e.+)\\nAdministrative Contact Email:\\s*(?P\u003cemail\u003e.+)\\n\",\n    # .CO Internet\n    \"Admin Contact: (?P\u003chandle\u003e.+)\\nAdmin Organization: (?P\u003corganization\u003e.+)\\nAdmin Name: (?P\u003cname\u003e.+)\\nAdmin Street: (?P\u003cstreet\u003e.+)\\nAdmin City: (?P\u003ccity\u003e.+)\\nAdmin State: (?P\u003cstate\u003e.+)\\nAdmin Postal Code: (?P\u003cpostalcode\u003e.+)\\nAdmin Country: (?P\u003ccountry\u003e.+)\\nAdmin Phone: (?P\u003cphone\u003e.*)\\nAdmin Phone Ext: (?P\u003cphone_ext\u003e.*)\\nAdmin Fax: (?P\u003cfax\u003e.*)\\nAdmin Fax Ext: (?P\u003cfax_ext\u003e.*)\\nAdmin Email: (?P\u003cemail\u003e.*)\\n\",\n    # Key-Systems GmbH\n    \"(?:Admin ID:[ ]*(?P\u003chandle\u003e.*)\\n)?Admin[ ]*Name:[ ]*(?P\u003cname\u003e.*)\\n(?:Admin[ ]*Organization:[ ]*(?P\u003corganization\u003e.*)\\n)?Admin[ ]*Street:[ ]*(?P\u003cstreet1\u003e.+)\\n(?:Admin[ ]*Street:[ ]*(?P\u003cstreet2\u003e.+)\\n)?(?:Admin[ ]*Street:[ ]*(?P\u003cstreet3\u003e.+)\\n)?Admin[ ]*City:[ ]*(?P\u003ccity\u003e.+)\\nAdmin[ ]*State(?:\\/Province)?:[ ]*(?P\u003cstate\u003e.*)\\nAdmin[ ]*Postal[ ]*Code:[ ]*(?P\u003cpostalcode\u003e.+)\\nAdmin[ ]*Country:[ ]*(?P\u003ccountry\u003e.+)\\n(?:Admin[ ]*Phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:Admin[ ]*Phone[ ]*Ext:[ ]*(?P\u003cphone_ext\u003e.*)\\n)?(?:Admin[ ]*Fax:[ ]*(?P\u003cfax\u003e.*)\\n)?(?:Admin[ ]*Fax[ ]*Ext:\\s*?(?P\u003cfax_ext\u003e.*)\\n)?(?:Admin[ ]*Email:[ ]*(?P\u003cemail\u003e.+)\\n)?\",\n    # WildWestDomains, GoDaddy, Namecheap/eNom, Ascio, Musedoma (.museum), EuroDNS, nic.ps\n    \"Administrative Contact\\n(?:    (?P\u003corganization\u003e.+)\\n)?    (?P\u003cname\u003e.+)\\n    Email:(?P\u003cemail\u003e.+)\\n    (?P\u003cstreet1\u003e.+)\\n(?:    (?P\u003cstreet2\u003e.+)\\n)?    (?P\u003cpostalcode\u003e.+) (?P\u003ccity\u003e.+)\\n    (?P\u003ccountry\u003e.+)\\n    Tel: (?P\u003cphone\u003e.+)\\n\\n\",\n    # internet.bs\n    \" Administrative Contact Details:[ ]*\\n    (?P\u003corganization\u003e.*)\\n    (?P\u003cname\u003e.*)[ ]{2,}\\((?P\u003cemail\u003e.*)\\)\\n    (?P\u003cstreet1\u003e.*)\\n(?:    (?P\u003cstreet2\u003e.*)\\n)?(?:    (?P\u003cstreet3\u003e.*)\\n)?    (?P\u003ccity\u003e.*)\\n    (?P\u003cstate\u003e.*),(?P\u003cpostalcode\u003e.*)\\n    (?P\u003ccountry\u003e.*)\\n    Tel. (?P\u003cphone\u003e.*)\",\n    # Whois.com\n    \"admin-id:[ ]*(?P\u003chandle\u003e.*)\\n(?:admin-organization:[ ]*(?P\u003corganization\u003e.*)\\n)?admin-name:[ ]*(?P\u003cname\u003e.*)\\nadmin-street:[ ]*(?P\u003cstreet\u003e.*)\\nadmin-city:[ ]*(?P\u003ccity\u003e.*)\\nadmin-zip:[ ]*(?P\u003cpostalcode\u003e.*)\\nadmin-country:[ ]*(?P\u003ccountry\u003e.*)\\n(?:admin-phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:admin-fax:[ ]*(?P\u003cfax\u003e.*)\\n)?admin-email:[ ]*(?P\u003cemail\u003e.*)\",\n    # InterNetworX\n    \"Administrative Contact:\\n admin_org: (?P\u003corganization\u003e.*)\\n admin_name: (?P\u003cname\u003e.*)\\n admin_email: (?P\u003cemail\u003e.*)\\n admin_address: (?P\u003caddress\u003e.*)\\n admin_city: (?P\u003ccity\u003e.*)\\n admin_state: (?P\u003cstate\u003e.*)\\n admin_zip: (?P\u003cpostalcode\u003e.*)\\n admin_country: (?P\u003ccountry\u003e.*)\\n admin_phone: (?P\u003cphone\u003e.*)\",\n    # Bellnames\n    \"Administrative Contact ID:(?P\u003chandle\u003e.*)\\nAdministrative Contact Name:(?P\u003cname\u003e.*)\\n(?:Administrative Contact Organization:(?P\u003corganization\u003e.*)\\n)?Administrative Contact Address1:(?P\u003cstreet1\u003e.*)\\n(?:Administrative Contact Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Administrative Contact Address3:(?P\u003cstreet3\u003e.*)\\n)?Administrative Contact City:(?P\u003ccity\u003e.*)\\n(?:Administrative Contact State/Province:(?P\u003cstate\u003e.*)\\n)?(?:Administrative Contact Postal Code:(?P\u003cpostalcode\u003e.*)\\n)?Administrative Contact Country:(?P\u003ccountry\u003e.*)\\nAdministrative Contact Country Code:.*\\nAdministrative Contact Phone Number:(?P\u003cphone\u003e.*)\\n(?:Administrative Contact Facsimile Number:(?P\u003cfacsimile\u003e.*)\\n)?Administrative Contact Email:(?P\u003cemail\u003e.*)\",\n    # .US, .biz (NeuStar), .buzz, .moe (Interlink Co. Ltd.)\n    \"Admin Contact\\n  Name:             (?P\u003cname\u003e.+)\\n(?:  Organization:     (?P\u003corganization\u003e.+)\\n)?  ContactID:        (?P\u003chandle\u003e.+)\\n(?:  Address:          (?P\u003cstreet1\u003e.+)\\n(?:                    (?P\u003cstreet2\u003e.+)\\n(?:                    (?P\u003cstreet3\u003e.+)\\n)?)?                    (?P\u003ccity\u003e.+)\\n                    (?P\u003cpostalcode\u003e.+)\\n                    (?P\u003cstate\u003e.+)\\n                    (?P\u003ccountry\u003e.+)\\n)?(?:  Created:          (?P\u003ccreationdate\u003e.+)\\n)?(?:  Last Update:      (?P\u003cchangedate\u003e.+)\\n)?\",\n    # nic.it\n    \"Admin Name[.]* (?P\u003cname\u003e.*)\\n  Admin Address[.]* (?P\u003cstreet1\u003e.*)\\n  Admin Address[.]* (?P\u003cstreet2\u003e.*)\\n(?:  Admin Address[.]* (?P\u003cstreet3\u003e.*)\\n)?  Admin Address[.]* (?P\u003ccity\u003e.*)\\n  Admin Address[.]* (?P\u003cpostalcode\u003e.*)\\n  Admin Address[.]* (?P\u003cstate\u003e.*)\\n  Admin Address[.]* (?P\u003ccountry\u003e.*)\\n  Admin Email[.]* (?P\u003cemail\u003e.*)\\n  Admin Phone[.]* (?P\u003cphone\u003e.*)\\n  Admin Fax[.]* (?P\u003cfax\u003e.*)\",\n    # Melbourne IT\n    \"Administrative contact:\\n(?:  (?P\u003corganization\u003e.+)\\n)?  (?P\u003cname\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n  (?P\u003cstreet\u003e.+)\\n  (?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+) (?P\u003cpostalcode\u003e.+) (?P\u003ccountry\u003e.+)\\n  Phone: (?P\u003cphone\u003e.*)\\n  Fax: (?P\u003cfax\u003e.*)\\n\",\n    # Fabulous.com\n    \"admin-c-name:\\s*(?P\u003cname\u003e.+)\\nadmin-c-type:\\s*(?P\u003ctype\u003e.+)\\nadmin-c-address:\\s*(?P\u003cstreet\u003e.+)\\nadmin-c-postcode:\\s*(?P\u003cpostalcode\u003e.+)\\nadmin-c-city:\\s*(?P\u003ccity\u003e.+)\\nadmin-c-country:\\s*(?P\u003ccountry\u003e.+)\\n(?:admin-c-phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:admin-c-email:\\s*(?P\u003cemail\u003e.+)\\n)?\",\n    # Hetzner\n    \"Tech Contact Information :[ ]*\\n[ ]+(?P\u003cfirstname\u003e.*)\\n[ ]+(?P\u003clastname\u003e.*)\\n[ ]+(?P\u003corganization\u003e.*)\\n[ ]+(?P\u003cemail\u003e.*)\\n[ ]+(?P\u003cstreet\u003e.*)\\n[ ]+(?P\u003ccity\u003e.*)\\n[ ]+(?P\u003cpostalcode\u003e.*)\\n[ ]+(?P\u003cphone\u003e.*)\\n[ ]+(?P\u003cfax\u003e.*)\\n\\n\",\n    # GAL Communication\n    \"   Administrative contact:\\n      (?P\u003cname\u003e.+)\\n      (?P\u003corganization\u003e.*)\\n      (?P\u003cstreet\u003e.+)\\n      (?P\u003ccity\u003e.+) (?P\u003cstate\u003e\\S+),[ ]+(?P\u003cpostalcode\u003e.+)\\n      (?P\u003ccountry\u003e.+)\\n      (?P\u003cemail\u003e.+)\\n      (?P\u003cphone\u003e.*)\\n      (?P\u003cfax\u003e.*)\",\n    # .am\n    \"Administrative Contact:\\n   Name:           (?P\u003cname\u003e.+)\\n   City:           (?P\u003ccity\u003e.+)\\n   State:          (?P\u003cstate\u003e.+)\\n   Country:        (?P\u003ccountry\u003e.+)\\n\",\n    # Akky (.com.mx)\n    \"\\[Tech-C\\]\\nType: (?P\u003ctype\u003e.+)\\nName: (?P\u003cname\u003e.+)\\n(Organisation: (?P\u003corganization\u003e.+)\\n){0,1}(Address: (?P\u003cstreet1\u003e.+)\\n){1}(Address: (?P\u003cstreet2\u003e.+)\\n){0,1}(Address: (?P\u003cstreet3\u003e.+)\\n){0,1}(Address: (?P\u003cstreet4\u003e.+)\\n){0,1}PostalCode: (?P\u003cpostalcode\u003e.+)\\nCity: (?P\u003ccity\u003e.+)\\nCountryCode: (?P\u003ccountry\u003e[A-Za-z]{2})\\nPhone: (?P\u003cphone\u003e.+)\\nFax: (?P\u003cfax\u003e.+)\\nEmail: (?P\u003cemail\u003e.+)\\n(Remarks: (?P\u003cremark\u003e.+)\\n){0,1}Changed: (?P\u003cchanged\u003e.+)\",\n    # DeNIC\n    \"   Administrative Contact:\\n      (?P\u003cname\u003e.+)  (?P\u003cemail\u003e.+)\\n      (?P\u003cphone\u003e.*)\\n      (?P\u003cfax\u003e.*)\\n\",\n    # .com.tw (Western registrars)\n    \"Administrative Contact Information:\\n\\n(?:Given name: (?P\u003cfirstname\u003e.+)\\n)?(?:Family name: (?P\u003clastname\u003e.+)\\n)?(?:Company name: (?P\u003corganization\u003e.+)\\n)?Address: (?P\u003cstreet\u003e.+)\\nCountry: (?P\u003ccountry\u003e.+)\\nPhone: (?P\u003cphone\u003e.*)\\nFax: (?P\u003cfax\u003e.*)\\nEmail: (?P\u003cemail\u003e.+)\\n(?:Account Name: (?P\u003chandle\u003e.+)\\n)?\",\n    # HKDNR (.hk)\n    \"ADMIN ID:(?P\u003chandle\u003e.+)\\nADMIN Name:(?P\u003cname\u003e.*)\\n(?:ADMIN Organization:(?P\u003corganization\u003e.*)\\n)?ADMIN Street1:(?P\u003cstreet1\u003e.+?)\\n(?:ADMIN Street2:(?P\u003cstreet2\u003e.+?)\\n(?:ADMIN Street3:(?P\u003cstreet3\u003e.+?)\\n)?)?ADMIN City:(?P\u003ccity\u003e.+)\\nADMIN State:(?P\u003cstate\u003e.*)\\nADMIN Postal Code:(?P\u003cpostalcode\u003e.+)\\nADMIN Country:(?P\u003ccountry\u003e[A-Z]+)\\nADMIN Phone:(?P\u003cphone\u003e.*?)\\nADMIN Fax:(?P\u003cfax\u003e.*)\\nADMIN Email:(?P\u003cemail\u003e.+)\\n\",\n    # Realtime Register\n    \"Admin Organization: (?P\u003cname\u003e.*)\\nAdmin State/Province: (?P\u003cstate\u003e.+)\\nAdmin Country: (?P\u003ccountry\u003e.+)\\n\",\n    # EDU registrar\n    \"Administrative Contact:\\n\\t(?P\u003cname\u003e.*)\\n\\t(?P\u003corganization\u003e.*)\\n\\t(?P\u003cstreet\u003e.+)\\n\\t(?P\u003ccity\u003e.*), (?P\u003cstate\u003e.+) (?P\u003cpostalcode\u003e.+)\\n\\t(?P\u003ccountry\u003e.+)\\n\\t(?P\u003cphone\u003e.*)\\n\\t(?P\u003cemail\u003e.+)\"\n]\n\nbilling_contact_regexes = [\n    \"(?:Billing ID:(?P\u003chandle\u003e.+)\\n)?Billing Name:(?P\u003cname\u003e.*)\\nBilling Organization:(?P\u003corganization\u003e.*)\\nBilling Street1:(?P\u003cstreet1\u003e.*)\\n(?:Billing Street2:(?P\u003cstreet2\u003e.*)\\n)?(?:Billing Street3:(?P\u003cstreet3\u003e.*)\\n)?Billing City:(?P\u003ccity\u003e.*)\\nBilling State/Province:(?P\u003cstate\u003e.*)\\nBilling Postal Code:(?P\u003cpostalcode\u003e.*)\\nBilling Country:(?P\u003ccountry\u003e.*)\\nBilling Phone:(?P\u003cphone\u003e.*)\\n(?:Billing Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Billing FAX:(?P\u003cfax\u003e.*)\\n)?(?:Billing FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Billing Email:(?P\u003cemail\u003e.*)\",\n    # nic.pw, No-IP.com\n    \"Billing ID:(?P\u003chandle\u003e.+)\\nBilling Name:(?P\u003cname\u003e.*)\\n(?:Billing Organization:(?P\u003corganization\u003e.*)\\n)?Billing Address1?:(?P\u003cstreet1\u003e.*)\\n(?:Billing Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Billing Address3:(?P\u003cstreet3\u003e.*)\\n)?Billing City:(?P\u003ccity\u003e.*)\\nBilling State/Province:(?P\u003cstate\u003e.*)\\nBilling Country/Economy:(?P\u003ccountry\u003e.*)\\nBilling Postal Code:(?P\u003cpostalcode\u003e.*)\\nBilling Phone:(?P\u003cphone\u003e.*)\\n(?:Billing Phone Ext.:(?P\u003cphone_ext\u003e.*)\\n)?(?:Billing FAX:(?P\u003cfax\u003e.*)\\n)?(?:Billing FAX Ext.:(?P\u003cfax_ext\u003e.*)\\n)?Billing E-mail:(?P\u003cemail\u003e.*)\",\n    # DotAsia\n    \"Billing Contact ID:\\s*(?P\u003chandle\u003e.+)\\nBilling Contact Name:\\s*(?P\u003cname\u003e.+)\\nBilling Contact Organization:\\s*(?P\u003corganization\u003e.*)\\nBilling Contact Address1:\\s*(?P\u003cstreet1\u003e.+)\\nBilling Contact Address2:\\s*(?P\u003cstreet2\u003e.*)\\nBilling Contact City:\\s*(?P\u003ccity\u003e.+)\\nBilling Contact State/Province:\\s*(?P\u003cstate\u003e.+)\\nBilling Contact Postal Code:\\s*(?P\u003cpostalcode\u003e.+)\\nBilling Contact Country:\\s*(?P\u003ccountry\u003e.+)\\nBilling Contact Country Code:\\s*(?P\u003ccountry_code\u003e.+)\\nBilling Contact Phone Number:\\s*(?P\u003cphone\u003e.+)\\nBilling Contact Email:\\s*(?P\u003cemail\u003e.+)\\n\",\n    # .CO Internet\n    \"Billing Contact: (?P\u003chandle\u003e.+)\\nBilling Organization: (?P\u003corganization\u003e.+)\\nBilling Name: (?P\u003cname\u003e.+)\\nBilling Street: (?P\u003cstreet\u003e.+)\\nBilling City: (?P\u003ccity\u003e.+)\\nBilling Postal Code: (?P\u003cpostalcode\u003e.+)\\nBilling State: (?P\u003cstate\u003e.+)\\nBilling Country: (?P\u003ccountry\u003e.+)\\nBilling Phone: (?P\u003cphone\u003e.*)\\nBilling Phone Ext: (?P\u003cphone_ext\u003e.*)\\nBilling Fax: (?P\u003cfax\u003e.*)\\nBilling Fax Ext: (?P\u003cfax_ext\u003e.*)\\nBilling Email: (?P\u003cemail\u003e.*)\\n\",\n    # Key-Systems GmbH\n    \"(?:Billing ID:[ ]*(?P\u003chandle\u003e.*)\\n)?Billing[ ]*Name:[ ]*(?P\u003cname\u003e.*)\\n(?:Billing[ ]*Organization:[ ]*(?P\u003corganization\u003e.*)\\n)?Billing[ ]*Street:[ ]*(?P\u003cstreet1\u003e.+)\\n(?:Billing[ ]*Street:[ ]*(?P\u003cstreet2\u003e.+)\\n)?Billing[ ]*City:[ ]*(?P\u003ccity\u003e.+)\\nBilling[ ]*State\\/Province:[ ]*(?P\u003cstate\u003e.+)\\nBilling[ ]*Postal[ ]*Code:[ ]*(?P\u003cpostalcode\u003e.+)\\nBilling[ ]*Country:[ ]*(?P\u003ccountry\u003e.+)\\n(?:Billing[ ]*Phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:Billing[ ]*Phone[ ]*Ext:[ ]*(?P\u003cphone_ext\u003e.*)\\n)?(?:Billing[ ]*Fax:[ ]*(?P\u003cfax\u003e.*)\\n)?(?:Billing[ ]*Fax[ ]*Ext:\\s*?(?P\u003cfax_ext\u003e.*)\\n)?(?:Billing[ ]*Email:[ ]*(?P\u003cemail\u003e.+)\\n)?\",\n    # Musedoma (.museum)\n    \"Billing Contact:\\n  (?P\u003cname\u003e.+)\\n  (?P\u003cstreet1\u003e.+)\\n(?:  (?P\u003cstreet2\u003e.*)\\n)?(?:  (?P\u003cstreet3\u003e.*)\\n)?  (?P\u003cpostalcode\u003e.+), (?P\u003ccity\u003e.+)\\n  (?P\u003ccountry\u003e.+)\\n  (?P\u003cphone\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n\\n\",\n    # OVH\n    \" Billing Contact Details:[ ]*\\n    (?P\u003corganization\u003e.*)\\n    (?P\u003cname\u003e.*)[ ]{2,}\\((?P\u003cemail\u003e.*)\\)\\n    (?P\u003cstreet1\u003e.*)\\n(?:    (?P\u003cstreet2\u003e.*)\\n)?(?:    (?P\u003cstreet3\u003e.*)\\n)?    (?P\u003ccity\u003e.*)\\n    (?P\u003cstate\u003e.*),(?P\u003cpostalcode\u003e.*)\\n    (?P\u003ccountry\u003e.*)\\n    Tel. (?P\u003cphone\u003e.*)\",\n    # Whois.com\n    \"billing-id:[ ]*(?P\u003chandle\u003e.*)\\n(?:billing-organization:[ ]*(?P\u003corganization\u003e.*)\\n)?billing-name:[ ]*(?P\u003cname\u003e.*)\\nbilling-street:[ ]*(?P\u003cstreet\u003e.*)\\nbilling-city:[ ]*(?P\u003ccity\u003e.*)\\nbilling-zip:[ ]*(?P\u003cpostalcode\u003e.*)\\nbilling-country:[ ]*(?P\u003ccountry\u003e.*)\\n(?:billing-phone:[ ]*(?P\u003cphone\u003e.*)\\n)?(?:billing-fax:[ ]*(?P\u003cfax\u003e.*)\\n)?billing-email:[ ]*(?P\u003cemail\u003e.*)\",\n    # InterNetworX\n    \"Billing Contact:\\n bill_org: (?P\u003corganization\u003e.*)\\n bill_name: (?P\u003cname\u003e.*)\\n bill_email: (?P\u003cemail\u003e.*)\\n bill_address: (?P\u003caddress\u003e.*)\\n bill_city: (?P\u003ccity\u003e.*)\\n bill_state: (?P\u003cstate\u003e.*)\\n bill_zip: (?P\u003cpostalcode\u003e.*)\\n bill_country: (?P\u003ccountry\u003e.*)\\n bill_phone: (?P\u003cphone\u003e.*)\",\n    # Bellnames\n    \"Billing Contact ID:(?P\u003chandle\u003e.*)\\nBilling Contact Name:(?P\u003cname\u003e.*)\\n(?:Billing Contact Organization:(?P\u003corganization\u003e.*)\\n)?Billing Contact Address1:(?P\u003cstreet1\u003e.*)\\n(?:Billing Contact Address2:(?P\u003cstreet2\u003e.*)\\n)?(?:Billing Contact Address3:(?P\u003cstreet3\u003e.*)\\n)?Billing Contact City:(?P\u003ccity\u003e.*)\\n(?:Billing Contact State/Province:(?P\u003cstate\u003e.*)\\n)?(?:Billing Contact Postal Code:(?P\u003cpostalcode\u003e.*)\\n)?Billing Contact Country:(?P\u003ccountry\u003e.*)\\nBilling Contact Country Code:.*\\nBilling Contact Phone Number:(?P\u003cphone\u003e.*)\\n(?:Billing Contact Facsimile Number:(?P\u003cfacsimile\u003e.*)\\n)?Billing Contact Email:(?P\u003cemail\u003e.*)\",\n    # .US, .biz (NeuStar), .buzz, .moe (Interlink Co. Ltd.)\n    \"Billing contact:\\n(?:  (?P\u003corganization\u003e.+)\\n)?  (?P\u003cname\u003e.+)\\n  (?P\u003cemail\u003e.+)\\n  (?P\u003cstreet\u003e.+)\\n  (?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+) (?P\u003cpostalcode\u003e.+) (?P\u003ccountry\u003e.+)\\n  Phone: (?P\u003cphone\u003e.*)\\n  Fax: (?P\u003cfax\u003e.*)\\n\",\n    # Fabulous.com\n    \"Billing Contact Information :[ ]*\\n[ ]+(?P\u003cfirstname\u003e.*)\\n[ ]+(?P\u003clastname\u003e.*)\\n[ ]+(?P\u003corganization\u003e.*)\\n[ ]+(?P\u003cemail\u003e.*)\\n[ ]+(?P\u003cstreet\u003e.*)\\n[ ]+(?P\u003ccity\u003e.*)\\n[ ]+(?P\u003cpostalcode\u003e.*)\\n[ ]+(?P\u003cphone\u003e.*)\\n[ ]+(?P\u003cfax\u003e.*)\\n\\n\",\n    # GAL Communication\n    \"Billing Contact:\\n   Name:           (?P\u003cname\u003e.+)\\n   City:           (?P\u003ccity\u003e.+)\\n   State:          (?P\u003cstate\u003e.+)\\n   Country:        (?P\u003ccountry\u003e.+)\\n\",\n    # Akky (.com.mx)\n    \"BILLING ID:(?P\u003chandle\u003e.+)\\nBILLING Name:(?P\u003cname\u003e.*)\\n(?:BILLING Organization:(?P\u003corganization\u003e.*)\\n)?BILLING Street1:(?P\u003cstreet1\u003e.+?)\\n(?:BILLING Street2:(?P\u003cstreet2\u003e.+?)\\n(?:BILLING Street3:(?P\u003cstreet3\u003e.+?)\\n)?)?BILLING City:(?P\u003ccity\u003e.+)\\nBILLING State:(?P\u003cstate\u003e.*)\\nBILLING Postal Code:(?P\u003cpostalcode\u003e.+)\\nBILLING Country:(?P\u003ccountry\u003e[A-Z]+)\\nBILLING Phone:(?P\u003cphone\u003e.*?)\\nBILLING Fax:(?P\u003cfax\u003e.*)\\nBILLING Email:(?P\u003cemail\u003e.+)\\n\",\n    # Realtime Register\n]\n\n# Some registries use NIC handle references instead of directly listing contacts...\nnic_contact_references = {\n    \"registrant\": [\n        \"registrant:\\s*(?P\u003chandle\u003e.+)\",  # nic.at\n        \"owner-contact:\\s*(?P\u003chandle\u003e.+)\",  # LCN.com\n        \"holder-c:\\s*(?P\u003chandle\u003e.+)\",  # AFNIC\n        \"holder:\\s*(?P\u003chandle\u003e.+)\",\n        # iis.se (they apparently want to be difficult, and won't give you contact info for the handle over their WHOIS service)\n    ],\n    \"tech\": [\n        \"tech-c:\\s*(?P\u003chandle\u003e.+)\",  # nic.at, AFNIC, iis.se\n        \"technical-contact:\\s*(?P\u003chandle\u003e.+)\",  # LCN.com\n        \"n\\. \\[Technical Contact\\]          (?P\u003chandle\u003e.+)\\n\",  # .co.jp\n    ],\n    \"admin\": [\n        \"admin-c:\\s*(?P\u003chandle\u003e.+)\",  # nic.at, AFNIC, iis.se\n        \"admin-contact:\\s*(?P\u003chandle\u003e.+)\",  # LCN.com\n        \"m\\. \\[Administrative Contact\\]     (?P\u003chandle\u003e.+)\\n\",  # .co.jp\n    ],\n    \"billing\": [\n        \"billing-c:\\s*(?P\u003chandle\u003e.+)\",  # iis.se\n        \"billing-contact:\\s*(?P\u003chandle\u003e.+)\",  # LCN.com\n    ]\n}\n\n# Why do the below? The below is meant to handle with an edge case (issue #2) where a partial match followed\n# by a failure, for a regex containing the \\s*.+ pattern, would send the regex module on a wild goose hunt for\n# matching positions. The workaround is to use \\S.* instead of .+, but in the interest of keeping the regexes\n# consistent and compact, it's more practical to do this (predictable) conversion on runtime.\n# FIXME: This breaks on NIC contact regex for nic.at. Why?\nregistrant_regexes = [preprocess_regex(regex) for regex in registrant_regexes]\ntech_contact_regexes = [preprocess_regex(regex) for regex in tech_contact_regexes]\nadmin_contact_regexes = [preprocess_regex(regex) for regex in admin_contact_regexes]\nbilling_contact_regexes = [preprocess_regex(regex) for regex in billing_contact_regexes]\n\nnic_contact_regexes = [\n    \"personname:\\s*(?P\u003cname\u003e.+)\\norganization:\\s*(?P\u003corganization\u003e.+)\\nstreet address:\\s*(?P\u003cstreet\u003e.+)\\npostal code:\\s*(?P\u003cpostalcode\u003e.+)\\ncity:\\s*(?P\u003ccity\u003e.+)\\ncountry:\\s*(?P\u003ccountry\u003e.+)\\n(?:phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:fax-no:\\s*(?P\u003cfax\u003e.+)\\n)?(?:e-mail:\\s*(?P\u003cemail\u003e.+)\\n)?nic-hdl:\\s*(?P\u003chandle\u003e.+)\\nchanged:\\s*(?P\u003cchangedate\u003e.+)\",\n    # nic.at\n    \"contact-handle:[ ]*(?P\u003chandle\u003e.+)\\ncontact:[ ]*(?P\u003cname\u003e.+)\\n(?:organisation:[ ]*(?P\u003corganization\u003e.+)\\n)?address:[ ]*(?P\u003cstreet1\u003e.+)\\n(?:address:[ ]*(?P\u003cstreet2\u003e.+)\\n)?(?:address:[ ]*(?P\u003cstreet3\u003e.+)\\n)?(?:address:[ ]*(?P\u003cstreet4\u003e.+)\\n)?address:[ ]*(?P\u003ccity\u003e.+)\\naddress:[ ]*(?P\u003cstate\u003e.+)\\naddress:[ ]*(?P\u003cpostalcode\u003e.+)\\naddress:[ ]*(?P\u003ccountry\u003e.+)\\n(?:phone:[ ]*(?P\u003cphone\u003e.+)\\n)?(?:fax:[ ]*(?P\u003cfax\u003e.+)\\n)?(?:email:[ ]*(?P\u003cemail\u003e.+)\\n)?\",\n    # LCN.com\n    \"Contact Information:\\na\\. \\[JPNIC Handle\\]               (?P\u003chandle\u003e.+)\\nc\\. \\[Last, First\\]                (?P\u003clastname\u003e.+), (?P\u003cfirstname\u003e.+)\\nd\\. \\[E-Mail\\]                     (?P\u003cemail\u003e.+)\\ng\\. \\[Organization\\]               (?P\u003corganization\u003e.+)\\nl\\. \\[Division\\]                   (?P\u003cdivision\u003e.+)\\nn\\. \\[Title\\]                      (?P\u003ctitle\u003e.+)\\no\\. \\[TEL\\]                        (?P\u003cphone\u003e.+)\\np\\. \\[FAX\\]                        (?P\u003cfax\u003e.+)\\ny\\. \\[Reply Mail\\]                 .*\\n\\[Last Update\\]                   (?P\u003cchangedate\u003e.+) \\(JST\\)\\n\",\n    # JPRS .co.jp contact handle lookup\n    \"person:\\s*(?P\u003cname\u003e.+)\\nnic-hdl:\\s*(?P\u003chandle\u003e.+)\\n\",  # .ie\n    \"nic-hdl:\\s+(?P\u003chandle\u003e.+)\\nperson:\\s+(?P\u003cname\u003e.+)\\n(?:e-mail:\\s+(?P\u003cemail\u003e.+)\\n)?(?:address:\\s+(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?, (?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+), (?P\u003ccountry\u003e.+)\\n)?(?:phone:\\s+(?P\u003cphone\u003e.+)\\n)?(?:fax-no:\\s+(?P\u003cfax\u003e.+)\\n)?\",\n    # nic.ir, individual  - this is a nasty one.\n    \"nic-hdl:\\s+(?P\u003chandle\u003e.+)\\norg:\\s+(?P\u003corganization\u003e.+)\\n(?:e-mail:\\s+(?P\u003cemail\u003e.+)\\n)?(?:address:\\s+(?P\u003cstreet1\u003e.+?)(?:,+ (?P\u003cstreet2\u003e.+?)(?:,+ (?P\u003cstreet3\u003e.+?)(?:,+ (?P\u003cstreet4\u003e.+?)(?:,+ (?P\u003cstreet5\u003e.+?)(?:,+ (?P\u003cstreet6\u003e.+?)(?:,+ (?P\u003cstreet7\u003e.+?))?)?)?)?)?)?, (?P\u003ccity\u003e.+), (?P\u003cstate\u003e.+), (?P\u003ccountry\u003e.+)\\n)?(?:phone:\\s+(?P\u003cphone\u003e.+)\\n)?(?:fax-no:\\s+(?P\u003cfax\u003e.+)\\n)?\",\n    # nic.ir, organization\n    \"nic-hdl:\\s*(?P\u003chandle\u003e.+)\\ntype:\\s*(?P\u003ctype\u003e.+)\\ncontact:\\s*(?P\u003cname\u003e.+)\\n(?:.+\\n)*?(?:address:\\s*(?P\u003cstreet1\u003e.+)\\naddress:\\s*(?P\u003cstreet2\u003e.+)\\naddress:\\s*(?P\u003cstreet3\u003e.+)\\naddress:\\s*(?P\u003ccountry\u003e.+)\\n)?(?:phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:fax-no:\\s*(?P\u003cfax\u003e.+)\\n)?(?:.+\\n)*?(?:e-mail:\\s*(?P\u003cemail\u003e.+)\\n)?(?:.+\\n)*?changed:\\s*(?P\u003cchangedate\u003e[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}).*\\n\",\n    # AFNIC madness without country field\n    \"nic-hdl:\\s*(?P\u003chandle\u003e.+)\\ntype:\\s*(?P\u003ctype\u003e.+)\\ncontact:\\s*(?P\u003cname\u003e.+)\\n(?:.+\\n)*?(?:address:\\s*(?P\u003cstreet1\u003e.+)\\n)?(?:address:\\s*(?P\u003cstreet2\u003e.+)\\n)?(?:address:\\s*(?P\u003cstreet3\u003e.+)\\n)?(?:phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:fax-no:\\s*(?P\u003cfax\u003e.+)\\n)?(?:.+\\n)*?(?:e-mail:\\s*(?P\u003cemail\u003e.+)\\n)?(?:.+\\n)*?changed:\\s*(?P\u003cchangedate\u003e[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}).*\\n\",\n    # AFNIC madness any country -at all-\n    \"nic-hdl:\\s*(?P\u003chandle\u003e.+)\\ntype:\\s*(?P\u003ctype\u003e.+)\\ncontact:\\s*(?P\u003cname\u003e.+)\\n(?:.+\\n)*?(?:address:\\s*(?P\u003cstreet1\u003e.+)\\n)?(?:address:\\s*(?P\u003cstreet2\u003e.+)\\n)?(?:address:\\s*(?P\u003cstreet3\u003e.+)\\n)?(?:address:\\s*(?P\u003cstreet4\u003e.+)\\n)?country:\\s*(?P\u003ccountry\u003e.+)\\n(?:phone:\\s*(?P\u003cphone\u003e.+)\\n)?(?:fax-no:\\s*(?P\u003cfax\u003e.+)\\n)?(?:.+\\n)*?(?:e-mail:\\s*(?P\u003cemail\u003e.+)\\n)?(?:.+\\n)*?changed:\\s*(?P\u003cchangedate\u003e[0-9]{2}\\/[0-9]{2}\\/[0-9]{4}).*\\n\",\n    # AFNIC madness with country field\n]\n\norganization_regexes = (\n    r\"\\sltd\\.?($|\\s)\",\n    r\"\\sco\\.?($|\\s)\",\n    r\"\\scorp\\.?($|\\s)\",\n    r\"\\sinc\\.?($|\\s)\",\n    r\"\\ss\\.?p\\.?a\\.?($|\\s)\",\n    r\"\\ss\\.?(c\\.?)?r\\.?l\\.?($|\\s)\",\n    r\"\\ss\\.?a\\.?s\\.?($|\\s)\",\n    r\"\\sa\\.?g\\.?($|\\s)\",\n    r\"\\sn\\.?v\\.?($|\\s)\",\n    r\"\\sb\\.?v\\.?($|\\s)\",\n    r\"\\sp\\.?t\\.?y\\.?($|\\s)\",\n    r\"\\sp\\.?l\\.?c\\.?($|\\s)\",\n    r\"\\sv\\.?o\\.?f\\.?($|\\s)\",\n    r\"\\sb\\.?v\\.?b\\.?a\\.?($|\\s)\",\n    r\"\\sg\\.?m\\.?b\\.?h\\.?($|\\s)\",\n    r\"\\ss\\.?a\\.?r\\.?l\\.?($|\\s)\",\n)\n\ngrammar[\"_data\"][\"id\"] = precompile_regexes(grammar[\"_data\"][\"id\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"status\"] = precompile_regexes(grammar[\"_data\"][\"status\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"creation_date\"] = precompile_regexes(grammar[\"_data\"][\"creation_date\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"expiration_date\"] = precompile_regexes(grammar[\"_data\"][\"expiration_date\"],  # type: ignore\n                                                         re.IGNORECASE)\ngrammar[\"_data\"][\"updated_date\"] = precompile_regexes(grammar[\"_data\"][\"updated_date\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"registrar\"] = precompile_regexes(grammar[\"_data\"][\"registrar\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"whois_server\"] = precompile_regexes(grammar[\"_data\"][\"whois_server\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"nameservers\"] = precompile_regexes(grammar[\"_data\"][\"nameservers\"], re.IGNORECASE)  # type: ignore\ngrammar[\"_data\"][\"emails\"] = precompile_regexes(grammar[\"_data\"][\"emails\"], re.IGNORECASE)  # type: ignore\n\ngrammar[\"_dateformats\"] = precompile_regexes(grammar[\"_dateformats\"], re.IGNORECASE)\n\nregistrant_regexes = precompile_regexes(registrant_regexes)\ntech_contact_regexes = precompile_regexes(tech_contact_regexes)\nbilling_contact_regexes = precompile_regexes(billing_contact_regexes)\nadmin_contact_regexes = precompile_regexes(admin_contact_regexes)\nnic_contact_regexes = precompile_regexes(nic_contact_regexes)\norganization_regexes = precompile_regexes(organization_regexes, re.IGNORECASE)\n\nnic_contact_references[\"registrant\"] = precompile_regexes(nic_contact_references[\"registrant\"])\nnic_contact_references[\"tech\"] = precompile_regexes(nic_contact_references[\"tech\"])\nnic_contact_references[\"admin\"] = precompile_regexes(nic_contact_references[\"admin\"])\nnic_contact_references[\"billing\"] = precompile_regexes(nic_contact_references[\"billing\"])\n\nif sys.version_info \u003c (3, 0):\n    def is_string(data):\n        \"\"\"Test for string with support for python 2.\"\"\"\n        return isinstance(data, basestring)\nelse:\n    def is_string(data):\n        \"\"\"Test for string with support for python 3.\"\"\"\n        return isinstance(data, str)\n\n\ndef parse_raw_whois(raw_data, normalized=None, never_query_handles=True, handle_server=\"\"):\n    normalized = normalized or []\n    data = {}  # type: dict\n\n    raw_data = [segment.replace(\"\\r\", \"\") for segment in raw_data]  # Carriage returns are the devil\n\n    for segment in raw_data:\n        for rule_key, rule_regexes in grammar['_data'].items():  # type: ignore\n            if (rule_key in data) == False:\n                for line in segment.splitlines():\n                    for regex in rule_regexes:\n                        result = re.search(regex, line)\n\n                        if result is not None:\n                            val = result.group(\"val\").strip()\n                            if val != \"\":\n                                try:\n                                    data[rule_key].append(val)\n                                except KeyError as e:\n                                    data[rule_key] = [val]\n\n        # Whois.com is a bit special... Fabulous.com also seems to use this format. As do some others.\n        match = re.search(\"^\\s?Name\\s?[Ss]ervers:?\\s*\\n((?:\\s*.+\\n)+?\\s?)\\n\", segment, re.MULTILINE)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"[ ]*(.+)\\n\", chunk):\n                if match.strip() != \"\":  # type: ignore\n                    if not re.match(\"^[a-zA-Z]+:\", match):  # type: ignore\n                        try:\n                            data[\"nameservers\"].append(match.strip())  # type: ignore\n                        except KeyError as e:\n                            data[\"nameservers\"] = [match.strip()]  # type: ignore\n        # Nominet also needs some special attention\n        match = re.search(\"    Registrar:\\n        (.+)\\n\", segment)\n        if match is not None:\n            data[\"registrar\"] = [match.group(1).strip()]\n        match = re.search(\"    Registration status:\\n        (.+)\\n\", segment)\n        if match is not None:\n            data[\"status\"] = [match.group(1).strip()]\n        match = re.search(\"    Name servers:\\n([\\s\\S]*?\\n)\\n\", segment)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"        (.+)\\n\", chunk):\n                match = match.split()[0]  # type: ignore\n                try:\n                    data[\"nameservers\"].append(match.strip())  # type: ignore\n                except KeyError as e:\n                    data[\"nameservers\"] = [match.strip()]  # type: ignore\n        # janet (.ac.uk) is kinda like Nominet, but also kinda not\n        match = re.search(\"Registered By:\\n\\t(.+)\\n\", segment)\n        if match is not None:\n            data[\"registrar\"] = [match.group(1).strip()]\n        match = re.search(\"Entry created:\\n\\t(.+)\\n\", segment)\n        if match is not None:\n            data[\"creation_date\"] = [match.group(1).strip()]\n        match = re.search(\"Renewal date:\\n\\t(.+)\\n\", segment)\n        if match is not None:\n            data[\"expiration_date\"] = [match.group(1).strip()]\n        match = re.search(\"Entry updated:\\n\\t(.+)\\n\", segment)\n        if match is not None:\n            data[\"updated_date\"] = [match.group(1).strip()]\n        match = re.search(\"Servers:([\\s\\S]*?\\n)\\n\", segment)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"\\t(.+)\\n\", chunk):\n                match = match.split()[0]  # type: ignore\n                try:\n                    data[\"nameservers\"].append(match.strip())  # type: ignore\n                except KeyError as e:\n                    data[\"nameservers\"] = [match.strip()]  # type: ignore\n        # .am plays the same game\n        match = re.search(\"   DNS servers:([\\s\\S]*?\\n)\\n\", segment)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"      (.+)\\n\", chunk):\n                match = match.split()[0]  # type: ignore\n                try:\n                    data[\"nameservers\"].append(match.strip())  # type: ignore\n                except KeyError as e:\n                    data[\"nameservers\"] = [match.strip()]  # type: ignore\n        # SIDN isn't very standard either. And EURid uses a similar format.\n        match = re.search(\"Registrar:\\n\\s+(?:Name:\\s*)?(\\S.*)\", segment)\n        if match is not None:\n            data[\"registrar\"].insert(0, match.group(1).strip())\n        match = re.search(\"(?:Domain nameservers|Name servers):([\\s\\S]*?\\n)\\n\", segment)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"\\s+?(.+)\\n\", chunk):\n                match = match.split()[0]  # type: ignore\n                # Prevent nameserver aliases from being picked up.\n                if not match.startswith(\"[\") and not match.endswith(\"]\"):  # type: ignore\n                    try:\n                        data[\"nameservers\"].append(match.strip())  # type: ignore\n                    except KeyError as e:\n                        data[\"nameservers\"] = [match.strip()]  # type: ignore\n        # The .ie WHOIS server puts ambiguous status information in an unhelpful order\n        match = re.search('ren-status:\\s*(.+)', segment)\n        if match is not None:\n            data[\"status\"].insert(0, match.group(1).strip())\n        # nic.it gives us the registrar in a multi-line format...\n        match = re.search('Registrar\\n  Organization:     (.+)\\n', segment)\n        if match is not None:\n            data[\"registrar\"] = [match.group(1).strip()]\n        # HKDNR (.hk) provides a weird nameserver format with too much whitespace\n        match = re.search(\"Name Servers Information:\\n\\n([\\s\\S]*?\\n)\\n\", segment)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"(.+)\\n\", chunk):\n                match = match.split()[0]  # type: ignore\n                try:\n                    data[\"nameservers\"].append(match.strip())  # type: ignore\n                except KeyError as e:\n                    data[\"nameservers\"] = [match.strip()]  # type: ignore\n        # ... and again for TWNIC.\n        match = re.search(\"   Domain servers in listed order:\\n([\\s\\S]*?\\n)\\n\", segment)\n        if match is not None:\n            chunk = match.group(1)\n            for match in re.findall(\"      (.+)\\n\", chunk):\n                match = match.split()[0]  # type: ignore\n                try:\n                    data[\"nameservers\"].append(match.strip())  # type: ignore\n                except KeyError as e:\n                    data[\"nameservers\"] = [match.strip()]  # type: ignore\n\n    data[\"contacts\"] = parse_registrants(raw_data, never_query_handles, handle_server)\n\n    # Parse dates\n    try:\n        data['expiration_date'] = remove_duplicates(data['expiration_date'])\n        data['expiration_date'] = parse_dates(data['expiration_date'])\n    except KeyError as e:\n        pass  # Not present\n\n    try:\n        data['creation_date'] = remove_duplicates(data['creation_date'])\n        data['creation_date'] = parse_dates(data['creation_date'])\n    except KeyError as e:\n        pass  # Not present\n\n    try:\n        data['updated_date'] = remove_duplicates(data['updated_date'])\n        data['updated_date'] = parse_dates(data['updated_date'])\n    except KeyError as e:\n        pass  # Not present\n\n    try:\n        data['nameservers'] = remove_suffixes(data['nameservers'])\n        data['nameservers'] = remove_duplicates([ns.rstrip(\".\") for ns in data['nameservers']])\n    except KeyError as e:\n        pass  # Not present\n\n    try:\n        data['emails'] = remove_duplicates(data['emails'])\n    except KeyError as e:\n        pass  # Not present\n\n    try:\n        data['registrar'] = remove_duplicates(data['registrar'])\n    except KeyError as e:\n        pass  # Not present\n\n    # Remove e-mail addresses if they are already listed for any of the contacts\n    known_emails = []\n    for contact in (\"registrant\", \"tech\", \"admin\", \"billing\"):\n        if data[\"contacts\"][contact] is not None:  # type: ignore\n            try:\n                known_emails.append(data[\"contacts\"][contact][\"email\"])  # type: ignore\n            except KeyError as e:\n                pass  # No e-mail recorded for this contact...\n    try:\n        data['emails'] = [email for email in data[\"emails\"] if email not in known_emails]\n    except KeyError as e:\n        pass  # Not present\n\n    for key in list(data.keys()):\n        if data[key] is None or len(data[key]) == 0:\n            del data[key]\n\n    data[\"raw\"] = raw_data\n\n    if normalized:\n        data = normalize_data(data, normalized)\n\n    return data\n\n\ndef normalize_data(data, normalized):\n    for key in (\"nameservers\", \"emails\", \"whois_server\"):\n        if key in data and data[key] is not None and (normalized == True or key in normalized):\n            if is_string(data[key]):\n                data[key] = data[key].lower()\n            else:\n                data[key] = [item.lower() for item in data[key]]\n\n    for key, threshold in ((\"registrar\", 4), (\"status\", 3)):\n        if key == \"registrar\":\n            ignore_nic = True\n        else:\n            ignore_nic = False\n        if key in data and data[key] is not None and (normalized == True or key in normalized):\n            if is_string(data[key]):\n                data[key] = normalize_name(data[key], abbreviation_threshold=threshold, length_threshold=1,\n                                           ignore_nic=ignore_nic)\n            else:\n                data[key] = [\n                    normalize_name(item, abbreviation_threshold=threshold, length_threshold=1, ignore_nic=ignore_nic)\n                    for item in data[key]]\n\n    for contact_type, contact in data['contacts'].items():\n        if contact is not None:\n            if 'country' in contact and contact['country'] in countries:\n                contact['country'] = countries[contact['country']]\n            if 'city' in contact and contact['city'] in airports:\n                contact['city'] = airports[contact['city']]\n            if 'country' in contact and 'state' in contact:\n                for country, source in ((\"united states\", states_us), (\"australia\", states_au), (\"canada\", states_ca)):\n                    if country in contact[\"country\"].lower() and contact[\"state\"] in source:\n                        contact[\"state\"] = source[contact[\"state\"]]\n\n            for key in (\"email\",):\n                if key in contact and contact[key] is not None and (normalized == True or key in normalized):\n                    if is_string(contact[key]):\n                        contact[key] = contact[key].lower()\n                    else:\n                        contact[key] = [item.lower() for item in contact[key]]\n\n            for key in (\"name\", \"street\"):\n                if key in contact and contact[key] is not None and (normalized == True or key in normalized):\n                    contact[key] = normalize_name(contact[key], abbreviation_threshold=3)\n\n            for key in (\"city\", \"organization\", \"state\", \"country\"):\n                if key in contact and contact[key] is not None and (normalized == True or key in normalized):\n                    contact[key] = normalize_name(contact[key], abbreviation_threshold=3, length_threshold=3)\n\n            if \"name\" in contact and \"organization\" not in contact:\n                lines = [x.strip() for x in contact[\"name\"].splitlines()]\n                new_lines = []\n                for i, line in enumerate(lines):\n                    for regex in organization_regexes:\n                        if re.search(regex, line):\n                            new_lines.append(line)\n                            del lines[i]\n                            break\n                if len(lines) \u003e 0:\n                    contact[\"name\"] = \"\\n\".join(lines)\n                else:\n                    del contact[\"name\"]\n\n                if len(new_lines) \u003e 0:\n                    contact[\"organization\"] = \"\\n\".join(new_lines)\n\n            if \"street\" in contact and \"organization\" not in contact:\n                lines = [x.strip() for x in contact[\"street\"].splitlines()]\n                if len(lines) \u003e 1:\n                    for regex in organization_regexes:\n                        if re.search(regex, lines[0]):\n                            contact[\"organization\"] = lines[0]\n                            contact[\"street\"] = \"\\n\".join(lines[1:])\n                            break\n\n            for key in list(contact.keys()):\n                try:\n                    contact[key] = contact[key].strip(\", \")\n                    if contact[key] == \"-\" or contact[key].lower() == \"n/a\":\n                        del contact[key]\n                except AttributeError as e:\n                    pass  # Not a string\n    return data\n\n\ndef normalize_name(value, abbreviation_threshold=4, length_threshold=8, lowercase_domains=True, ignore_nic=False):\n    normalized_lines = []\n    for line in value.split(\"\\n\"):\n        line = line.strip(\",\")  # Get rid of useless comma's\n        if (line.isupper() or line.islower()) and len(line) \u003e= length_threshold:\n            # This line is likely not capitalized properly\n            if ignore_nic == True and \"nic\" in line.lower():\n                # This is a registrar name containing 'NIC' - it should probably be all-uppercase.\n                line = line.upper()\n            else:\n                words = line.split()\n                normalized_words = []\n                if len(words) \u003e= 1:\n                    # First word\n                    if len(words[0]) \u003e= abbreviation_threshold and \".\" not in words[0]:\n                        normalized_words.append(words[0].capitalize())\n                    elif lowercase_domains and \".\" in words[0] and not words[0].endswith(\".\") and not words[\n                        0].startswith(\".\"):\n                        normalized_words.append(words[0].lower())\n                    else:\n                        # Probably an abbreviation or domain, leave it alone\n                        normalized_words.append(words[0])\n                if len(words) \u003e= 3:\n                    # Words between the first and last\n                    for word in words[1:-1]:\n                        if len(word) \u003e= abbreviation_threshold and \".\" not in word:\n                            normalized_words.append(word.capitalize())\n                        elif lowercase_domains and \".\" in word and not word.endswith(\".\") and not word.startswith(\".\"):\n                            normalized_words.append(word.lower())\n                        else:\n                            # Probably an abbreviation or domain, leave it alone\n                            normalized_words.append(word)\n                if len(words) \u003e= 2:\n                    # Last word\n                    if len(words[-1]) \u003e= abbreviation_threshold and \".\" not in words[-1]:\n                        normalized_words.append(words[-1].capitalize())\n                    elif lowercase_domains and \".\" in words[-1] and not words[-1].endswith(\".\") and not words[\n                        -1].startswith(\".\"):\n                        normalized_words.append(words[-1].lower())\n                    else:\n                        # Probably an abbreviation or domain, leave it alone\n                        normalized_words.append(words[-1])\n                line = \" \".join(normalized_words)\n        normalized_lines.append(line)\n    return \"\\n\".join(normalized_lines)\n\n\ndef parse_dates(dates):\n    global grammar\n    parsed_dates = []\n\n    for date in dates:\n        for rule in grammar['_dateformats']:  # type: ignore\n            result = re.match(rule, date)\n\n            if result is not None:\n                try:\n                    # These are always numeric. If they fail, there is no valid date present.\n                    year = int(result.group(\"year\"))\n                    day = int(result.group(\"day\"))\n\n                    # Detect and correct shorthand year notation\n                    if year \u003c 60:\n                        year += 2000\n                    elif year \u003c 100:\n                        year += 1900\n\n                    # This will require some more guesswork - some WHOIS servers present the name of the month\n                    try:\n                        month = int(result.group(\"month\"))\n                    except ValueError as e:\n                        # Apparently not a number. Look up the corresponding number.\n                        try:\n                            month = grammar['_months'][result.group(\"month\").lower()]  # type: ignore\n                        except KeyError as e:\n                            # Unknown month name, default to 0\n                            month = 0\n\n                    try:\n                        hour = int(result.group(\"hour\"))\n                    except IndexError as e:\n                        hour = 0\n                    except TypeError as e:\n                        hour = 0\n\n                    try:\n                        minute = int(result.group(\"minute\"))\n                    except IndexError as e:\n                        minute = 0\n                    except TypeError as e:\n                        minute = 0\n\n                    try:\n                        second = int(result.group(\"second\"))\n                    except IndexError as e:\n                        second = 0\n                    except TypeError as e:\n                        second = 0\n\n                    break\n                except ValueError as e:\n                    # Something went horribly wrong, maybe there is no valid date present?\n                    year = 0\n                    month = 0\n                    day = 0\n                    hour = 0\n                    minute = 0\n                    second = 0\n                    demisto.debug(e.message)\n        try:\n            if year \u003e 0:\n                try:\n                    parsed_dates.append(datetime(year, month, day, hour, minute, second))\n                except ValueError as e:\n                    # We might have gotten the day and month the wrong way around, let's try it the other way around\n                    # If you're not using an ISO-standard date format, you're an evil registrar!\n                    parsed_dates.append(datetime(year, day, month, hour, minute, second))\n        except UnboundLocalError as e:\n            pass\n\n    if len(parsed_dates) \u003e 0:\n        return parsed_dates\n    else:\n        return None\n\n\ndef remove_duplicates(data):\n    cleaned_list = []  # type: ignore\n\n    for entry in data:\n        if entry not in cleaned_list:\n            cleaned_list.append(entry)\n\n    return cleaned_list\n\n\ndef remove_suffixes(data):\n    # Removes everything before and after the first non-whitespace continuous string.\n    # Used to get rid of IP suffixes for nameservers.\n    cleaned_list = []\n\n    for entry in data:\n        cleaned_list.append(re.search(\"([^\\s]+)\\s*[\\s]*\", entry).group(1).lstrip())  # type: ignore\n\n    return cleaned_list\n\n\ndef parse_registrants(data, never_query_handles=True, handle_server=\"\"):\n    registrant = None\n    tech_contact = None\n    billing_contact = None\n    admin_contact = None\n\n    for segment in data:\n        for regex in registrant_regexes:\n            match = re.search(regex, segment)\n            if match is not None:\n                registrant = match.groupdict()\n                break\n\n    for segment in data:\n        for regex in tech_contact_regexes:\n            match = re.search(regex, segment)\n            if match is not None:\n                tech_contact = match.groupdict()\n                break\n\n    for segment in data:\n        for regex in admin_contact_regexes:\n            match = re.search(regex, segment)\n            if match is not None:\n                admin_contact = match.groupdict()\n                break\n\n    for segment in data:\n        for regex in billing_contact_regexes:\n            match = re.search(regex, segment)\n            if match is not None:\n                billing_contact = match.groupdict()\n                break\n\n    # Find NIC handle contact definitions\n    handle_contacts = parse_nic_contact(data)\n\n    # Find NIC handle references and process them\n    missing_handle_contacts = []  # type: list\n    for category in nic_contact_references:\n        for regex in nic_contact_references[category]:\n            for segment in data:\n                match = re.search(regex, segment)\n                if match is not None:\n                    data_reference = match.groupdict()\n                    if data_reference[\"handle\"] == \"-\" or re.match(\"https?:\\/\\/\", data_reference[\"handle\"]) is not None:\n                        pass  # Reference was either blank or a URL; the latter is to deal with false positives for nic.ru\n                    else:\n                        found = False\n                        for contact in handle_contacts:\n                            if contact[\"handle\"] == data_reference[\"handle\"]:\n                                found = True\n                                data_reference.update(contact)\n                        if not found:\n                            # The contact definition was not found in the supplied raw WHOIS data. If the\n                            # method has been called with never_query_handles=False, we can use the supplied\n                            # WHOIS server for looking up the handle information separately.\n                            if not never_query_handles:\n                                try:\n                                    contact = fetch_nic_contact(data_reference[\"handle\"], handle_server)\n                                    data_reference.update(contact)\n                                except WhoisException as e:\n                                    pass  # No data found. TODO: Log error?\n                            else:\n                                pass  # TODO: Log warning?\n                        if category == \"registrant\":\n                            registrant = data_reference\n                        elif category == \"tech\":\n                            tech_contact = data_reference\n                        elif category == \"billing\":\n                            billing_contact = data_reference\n                        elif category == \"admin\":\n                            admin_contact = data_reference\n                    break\n\n    # Post-processing\n    for obj in (registrant, tech_contact, billing_contact, admin_contact):\n        if obj is not None:\n            for key in list(obj.keys()):\n                if obj[key] is None or obj[key].strip() == \"\":  # Just chomp all surrounding whitespace\n                    del obj[key]\n                else:\n                    obj[key] = obj[key].strip()\n            if \"phone_ext\" in obj:\n                if \"phone\" in obj:\n                    obj[\"phone\"] += \" ext. %s\" % obj[\"phone_ext\"]\n                    del obj[\"phone_ext\"]\n            if \"street1\" in obj:\n                street_items = []\n                i = 1\n                while True:\n                    try:\n                        street_items.append(obj[\"street%d\" % i])\n                        del obj[\"street%d\" % i]\n                    except KeyError as e:\n                        break\n                    i += 1\n                obj[\"street\"] = \"\\n\".join(street_items)\n            if \"organization1\" in obj:  # This is to deal with eg. HKDNR, who allow organization names in multiple languages.\n                organization_items = []\n                i = 1\n                while True:\n                    try:\n                        if obj[\"organization%d\" % i].strip() != \"\":\n                            organization_items.append(obj[\"organization%d\" % i])\n                            del obj[\"organization%d\" % i]\n                    except KeyError as e:\n                        break\n                    i += 1\n                obj[\"organization\"] = \"\\n\".join(organization_items)\n            if 'changedate' in obj:\n                obj['changedate'] = parse_dates([obj['changedate']])[0].strftime('%d-%m-%Y')\n            if 'creationdate' in obj:\n                obj['creationdate'] = parse_dates([obj['creationdate']])[0].strftime('%d-%m-%Y')\n            if 'street' in obj and \"\\n\" in obj[\"street\"] and 'postalcode' not in obj:\n                # Deal with certain mad WHOIS servers that don't properly delimit address data... (yes, AFNIC, looking at you)\n                lines = [x.strip() for x in obj[\"street\"].splitlines()]\n                if \" \" in lines[-1]:\n                    postal_code, city = lines[-1].split(\" \", 1)\n                    if \".\" not in lines[-1] and re.match(\"[0-9]\", postal_code) and len(postal_code) \u003e= 3:\n                        obj[\"postalcode\"] = postal_code\n                        obj[\"city\"] = city\n                        obj[\"street\"] = \"\\n\".join(lines[:-1])\n            if 'firstname' in obj or 'lastname' in obj:\n                elements = []\n                if 'firstname' in obj:\n                    elements.append(obj[\"firstname\"])\n                if 'lastname' in obj:\n                    elements.append(obj[\"lastname\"])\n                obj[\"name\"] = \" \".join(elements)\n            if 'country' in obj and 'city' in obj and (re.match(\"^R\\.?O\\.?C\\.?$\", obj[\"country\"], re.IGNORECASE) or obj[\n                \"country\"].lower() == \"republic of china\") and obj[\"city\"].lower() == \"taiwan\":\n                # There's an edge case where some registrants append \", Republic of China\" after \"Taiwan\", and this is mis-parsed\n                # as Taiwan being the city. This is meant to correct that.\n                obj[\"country\"] = \"%s, %s\" % (obj[\"city\"], obj[\"country\"])\n                lines = [x.strip() for x in obj[\"street\"].splitlines()]\n                obj[\"city\"] = lines[-1]\n                obj[\"street\"] = \"\\n\".join(lines[:-1])\n\n    return {\n        \"registrant\": registrant,\n        \"tech\": tech_contact,\n        \"admin\": admin_contact,\n        \"billing\": billing_contact,\n    }\n\n\ndef fetch_nic_contact(handle, lookup_server):\n    response = get_whois_raw(handle, lookup_server)\n    response = [segment.replace(\"\\r\", \"\") for segment in response]\n    results = parse_nic_contact(response)\n\n    if len(results) \u003e 0:\n        return results[0]\n    else:\n        raise WhoisException(\"No contact data found in the response.\")\n\n\ndef parse_nic_contact(data):\n    handle_contacts = []\n    for regex in nic_contact_regexes:\n        for segment in data:\n            matches = re.finditer(regex, segment)\n            for match in matches:\n                handle_contacts.append(match.groupdict())\n\n    return handle_contacts\n\n\ndef get_whois(domain, normalized=None):\n    if normalized is None:\n        normalized = []\n    raw_data, server_list = get_whois_raw(domain, with_server_list=True)\n    return parse_raw_whois(raw_data, normalized=normalized, never_query_handles=False,\n                           handle_server=server_list[-1])\n\n\n# Drops the mic disable-secrets-detection-end\n\ndef get_domain_from_query(query):\n    # checks for largest matching suffix inside tlds dictionary\n    suffix_len = max([len(suffix) for suffix in tlds if query.endswith('.{}'.format(suffix))] or [0])\n    # if suffix(TLD) was found increase the length by one in order to add the dot before it. --\u003e .com instead of com\n    if suffix_len != 0:\n        suffix_len += 1\n    suffixless_query = query[:-suffix_len]\n    domain = query\n    # checks if query includes subdomain\n    if suffixless_query.count(\".\") \u003e 0:\n        domain = query[suffixless_query.rindex(\".\") + 1:]\n    return domain\n\n\ndef is_good_query_result(raw_result):\n    \"\"\" Good result is one where the raw_result does not contains `NOT FOUND` or `No match` \"\"\"\n    return 'NOT FOUND' not in raw_result and 'No match' not in raw_result\n\n\ndef create_outputs(whois_result, domain, reliability, query=None):\n    md = {'Name': domain}\n    ec = {'Name': domain,\n          'QueryResult': is_good_query_result(str(whois_result.get('raw', 'NOT FOUND')))}\n    standard_ec = {}  # type:dict\n    standard_ec['WHOIS'] = {}\n    if 'status' in whois_result:\n        ec['DomainStatus'] = whois_result.get('status')\n        standard_ec['DomainStatus'] = whois_result.get('status')\n        standard_ec['WHOIS']['DomainStatus'] = whois_result.get('status')\n        md['Domain Status'] = whois_result.get('status')\n    if 'raw' in whois_result:\n        ec['Raw'] = whois_result.get('raw')\n    if 'nameservers' in whois_result:\n        ec['NameServers'] = whois_result.get('nameservers')\n        standard_ec['NameServers'] = whois_result.get('nameservers')\n        standard_ec['WHOIS']['NameServers'] = whois_result.get('nameservers')\n        md['NameServers'] = whois_result.get('nameservers')\n    try:\n        if 'creation_date' in whois_result:\n            ec['CreationDate'] = whois_result.get('creation_date')[0].strftime('%d-%m-%Y')\n            standard_ec['CreationDate'] = whois_result.get('creation_date')[0].strftime('%d-%m-%Y')\n            standard_ec['WHOIS']['CreationDate'] = whois_result.get('creation_date')[0].strftime(\n                '%d-%m-%Y')\n            md['Creation Date'] = whois_result.get('creation_date')[0].strftime('%d-%m-%Y')\n        if 'updated_date' in whois_result:\n            ec['UpdatedDate'] = whois_result.get('updated_date')[0].strftime('%d-%m-%Y')\n            standard_ec['UpdatedDate'] = whois_result.get('updated_date')[0].strftime('%d-%m-%Y')\n            standard_ec['WHOIS']['UpdatedDate'] = whois_result.get('updated_date')[0].strftime(\n                '%d-%m-%Y')\n            md['Updated Date'] = whois_result.get('updated_date')[0].strftime('%d-%m-%Y')\n        if 'expiration_date' in whois_result:\n            ec['ExpirationDate'] = whois_result.get('expiration_date')[0].strftime('%d-%m-%Y')\n            standard_ec['ExpirationDate'] = whois_result.get('expiration_date')[0].strftime(\n                '%d-%m-%Y')\n            standard_ec['WHOIS']['ExpirationDate'] = whois_result.get('expiration_date')[\n                0].strftime(\n                '%d-%m-%Y')\n            md['Expiration Date'] = whois_result.get('expiration_date')[0].strftime('%d-%m-%Y')\n    except ValueError as e:\n        return_error('Date could not be parsed. Please check the date again.\\n{}'.format(e))\n    if 'registrar' in whois_result:\n        ec.update({'Registrar': {'Name': whois_result.get('registrar')}})\n        standard_ec['WHOIS']['Registrar'] = whois_result.get('registrar')\n        md['Registrar'] = whois_result.get('registrar')\n        standard_ec['Registrar'] = {'Name': whois_result.get('registrar')}\n    if 'id' in whois_result:\n        ec['ID'] = whois_result.get('id')\n        md['ID'] = whois_result.get('id')\n    if 'contacts' in whois_result:\n        contacts = whois_result['contacts']\n        if 'registrant' in contacts and contacts['registrant'] is not None:\n            md['Registrant'] = contacts['registrant']\n            standard_ec['Registrant'] = contacts['registrant'].copy()\n            for key, val in contacts['registrant'].items():\n                standard_ec['Registrant'][key.capitalize()] = val\n            ec['Registrant'] = contacts['registrant']\n            if 'organization' in contacts['registrant']:\n                standard_ec['Organization'] = contacts['registrant']['organization']\n        if 'admin' in contacts and contacts['admin'] is not None:\n            md['Administrator'] = contacts['admin']\n            ec['Administrator'] = contacts['admin']\n            standard_ec['Admin'] = contacts['admin'].copy()\n            for key, val in contacts['admin'].items():\n                standard_ec['Admin'][key.capitalize()] = val\n            standard_ec['WHOIS']['Admin'] = contacts['admin']\n        if 'tech' in contacts and contacts['tech'] is not None:\n            md['Tech Admin'] = contacts['tech']\n            ec['TechAdmin'] = contacts['tech']\n            standard_ec['Tech'] = {}\n            if 'country' in contacts['tech']:\n                standard_ec['Tech']['Country'] = contacts['tech']['country']\n            if 'email' in contacts['tech']:\n                standard_ec['Tech']['Email'] = contacts['tech']['email']\n            if 'organization' in contacts['tech']:\n                standard_ec['Tech']['Organization'] = contacts['tech']['organization']\n        if 'billing' in contacts and contacts['billing'] is not None:\n            md['Billing Admin'] = contacts['billing']\n            ec['BillingAdmin'] = contacts['billing']\n            standard_ec['Billing'] = contacts['billing']\n    if 'emails' in whois_result:\n        ec['Emails'] = whois_result.get('emails')\n        md['Emails'] = whois_result.get('emails')\n        standard_ec['FeedRelatedIndicators'] = [{'type': 'Email', 'value': email}\n                                                for email in whois_result.get('emails')]\n    ec['QueryStatus'] = 'Success'\n    md['QueryStatus'] = 'Success'\n\n    standard_ec['Name'] = domain\n    standard_ec['Whois'] = ec\n    standard_ec['Whois']['QueryValue'] = query\n\n    dbot_score = Common.DBotScore(indicator=domain, indicator_type='domain', integration_name='Whois', score=0,\n                                  reliability=reliability)\n\n    return md, standard_ec, dbot_score.to_context()\n\n\n'''COMMANDS'''\n\n\ndef domain_command(reliability):\n    domains = demisto.args().get('domain', [])\n    for domain in argToList(domains):\n        whois_result = get_whois(domain)\n        md, standard_ec, dbot_score = create_outputs(whois_result, domain, reliability)\n        dbot_score.update({Common.Domain.CONTEXT_PATH: standard_ec})\n        demisto.results({\n            'Type': entryTypes['note'],\n            'ContentsFormat': formats['markdown'],\n            'Contents': str(whois_result),\n            'HumanReadable': tableToMarkdown('Whois results for {}'.format(domain), md),\n            'EntryContext': dbot_score,\n        })\n\n\ndef get_whois_ip(ip):\n    from urllib2 import build_opener, ProxyHandler\n    from ipwhois import IPWhois\n    proxy_opener = None\n    if demisto.params().get('proxy'):\n        proxies = assign_params(http=handle_proxy().get('http'), https=handle_proxy().get('https'))\n        handler = ProxyHandler(proxies)\n        proxy_opener = build_opener(handler)\n        ip_obj = IPWhois(ip, proxy_opener=proxy_opener)\n    else:\n        ip_obj = IPWhois(ip)\n\n    return ip_obj.lookup_rdap(depth=1)\n\n\ndef ip_command(ips, reliability):\n    results = []\n    for ip in argToList(ips):\n        response = get_whois_ip(ip)\n\n        dbot_score = Common.DBotScore(\n            indicator=ip,\n            indicator_type=DBotScoreType.IP,\n            integration_name='Whois',\n            score=Common.DBotScore.NONE,\n            reliability=reliability\n        )\n        related_feed = Common.FeedRelatedIndicators(\n            value=response.get('network', {}).get('cidr'),\n            indicator_type='CIDR'\n        )\n        ip_output = Common.IP(\n            ip=ip,\n            asn=response.get('asn'),\n            geo_country=response.get('asn_country_code'),\n            organization_name=response.get('asn_description'),\n            dbot_score=dbot_score,\n            feed_related_indicators=[related_feed]\n        )\n        result = CommandResults(\n            outputs_prefix='Whois.IP',\n            outputs_key_field='query',\n            outputs=response,\n            readable_output=tableToMarkdown('Whois results:', response,\n                                            ['query', 'asn', 'asn_cidr', 'asn_country_code', 'asn_date',\n                                             'asn_description']),\n            raw_response=response,\n            indicator=ip_output\n        )\n\n        results.append(result)\n    return results\n\n\ndef whois_command(reliability):\n    query = demisto.args().get('query')\n    domain = get_domain_from_query(query)\n    whois_result = get_whois(domain)\n    md, standard_ec, dbot_score = create_outputs(whois_result, domain, reliability, query)\n    dbot_score.update({Common.Domain.CONTEXT_PATH: standard_ec})\n    demisto.results({\n        'Type': entryTypes['note'],\n        'ContentsFormat': formats['markdown'],\n        'Contents': str(whois_result),\n        'HumanReadable': tableToMarkdown('Whois results for {}'.format(domain), md),\n        'EntryContext': dbot_score,\n    })\n\n\ndef test_command():\n    whois_result = get_whois('google.co.uk')\n\n    try:\n        domain_test = whois_result['nameservers'][0]\n    except ValueError as e:\n        return_error('Whois did not return the correct result: {}'.format(str(e)))\n\n    if domain_test == 'ns1.google.com':\n        demisto.results('ok')\n\n\ndef setup_proxy():\n    scheme_to_proxy_type = {\n        'socks5': [socks.PROXY_TYPE_SOCKS5, False],\n        'socks5h': [socks.PROXY_TYPE_SOCKS5, True],\n        'socks4': [socks.PROXY_TYPE_SOCKS4, False],\n        'socks4a': [socks.PROXY_TYPE_SOCKS4, True],\n        'http': [socks.PROXY_TYPE_HTTP, True]\n    }\n    proxy_url = demisto.params().get('proxy_url')\n    def_scheme = 'socks5h'\n    if proxy_url == 'system_http' or not proxy_url and demisto.params().get('proxy'):\n        system_proxy = handle_proxy('proxy')\n        # use system proxy. Prefer https and fallback to http\n        proxy_url = system_proxy.get('https') if system_proxy.get('https') else system_proxy.get('http')\n        def_scheme = 'http'\n    if not proxy_url and not demisto.params().get('proxy'):\n        return\n    scheme, host = (def_scheme, proxy_url) if '://' not in proxy_url else proxy_url.split('://')\n    host, port = (host, None) if ':' not in host else host.split(':')\n    if port:\n        port = int(port)\n    proxy_type = scheme_to_proxy_type.get(scheme)\n    if not proxy_type:\n        raise ValueError(\"Un supported proxy scheme: {}\".format(scheme))\n    socks.set_default_proxy(proxy_type[0], host, port, proxy_type[1])\n    socket.socket = socks.socksocket  # type: ignore\n\n''' EXECUTION CODE '''\n\n\ndef main():\n    LOG('command is {}'.format(str(demisto.command())))\n    command = demisto.command()\n\n    reliability = demisto.params().get('integrationReliability')\n    reliability = reliability if reliability else DBotScoreReliability.B\n\n    if DBotScoreReliability.is_valid_type(reliability):\n        reliability = DBotScoreReliability.get_dbot_score_reliability_from_str(reliability)\n    else:\n        raise Exception(\"Please provide a valid value for the Source Reliability parameter.\")\n\n    try:\n        if command == 'ip':\n            return_results(ip_command(demisto.args().get('ip'), reliability))\n        else:\n            org_socket = socket.socket\n            setup_proxy()\n            if command == 'test-module':\n                test_command()\n            elif command == 'whois':\n                whois_command(reliability)\n            elif command == 'domain':\n                domain_command(reliability)\n    except Exception as e:\n        LOG(e)\n        return_error(str(e))\n    finally:\n        if command != 'ip':\n            socks.set_default_proxy()  # clear proxy settings\n            socket.socket = org_socket  # type: ignore\n\n\n# python2 uses __builtin__ python3 uses builtins\nif __name__ == \"__builtin__\" or __name__ == \"builtins\":\n    main()\n","subtype":"python2","type":"python"},"itemVersion":"1.2.5","modified":"2021-08-28T19:58:23.344711+03:00","name":"Whois","packID":"Whois","packPropagationLabels":["all"],"prevName":"Whois","propagationLabels":[],"shouldCommit":false,"sortValues":null,"system":true,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":3}],"engines":{"engineGroups":null,"engines":[],"pkgTypes":["shell","zip","deb","rpm","conf"],"requestedLogs":{},"total":0},"health":{},"instances":[{"brand":"activedir-login","canSample":false,"category":"Authentication","cmdline":"","commandsPermissions":null,"configtypes":{"Credentials":9,"LDAPBaseDN":0,"LDAPImageAttr":0,"LDAPIsAuthentication":0,"LDAPPageSize":0,"LDAPSInsecure":8,"LDAPSecurity":0,"LDAPServer":0,"LDAPServerPort":0},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"Credentials":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"demisto\\demistoadmin","passwordChanged":false},"LDAPBaseDN":"DC=demisto,DC=ninja","LDAPImageAttr":"thumbnailPhoto","LDAPIsAuthentication":true,"LDAPPageSize":"500","LDAPSInsecure":true,"LDAPSecurity":"ssl","LDAPServer":"18.217.153.77","LDAPServerPort":"636"},"data":[{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9,"value":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"demisto\\demistoadmin","passwordChanged":false}},{"defaultValue":"","display":"Base DN (e.g. DC=domain,DC=com)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPBaseDN","options":null,"required":true,"type":0,"value":"DC=demisto,DC=ninja"},{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPImageAttr","options":null,"required":false,"type":0,"value":"thumbnailPhoto"},{"defaultValue":"none","display":"Security Type (none/ssl/tls)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSecurity","options":null,"required":true,"type":0,"value":"ssl"},{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPIsAuthentication","options":null,"required":false,"type":0,"value":true},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSInsecure","options":null,"required":false,"type":8,"value":true},{"defaultValue":"389","display":"Port","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServerPort","options":null,"required":false,"type":0,"value":"636"},{"defaultValue":"","display":"Server IP (e.g. 192.168.0.1)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServer","options":null,"required":true,"type":0,"value":"18.217.153.77"},{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPPageSize","options":null,"required":false,"type":0,"value":"500"}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"ad-login","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":false,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-08T08:30:29.282584+03:00","name":"ad-login","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":19},{"brand":"activedir","canSample":false,"category":"Authentication","cmdline":"","commandsPermissions":null,"configtypes":{"Credentials":9,"LDAPBaseDN":0,"LDAPImageAttr":0,"LDAPIsAuthentication":0,"LDAPPageSize":0,"LDAPSInsecure":8,"LDAPSecurity":0,"LDAPServer":0,"LDAPServerPort":0},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"Credentials":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"demisto\\demistoadmin","passwordChanged":false},"LDAPBaseDN":"DC=demisto,DC=ninja","LDAPImageAttr":"thumbnailPhoto","LDAPIsAuthentication":false,"LDAPPageSize":"500","LDAPSInsecure":true,"LDAPSecurity":"ssl","LDAPServer":"18.217.153.77","LDAPServerPort":"636"},"data":[{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Credentials","options":null,"required":true,"type":9,"value":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"demisto\\demistoadmin","passwordChanged":false}},{"defaultValue":"none","display":"Security Type (none/ssl/tls)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSecurity","options":null,"required":true,"type":0,"value":"ssl"},{"defaultValue":"","display":"Server IP (e.g. 192.168.0.1)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServer","options":null,"required":true,"type":0,"value":"18.217.153.77"},{"defaultValue":"500","display":"Page Size","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPPageSize","options":null,"required":false,"type":0,"value":"500"},{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPIsAuthentication","options":null,"required":false,"type":0,"value":false},{"defaultValue":"","display":"Do not validate server certificate (insecure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPSInsecure","options":null,"required":false,"type":8,"value":true},{"defaultValue":"","display":"Base DN (e.g. DC=domain,DC=com)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPBaseDN","options":null,"required":true,"type":0,"value":"DC=demisto,DC=ninja"},{"defaultValue":"","display":"","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPImageAttr","options":null,"required":false,"type":0,"value":"thumbnailPhoto"},{"defaultValue":"389","display":"Port","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"LDAPServerPort","options":null,"required":false,"type":0,"value":"636"}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"ad-query","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":false,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-08T08:30:29.190476+03:00","name":"ad-query","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":19},{"brand":"d2","canSample":false,"category":"Endpoint","cmdline":"","commandsPermissions":null,"configtypes":null,"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":null,"data":null,"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"0359a7fb-8fd3-4be5-8d1f-6d1cf7cdab5e","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":false,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-08-24T18:47:15.414932+03:00","name":"d2","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":null,"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":1},{"brand":"epo","canSample":false,"category":"Endpoint","cmdline":"","commandsPermissions":null,"configtypes":{"address":0,"authentication":9,"insecure":8,"proxy":8},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"address":"https://34.250.181.13:8443","authentication":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"admin","passwordChanged":false},"insecure":true,"proxy":false},"data":[{"defaultValue":"","display":"https://\u003caddress\u003e:port","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0,"value":"https://34.250.181.13:8443"},{"defaultValue":"","display":"Username","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"authentication","options":null,"required":true,"type":9,"value":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"admin","passwordChanged":false}},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8,"value":true},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8,"value":false}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"4acf02d7-84d0-46bf-86d1-c9b19910748d","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"Verbose","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-07T11:45:10.083635+03:00","name":"epo_instance_1","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":8},{"brand":"epo V2","canSample":true,"category":"Endpoint","cmdline":"","commandsPermissions":null,"configtypes":{"address":0,"authentication":9,"incidentFetchInterval":19,"incidentType":13,"insecure":8,"isFetch":8,"proxy":8},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"address":"https://34.250.181.13:8443","authentication":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"admin","passwordChanged":false},"incidentFetchInterval":"1","incidentType":null,"insecure":true,"isFetch":false,"proxy":false},"data":[{"defaultValue":"","display":"Username","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"authentication","options":null,"required":true,"type":9,"value":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","sortValues":null,"user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"admin","passwordChanged":false}},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8,"value":true},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8,"value":false},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8,"value":false},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19,"value":"1"},{"defaultValue":"","display":"Incident type","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13,"value":null},{"defaultValue":"","display":"https://\u003caddress\u003e:port","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"address","options":null,"required":true,"type":0,"value":"https://34.250.181.13:8443"}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"9b132966-5855-45ce-8918-6324f14cb521","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"Verbose","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-07T11:20:36.265745+03:00","name":"epo_V2_instance_1","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":147},{"brand":"fcm","canSample":false,"category":"","cmdline":"","commandsPermissions":null,"configtypes":{"useproxy":8},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"useproxy":true},"data":[{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8,"value":true}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"f728546e-2e2c-4e39-8c6a-7a322dfab239","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":false,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-08-24T18:47:17.264905+03:00","name":"fcm_default_instance","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":1},{"brand":"GitHub","canSample":true,"category":"Utilities","cmdline":"","commandsPermissions":null,"configtypes":{"credentials":9,"fetch_object":15,"fetch_time":0,"incidentFetchInterval":19,"incidentType":13,"insecure":8,"installation_id":0,"integration_id":0,"isFetch":8,"proxy":8,"repository":0,"token":4,"url":0,"user":0},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"credentials":null,"fetch_object":"Issue","fetch_time":"","incidentFetchInterval":"1","incidentType":null,"insecure":true,"installation_id":null,"integration_id":null,"isFetch":false,"proxy":false,"repository":"etc","url":"https://api.github.com","user":"demisto"},"data":[{"defaultValue":"","display":"Incident type","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentType","options":null,"required":false,"type":13,"value":null},{"defaultValue":"","display":"GitHub app installation ID","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"installation_id","options":null,"required":false,"type":0,"value":null},{"defaultValue":"https://api.github.com","display":"Server URL","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":false,"type":0,"value":"https://api.github.com"},{"defaultValue":"","display":"GitHub app integration ID","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"integration_id","options":null,"required":false,"type":0,"value":null},{"defaultValue":"","display":"API Token","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"token","options":null,"required":false,"type":4,"value":""},{"defaultValue":"","display":"Username of the repository owner, for example: github.com/repos/{_owner_}/{repo}/issues","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"user","options":null,"required":false,"type":0,"value":"demisto"},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8,"value":false},{"defaultValue":"3","display":"First fetch interval (in days)","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_time","options":null,"required":false,"type":0,"value":""},{"defaultValue":"","display":"Fetch incidents","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"isFetch","options":null,"required":false,"type":8,"value":false},{"defaultValue":"","display":"Credentials","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"credentials","options":null,"required":false,"type":9,"value":null},{"defaultValue":"1","display":"Incidents Fetch Interval","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"incidentFetchInterval","options":null,"required":false,"type":19,"value":"1"},{"defaultValue":"Issue","display":"Select an Issue or Pull requests to Fetch","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fetch_object","options":["Issue","Pull_requests"],"required":false,"type":15,"value":"Issue"},{"defaultValue":"","display":"The name of the requested repository","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"repository","options":null,"required":false,"type":0,"value":"etc"},{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8,"value":true}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"6702345c-8fc9-4711-8478-2054361cc2d0","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"Verbose","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-05T15:25:57.167039+03:00","name":"GitHub_IronBank_1","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":1},{"brand":"GitLab","canSample":false,"category":"Utilities","cmdline":"","commandsPermissions":null,"configtypes":{"api_key":4,"insecure":8,"proxy":8,"url":0},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"insecure":false,"proxy":false,"url":"https://repo1.dso.mil/api/v4"},"data":[{"defaultValue":"","display":"API Key","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"api_key","options":null,"required":true,"type":4,"value":""},{"defaultValue":"","display":"Trust any certificate (not secure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8,"value":false},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8,"value":false},{"defaultValue":"https://gitlab.com/api/v4","display":"Server URL (e.g. https://gitlab.com/api/v4)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"url","options":null,"required":true,"type":0,"value":"https://repo1.dso.mil/api/v4"}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"d510674d-cf16-47b3-88db-e146123c81c2","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-05T10:56:39.34185+03:00","name":"GitLab_repo1_dso_mil_ironbank_1","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":4},{"brand":"Image OCR","canSample":false,"category":"","cmdline":"","commandsPermissions":null,"configtypes":null,"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{},"data":null,"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"e1ecf808-2e16-49e5-85e1-aa2afad4b190","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-02T18:10:27.509071+03:00","name":"Image OCR_default_instance","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":3},{"brand":"Rasterize","canSample":false,"category":"Utilities","cmdline":"","commandsPermissions":null,"configtypes":{"chrome_options":0,"max_page_load_time":0,"proxy":8,"wait_time":0,"with_error":8},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"chrome_options":null,"max_page_load_time":"180","proxy":null,"wait_time":"0","with_error":false},"data":[{"defaultValue":"false","display":"Return Errors","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"with_error","options":null,"required":false,"type":8,"value":false},{"defaultValue":"0","display":"Time to wait before taking a screen shot (in seconds)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"wait_time","options":null,"required":false,"type":0,"value":"0"},{"defaultValue":"180","display":"Maximum time to wait for a page to load (in seconds)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"max_page_load_time","options":null,"required":false,"type":0,"value":"180"},{"defaultValue":"","display":"Chrome options (Advanced. See [?])","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"chrome_options","options":null,"required":false,"type":0,"value":null},{"defaultValue":"","display":"Use system proxy settings","displayPassword":"","hasvalue":false,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"proxy","options":null,"required":false,"type":8,"value":null}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"c0aebd2f-fe0b-49eb-80b3-0457889eed70","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"Verbose","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-01T21:20:15.931142+03:00","name":"Rasterize_default_instance","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":5},{"brand":"splunk","canSample":false,"category":"SIEM","cmdline":"","commandsPermissions":null,"configtypes":{"Port":0,"Server":0,"SplunkApp":0,"SplunkUser":0,"Username":9,"isFetch":0},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"Port":"8089","Server":"https://18.196.185.172","SplunkApp":"","SplunkUser":"","Username":{"credential":"","credentials":{"id":"","locked":false,"modified":"0001-01-01T00:00:00Z","name":"","password":"","sortValues":null,"sshkey":"","sshkeyPass":"","user":"","vaultInstanceId":"","version":0,"workgroup":""},"identifier":"admin","password":"{ENCRYPTED}3ytLe6hH7ZQYpe1cH0V4NtQb/0YXtHtCjA7oKEuCGmXzTsA5fYmJe5lICFn4P4/5oSUJabYD3jH+FoAYQYp3cg==","passwordChanged":false},"isFetch":false},"data":null,"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"splunk","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":false,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-08T08:30:29.101204+03:00","name":"splunk","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":19},{"brand":"testmodule","canSample":false,"category":"InformationGathering","cmdline":"","commandsPermissions":null,"configtypes":null,"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{},"data":null,"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"testmodule","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":false,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-08T08:30:29.882183+03:00","name":"testmodule","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":19},{"brand":"VirusTotal","canSample":false,"category":"Data Enrichment","cmdline":"","commandsPermissions":null,"configtypes":{"APIKey":4,"Server":0,"domainThreshold":0,"fileThreshold":0,"fullResponseGlobal":8,"insecure":8,"integrationReliability":0,"ipThreshold":0,"urlThreshold":0,"useproxy":8},"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{"Server":"https://www.virustotal.com/vtapi/v2/","domainThreshold":"10","fileThreshold":"10","fullResponseGlobal":false,"insecure":false,"integrationReliability":"C - Fairly reliable","ipThreshold":"10","urlThreshold":"10","useproxy":true},"data":[{"defaultValue":"false","display":"Trust any certificate (not secure)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"insecure","options":null,"required":false,"type":8,"value":false},{"defaultValue":"C - Fairly reliable","display":"Source Reliability","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"Reliability of the source providing the intelligence data.","name":"integrationReliability","options":["A+ - 3rd party enrichment","A - Completely reliable","B - Usually reliable","C - Fairly reliable","D - Not usually reliable","E - Unreliable","F - Reliability cannot be judged"],"required":true,"type":15,"value":"C - Fairly reliable"},{"defaultValue":"10","display":"Domain Threshold. Minimum number of positive results from VT scanners to consider the domain malicious.","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"domainThreshold","options":null,"required":false,"type":0,"value":"10"},{"defaultValue":"https://www.virustotal.com/vtapi/v2/","display":"Server URL (e.g. https://192.168.0.1)","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"Server","options":null,"required":true,"type":0,"value":"https://www.virustotal.com/vtapi/v2/"},{"defaultValue":"false","display":"Determines whether to return all results, which can number in the thousands. If “true”, returns all results and overrides the _fullResponse_, _long_ arguments (if set to “false”) in a command. If “false”, the _fullResponse_, _long_ arguments in the command determines how results are returned.","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fullResponseGlobal","options":null,"required":false,"type":8,"value":false},{"defaultValue":"true","display":"Use system proxy settings","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"useproxy","options":null,"required":false,"type":8,"value":true},{"defaultValue":"10","display":"URL Threshold. Minimum number of positive results from VT scanners to consider the URL malicious.","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"urlThreshold","options":null,"required":false,"type":0,"value":"10"},{"defaultValue":"","display":"API Key","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"APIKey","options":null,"required":true,"type":4,"value":""},{"defaultValue":"10","display":"IP Threshold. Minimum number of positive results from VT scanners to consider the IP malicious.","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"ipThreshold","options":null,"required":false,"type":0,"value":"10"},{"defaultValue":"10","display":"File Threshold. Minimum number of positive results from VT scanners to consider the file malicious.","displayPassword":"","hasvalue":true,"hidden":false,"hiddenPassword":false,"hiddenUsername":false,"info":"","name":"fileThreshold","options":null,"required":false,"type":0,"value":"10"}],"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"vt","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-09-08T08:30:28.997686+03:00","name":"vt","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":21},{"brand":"Where is the egg?","canSample":false,"category":"","cmdline":"","commandsPermissions":null,"configtypes":null,"configuration":{"brand":"","canGetSamples":false,"category":"","commitMessage":"","configuration":null,"definitionId":"","description":"","display":"","fromServerVersion":"","hidden":false,"icon":"","id":"","integrationScript":null,"itemVersion":"","modified":"0001-01-01T00:00:00Z","name":"","packID":"","prevName":"","shouldCommit":false,"sortValues":null,"toServerVersion":"","vcShouldIgnore":false,"vcShouldKeepItemLegacyProdMachine":false,"version":0},"configvalues":{},"data":null,"debugMode":false,"defaultIgnore":false,"definitionId":"","displayPassword":"","enabled":"true","engine":"","engineGroup":"","executable":"","fromServerVersion":"","hidden":false,"id":"b6a11805-021c-413f-88d2-4181ce8d7791","incidentFetchInterval":0,"incomingMapperId":"","integrationLogLevel":"","isFetchSamples":false,"isIntegrationScript":true,"islongRunning":false,"itemVersion":"","longRunningId":"","mappable":false,"mappingId":"","modified":"2021-08-24T18:47:07.584061+03:00","name":"Where is the egg?_default_instance","outgoingMapperId":"","packID":"","passwordProtected":false,"path":"","propagationLabels":["all"],"remoteSync":false,"remoteSyncableIn":false,"remoteSyncableOut":false,"servicesID":"main","sortValues":null,"toServerVersion":"","version":1}]}